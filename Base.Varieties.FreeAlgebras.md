---
layout: default
title : "Base.Varieties.FreeAlgebras module (Agda Universal Algebra Library)"
date : "2021-03-01"
author: "the agda-algebras development team"
---

### <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Base.Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if `𝒦` is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="818" class="Symbol">{-#</a> <a id="822" class="Keyword">OPTIONS</a> <a id="830" class="Pragma">--without-K</a> <a id="842" class="Pragma">--exact-split</a> <a id="856" class="Pragma">--safe</a> <a id="863" class="Symbol">#-}</a>

<a id="868" class="Keyword">open</a> <a id="873" class="Keyword">import</a> <a id="880" href="Level.html" class="Module">Level</a>            <a id="897" class="Keyword">using</a> <a id="903" class="Symbol">(</a> <a id="905" href="Agda.Primitive.html#597" class="Postulate">Level</a> <a id="911" class="Symbol">)</a>
<a id="913" class="Keyword">open</a> <a id="918" class="Keyword">import</a> <a id="925" href="Overture.html" class="Module">Overture</a>  <a id="935" class="Keyword">using</a> <a id="941" class="Symbol">(</a> <a id="943" href="Overture.Signatures.html#520" class="Generalizable">𝓞</a> <a id="945" class="Symbol">;</a> <a id="947" href="Overture.Signatures.html#522" class="Generalizable">𝓥</a> <a id="949" class="Symbol">;</a> <a id="951" href="Overture.Signatures.html#3171" class="Function">Signature</a> <a id="961" class="Symbol">)</a>
<a id="963" class="Keyword">module</a> <a id="970" href="Base.Varieties.FreeAlgebras.html" class="Module">Base.Varieties.FreeAlgebras</a> <a id="998" class="Symbol">{</a><a id="999" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="1001" class="Symbol">:</a> <a id="1003" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="1008" class="Symbol">}</a> <a id="1010" class="Symbol">{</a><a id="1011" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="Overture.Signatures.html#3171" class="Function">Signature</a> <a id="1025" href="Overture.Signatures.html#520" class="Generalizable">𝓞</a> <a id="1027" href="Overture.Signatures.html#522" class="Generalizable">𝓥</a><a id="1028" class="Symbol">}</a> <a id="1030" class="Keyword">where</a>

<a id="1037" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1110" class="Keyword">open</a>  <a id="1116" class="Keyword">import</a> <a id="1123" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>   <a id="1140" class="Keyword">using</a> <a id="1146" class="Symbol">(</a> <a id="1148" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1152" class="Symbol">)</a><a id="1153" class="Keyword">renaming</a>  <a id="1163" class="Symbol">(</a> <a id="1165" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1169" class="Symbol">to</a> <a id="1172" class="Primitive">Type</a> <a id="1177" class="Symbol">)</a>
<a id="1179" class="Keyword">open</a>  <a id="1185" class="Keyword">import</a> <a id="1192" href="Data.Product.html" class="Module">Data.Product</a>     <a id="1209" class="Keyword">using</a> <a id="1215" class="Symbol">(</a> <a id="1217" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1221" class="Symbol">;</a> <a id="1223" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1232" class="Symbol">;</a> <a id="1234" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1238" class="Symbol">)</a>
                              <a id="1270" class="Keyword">renaming</a>  <a id="1280" class="Symbol">(</a> <a id="1282" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1288" class="Symbol">to</a> <a id="1291" class="Field">fst</a> <a id="1295" class="Symbol">;</a> <a id="1297" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1303" class="Symbol">to</a> <a id="1306" class="Field">snd</a> <a id="1310" class="Symbol">)</a>
<a id="1312" class="Keyword">open</a>  <a id="1318" class="Keyword">import</a> <a id="1325" href="Function.html" class="Module">Function</a>         <a id="1342" class="Keyword">using</a> <a id="1348" class="Symbol">(</a> <a id="1350" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1354" class="Symbol">)</a>
<a id="1356" class="Keyword">open</a>  <a id="1362" class="Keyword">import</a> <a id="1369" href="Level.html" class="Module">Level</a>            <a id="1386" class="Keyword">using</a> <a id="1392" class="Symbol">(</a> <a id="1394" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="1398" class="Symbol">)</a>
<a id="1400" class="Keyword">open</a>  <a id="1406" class="Keyword">import</a> <a id="1413" href="Relation.Binary.html" class="Module">Relation.Binary</a>  <a id="1430" class="Keyword">using</a> <a id="1436" class="Symbol">(</a> <a id="1438" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1452" class="Symbol">)</a> <a id="1454" class="Keyword">renaming</a>  <a id="1464" class="Symbol">(</a> <a id="1466" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1470" class="Symbol">to</a> <a id="1473" class="Function">BinRel</a> <a id="1480" class="Symbol">)</a>
<a id="1482" class="Keyword">open</a>  <a id="1488" class="Keyword">import</a> <a id="1495" href="Relation.Unary.html" class="Module">Relation.Unary</a>   <a id="1512" class="Keyword">using</a> <a id="1518" class="Symbol">(</a> <a id="1520" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1525" class="Symbol">;</a> <a id="1527" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1531" class="Symbol">;</a> <a id="1533" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1537" class="Symbol">;</a> <a id="1539" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1543" class="Symbol">;</a> <a id="1545" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1549" class="Symbol">)</a>

<a id="1552" class="Keyword">open</a>  <a id="1558" class="Keyword">import</a> <a id="1565" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
      <a id="1606" class="Keyword">using</a> <a id="1612" class="Symbol">()</a> <a id="1615" class="Keyword">renaming</a>  <a id="1625" class="Symbol">(</a><a id="1626" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1641" class="Symbol">to</a> <a id="1644" class="Function">funext</a><a id="1650" class="Symbol">)</a>
<a id="1652" class="Keyword">open</a>  <a id="1658" class="Keyword">import</a> <a id="1665" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1703" class="Symbol">as</a> <a id="1706" class="Module">≡</a>
      <a id="1714" class="Keyword">using</a> <a id="1720" class="Symbol">(</a> <a id="1722" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1726" class="Symbol">;</a> <a id="1728" class="Keyword">module</a> <a id="1735" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1747" class="Symbol">)</a>

<a id="1750" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1845" class="Keyword">open</a>  <a id="1851" class="Keyword">import</a> <a id="1858" href="Overture.html" class="Module">Overture</a>        <a id="1874" class="Keyword">using</a> <a id="1880" class="Symbol">(</a> <a id="1882" href="Overture.Basic.html#4303" class="Function Operator">∣_∣</a> <a id="1886" class="Symbol">;</a> <a id="1888" href="Overture.Basic.html#4341" class="Function Operator">∥_∥</a> <a id="1892" class="Symbol">;</a> <a id="1894" href="Overture.Basic.html#5223" class="Function Operator">_∙_</a> <a id="1898" class="Symbol">;</a> <a id="1900" href="Overture.Basic.html#4897" class="Function Operator">_⁻¹</a> <a id="1904" class="Symbol">)</a>
<a id="1906" class="Keyword">open</a>  <a id="1912" class="Keyword">import</a> <a id="1919" href="Base.Functions.html" class="Module">Base.Functions</a>  <a id="1935" class="Keyword">using</a> <a id="1941" class="Symbol">(</a> <a id="1943" href="Base.Functions.Surjective.html#1759" class="Function">IsSurjective</a> <a id="1956" class="Symbol">)</a>
<a id="1958" class="Keyword">open</a>  <a id="1964" class="Keyword">import</a> <a id="1971" href="Base.Relations.html" class="Module">Base.Relations</a>  <a id="1987" class="Keyword">using</a> <a id="1993" class="Symbol">(</a> <a id="1995" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="2002" class="Symbol">;</a> <a id="2004" href="Base.Relations.Quotients.html#5437" class="Function Operator">⟪_⟫</a> <a id="2008" class="Symbol">)</a>
<a id="2010" class="Keyword">open</a>  <a id="2016" class="Keyword">import</a> <a id="2023" href="Base.Equality.html" class="Module">Base.Equality</a>
      <a id="2043" class="Keyword">using</a> <a id="2049" class="Symbol">(</a> <a id="2051" href="Base.Equality.Welldefined.html#2798" class="Function">SwellDef</a> <a id="2060" class="Symbol">;</a> <a id="2062" href="Base.Equality.Welldefined.html#2509" class="Function">swelldef</a> <a id="2071" class="Symbol">;</a> <a id="2073" href="Base.Equality.Truncation.html#6603" class="Function">is-set</a> <a id="2080" class="Symbol">;</a> <a id="2082" href="Base.Equality.Truncation.html#10874" class="Function">blk-uip</a> <a id="2090" class="Symbol">;</a> <a id="2092" href="Base.Equality.Truncation.html#3945" class="Function">hfunext</a> <a id="2100" class="Symbol">;</a> <a id="2102" href="Base.Equality.Extensionality.html#2206" class="Function">DFunExt</a><a id="2109" class="Symbol">;</a> <a id="2111" href="Base.Equality.Extensionality.html#3021" class="Function">pred-ext</a> <a id="2120" class="Symbol">)</a>

<a id="2123" class="Keyword">open</a>  <a id="2129" class="Keyword">import</a> <a id="2136" href="Base.Algebras.html" class="Module">Base.Algebras</a> <a id="2150" class="Symbol">{</a><a id="2151" class="Argument">𝑆</a> <a id="2153" class="Symbol">=</a> <a id="2155" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2156" class="Symbol">}</a>
      <a id="2164" class="Keyword">using</a> <a id="2170" class="Symbol">(</a> <a id="2172" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="2180" class="Symbol">;</a> <a id="2182" href="Base.Algebras.Basic.html#7594" class="Function">Lift-Alg</a> <a id="2191" class="Symbol">;</a> <a id="2193" href="Base.Algebras.Basic.html#9230" class="Function">compatible</a><a id="2203" class="Symbol">;</a>  <a id="2206" href="Base.Algebras.Basic.html#6152" class="Function Operator">_̂_</a> <a id="2210" class="Symbol">;</a> <a id="2212" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="2215" class="Symbol">;</a> <a id="2217" href="Base.Algebras.Products.html#1925" class="Function">⨅</a> <a id="2219" class="Symbol">;</a> <a id="2221" href="Base.Algebras.Congruences.html#1999" class="Function">Con</a><a id="2224" class="Symbol">;</a> <a id="2226" href="Base.Algebras.Congruences.html#1916" class="InductiveConstructor">mkcon</a> <a id="2232" class="Symbol">;</a> <a id="2234" href="Base.Algebras.Congruences.html#1828" class="Record">IsCongruence</a> <a id="2247" class="Symbol">)</a>
<a id="2249" class="Keyword">open</a>  <a id="2255" class="Keyword">import</a> <a id="2262" href="Base.Homomorphisms.html" class="Module">Base.Homomorphisms</a> <a id="2281" class="Symbol">{</a><a id="2282" class="Argument">𝑆</a> <a id="2284" class="Symbol">=</a> <a id="2286" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2287" class="Symbol">}</a>
      <a id="2295" class="Keyword">using</a> <a id="2301" class="Symbol">(</a> <a id="2303" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="2307" class="Symbol">;</a> <a id="2309" href="Base.Homomorphisms.Basic.html#4313" class="Function">epi</a> <a id="2313" class="Symbol">;</a> <a id="2315" href="Base.Homomorphisms.Basic.html#4774" class="Function">epi→hom</a> <a id="2323" class="Symbol">;</a> <a id="2325" href="Base.Homomorphisms.Kernels.html#2368" class="Function">kercon</a> <a id="2332" class="Symbol">;</a> <a id="2334" href="Base.Homomorphisms.Kernels.html#4792" class="Function">ker-in-con</a> <a id="2345" class="Symbol">;</a> <a id="2347" href="Base.Homomorphisms.Kernels.html#4274" class="Function">πker</a> <a id="2352" class="Symbol">;</a> <a id="2354" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2366" class="Symbol">;</a> <a id="2368" href="Base.Homomorphisms.Properties.html#1464" class="Function">∘-hom</a> <a id="2374" class="Symbol">)</a>
      <a id="2382" class="Keyword">using</a> <a id="2388" class="Symbol">(</a> <a id="2390" href="Base.Homomorphisms.Products.html#1638" class="Function">⨅-hom-co</a> <a id="2399" class="Symbol">;</a> <a id="2401" href="Base.Homomorphisms.Factor.html#1854" class="Function">HomFactor</a> <a id="2411" class="Symbol">;</a> <a id="2413" href="Base.Homomorphisms.Factor.html#3126" class="Function">HomFactorEpi</a> <a id="2426" class="Symbol">;</a> <a id="2428" href="Base.Homomorphisms.Isomorphisms.html#2018" class="Record Operator">_≅_</a> <a id="2432" class="Symbol">;</a> <a id="2434" href="Base.Homomorphisms.Isomorphisms.html#2882" class="Function">≅-refl</a> <a id="2441" class="Symbol">;</a> <a id="2443" href="Base.Homomorphisms.Isomorphisms.html#2976" class="Function">≅-sym</a> <a id="2449" class="Symbol">;</a> <a id="2451" href="Base.Homomorphisms.Isomorphisms.html#4433" class="Function">Lift-≅</a> <a id="2458" class="Symbol">)</a>
<a id="2460" class="Keyword">open</a>  <a id="2466" class="Keyword">import</a> <a id="2473" href="Base.Terms.html" class="Module">Base.Terms</a> <a id="2484" class="Symbol">{</a><a id="2485" class="Argument">𝑆</a> <a id="2487" class="Symbol">=</a> <a id="2489" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2490" class="Symbol">}</a>
      <a id="2498" class="Keyword">using</a> <a id="2504" class="Symbol">(</a> <a id="2506" href="Base.Terms.Basic.html#2087" class="Datatype">Term</a> <a id="2511" class="Symbol">;</a> <a id="2513" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="2515" class="Symbol">;</a> <a id="2517" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="2527" class="Symbol">;</a> <a id="2529" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="2538" class="Symbol">;</a> <a id="2540" href="Base.Terms.Properties.html#3609" class="Function">free-unique</a> <a id="2552" class="Symbol">;</a> <a id="2554" href="Base.Terms.Operations.html#2603" class="Function Operator">_⟦_⟧</a> <a id="2559" class="Symbol">)</a>
      <a id="2567" class="Keyword">using</a> <a id="2573" class="Symbol">(</a> <a id="2575" href="Base.Terms.Properties.html#4850" class="Function">lift-of-epi-is-epi</a> <a id="2594" class="Symbol">;</a> <a id="2596" href="Base.Terms.Operations.html#6698" class="Function">comm-hom-term</a><a id="2609" class="Symbol">;</a> <a id="2611" href="Base.Terms.Operations.html#2914" class="Function">free-lift-interp</a> <a id="2628" class="Symbol">)</a>
<a id="2630" class="Keyword">open</a>  <a id="2636" class="Keyword">import</a> <a id="2643" href="Base.Subalgebras.html" class="Module">Base.Subalgebras</a> <a id="2660" class="Symbol">{</a><a id="2661" class="Argument">𝑆</a> <a id="2663" class="Symbol">=</a> <a id="2665" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2666" class="Symbol">}</a>
      <a id="2674" class="Keyword">using</a> <a id="2680" class="Symbol">(</a> <a id="2682" href="Base.Subalgebras.Subalgebras.html#1868" class="Function Operator">_≤_</a> <a id="2686" class="Symbol">;</a> <a id="2688" href="Base.Subalgebras.Subalgebras.html#3711" class="Function">FirstHomCorollary|Set</a> <a id="2710" class="Symbol">)</a>

<a id="2713" class="Keyword">open</a>  <a id="2719" class="Keyword">import</a> <a id="2726" href="Base.Varieties.EquationalLogic.html" class="Module">Base.Varieties.EquationalLogic</a> <a id="2757" class="Symbol">{</a><a id="2758" class="Argument">𝑆</a> <a id="2760" class="Symbol">=</a> <a id="2762" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2763" class="Symbol">}</a>
      <a id="2771" class="Keyword">using</a> <a id="2777" class="Symbol">(</a> <a id="2779" href="Base.Varieties.EquationalLogic.html#2530" class="Function Operator">_⊫_≈_</a><a id="2784" class="Symbol">;</a> <a id="2786" href="Base.Varieties.EquationalLogic.html#2452" class="Function Operator">_⊧_≈_</a><a id="2791" class="Symbol">;</a> <a id="2793" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a><a id="2795" class="Symbol">;</a> <a id="2797" href="Base.Varieties.EquationalLogic.html#3871" class="Function">Mod</a> <a id="2801" class="Symbol">)</a>
<a id="2803" class="Keyword">open</a>  <a id="2809" class="Keyword">import</a> <a id="2816" href="Base.Varieties.Closure.html" class="Module">Base.Varieties.Closure</a> <a id="2839" class="Symbol">{</a><a id="2840" class="Argument">𝑆</a> <a id="2842" class="Symbol">=</a> <a id="2844" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2845" class="Symbol">}</a>
      <a id="2853" class="Keyword">using</a> <a id="2859" class="Symbol">(</a> <a id="2861" href="Base.Varieties.Closure.html#3549" class="Datatype">S</a> <a id="2863" class="Symbol">;</a> <a id="2865" href="Base.Varieties.Closure.html#4124" class="Datatype">P</a> <a id="2867" class="Symbol">;</a> <a id="2869" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="2871" class="Symbol">)</a>
<a id="2873" class="Keyword">open</a>  <a id="2879" class="Keyword">import</a> <a id="2886" href="Base.Varieties.Preservation.html" class="Module">Base.Varieties.Preservation</a> <a id="2914" class="Symbol">{</a><a id="2915" class="Argument">𝑆</a> <a id="2917" class="Symbol">=</a> <a id="2919" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="2920" class="Symbol">}</a>
      <a id="2928" class="Keyword">using</a> <a id="2934" class="Symbol">(</a> <a id="2936" class="Keyword">module</a> <a id="2943" href="Base.Varieties.Preservation.html#9933" class="Module">class-products-with-maps</a> <a id="2968" class="Symbol">;</a> <a id="2970" href="Base.Varieties.Preservation.html#20002" class="Function">class-ids-⇒</a> <a id="2982" class="Symbol">;</a> <a id="2984" href="Base.Varieties.Preservation.html#20115" class="Function">class-ids</a> <a id="2994" class="Symbol">;</a> <a id="2996" href="Base.Varieties.Preservation.html#8748" class="Function">SP⊆V&#39;</a><a id="3001" class="Symbol">)</a>

<a id="3004" class="Keyword">open</a> <a id="3009" href="Base.Terms.Basic.html#2087" class="Module">Term</a> <a id="3014" class="Symbol">;</a> <a id="3016" class="Keyword">open</a> <a id="3021" href="Base.Varieties.Closure.html#3549" class="Module">S</a> <a id="3023" class="Symbol">;</a> <a id="3025" class="Keyword">open</a> <a id="3030" href="Base.Varieties.Closure.html#5094" class="Module">V</a>

<a id="𝓕"></a><a id="3033" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3035" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="3038" class="Symbol">:</a> <a id="3040" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3046" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="3048" class="Symbol">=</a> <a id="3050" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="3053" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a>
<a id="3055" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="3058" class="Symbol">=</a> <a id="3060" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="3064" class="Symbol">(</a><a id="3065" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="3068" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="3069" class="Symbol">)</a>    <a id="3074" class="Comment">-- (this will be the level of the free algebra)</a>
</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in the [Base.Terms.Basic][] module that the term algebra `𝑻 X` is absolutely free in the class of all `𝑆`-structures.
In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.
Let `Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}`, and let `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.
(Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.)
The free algebra is constructed by applying the definitions of `θ` and `ψ` to the special case in which `𝑨` is the algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔽[ X ] := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔽[ X ]` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔽[ X ]` belongs to `SP(𝒦)`, and must therefore satisfy all identities modeled by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔽[ X ]`.

The `𝔽[ X ]` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔽[ X ]` is free *in* `SP(𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔽[ X ]`, technically it doesn't make sense to say "`X` generates `𝔽[ X ]`." But as long as `𝒦` contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which *is* a subset of `𝔽[ X ]`.



#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔽[ X ] := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="5509" class="Keyword">module</a> <a id="5516" href="Base.Varieties.FreeAlgebras.html#5516" class="Module">_</a> <a id="5518" class="Symbol">{</a><a id="5519" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a> <a id="5521" class="Symbol">:</a> <a id="5523" href="Base.Varieties.FreeAlgebras.html#1172" class="Primitive">Type</a> <a id="5528" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="5529" class="Symbol">}(</a><a id="5531" href="Base.Varieties.FreeAlgebras.html#5531" class="Bound">𝒦</a> <a id="5533" class="Symbol">:</a> <a id="5535" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="5540" class="Symbol">(</a><a id="5541" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="5549" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="5551" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="5552" class="Symbol">)</a> <a id="5554" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="5555" class="Symbol">)</a> <a id="5557" class="Keyword">where</a>

 <a id="5565" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="5567" class="Symbol">:</a> <a id="5569" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="5574" class="Symbol">(</a><a id="5575" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5577" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="5579" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a> <a id="5581" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5583" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5585" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5587" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="5589" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a> <a id="5591" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="5592" class="Symbol">)</a> <a id="5594" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a>
 <a id="5597" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="5599" class="Symbol">(</a><a id="5600" href="Base.Varieties.FreeAlgebras.html#5600" class="Bound">p</a> <a id="5602" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5604" href="Base.Varieties.FreeAlgebras.html#5604" class="Bound">q</a><a id="5605" class="Symbol">)</a> <a id="5607" class="Symbol">=</a> <a id="5609" class="Symbol">∀(</a><a id="5611" href="Base.Varieties.FreeAlgebras.html#5611" class="Bound">𝑨</a> <a id="5613" class="Symbol">:</a> <a id="5615" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="5623" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="5625" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="5626" class="Symbol">)(</a><a id="5628" href="Base.Varieties.FreeAlgebras.html#5628" class="Bound">sA</a> <a id="5631" class="Symbol">:</a> <a id="5633" href="Base.Varieties.FreeAlgebras.html#5611" class="Bound">𝑨</a> <a id="5635" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="5637" href="Base.Varieties.Closure.html#3549" class="Datatype">S</a><a id="5638" class="Symbol">{</a><a id="5639" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="5640" class="Symbol">}{</a><a id="5642" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="5643" class="Symbol">}</a> <a id="5645" href="Base.Varieties.FreeAlgebras.html#5531" class="Bound">𝒦</a><a id="5646" class="Symbol">)(</a><a id="5648" href="Base.Varieties.FreeAlgebras.html#5648" class="Bound">h</a> <a id="5650" class="Symbol">:</a> <a id="5652" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a> <a id="5654" class="Symbol">→</a> <a id="5656" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5658" href="Base.Varieties.FreeAlgebras.html#5611" class="Bound">𝑨</a> <a id="5660" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5662" class="Symbol">)</a>
                 <a id="5681" class="Symbol">→</a>  <a id="5684" class="Symbol">(</a><a id="5685" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="5695" href="Base.Varieties.FreeAlgebras.html#5611" class="Bound">𝑨</a> <a id="5697" href="Base.Varieties.FreeAlgebras.html#5648" class="Bound">h</a><a id="5698" class="Symbol">)</a> <a id="5700" href="Base.Varieties.FreeAlgebras.html#5600" class="Bound">p</a> <a id="5702" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5704" class="Symbol">(</a><a id="5705" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="5715" href="Base.Varieties.FreeAlgebras.html#5611" class="Bound">𝑨</a> <a id="5717" href="Base.Varieties.FreeAlgebras.html#5648" class="Bound">h</a><a id="5718" class="Symbol">)</a> <a id="5720" href="Base.Varieties.FreeAlgebras.html#5604" class="Bound">q</a>

</pre>

We convert the predicate `ψ` into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="5851" href="Base.Varieties.FreeAlgebras.html#5851" class="Function">ψRel</a> <a id="5856" class="Symbol">:</a> <a id="5858" href="Base.Varieties.FreeAlgebras.html#1473" class="Function">BinRel</a> <a id="5865" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5867" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="5869" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a> <a id="5871" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="5873" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a>
 <a id="5876" href="Base.Varieties.FreeAlgebras.html#5851" class="Function">ψRel</a> <a id="5881" href="Base.Varieties.FreeAlgebras.html#5881" class="Bound">p</a> <a id="5883" href="Base.Varieties.FreeAlgebras.html#5883" class="Bound">q</a> <a id="5885" class="Symbol">=</a> <a id="5887" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="5889" class="Symbol">(</a><a id="5890" href="Base.Varieties.FreeAlgebras.html#5881" class="Bound">p</a> <a id="5892" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5894" href="Base.Varieties.FreeAlgebras.html#5883" class="Bound">q</a><a id="5895" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6143" class="Keyword">open</a> <a id="6148" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6162" href="Base.Varieties.FreeAlgebras.html#6162" class="Function">ψcompatible</a> <a id="6174" class="Symbol">:</a> <a id="6176" href="Base.Equality.Welldefined.html#2509" class="Function">swelldef</a> <a id="6185" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="6187" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="6189" class="Symbol">→</a> <a id="6191" href="Base.Algebras.Basic.html#9230" class="Function">compatible</a> <a id="6202" class="Symbol">(</a><a id="6203" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6205" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6206" class="Symbol">)</a> <a id="6208" href="Base.Varieties.FreeAlgebras.html#5851" class="Function">ψRel</a>
 <a id="6214" href="Base.Varieties.FreeAlgebras.html#6162" class="Function">ψcompatible</a> <a id="6226" href="Base.Varieties.FreeAlgebras.html#6226" class="Bound">wd</a> <a id="6229" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6231" class="Symbol">{</a><a id="6232" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a><a id="6233" class="Symbol">}</a> <a id="6235" class="Symbol">{</a><a id="6236" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6237" class="Symbol">}</a> <a id="6239" href="Base.Varieties.FreeAlgebras.html#6239" class="Bound">ψpq</a> <a id="6243" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a> <a id="6245" href="Base.Varieties.FreeAlgebras.html#6245" class="Bound">sA</a> <a id="6248" href="Base.Varieties.FreeAlgebras.html#6248" class="Bound">h</a> <a id="6250" class="Symbol">=</a> <a id="6252" href="Base.Varieties.FreeAlgebras.html#6302" class="Function">γ</a>
  <a id="6256" class="Keyword">where</a>
  <a id="6264" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6266" class="Symbol">:</a> <a id="6268" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="6272" class="Symbol">(</a><a id="6273" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6275" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6276" class="Symbol">)</a> <a id="6278" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a>
  <a id="6282" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6284" class="Symbol">=</a> <a id="6286" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="6295" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a> <a id="6297" href="Base.Varieties.FreeAlgebras.html#6248" class="Bound">h</a>

  <a id="6302" href="Base.Varieties.FreeAlgebras.html#6302" class="Function">γ</a> <a id="6304" class="Symbol">:</a> <a id="6306" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6308" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6310" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6312" class="Symbol">((</a><a id="6314" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6316" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6318" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6320" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6321" class="Symbol">)</a> <a id="6323" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a><a id="6324" class="Symbol">)</a> <a id="6326" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6328" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6330" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6332" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6334" class="Symbol">((</a><a id="6336" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6338" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6340" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6342" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6343" class="Symbol">)</a> <a id="6345" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6346" class="Symbol">)</a>

  <a id="6351" href="Base.Varieties.FreeAlgebras.html#6302" class="Function">γ</a> <a id="6353" class="Symbol">=</a> <a id="6355" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6357" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6359" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6361" class="Symbol">((</a><a id="6363" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6365" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6367" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6369" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6370" class="Symbol">)</a> <a id="6372" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a><a id="6373" class="Symbol">)</a>  <a id="6376" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6379" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="6381" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6383" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="6385" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6387" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a> <a id="6389" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="6397" class="Symbol">(</a><a id="6398" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6400" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6402" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a><a id="6403" class="Symbol">)</a> <a id="6405" class="Symbol">(</a><a id="6406" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6408" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6410" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6412" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6414" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a><a id="6415" class="Symbol">)</a>  <a id="6418" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6421" href="Base.Varieties.FreeAlgebras.html#6226" class="Bound">wd</a> <a id="6424" class="Symbol">(</a><a id="6425" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6427" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6429" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a><a id="6430" class="Symbol">)(</a><a id="6432" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6434" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6436" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6438" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6440" href="Base.Varieties.FreeAlgebras.html#6232" class="Bound">p</a><a id="6441" class="Symbol">)(</a><a id="6443" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6445" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6447" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6449" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6451" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6452" class="Symbol">)(λ</a> <a id="6456" href="Base.Varieties.FreeAlgebras.html#6456" class="Bound">x</a> <a id="6458" class="Symbol">→</a> <a id="6460" href="Base.Varieties.FreeAlgebras.html#6239" class="Bound">ψpq</a> <a id="6464" href="Base.Varieties.FreeAlgebras.html#6456" class="Bound">x</a> <a id="6466" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a> <a id="6468" href="Base.Varieties.FreeAlgebras.html#6245" class="Bound">sA</a> <a id="6471" href="Base.Varieties.FreeAlgebras.html#6248" class="Bound">h</a><a id="6472" class="Symbol">)</a> <a id="6474" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="6482" class="Symbol">(</a><a id="6483" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6485" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6487" href="Base.Varieties.FreeAlgebras.html#6243" class="Bound">𝑨</a><a id="6488" class="Symbol">)</a> <a id="6490" class="Symbol">(</a><a id="6491" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6493" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6495" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6497" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6499" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6500" class="Symbol">)</a>  <a id="6503" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6506" class="Symbol">(</a><a id="6507" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="6509" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6511" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="6513" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6515" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6516" class="Symbol">)</a><a id="6517" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a> <a id="6520" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="6528" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6530" href="Base.Varieties.FreeAlgebras.html#6264" class="Function">φ</a> <a id="6532" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="6534" class="Symbol">((</a><a id="6536" href="Base.Varieties.FreeAlgebras.html#6229" class="Bound">𝑓</a> <a id="6538" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="6540" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="6542" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="6543" class="Symbol">)</a> <a id="6545" href="Base.Varieties.FreeAlgebras.html#6236" class="Bound">q</a><a id="6546" class="Symbol">)</a>  <a id="6549" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="6553" href="Base.Varieties.FreeAlgebras.html#6553" class="Function">ψIsEquivalence</a> <a id="6568" class="Symbol">:</a> <a id="6570" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="6584" href="Base.Varieties.FreeAlgebras.html#5851" class="Function">ψRel</a>
 <a id="6590" href="Base.Varieties.FreeAlgebras.html#6553" class="Function">ψIsEquivalence</a> <a id="6605" class="Symbol">=</a> <a id="6607" class="Keyword">record</a>  <a id="6615" class="Symbol">{</a> <a id="6617" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="6622" class="Symbol">=</a> <a id="6624" class="Symbol">λ</a> <a id="6626" href="Base.Varieties.FreeAlgebras.html#6626" class="Bound">𝑨</a> <a id="6628" href="Base.Varieties.FreeAlgebras.html#6628" class="Bound">sA</a> <a id="6631" href="Base.Varieties.FreeAlgebras.html#6631" class="Bound">h</a> <a id="6633" class="Symbol">→</a> <a id="6635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">≡.refl</a>
                          <a id="6668" class="Symbol">;</a> <a id="6670" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="6674" class="Symbol">=</a> <a id="6676" class="Symbol">λ</a> <a id="6678" href="Base.Varieties.FreeAlgebras.html#6678" class="Bound">x</a> <a id="6680" href="Base.Varieties.FreeAlgebras.html#6680" class="Bound">𝑨</a> <a id="6682" href="Base.Varieties.FreeAlgebras.html#6682" class="Bound">sA</a> <a id="6685" href="Base.Varieties.FreeAlgebras.html#6685" class="Bound">h</a> <a id="6687" class="Symbol">→</a> <a id="6689" class="Symbol">(</a><a id="6690" href="Base.Varieties.FreeAlgebras.html#6678" class="Bound">x</a> <a id="6692" href="Base.Varieties.FreeAlgebras.html#6680" class="Bound">𝑨</a> <a id="6694" href="Base.Varieties.FreeAlgebras.html#6682" class="Bound">sA</a> <a id="6697" href="Base.Varieties.FreeAlgebras.html#6685" class="Bound">h</a><a id="6698" class="Symbol">)</a><a id="6699" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a>
                          <a id="6728" class="Symbol">;</a> <a id="6730" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="6736" class="Symbol">=</a> <a id="6738" class="Symbol">λ</a> <a id="6740" href="Base.Varieties.FreeAlgebras.html#6740" class="Bound">pψq</a> <a id="6744" href="Base.Varieties.FreeAlgebras.html#6744" class="Bound">qψr</a> <a id="6748" href="Base.Varieties.FreeAlgebras.html#6748" class="Bound">𝑨</a> <a id="6750" href="Base.Varieties.FreeAlgebras.html#6750" class="Bound">sA</a> <a id="6753" href="Base.Varieties.FreeAlgebras.html#6753" class="Bound">h</a> <a id="6755" class="Symbol">→</a> <a id="6757" class="Symbol">(</a><a id="6758" href="Base.Varieties.FreeAlgebras.html#6740" class="Bound">pψq</a> <a id="6762" href="Base.Varieties.FreeAlgebras.html#6748" class="Bound">𝑨</a> <a id="6764" href="Base.Varieties.FreeAlgebras.html#6750" class="Bound">sA</a> <a id="6767" href="Base.Varieties.FreeAlgebras.html#6753" class="Bound">h</a><a id="6768" class="Symbol">)</a> <a id="6770" href="Overture.Basic.html#5223" class="Function Operator">∙</a> <a id="6772" class="Symbol">(</a><a id="6773" href="Base.Varieties.FreeAlgebras.html#6744" class="Bound">qψr</a> <a id="6777" href="Base.Varieties.FreeAlgebras.html#6748" class="Bound">𝑨</a> <a id="6779" href="Base.Varieties.FreeAlgebras.html#6750" class="Bound">sA</a> <a id="6782" href="Base.Varieties.FreeAlgebras.html#6753" class="Bound">h</a><a id="6783" class="Symbol">)</a> <a id="6785" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7085" href="Base.Varieties.FreeAlgebras.html#7085" class="Function">ψCon</a> <a id="7090" class="Symbol">:</a> <a id="7092" href="Base.Equality.Welldefined.html#2509" class="Function">swelldef</a> <a id="7101" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="7103" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="7105" class="Symbol">→</a> <a id="7107" href="Base.Algebras.Congruences.html#1999" class="Function">Con</a> <a id="7111" class="Symbol">(</a><a id="7112" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="7114" href="Base.Varieties.FreeAlgebras.html#5519" class="Bound">X</a><a id="7115" class="Symbol">)</a>
 <a id="7118" href="Base.Varieties.FreeAlgebras.html#7085" class="Function">ψCon</a> <a id="7123" href="Base.Varieties.FreeAlgebras.html#7123" class="Bound">wd</a> <a id="7126" class="Symbol">=</a> <a id="7128" href="Base.Varieties.FreeAlgebras.html#5851" class="Function">ψRel</a> <a id="7133" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7135" href="Base.Algebras.Congruences.html#1916" class="InductiveConstructor">mkcon</a> <a id="7141" href="Base.Varieties.FreeAlgebras.html#6553" class="Function">ψIsEquivalence</a> <a id="7156" class="Symbol">(</a><a id="7157" href="Base.Varieties.FreeAlgebras.html#6162" class="Function">ψcompatible</a> <a id="7169" href="Base.Varieties.FreeAlgebras.html#7123" class="Bound">wd</a><a id="7171" class="Symbol">)</a>
</pre>


#### <a id="hsp-theorem">HSP Theorem</a>

To complete the proof of the HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄 hom𝔄`. Here, `⨅-hom-co` (defined in the [Base.Homomorphisms.Properties][] module) takes the term algebra `𝑻 X`, a family `{𝔄 : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄 i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is "natural" in the sense that the `i`-th component of the image of `t : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ t` of `t` under the i-th homomorphism `hom𝔄 i`.


#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in our approach to formalizing the HSP theorem that turned out to be more technically challenging than we anticipated.  We must prove that the free algebra embeds in the product `ℭ` of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels `𝓥` and `α`, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="9576" class="Keyword">module</a> <a id="9583" href="Base.Varieties.FreeAlgebras.html#9583" class="Module">_</a> <a id="9585" class="Symbol">{</a><a id="9586" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="9589" class="Symbol">:</a> <a id="9591" href="Base.Equality.Extensionality.html#2206" class="Function">DFunExt</a><a id="9598" class="Symbol">}{</a><a id="9600" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="9603" class="Symbol">:</a> <a id="9605" href="Base.Equality.Welldefined.html#2798" class="Function">SwellDef</a><a id="9613" class="Symbol">}{</a><a id="9615" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="9617" class="Symbol">:</a> <a id="9619" href="Base.Varieties.FreeAlgebras.html#1172" class="Primitive">Type</a> <a id="9624" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="9625" class="Symbol">}</a> <a id="9627" class="Symbol">{</a><a id="9628" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="9630" class="Symbol">:</a> <a id="9632" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="9637" class="Symbol">(</a><a id="9638" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="9646" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="9648" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="9649" class="Symbol">)</a> <a id="9651" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="9652" class="Symbol">}</a> <a id="9654" class="Keyword">where</a>

 <a id="9662" class="Keyword">open</a> <a id="9667" href="Base.Varieties.Preservation.html#9933" class="Module">class-products-with-maps</a> <a id="9692" class="Symbol">{</a><a id="9693" class="Argument">X</a> <a id="9695" class="Symbol">=</a> <a id="9697" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="9698" class="Symbol">}{</a><a id="9700" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="9703" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="9705" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="9706" class="Symbol">}{</a><a id="9708" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="9711" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="9714" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="9716" class="Symbol">}{</a><a id="9718" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="9721" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="9723" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="9724" class="Symbol">}</a> <a id="9726" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Base.Varieties.Base.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

 <a id="9950" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10008" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="10010" class="Symbol">:</a> <a id="10012" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="10020" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="10022" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a>
 <a id="10025" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="10027" class="Symbol">=</a> <a id="10029" href="Base.Algebras.Products.html#1925" class="Function">⨅</a> <a id="10031" href="Base.Varieties.Preservation.html#11347" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="10195" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="10200" class="Symbol">:</a> <a id="10202" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="10206" class="Symbol">(</a><a id="10207" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="10209" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="10210" class="Symbol">)</a> <a id="10212" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a>
 <a id="10215" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="10220" class="Symbol">=</a> <a id="10222" href="Base.Homomorphisms.Products.html#1638" class="Function">⨅-hom-co</a> <a id="10231" href="Base.Varieties.Preservation.html#11347" class="Function">𝔄&#39;</a> <a id="10234" class="Symbol">(</a><a id="10235" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="10238" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="10240" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="10241" class="Symbol">){</a><a id="10243" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="10244" class="Symbol">}(</a><a id="10246" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="10248" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="10249" class="Symbol">)</a> <a id="10251" class="Symbol">λ</a> <a id="10253" href="Base.Varieties.FreeAlgebras.html#10253" class="Bound">i</a> <a id="10255" class="Symbol">→</a> <a id="10257" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="10266" class="Symbol">(</a><a id="10267" href="Base.Varieties.Preservation.html#11347" class="Function">𝔄&#39;</a> <a id="10270" href="Base.Varieties.FreeAlgebras.html#10253" class="Bound">i</a><a id="10271" class="Symbol">)(</a><a id="10273" href="Base.Varieties.FreeAlgebras.html#1306" class="Field">snd</a> <a id="10277" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="10279" href="Base.Varieties.FreeAlgebras.html#10253" class="Bound">i</a> <a id="10281" href="Overture.Basic.html#4341" class="Function Operator">∥</a><a id="10282" class="Symbol">)</a>
</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned, the initial version of the [agda-algebras](https://github.com/ualib/agda-algebras) library used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="10819" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="10821" class="Symbol">:</a> <a id="10823" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="10831" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="10834" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a>
 <a id="10837" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="10839" class="Symbol">=</a> <a id="10841" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">ker[</a> <a id="10846" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="10848" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="10850" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">⇒</a> <a id="10852" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="10854" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">]</a> <a id="10856" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="10861" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">↾</a> <a id="10863" class="Symbol">(</a><a id="10864" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="10867" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="10869" class="Symbol">(</a><a id="10870" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="10873" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="10874" class="Symbol">))</a>

 <a id="10879" href="Base.Varieties.FreeAlgebras.html#10879" class="Function">epi𝔽</a> <a id="10884" class="Symbol">:</a> <a id="10886" href="Base.Homomorphisms.Basic.html#4313" class="Function">epi</a> <a id="10890" class="Symbol">(</a><a id="10891" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="10893" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="10894" class="Symbol">)</a> <a id="10896" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a>
 <a id="10899" href="Base.Varieties.FreeAlgebras.html#10879" class="Function">epi𝔽</a> <a id="10904" class="Symbol">=</a> <a id="10906" href="Base.Homomorphisms.Kernels.html#4274" class="Function">πker</a> <a id="10911" class="Symbol">(</a><a id="10912" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="10915" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="10917" class="Symbol">(</a><a id="10918" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="10921" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="10922" class="Symbol">))</a> <a id="10925" class="Symbol">{</a><a id="10926" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a><a id="10927" class="Symbol">}</a> <a id="10929" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a>

 <a id="10936" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="10941" class="Symbol">:</a> <a id="10943" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="10947" class="Symbol">(</a><a id="10948" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="10950" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="10951" class="Symbol">)</a> <a id="10953" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a>
 <a id="10956" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="10961" class="Symbol">=</a> <a id="10963" href="Base.Homomorphisms.Basic.html#4774" class="Function">epi→hom</a> <a id="10971" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="10973" href="Base.Varieties.FreeAlgebras.html#10879" class="Function">epi𝔽</a>

 <a id="10980" href="Base.Varieties.FreeAlgebras.html#10980" class="Function">hom𝔽-is-epic</a> <a id="10993" class="Symbol">:</a> <a id="10995" href="Base.Functions.Surjective.html#1759" class="Function">IsSurjective</a> <a id="11008" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11010" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="11015" href="Overture.Basic.html#4303" class="Function Operator">∣</a>
 <a id="11018" href="Base.Varieties.FreeAlgebras.html#10980" class="Function">hom𝔽-is-epic</a> <a id="11031" class="Symbol">=</a> <a id="11033" href="Base.Varieties.FreeAlgebras.html#1306" class="Field">snd</a> <a id="11037" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="11039" href="Base.Varieties.FreeAlgebras.html#10879" class="Function">epi𝔽</a> <a id="11044" href="Overture.Basic.html#4341" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11142" href="Base.Varieties.FreeAlgebras.html#11142" class="Function">ψlemma0</a> <a id="11150" class="Symbol">:</a> <a id="11152" class="Symbol">∀</a> <a id="11154" href="Base.Varieties.FreeAlgebras.html#11154" class="Bound">p</a> <a id="11156" href="Base.Varieties.FreeAlgebras.html#11156" class="Bound">q</a> <a id="11158" class="Symbol">→</a>  <a id="11161" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11163" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="11168" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11170" href="Base.Varieties.FreeAlgebras.html#11154" class="Bound">p</a> <a id="11172" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11174" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11176" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="11181" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11183" href="Base.Varieties.FreeAlgebras.html#11156" class="Bound">q</a>  <a id="11186" class="Symbol">→</a> <a id="11188" class="Symbol">(</a><a id="11189" href="Base.Varieties.FreeAlgebras.html#11154" class="Bound">p</a> <a id="11191" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11193" href="Base.Varieties.FreeAlgebras.html#11156" class="Bound">q</a><a id="11194" class="Symbol">)</a> <a id="11196" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11198" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="11200" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
 <a id="11203" href="Base.Varieties.FreeAlgebras.html#11142" class="Function">ψlemma0</a> <a id="11211" href="Base.Varieties.FreeAlgebras.html#11211" class="Bound">p</a> <a id="11213" href="Base.Varieties.FreeAlgebras.html#11213" class="Bound">q</a> <a id="11215" href="Base.Varieties.FreeAlgebras.html#11215" class="Bound">phomℭq</a> <a id="11222" href="Base.Varieties.FreeAlgebras.html#11222" class="Bound">𝑨</a> <a id="11224" href="Base.Varieties.FreeAlgebras.html#11224" class="Bound">sA</a> <a id="11227" href="Base.Varieties.FreeAlgebras.html#11227" class="Bound">h</a> <a id="11229" class="Symbol">=</a> <a id="11231" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">≡.cong-app</a> <a id="11242" href="Base.Varieties.FreeAlgebras.html#11215" class="Bound">phomℭq</a> <a id="11249" class="Symbol">(</a><a id="11250" href="Base.Varieties.FreeAlgebras.html#11222" class="Bound">𝑨</a> <a id="11252" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11254" href="Base.Varieties.FreeAlgebras.html#11224" class="Bound">sA</a> <a id="11257" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11259" href="Base.Varieties.FreeAlgebras.html#11227" class="Bound">h</a><a id="11260" class="Symbol">)</a>

 <a id="11264" href="Base.Varieties.FreeAlgebras.html#11264" class="Function">ψlemma0-ap</a> <a id="11275" class="Symbol">:</a> <a id="11277" class="Symbol">{</a><a id="11278" href="Base.Varieties.FreeAlgebras.html#11278" class="Bound">𝑨</a> <a id="11280" class="Symbol">:</a> <a id="11282" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="11290" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="11292" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="11293" class="Symbol">}{</a><a id="11295" href="Base.Varieties.FreeAlgebras.html#11295" class="Bound">h</a> <a id="11297" class="Symbol">:</a> <a id="11299" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="11301" class="Symbol">→</a> <a id="11303" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11305" href="Base.Varieties.FreeAlgebras.html#11278" class="Bound">𝑨</a> <a id="11307" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="11308" class="Symbol">}</a> <a id="11310" class="Symbol">→</a> <a id="11312" href="Base.Varieties.FreeAlgebras.html#11278" class="Bound">𝑨</a> <a id="11314" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11316" href="Base.Varieties.Closure.html#3549" class="Datatype">S</a><a id="11317" class="Symbol">{</a><a id="11318" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11319" class="Symbol">}{</a><a id="11321" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11322" class="Symbol">}</a> <a id="11324" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
  <a id="11328" class="Symbol">→</a>           <a id="11340" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="11347" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11349" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="11354" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11356" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="11358" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="11365" class="Symbol">(</a><a id="11366" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="11376" href="Base.Varieties.FreeAlgebras.html#11278" class="Bound">𝑨</a> <a id="11378" href="Base.Varieties.FreeAlgebras.html#11295" class="Bound">h</a><a id="11379" class="Symbol">)</a>

 <a id="11383" href="Base.Varieties.FreeAlgebras.html#11264" class="Function">ψlemma0-ap</a> <a id="11394" class="Symbol">{</a><a id="11395" href="Base.Varieties.FreeAlgebras.html#11395" class="Bound">𝑨</a><a id="11396" class="Symbol">}{</a><a id="11398" href="Base.Varieties.FreeAlgebras.html#11398" class="Bound">h</a><a id="11399" class="Symbol">}</a> <a id="11401" href="Base.Varieties.FreeAlgebras.html#11401" class="Bound">skA</a> <a id="11405" class="Symbol">{</a><a id="11406" href="Base.Varieties.FreeAlgebras.html#11406" class="Bound">p</a> <a id="11408" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11410" href="Base.Varieties.FreeAlgebras.html#11410" class="Bound">q</a><a id="11411" class="Symbol">}</a> <a id="11413" href="Base.Varieties.FreeAlgebras.html#11413" class="Bound">x</a> <a id="11415" class="Symbol">=</a> <a id="11417" href="Base.Varieties.FreeAlgebras.html#11559" class="Function">γ</a> <a id="11419" class="Keyword">where</a>

  <a id="11428" href="Base.Varieties.FreeAlgebras.html#11428" class="Function">ν</a> <a id="11430" class="Symbol">:</a> <a id="11432" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11434" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="11439" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11441" href="Base.Varieties.FreeAlgebras.html#11406" class="Bound">p</a> <a id="11443" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11445" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11447" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="11452" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11454" href="Base.Varieties.FreeAlgebras.html#11410" class="Bound">q</a>
  <a id="11458" href="Base.Varieties.FreeAlgebras.html#11428" class="Function">ν</a> <a id="11460" class="Symbol">=</a> <a id="11462" href="Base.Homomorphisms.Kernels.html#4792" class="Function">ker-in-con</a> <a id="11473" class="Symbol">{</a><a id="11474" class="Argument">α</a> <a id="11476" class="Symbol">=</a> <a id="11478" class="Symbol">(</a><a id="11479" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="11482" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11483" class="Symbol">)}{</a><a id="11486" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="11489" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11490" class="Symbol">}{</a><a id="11492" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="11494" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="11495" class="Symbol">}{</a><a id="11497" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="11500" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="11502" class="Symbol">(</a><a id="11503" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="11507" class="Symbol">(</a><a id="11508" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="11511" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11512" class="Symbol">))}(</a><a id="11516" href="Base.Homomorphisms.Kernels.html#2368" class="Function">kercon</a> <a id="11523" class="Symbol">(</a><a id="11524" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="11527" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="11529" class="Symbol">(</a><a id="11530" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="11533" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11534" class="Symbol">))</a> <a id="11537" class="Symbol">{</a><a id="11538" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a><a id="11539" class="Symbol">}</a> <a id="11541" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a><a id="11545" class="Symbol">)</a> <a id="11547" class="Symbol">{</a><a id="11548" href="Base.Varieties.FreeAlgebras.html#11406" class="Bound">p</a><a id="11549" class="Symbol">}{</a><a id="11551" href="Base.Varieties.FreeAlgebras.html#11410" class="Bound">q</a><a id="11552" class="Symbol">}</a> <a id="11554" href="Base.Varieties.FreeAlgebras.html#11413" class="Bound">x</a>

  <a id="11559" href="Base.Varieties.FreeAlgebras.html#11559" class="Function">γ</a> <a id="11561" class="Symbol">:</a> <a id="11563" class="Symbol">(</a><a id="11564" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="11574" href="Base.Varieties.FreeAlgebras.html#11395" class="Bound">𝑨</a> <a id="11576" href="Base.Varieties.FreeAlgebras.html#11398" class="Bound">h</a><a id="11577" class="Symbol">)</a> <a id="11579" href="Base.Varieties.FreeAlgebras.html#11406" class="Bound">p</a> <a id="11581" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11583" class="Symbol">(</a><a id="11584" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="11594" href="Base.Varieties.FreeAlgebras.html#11395" class="Bound">𝑨</a> <a id="11596" href="Base.Varieties.FreeAlgebras.html#11398" class="Bound">h</a><a id="11597" class="Symbol">)</a> <a id="11599" href="Base.Varieties.FreeAlgebras.html#11410" class="Bound">q</a>
  <a id="11603" href="Base.Varieties.FreeAlgebras.html#11559" class="Function">γ</a> <a id="11605" class="Symbol">=</a> <a id="11607" class="Symbol">((</a><a id="11609" href="Base.Varieties.FreeAlgebras.html#11142" class="Function">ψlemma0</a> <a id="11617" href="Base.Varieties.FreeAlgebras.html#11406" class="Bound">p</a> <a id="11619" href="Base.Varieties.FreeAlgebras.html#11410" class="Bound">q</a><a id="11620" class="Symbol">)</a> <a id="11622" href="Base.Varieties.FreeAlgebras.html#11428" class="Function">ν</a><a id="11623" class="Symbol">)</a> <a id="11625" href="Base.Varieties.FreeAlgebras.html#11395" class="Bound">𝑨</a> <a id="11627" href="Base.Varieties.FreeAlgebras.html#11401" class="Bound">skA</a> <a id="11631" href="Base.Varieties.FreeAlgebras.html#11398" class="Bound">h</a>

</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="11811" href="Base.Varieties.FreeAlgebras.html#11811" class="Function">𝔽-lift-hom</a> <a id="11822" class="Symbol">:</a> <a id="11824" class="Symbol">(</a><a id="11825" href="Base.Varieties.FreeAlgebras.html#11825" class="Bound">𝑨</a> <a id="11827" class="Symbol">:</a> <a id="11829" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="11837" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="11839" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="11840" class="Symbol">)</a> <a id="11842" class="Symbol">→</a> <a id="11844" href="Base.Varieties.FreeAlgebras.html#11825" class="Bound">𝑨</a> <a id="11846" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11848" href="Base.Varieties.Closure.html#3549" class="Datatype">S</a><a id="11849" class="Symbol">{</a><a id="11850" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11851" class="Symbol">}{</a><a id="11853" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11854" class="Symbol">}</a> <a id="11856" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="11858" class="Symbol">→</a> <a id="11860" class="Symbol">(</a><a id="11861" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="11863" class="Symbol">→</a> <a id="11865" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="11867" href="Base.Varieties.FreeAlgebras.html#11825" class="Bound">𝑨</a> <a id="11869" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="11870" class="Symbol">)</a> <a id="11872" class="Symbol">→</a> <a id="11874" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="11878" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="11880" href="Base.Varieties.FreeAlgebras.html#11825" class="Bound">𝑨</a>
 <a id="11883" href="Base.Varieties.FreeAlgebras.html#11811" class="Function">𝔽-lift-hom</a> <a id="11894" href="Base.Varieties.FreeAlgebras.html#11894" class="Bound">𝑨</a> <a id="11896" href="Base.Varieties.FreeAlgebras.html#11896" class="Bound">skA</a> <a id="11900" href="Base.Varieties.FreeAlgebras.html#11900" class="Bound">h</a> <a id="11902" class="Symbol">=</a> <a id="11904" href="Base.Varieties.FreeAlgebras.html#1291" class="Field">fst</a><a id="11907" class="Symbol">(</a><a id="11908" href="Base.Homomorphisms.Factor.html#1854" class="Function">HomFactor</a> <a id="11918" class="Symbol">(</a><a id="11919" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="11922" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="11924" class="Symbol">(</a><a id="11925" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="11929" class="Symbol">(</a><a id="11930" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="11933" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="11934" class="Symbol">)))</a>  <a id="11939" href="Base.Varieties.FreeAlgebras.html#11894" class="Bound">𝑨</a> <a id="11941" class="Symbol">(</a><a id="11942" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="11951" href="Base.Varieties.FreeAlgebras.html#11894" class="Bound">𝑨</a> <a id="11953" href="Base.Varieties.FreeAlgebras.html#11900" class="Bound">h</a><a id="11954" class="Symbol">)</a> <a id="11956" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="11961" class="Symbol">(</a><a id="11962" href="Base.Varieties.FreeAlgebras.html#11264" class="Function">ψlemma0-ap</a> <a id="11973" href="Base.Varieties.FreeAlgebras.html#11896" class="Bound">skA</a><a id="11976" class="Symbol">)</a> <a id="11978" href="Base.Varieties.FreeAlgebras.html#10980" class="Function">hom𝔽-is-epic</a><a id="11990" class="Symbol">)</a>
</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into `𝔽`. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="12376" class="Keyword">open</a> <a id="12381" href="Base.Algebras.Congruences.html#1828" class="Module">IsCongruence</a>

 <a id="12396" href="Base.Varieties.FreeAlgebras.html#12396" class="Function">X↪𝔽</a> <a id="12400" class="Symbol">:</a> <a id="12402" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="12404" class="Symbol">→</a> <a id="12406" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12408" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="12410" href="Overture.Basic.html#4303" class="Function Operator">∣</a>
 <a id="12413" href="Base.Varieties.FreeAlgebras.html#12396" class="Function">X↪𝔽</a> <a id="12417" href="Base.Varieties.FreeAlgebras.html#12417" class="Bound">x</a> <a id="12419" class="Symbol">=</a> <a id="12421" href="Base.Relations.Quotients.html#5437" class="Function Operator">⟪</a> <a id="12423" href="Base.Terms.Basic.html#2128" class="InductiveConstructor">ℊ</a> <a id="12425" href="Base.Varieties.FreeAlgebras.html#12417" class="Bound">x</a> <a id="12427" href="Base.Relations.Quotients.html#5437" class="Function Operator">⟫</a> <a id="12429" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="12495" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12497" class="Symbol">:</a> <a id="12499" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="12503" class="Symbol">(</a><a id="12504" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="12506" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="12507" class="Symbol">)</a> <a id="12509" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a>
 <a id="12512" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12514" class="Symbol">=</a> <a id="12516" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="12525" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="12527" href="Base.Varieties.FreeAlgebras.html#12396" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="12630" class="Keyword">open</a> <a id="12635" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="12649" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a> <a id="12666" class="Symbol">:</a> <a id="12668" class="Symbol">∀</a> <a id="12670" href="Base.Varieties.FreeAlgebras.html#12670" class="Bound">p</a> <a id="12672" class="Symbol">→</a> <a id="12674" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12676" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12678" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12680" href="Base.Varieties.FreeAlgebras.html#12670" class="Bound">p</a> <a id="12682" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12684" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12686" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="12691" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12693" href="Base.Varieties.FreeAlgebras.html#12670" class="Bound">p</a>
 <a id="12696" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a> <a id="12713" class="Symbol">(</a><a id="12714" href="Base.Terms.Basic.html#2128" class="InductiveConstructor">ℊ</a> <a id="12716" href="Base.Varieties.FreeAlgebras.html#12716" class="Bound">x</a><a id="12717" class="Symbol">)</a> <a id="12719" class="Symbol">=</a> <a id="12721" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">≡.refl</a>
 <a id="12729" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a> <a id="12746" class="Symbol">(</a><a id="12747" href="Base.Terms.Basic.html#2170" class="InductiveConstructor">node</a> <a id="12752" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12754" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a><a id="12755" class="Symbol">)</a> <a id="12757" class="Symbol">=</a>
  <a id="12761" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12763" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12765" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12767" class="Symbol">(</a><a id="12768" href="Base.Terms.Basic.html#2170" class="InductiveConstructor">node</a> <a id="12773" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12775" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a><a id="12776" class="Symbol">)</a>              <a id="12791" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12794" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="12796" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12798" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="12800" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12802" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="12804" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="12808" class="Symbol">(</a><a id="12809" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12811" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="12813" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a><a id="12814" class="Symbol">)(λ</a> <a id="12818" href="Base.Varieties.FreeAlgebras.html#12818" class="Bound">i</a> <a id="12820" class="Symbol">→</a> <a id="12822" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12824" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="12826" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="12827" class="Symbol">(</a><a id="12828" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="12830" href="Base.Varieties.FreeAlgebras.html#12818" class="Bound">i</a><a id="12831" class="Symbol">))</a>     <a id="12838" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12841" href="Base.Varieties.FreeAlgebras.html#12949" class="Function">wd-proof</a> <a id="12850" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="12854" class="Symbol">(</a><a id="12855" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12857" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="12859" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a><a id="12860" class="Symbol">)(λ</a> <a id="12864" href="Base.Varieties.FreeAlgebras.html#12864" class="Bound">i</a> <a id="12866" class="Symbol">→</a> <a id="12868" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12870" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="12875" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12877" class="Symbol">(</a><a id="12878" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="12880" href="Base.Varieties.FreeAlgebras.html#12864" class="Bound">i</a><a id="12881" class="Symbol">))</a> <a id="12884" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="12887" class="Symbol">(</a><a id="12888" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="12890" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="12895" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="12897" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12899" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a><a id="12900" class="Symbol">)</a><a id="12901" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a> <a id="12904" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="12908" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12910" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="12915" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="12917" class="Symbol">(</a><a id="12918" href="Base.Terms.Basic.html#2170" class="InductiveConstructor">node</a> <a id="12923" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="12925" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a><a id="12926" class="Symbol">)</a>           <a id="12938" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="12943" class="Keyword">where</a> <a id="12949" href="Base.Varieties.FreeAlgebras.html#12949" class="Function">wd-proof</a> <a id="12958" class="Symbol">=</a> <a id="12960" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="12963" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="12965" class="Symbol">(</a><a id="12966" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="12970" class="Symbol">(</a><a id="12971" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="12974" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="12975" class="Symbol">))</a>
                    <a id="12998" class="Symbol">(</a><a id="12999" href="Base.Varieties.FreeAlgebras.html#12752" class="Bound">𝑓</a> <a id="13001" href="Base.Algebras.Basic.html#6152" class="Function Operator">̂</a> <a id="13003" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a><a id="13004" class="Symbol">)</a> <a id="13006" class="Symbol">(λ</a> <a id="13009" href="Base.Varieties.FreeAlgebras.html#13009" class="Bound">i</a> <a id="13011" class="Symbol">→</a> <a id="13013" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13015" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13017" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="13018" class="Symbol">(</a><a id="13019" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="13021" href="Base.Varieties.FreeAlgebras.html#13009" class="Bound">i</a><a id="13022" class="Symbol">))</a> <a id="13025" class="Symbol">(λ</a> <a id="13028" href="Base.Varieties.FreeAlgebras.html#13028" class="Bound">i</a> <a id="13030" class="Symbol">→</a> <a id="13032" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13034" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="13039" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13041" class="Symbol">(</a><a id="13042" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="13044" href="Base.Varieties.FreeAlgebras.html#13028" class="Bound">i</a><a id="13045" class="Symbol">))</a>
                    <a id="13068" class="Symbol">(λ</a> <a id="13071" href="Base.Varieties.FreeAlgebras.html#13071" class="Bound">x</a> <a id="13073" class="Symbol">→</a> <a id="13075" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a><a id="13091" class="Symbol">(</a><a id="13092" href="Base.Varieties.FreeAlgebras.html#12754" class="Bound">𝒕</a> <a id="13094" href="Base.Varieties.FreeAlgebras.html#13071" class="Bound">x</a><a id="13095" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="13199" href="Base.Varieties.FreeAlgebras.html#13199" class="Function">ψlemma1</a> <a id="13207" class="Symbol">:</a> <a id="13209" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="13216" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13218" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13220" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13222" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="13224" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="13226" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
 <a id="13229" href="Base.Varieties.FreeAlgebras.html#13199" class="Function">ψlemma1</a> <a id="13237" class="Symbol">{</a><a id="13238" href="Base.Varieties.FreeAlgebras.html#13238" class="Bound">p</a> <a id="13240" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13242" href="Base.Varieties.FreeAlgebras.html#13242" class="Bound">q</a><a id="13243" class="Symbol">}</a> <a id="13245" href="Base.Varieties.FreeAlgebras.html#13245" class="Bound">𝔑pq</a> <a id="13249" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a> <a id="13251" href="Base.Varieties.FreeAlgebras.html#13251" class="Bound">sA</a> <a id="13254" href="Base.Varieties.FreeAlgebras.html#13254" class="Bound">h</a> <a id="13256" class="Symbol">=</a> <a id="13258" href="Base.Varieties.FreeAlgebras.html#13481" class="Function">γ</a>
  <a id="13262" class="Keyword">where</a>
   <a id="13271" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13273" class="Symbol">:</a> <a id="13275" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="13279" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="13281" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a>
   <a id="13286" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13288" class="Symbol">=</a> <a id="13290" href="Base.Varieties.FreeAlgebras.html#11811" class="Function">𝔽-lift-hom</a> <a id="13301" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a> <a id="13303" href="Base.Varieties.FreeAlgebras.html#13251" class="Bound">sA</a> <a id="13306" href="Base.Varieties.FreeAlgebras.html#13254" class="Bound">h</a>

   <a id="13312" href="Base.Varieties.FreeAlgebras.html#13312" class="Function">h&#39;</a> <a id="13315" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13317" class="Symbol">:</a> <a id="13319" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="13323" class="Symbol">(</a><a id="13324" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="13326" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="13327" class="Symbol">)</a> <a id="13329" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a>
   <a id="13334" href="Base.Varieties.FreeAlgebras.html#13312" class="Function">h&#39;</a> <a id="13337" class="Symbol">=</a> <a id="13339" href="Base.Homomorphisms.Properties.html#1464" class="Function">∘-hom</a> <a id="13345" class="Symbol">(</a><a id="13346" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="13348" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="13349" class="Symbol">)</a> <a id="13351" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a> <a id="13353" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13355" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a>
   <a id="13360" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13362" class="Symbol">=</a> <a id="13364" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="13373" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a> <a id="13375" href="Base.Varieties.FreeAlgebras.html#13254" class="Bound">h</a>

   <a id="13381" href="Base.Varieties.FreeAlgebras.html#13381" class="Function">h≡φ</a> <a id="13385" class="Symbol">:</a> <a id="13387" class="Symbol">∀</a> <a id="13389" href="Base.Varieties.FreeAlgebras.html#13389" class="Bound">t</a> <a id="13391" class="Symbol">→</a> <a id="13393" class="Symbol">(</a><a id="13394" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13396" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13398" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13400" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="13402" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13404" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13406" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="13407" class="Symbol">)</a> <a id="13409" href="Base.Varieties.FreeAlgebras.html#13389" class="Bound">t</a> <a id="13411" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13413" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13415" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13417" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13419" href="Base.Varieties.FreeAlgebras.html#13389" class="Bound">t</a>
   <a id="13424" href="Base.Varieties.FreeAlgebras.html#13381" class="Function">h≡φ</a> <a id="13428" href="Base.Varieties.FreeAlgebras.html#13428" class="Bound">t</a> <a id="13430" class="Symbol">=</a> <a id="13432" href="Base.Terms.Properties.html#3609" class="Function">free-unique</a> <a id="13444" class="Symbol">(</a><a id="13445" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="13448" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="13450" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="13451" class="Symbol">)</a> <a id="13453" href="Base.Varieties.FreeAlgebras.html#13249" class="Bound">𝑨</a> <a id="13455" href="Base.Varieties.FreeAlgebras.html#13312" class="Function">h&#39;</a> <a id="13458" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13460" class="Symbol">(λ</a> <a id="13463" href="Base.Varieties.FreeAlgebras.html#13463" class="Bound">x</a> <a id="13465" class="Symbol">→</a> <a id="13467" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">≡.refl</a><a id="13473" class="Symbol">)</a> <a id="13475" href="Base.Varieties.FreeAlgebras.html#13428" class="Bound">t</a>

   <a id="13481" href="Base.Varieties.FreeAlgebras.html#13481" class="Function">γ</a> <a id="13483" class="Symbol">:</a> <a id="13485" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13487" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13489" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13491" href="Base.Varieties.FreeAlgebras.html#13238" class="Bound">p</a> <a id="13493" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13495" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13497" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13499" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13501" href="Base.Varieties.FreeAlgebras.html#13242" class="Bound">q</a>
   <a id="13506" href="Base.Varieties.FreeAlgebras.html#13481" class="Function">γ</a> <a id="13508" class="Symbol">=</a> <a id="13510" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13512" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13514" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13516" href="Base.Varieties.FreeAlgebras.html#13238" class="Bound">p</a>             <a id="13530" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13533" class="Symbol">(</a><a id="13534" href="Base.Varieties.FreeAlgebras.html#13381" class="Function">h≡φ</a> <a id="13538" href="Base.Varieties.FreeAlgebras.html#13238" class="Bound">p</a><a id="13539" class="Symbol">)</a><a id="13540" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a> <a id="13543" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="13552" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13554" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13556" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13558" class="Symbol">(</a> <a id="13560" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13562" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13564" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13566" href="Base.Varieties.FreeAlgebras.html#13238" class="Bound">p</a> <a id="13568" class="Symbol">)</a>   <a id="13572" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13575" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">≡.cong</a> <a id="13582" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13584" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13586" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13588" href="Base.Varieties.FreeAlgebras.html#13245" class="Bound">𝔑pq</a> <a id="13592" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="13601" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13603" href="Base.Varieties.FreeAlgebras.html#13271" class="Function">f</a> <a id="13605" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13607" class="Symbol">(</a> <a id="13609" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13611" href="Base.Varieties.FreeAlgebras.html#12495" class="Function">𝔑</a> <a id="13613" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13615" href="Base.Varieties.FreeAlgebras.html#13242" class="Bound">q</a> <a id="13617" class="Symbol">)</a>   <a id="13621" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13624" href="Base.Varieties.FreeAlgebras.html#13381" class="Function">h≡φ</a> <a id="13628" href="Base.Varieties.FreeAlgebras.html#13242" class="Bound">q</a> <a id="13630" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="13639" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13641" href="Base.Varieties.FreeAlgebras.html#13315" class="Function">φ</a> <a id="13643" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13645" href="Base.Varieties.FreeAlgebras.html#13242" class="Bound">q</a>             <a id="13659" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="13664" href="Base.Varieties.FreeAlgebras.html#13664" class="Function">ψlemma2</a> <a id="13672" class="Symbol">:</a> <a id="13674" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="13681" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13683" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="13688" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="13690" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="13692" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a> <a id="13694" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
 <a id="13697" href="Base.Varieties.FreeAlgebras.html#13664" class="Function">ψlemma2</a> <a id="13705" class="Symbol">{</a><a id="13706" href="Base.Varieties.FreeAlgebras.html#13706" class="Bound">p</a> <a id="13708" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13710" href="Base.Varieties.FreeAlgebras.html#13710" class="Bound">q</a><a id="13711" class="Symbol">}</a> <a id="13713" href="Base.Varieties.FreeAlgebras.html#13713" class="Bound">x</a> <a id="13715" class="Symbol">=</a> <a id="13717" href="Base.Varieties.FreeAlgebras.html#13199" class="Function">ψlemma1</a> <a id="13725" class="Symbol">{</a><a id="13726" href="Base.Varieties.FreeAlgebras.html#13706" class="Bound">p</a> <a id="13728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13730" href="Base.Varieties.FreeAlgebras.html#13710" class="Bound">q</a><a id="13731" class="Symbol">}</a> <a id="13733" href="Base.Varieties.FreeAlgebras.html#13748" class="Function">γ</a>
   <a id="13738" class="Keyword">where</a>
    <a id="13748" href="Base.Varieties.FreeAlgebras.html#13748" class="Function">γ</a> <a id="13750" class="Symbol">:</a> <a id="13752" class="Symbol">(</a><a id="13753" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="13763" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="13765" href="Base.Varieties.FreeAlgebras.html#12396" class="Function">X↪𝔽</a><a id="13768" class="Symbol">)</a> <a id="13770" href="Base.Varieties.FreeAlgebras.html#13706" class="Bound">p</a> <a id="13772" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13774" class="Symbol">(</a><a id="13775" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="13785" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="13787" href="Base.Varieties.FreeAlgebras.html#12396" class="Function">X↪𝔽</a><a id="13790" class="Symbol">)</a> <a id="13792" href="Base.Varieties.FreeAlgebras.html#13710" class="Bound">q</a>
    <a id="13798" href="Base.Varieties.FreeAlgebras.html#13748" class="Function">γ</a> <a id="13800" class="Symbol">=</a> <a id="13802" class="Symbol">(</a><a id="13803" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a> <a id="13820" href="Base.Varieties.FreeAlgebras.html#13706" class="Bound">p</a><a id="13821" class="Symbol">)</a> <a id="13823" href="Overture.Basic.html#5223" class="Function Operator">∙</a> <a id="13825" href="Base.Varieties.FreeAlgebras.html#13713" class="Bound">x</a> <a id="13827" href="Overture.Basic.html#5223" class="Function Operator">∙</a> <a id="13829" class="Symbol">(</a><a id="13830" href="Base.Varieties.FreeAlgebras.html#12649" class="Function">hom𝔽-is-lift-hom</a> <a id="13847" href="Base.Varieties.FreeAlgebras.html#13710" class="Bound">q</a><a id="13848" class="Symbol">)</a><a id="13849" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a>


 <a id="13855" href="Base.Varieties.FreeAlgebras.html#13855" class="Function">ψlemma3</a> <a id="13863" class="Symbol">:</a> <a id="13865" class="Symbol">∀</a> <a id="13867" href="Base.Varieties.FreeAlgebras.html#13867" class="Bound">p</a> <a id="13869" href="Base.Varieties.FreeAlgebras.html#13869" class="Bound">q</a> <a id="13871" class="Symbol">→</a> <a id="13873" class="Symbol">(</a><a id="13874" href="Base.Varieties.FreeAlgebras.html#13867" class="Bound">p</a> <a id="13876" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13878" href="Base.Varieties.FreeAlgebras.html#13869" class="Bound">q</a><a id="13879" class="Symbol">)</a> <a id="13881" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="13883" href="Base.Varieties.FreeAlgebras.html#5565" class="Function">ψ</a><a id="13884" class="Symbol">{</a><a id="13885" class="Argument">X</a> <a id="13887" class="Symbol">=</a> <a id="13889" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="13890" class="Symbol">}</a> <a id="13892" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="13894" class="Symbol">→</a> <a id="13896" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="13898" href="Base.Varieties.EquationalLogic.html#2530" class="Function Operator">⊫</a> <a id="13900" href="Base.Varieties.FreeAlgebras.html#13867" class="Bound">p</a> <a id="13902" href="Base.Varieties.EquationalLogic.html#2530" class="Function Operator">≈</a> <a id="13904" href="Base.Varieties.FreeAlgebras.html#13869" class="Bound">q</a>
 <a id="13907" href="Base.Varieties.FreeAlgebras.html#13855" class="Function">ψlemma3</a> <a id="13915" href="Base.Varieties.FreeAlgebras.html#13915" class="Bound">p</a> <a id="13917" href="Base.Varieties.FreeAlgebras.html#13917" class="Bound">q</a> <a id="13919" href="Base.Varieties.FreeAlgebras.html#13919" class="Bound">pψq</a> <a id="13923" class="Symbol">{</a><a id="13924" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a><a id="13925" class="Symbol">}</a> <a id="13927" href="Base.Varieties.FreeAlgebras.html#13927" class="Bound">kA</a> <a id="13930" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a> <a id="13932" class="Symbol">=</a> <a id="13934" href="Base.Varieties.FreeAlgebras.html#13951" class="Function">goal</a>
   <a id="13942" class="Keyword">where</a>
   <a id="13951" href="Base.Varieties.FreeAlgebras.html#13951" class="Function">goal</a> <a id="13956" class="Symbol">:</a> <a id="13958" class="Symbol">(</a><a id="13959" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="13961" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="13963" href="Base.Varieties.FreeAlgebras.html#13915" class="Bound">p</a> <a id="13965" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="13966" class="Symbol">)</a> <a id="13968" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a> <a id="13970" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13972" class="Symbol">(</a><a id="13973" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="13975" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="13977" href="Base.Varieties.FreeAlgebras.html#13917" class="Bound">q</a> <a id="13979" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="13980" class="Symbol">)</a> <a id="13982" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a>
   <a id="13987" href="Base.Varieties.FreeAlgebras.html#13951" class="Function">goal</a> <a id="13992" class="Symbol">=</a> <a id="13994" class="Symbol">(</a><a id="13995" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="13997" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="13999" href="Base.Varieties.FreeAlgebras.html#13915" class="Bound">p</a> <a id="14001" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="14002" class="Symbol">)</a> <a id="14004" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a>       <a id="14012" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14015" href="Base.Terms.Operations.html#2914" class="Function">free-lift-interp</a> <a id="14032" class="Symbol">(</a><a id="14033" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="14036" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="14038" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="14039" class="Symbol">)</a> <a id="14041" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14043" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a> <a id="14045" href="Base.Varieties.FreeAlgebras.html#13915" class="Bound">p</a> <a id="14047" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14059" class="Symbol">(</a><a id="14060" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="14070" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14072" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a><a id="14073" class="Symbol">)</a> <a id="14075" href="Base.Varieties.FreeAlgebras.html#13915" class="Bound">p</a> <a id="14077" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14080" href="Base.Varieties.FreeAlgebras.html#13919" class="Bound">pψq</a> <a id="14084" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14086" class="Symbol">(</a><a id="14087" href="Base.Varieties.Closure.html#3835" class="InductiveConstructor">siso</a> <a id="14092" class="Symbol">(</a><a id="14093" href="Base.Varieties.Closure.html#3637" class="InductiveConstructor">sbase</a> <a id="14099" href="Base.Varieties.FreeAlgebras.html#13927" class="Bound">kA</a><a id="14101" class="Symbol">)</a> <a id="14103" class="Symbol">(</a><a id="14104" href="Base.Homomorphisms.Isomorphisms.html#2976" class="Function">≅-sym</a> <a id="14110" href="Base.Homomorphisms.Isomorphisms.html#4433" class="Function">Lift-≅</a><a id="14116" class="Symbol">))</a> <a id="14119" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a> <a id="14121" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14133" class="Symbol">(</a><a id="14134" href="Base.Terms.Properties.html#2499" class="Function">free-lift</a> <a id="14144" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14146" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a><a id="14147" class="Symbol">)</a> <a id="14149" href="Base.Varieties.FreeAlgebras.html#13917" class="Bound">q</a> <a id="14151" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14154" class="Symbol">(</a><a id="14155" href="Base.Terms.Operations.html#2914" class="Function">free-lift-interp</a> <a id="14172" class="Symbol">(</a><a id="14173" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="14176" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="14178" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="14179" class="Symbol">)</a> <a id="14181" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14183" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a> <a id="14185" href="Base.Varieties.FreeAlgebras.html#13917" class="Bound">q</a><a id="14186" class="Symbol">)</a><a id="14187" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a>  <a id="14191" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14203" class="Symbol">(</a><a id="14204" href="Base.Varieties.FreeAlgebras.html#13924" class="Bound">𝑨</a> <a id="14206" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="14208" href="Base.Varieties.FreeAlgebras.html#13917" class="Bound">q</a> <a id="14210" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="14211" class="Symbol">)</a> <a id="14213" href="Base.Varieties.FreeAlgebras.html#13930" class="Bound">h</a>       <a id="14221" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="14344" href="Base.Varieties.FreeAlgebras.html#14344" class="Function">class-models-kernel</a> <a id="14364" class="Symbol">:</a> <a id="14366" class="Symbol">∀</a> <a id="14368" href="Base.Varieties.FreeAlgebras.html#14368" class="Bound">p</a> <a id="14370" href="Base.Varieties.FreeAlgebras.html#14370" class="Bound">q</a> <a id="14372" class="Symbol">→</a> <a id="14374" class="Symbol">(</a><a id="14375" href="Base.Varieties.FreeAlgebras.html#14368" class="Bound">p</a> <a id="14377" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14379" href="Base.Varieties.FreeAlgebras.html#14370" class="Bound">q</a><a id="14380" class="Symbol">)</a> <a id="14382" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14384" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="14391" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14393" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="14398" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14400" class="Symbol">→</a> <a id="14402" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="14404" href="Base.Varieties.EquationalLogic.html#2530" class="Function Operator">⊫</a> <a id="14406" href="Base.Varieties.FreeAlgebras.html#14368" class="Bound">p</a> <a id="14408" href="Base.Varieties.EquationalLogic.html#2530" class="Function Operator">≈</a> <a id="14410" href="Base.Varieties.FreeAlgebras.html#14370" class="Bound">q</a>
 <a id="14413" href="Base.Varieties.FreeAlgebras.html#14344" class="Function">class-models-kernel</a> <a id="14433" href="Base.Varieties.FreeAlgebras.html#14433" class="Bound">p</a> <a id="14435" href="Base.Varieties.FreeAlgebras.html#14435" class="Bound">q</a> <a id="14437" href="Base.Varieties.FreeAlgebras.html#14437" class="Bound">x</a> <a id="14439" class="Symbol">=</a> <a id="14441" href="Base.Varieties.FreeAlgebras.html#13855" class="Function">ψlemma3</a> <a id="14449" href="Base.Varieties.FreeAlgebras.html#14433" class="Bound">p</a> <a id="14451" href="Base.Varieties.FreeAlgebras.html#14435" class="Bound">q</a> <a id="14453" class="Symbol">(</a><a id="14454" href="Base.Varieties.FreeAlgebras.html#13664" class="Function">ψlemma2</a> <a id="14462" href="Base.Varieties.FreeAlgebras.html#14437" class="Bound">x</a><a id="14463" class="Symbol">)</a>

 <a id="14467" href="Base.Varieties.FreeAlgebras.html#14467" class="Function">𝕍𝒦</a> <a id="14470" class="Symbol">:</a> <a id="14472" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="14477" class="Symbol">(</a><a id="14478" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="14486" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="14489" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="14490" class="Symbol">)</a> <a id="14492" class="Symbol">(</a><a id="14493" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="14497" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="14499" class="Symbol">)</a>
 <a id="14502" href="Base.Varieties.FreeAlgebras.html#14467" class="Function">𝕍𝒦</a> <a id="14505" class="Symbol">=</a> <a id="14507" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a><a id="14508" class="Symbol">{</a><a id="14509" class="Argument">α</a> <a id="14511" class="Symbol">=</a> <a id="14513" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="14514" class="Symbol">}{</a><a id="14516" class="Argument">β</a> <a id="14518" class="Symbol">=</a> <a id="14520" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="14522" class="Symbol">}</a> <a id="14524" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>

 <a id="14528" href="Base.Varieties.FreeAlgebras.html#14528" class="Function">kernel-in-theory&#39;</a> <a id="14546" class="Symbol">:</a> <a id="14548" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="14555" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14557" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="14562" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14564" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14566" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a> <a id="14569" class="Symbol">(</a><a id="14570" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="14572" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a><a id="14573" class="Symbol">)</a>
 <a id="14576" href="Base.Varieties.FreeAlgebras.html#14528" class="Function">kernel-in-theory&#39;</a> <a id="14594" class="Symbol">{</a><a id="14595" href="Base.Varieties.FreeAlgebras.html#14595" class="Bound">p</a> <a id="14597" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14599" href="Base.Varieties.FreeAlgebras.html#14599" class="Bound">q</a><a id="14600" class="Symbol">}</a> <a id="14602" href="Base.Varieties.FreeAlgebras.html#14602" class="Bound">pKq</a> <a id="14606" class="Symbol">=</a> <a id="14608" class="Symbol">(</a><a id="14609" href="Base.Varieties.Preservation.html#20002" class="Function">class-ids-⇒</a> <a id="14621" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="14624" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="14627" href="Base.Varieties.FreeAlgebras.html#14595" class="Bound">p</a> <a id="14629" href="Base.Varieties.FreeAlgebras.html#14599" class="Bound">q</a> <a id="14631" class="Symbol">(</a><a id="14632" href="Base.Varieties.FreeAlgebras.html#14344" class="Function">class-models-kernel</a> <a id="14652" href="Base.Varieties.FreeAlgebras.html#14595" class="Bound">p</a> <a id="14654" href="Base.Varieties.FreeAlgebras.html#14599" class="Bound">q</a> <a id="14656" href="Base.Varieties.FreeAlgebras.html#14602" class="Bound">pKq</a><a id="14659" class="Symbol">))</a>

 <a id="14664" href="Base.Varieties.FreeAlgebras.html#14664" class="Function">kernel-in-theory</a> <a id="14681" class="Symbol">:</a> <a id="14683" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="14690" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14692" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="14697" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14699" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14701" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a> <a id="14704" href="Base.Varieties.FreeAlgebras.html#14467" class="Function">𝕍𝒦</a>
 <a id="14708" href="Base.Varieties.FreeAlgebras.html#14664" class="Function">kernel-in-theory</a> <a id="14725" class="Symbol">{</a><a id="14726" href="Base.Varieties.FreeAlgebras.html#14726" class="Bound">p</a> <a id="14728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14730" href="Base.Varieties.FreeAlgebras.html#14730" class="Bound">q</a><a id="14731" class="Symbol">}</a> <a id="14733" href="Base.Varieties.FreeAlgebras.html#14733" class="Bound">pKq</a> <a id="14737" href="Base.Varieties.FreeAlgebras.html#14737" class="Bound">vkA</a> <a id="14741" href="Base.Varieties.FreeAlgebras.html#14741" class="Bound">x</a> <a id="14743" class="Symbol">=</a> <a id="14745" href="Base.Varieties.Preservation.html#20115" class="Function">class-ids</a> <a id="14755" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="14758" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="14761" href="Base.Varieties.FreeAlgebras.html#14726" class="Bound">p</a> <a id="14763" href="Base.Varieties.FreeAlgebras.html#14730" class="Bound">q</a> <a id="14765" class="Symbol">(</a><a id="14766" href="Base.Varieties.FreeAlgebras.html#14344" class="Function">class-models-kernel</a> <a id="14786" href="Base.Varieties.FreeAlgebras.html#14726" class="Bound">p</a> <a id="14788" href="Base.Varieties.FreeAlgebras.html#14730" class="Bound">q</a> <a id="14790" href="Base.Varieties.FreeAlgebras.html#14733" class="Bound">pKq</a><a id="14793" class="Symbol">)</a> <a id="14795" href="Base.Varieties.FreeAlgebras.html#14737" class="Bound">vkA</a> <a id="14799" href="Base.Varieties.FreeAlgebras.html#14741" class="Bound">x</a>

 <a id="14803" href="Base.Varieties.FreeAlgebras.html#14803" class="Function Operator">_↠_</a> <a id="14807" class="Symbol">:</a> <a id="14809" href="Base.Varieties.FreeAlgebras.html#1172" class="Primitive">Type</a> <a id="14814" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a> <a id="14816" class="Symbol">→</a> <a id="14818" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="14826" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="14829" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a> <a id="14831" class="Symbol">→</a> <a id="14833" href="Base.Varieties.FreeAlgebras.html#1172" class="Primitive">Type</a> <a id="14838" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a>
 <a id="14842" href="Base.Varieties.FreeAlgebras.html#14842" class="Bound">X</a> <a id="14844" href="Base.Varieties.FreeAlgebras.html#14803" class="Function Operator">↠</a> <a id="14846" href="Base.Varieties.FreeAlgebras.html#14846" class="Bound">𝑨</a> <a id="14848" class="Symbol">=</a> <a id="14850" href="Data.Product.html#916" class="Function">Σ[</a> <a id="14853" href="Base.Varieties.FreeAlgebras.html#14853" class="Bound">h</a> <a id="14855" href="Data.Product.html#916" class="Function">∈</a> <a id="14857" class="Symbol">(</a><a id="14858" href="Base.Varieties.FreeAlgebras.html#14842" class="Bound">X</a> <a id="14860" class="Symbol">→</a> <a id="14862" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="14864" href="Base.Varieties.FreeAlgebras.html#14846" class="Bound">𝑨</a> <a id="14866" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="14867" class="Symbol">)</a> <a id="14869" href="Data.Product.html#916" class="Function">]</a> <a id="14871" href="Base.Functions.Surjective.html#1759" class="Function">IsSurjective</a> <a id="14884" href="Base.Varieties.FreeAlgebras.html#14853" class="Bound">h</a>

 <a id="14888" href="Base.Varieties.FreeAlgebras.html#14888" class="Function">𝔽-ModTh-epi</a> <a id="14900" class="Symbol">:</a> <a id="14902" class="Symbol">(</a><a id="14903" href="Base.Varieties.FreeAlgebras.html#14903" class="Bound">𝑨</a> <a id="14905" class="Symbol">:</a> <a id="14907" href="Base.Algebras.Basic.html#3051" class="Function">Algebra</a> <a id="14915" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="14918" href="Base.Varieties.FreeAlgebras.html#1011" class="Bound">𝑆</a><a id="14919" class="Symbol">)</a> <a id="14921" class="Symbol">→</a> <a id="14923" class="Symbol">(</a><a id="14924" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="14926" href="Base.Varieties.FreeAlgebras.html#14803" class="Function Operator">↠</a> <a id="14928" href="Base.Varieties.FreeAlgebras.html#14903" class="Bound">𝑨</a><a id="14929" class="Symbol">)</a> <a id="14931" class="Symbol">→</a> <a id="14933" href="Base.Varieties.FreeAlgebras.html#14903" class="Bound">𝑨</a> <a id="14935" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14937" href="Base.Varieties.EquationalLogic.html#3871" class="Function">Mod</a> <a id="14941" class="Symbol">(</a><a id="14942" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a> <a id="14945" href="Base.Varieties.FreeAlgebras.html#14467" class="Function">𝕍𝒦</a><a id="14947" class="Symbol">)</a> <a id="14949" class="Symbol">→</a> <a id="14951" href="Base.Homomorphisms.Basic.html#4313" class="Function">epi</a> <a id="14955" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="14957" href="Base.Varieties.FreeAlgebras.html#14903" class="Bound">𝑨</a>
 <a id="14960" href="Base.Varieties.FreeAlgebras.html#14888" class="Function">𝔽-ModTh-epi</a> <a id="14972" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="14974" class="Symbol">(</a><a id="14975" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a> <a id="14977" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14979" href="Base.Varieties.FreeAlgebras.html#14979" class="Bound">ηE</a><a id="14981" class="Symbol">)</a> <a id="14983" href="Base.Varieties.FreeAlgebras.html#14983" class="Bound">AinMTV</a> <a id="14990" class="Symbol">=</a> <a id="14992" href="Base.Varieties.FreeAlgebras.html#15504" class="Function">goal</a>
  <a id="14999" class="Keyword">where</a>
  <a id="15007" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15009" class="Symbol">:</a> <a id="15011" href="Base.Homomorphisms.Basic.html#2738" class="Function">hom</a> <a id="15015" class="Symbol">(</a><a id="15016" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="15018" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="15019" class="Symbol">)</a> <a id="15021" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a>
  <a id="15025" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15027" class="Symbol">=</a> <a id="15029" href="Base.Terms.Properties.html#3206" class="Function">lift-hom</a> <a id="15038" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15040" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a>

  <a id="15045" href="Base.Varieties.FreeAlgebras.html#15045" class="Function">φE</a> <a id="15048" class="Symbol">:</a> <a id="15050" href="Base.Functions.Surjective.html#1759" class="Function">IsSurjective</a> <a id="15063" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15065" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15067" href="Overture.Basic.html#4303" class="Function Operator">∣</a>
  <a id="15071" href="Base.Varieties.FreeAlgebras.html#15045" class="Function">φE</a> <a id="15074" class="Symbol">=</a> <a id="15076" href="Base.Terms.Properties.html#4850" class="Function">lift-of-epi-is-epi</a> <a id="15095" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15097" href="Base.Varieties.FreeAlgebras.html#14979" class="Bound">ηE</a>

  <a id="15103" href="Base.Varieties.FreeAlgebras.html#15103" class="Function">pqlem2</a> <a id="15110" class="Symbol">:</a> <a id="15112" class="Symbol">∀</a> <a id="15114" href="Base.Varieties.FreeAlgebras.html#15114" class="Bound">p</a> <a id="15116" href="Base.Varieties.FreeAlgebras.html#15116" class="Bound">q</a> <a id="15118" class="Symbol">→</a> <a id="15120" class="Symbol">(</a><a id="15121" href="Base.Varieties.FreeAlgebras.html#15114" class="Bound">p</a> <a id="15123" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15125" href="Base.Varieties.FreeAlgebras.html#15116" class="Bound">q</a><a id="15126" class="Symbol">)</a> <a id="15128" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15130" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="15137" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15139" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="15144" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15146" class="Symbol">→</a> <a id="15148" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15150" href="Base.Varieties.EquationalLogic.html#2452" class="Function Operator">⊧</a> <a id="15152" href="Base.Varieties.FreeAlgebras.html#15114" class="Bound">p</a> <a id="15154" href="Base.Varieties.EquationalLogic.html#2452" class="Function Operator">≈</a> <a id="15156" href="Base.Varieties.FreeAlgebras.html#15116" class="Bound">q</a>
  <a id="15160" href="Base.Varieties.FreeAlgebras.html#15103" class="Function">pqlem2</a> <a id="15167" href="Base.Varieties.FreeAlgebras.html#15167" class="Bound">p</a> <a id="15169" href="Base.Varieties.FreeAlgebras.html#15169" class="Bound">q</a> <a id="15171" href="Base.Varieties.FreeAlgebras.html#15171" class="Bound">z</a> <a id="15173" class="Symbol">=</a> <a id="15175" class="Symbol">λ</a> <a id="15177" href="Base.Varieties.FreeAlgebras.html#15177" class="Bound">x</a> <a id="15179" class="Symbol">→</a> <a id="15181" href="Base.Varieties.FreeAlgebras.html#14983" class="Bound">AinMTV</a> <a id="15188" href="Base.Varieties.FreeAlgebras.html#15167" class="Bound">p</a> <a id="15190" href="Base.Varieties.FreeAlgebras.html#15169" class="Bound">q</a> <a id="15192" class="Symbol">(</a><a id="15193" href="Base.Varieties.FreeAlgebras.html#14664" class="Function">kernel-in-theory</a> <a id="15210" href="Base.Varieties.FreeAlgebras.html#15171" class="Bound">z</a><a id="15211" class="Symbol">)</a> <a id="15213" href="Base.Varieties.FreeAlgebras.html#15177" class="Bound">x</a>

  <a id="15218" href="Base.Varieties.FreeAlgebras.html#15218" class="Function">kerincl</a> <a id="15226" class="Symbol">:</a> <a id="15228" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="15235" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15237" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="15242" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15244" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15246" href="Base.Relations.Discrete.html#4558" class="Function">kernel</a> <a id="15253" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15255" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15257" href="Overture.Basic.html#4303" class="Function Operator">∣</a>
  <a id="15261" href="Base.Varieties.FreeAlgebras.html#15218" class="Function">kerincl</a> <a id="15269" class="Symbol">{</a><a id="15270" href="Base.Varieties.FreeAlgebras.html#15270" class="Bound">p</a> <a id="15272" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15274" href="Base.Varieties.FreeAlgebras.html#15274" class="Bound">q</a><a id="15275" class="Symbol">}</a> <a id="15277" href="Base.Varieties.FreeAlgebras.html#15277" class="Bound">x</a> <a id="15279" class="Symbol">=</a> <a id="15281" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15283" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15285" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15287" href="Base.Varieties.FreeAlgebras.html#15270" class="Bound">p</a>      <a id="15294" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15297" class="Symbol">(</a><a id="15298" href="Base.Terms.Operations.html#2914" class="Function">free-lift-interp</a> <a id="15315" class="Symbol">(</a><a id="15316" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="15319" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="15321" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="15323" class="Symbol">)</a> <a id="15325" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15327" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a> <a id="15329" href="Base.Varieties.FreeAlgebras.html#15270" class="Bound">p</a><a id="15330" class="Symbol">)</a><a id="15331" href="Overture.Basic.html#4897" class="Function Operator">⁻¹</a> <a id="15334" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15358" class="Symbol">(</a><a id="15359" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15361" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="15363" href="Base.Varieties.FreeAlgebras.html#15270" class="Bound">p</a> <a id="15365" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="15366" class="Symbol">)</a> <a id="15368" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a>  <a id="15371" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15374" href="Base.Varieties.FreeAlgebras.html#15103" class="Function">pqlem2</a> <a id="15381" href="Base.Varieties.FreeAlgebras.html#15270" class="Bound">p</a> <a id="15383" href="Base.Varieties.FreeAlgebras.html#15274" class="Bound">q</a> <a id="15385" href="Base.Varieties.FreeAlgebras.html#15277" class="Bound">x</a> <a id="15387" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a> <a id="15389" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15413" class="Symbol">(</a><a id="15414" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15416" href="Base.Terms.Operations.html#2603" class="Function Operator">⟦</a> <a id="15418" href="Base.Varieties.FreeAlgebras.html#15274" class="Bound">q</a> <a id="15420" href="Base.Terms.Operations.html#2603" class="Function Operator">⟧</a><a id="15421" class="Symbol">)</a> <a id="15423" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a>  <a id="15426" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15429" href="Base.Terms.Operations.html#2914" class="Function">free-lift-interp</a> <a id="15446" class="Symbol">(</a><a id="15447" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="15450" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="15452" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="15454" class="Symbol">)</a> <a id="15456" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15458" href="Base.Varieties.FreeAlgebras.html#14975" class="Bound">η</a> <a id="15460" href="Base.Varieties.FreeAlgebras.html#15274" class="Bound">q</a> <a id="15462" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15486" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15488" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15490" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="15492" href="Base.Varieties.FreeAlgebras.html#15274" class="Bound">q</a>      <a id="15499" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="15504" href="Base.Varieties.FreeAlgebras.html#15504" class="Function">goal</a> <a id="15509" class="Symbol">:</a> <a id="15511" href="Base.Homomorphisms.Basic.html#4313" class="Function">epi</a> <a id="15515" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="15517" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a>
  <a id="15521" href="Base.Varieties.FreeAlgebras.html#15504" class="Function">goal</a> <a id="15526" class="Symbol">=</a> <a id="15528" href="Base.Varieties.FreeAlgebras.html#1291" class="Field">fst</a> <a id="15532" class="Symbol">(</a><a id="15533" href="Base.Homomorphisms.Factor.html#3126" class="Function">HomFactorEpi</a> <a id="15546" class="Symbol">(</a><a id="15547" href="Base.Varieties.FreeAlgebras.html#9600" class="Bound">wd</a> <a id="15550" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="15552" class="Symbol">(</a><a id="15553" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="15557" class="Symbol">(</a><a id="15558" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="15561" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="15562" class="Symbol">)))</a> <a id="15566" href="Base.Varieties.FreeAlgebras.html#14972" class="Bound">𝑨</a> <a id="15568" href="Base.Varieties.FreeAlgebras.html#15007" class="Function">φ</a> <a id="15570" href="Base.Varieties.FreeAlgebras.html#10936" class="Function">hom𝔽</a> <a id="15575" href="Base.Varieties.FreeAlgebras.html#15218" class="Function">kerincl</a> <a id="15583" href="Base.Varieties.FreeAlgebras.html#10980" class="Function">hom𝔽-is-epic</a> <a id="15596" href="Base.Varieties.FreeAlgebras.html#15045" class="Function">φE</a><a id="15598" class="Symbol">)</a>
</pre>


#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of `𝔽`.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="15958" class="Keyword">module</a> <a id="15965" href="Base.Varieties.FreeAlgebras.html#15965" class="Module">_</a> <a id="15967" class="Symbol">(</a><a id="15968" href="Base.Varieties.FreeAlgebras.html#15968" class="Bound">pe</a> <a id="15971" class="Symbol">:</a> <a id="15973" href="Base.Equality.Extensionality.html#3021" class="Function">pred-ext</a> <a id="15982" class="Symbol">(</a><a id="15983" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="15986" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="15987" class="Symbol">)(</a><a id="15989" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="15992" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="15993" class="Symbol">))(</a><a id="15996" href="Base.Varieties.FreeAlgebras.html#15996" class="Bound">wd</a> <a id="15999" class="Symbol">:</a> <a id="16001" href="Base.Equality.Welldefined.html#2798" class="Function">SwellDef</a><a id="16009" class="Symbol">)</a> <a id="16011" class="Comment">-- extensionality assumptions</a>
          <a id="16051" class="Symbol">(</a><a id="16052" href="Base.Varieties.FreeAlgebras.html#16052" class="Bound">Cset</a> <a id="16057" class="Symbol">:</a> <a id="16059" href="Base.Equality.Truncation.html#6603" class="Function">is-set</a> <a id="16066" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="16068" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="16070" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="16071" class="Symbol">)</a>                       <a id="16095" class="Comment">-- truncation assumptions</a>
          <a id="16131" class="Symbol">(</a><a id="16132" href="Base.Varieties.FreeAlgebras.html#16132" class="Bound">kuip</a> <a id="16137" class="Symbol">:</a> <a id="16139" href="Base.Equality.Truncation.html#10874" class="Function">blk-uip</a><a id="16146" class="Symbol">(</a><a id="16147" href="Base.Terms.Basic.html#2087" class="Datatype">Term</a> <a id="16152" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="16153" class="Symbol">)</a><a id="16154" href="Overture.Basic.html#4303" class="Function Operator">∣</a> <a id="16156" href="Base.Homomorphisms.Kernels.html#2368" class="Function">kercon</a> <a id="16163" class="Symbol">(</a><a id="16164" href="Base.Varieties.FreeAlgebras.html#15996" class="Bound">wd</a> <a id="16167" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="16169" class="Symbol">(</a><a id="16170" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="16173" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="16174" class="Symbol">)){</a><a id="16177" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a><a id="16178" class="Symbol">}</a><a id="16179" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="16184" href="Overture.Basic.html#4303" class="Function Operator">∣</a><a id="16185" class="Symbol">)</a>
  <a id="16189" class="Keyword">where</a>

  <a id="16198" href="Base.Varieties.FreeAlgebras.html#16198" class="Function">𝔽≤ℭ</a> <a id="16202" class="Symbol">:</a> <a id="16204" class="Symbol">(</a><a id="16205" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">ker[</a> <a id="16210" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="16212" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="16214" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">⇒</a> <a id="16216" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="16218" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">]</a> <a id="16220" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="16225" href="Base.Homomorphisms.Kernels.html#2774" class="Function Operator">↾</a> <a id="16227" class="Symbol">(</a><a id="16228" href="Base.Varieties.FreeAlgebras.html#15996" class="Bound">wd</a> <a id="16231" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="16233" class="Symbol">(</a><a id="16234" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="16237" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="16238" class="Symbol">)))</a> <a id="16242" href="Base.Subalgebras.Subalgebras.html#1868" class="Function Operator">≤</a> <a id="16244" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a>
  <a id="16248" href="Base.Varieties.FreeAlgebras.html#16198" class="Function">𝔽≤ℭ</a> <a id="16252" class="Symbol">=</a> <a id="16254" href="Base.Subalgebras.Subalgebras.html#3711" class="Function">FirstHomCorollary|Set</a> <a id="16276" class="Symbol">(</a><a id="16277" href="Base.Terms.Basic.html#3370" class="Function">𝑻</a> <a id="16279" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="16280" class="Symbol">)</a> <a id="16282" href="Base.Varieties.FreeAlgebras.html#10008" class="Function">ℭ</a> <a id="16284" href="Base.Varieties.FreeAlgebras.html#10195" class="Function">homℭ</a> <a id="16289" href="Base.Varieties.FreeAlgebras.html#15968" class="Bound">pe</a> <a id="16292" class="Symbol">(</a><a id="16293" href="Base.Varieties.FreeAlgebras.html#15996" class="Bound">wd</a> <a id="16296" href="Base.Varieties.FreeAlgebras.html#1027" class="Bound">𝓥</a> <a id="16298" class="Symbol">(</a><a id="16299" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="16302" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="16303" class="Symbol">))</a> <a id="16306" href="Base.Varieties.FreeAlgebras.html#16052" class="Bound">Cset</a> <a id="16311" href="Base.Varieties.FreeAlgebras.html#16132" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.


#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="17373" href="Base.Varieties.FreeAlgebras.html#17373" class="Function">𝔽∈SP</a> <a id="17378" class="Symbol">:</a> <a id="17380" href="Base.Equality.Truncation.html#3945" class="Function">hfunext</a> <a id="17388" class="Symbol">(</a><a id="17389" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17392" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17393" class="Symbol">)(</a><a id="17395" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17398" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17399" class="Symbol">)</a> <a id="17401" class="Symbol">→</a> <a id="17403" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="17405" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="17407" class="Symbol">(</a><a id="17408" href="Base.Varieties.Closure.html#3549" class="Datatype">S</a><a id="17409" class="Symbol">{</a><a id="17410" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="17411" class="Symbol">}{</a><a id="17413" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="17415" class="Symbol">}</a> <a id="17417" class="Symbol">(</a><a id="17418" href="Base.Varieties.Closure.html#4124" class="Datatype">P</a><a id="17419" class="Symbol">{</a><a id="17420" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17421" class="Symbol">}{</a><a id="17423" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="17424" class="Symbol">}</a> <a id="17426" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a><a id="17427" class="Symbol">))</a>
  <a id="17432" href="Base.Varieties.FreeAlgebras.html#17373" class="Function">𝔽∈SP</a> <a id="17437" href="Base.Varieties.FreeAlgebras.html#17437" class="Bound">hfe</a> <a id="17441" class="Symbol">=</a> <a id="17443" href="Base.Varieties.Closure.html#3757" class="InductiveConstructor">ssub</a> <a id="17448" class="Symbol">(</a><a id="17449" href="Base.Varieties.Preservation.html#12453" class="Function">class-prod-s-∈-sp</a> <a id="17467" href="Base.Varieties.FreeAlgebras.html#17437" class="Bound">hfe</a><a id="17470" class="Symbol">)</a> <a id="17472" href="Base.Varieties.FreeAlgebras.html#16198" class="Function">𝔽≤ℭ</a>

  <a id="17479" href="Base.Varieties.FreeAlgebras.html#17479" class="Function">𝔽∈𝕍</a> <a id="17483" class="Symbol">:</a> <a id="17485" href="Base.Equality.Truncation.html#3945" class="Function">hfunext</a> <a id="17493" class="Symbol">(</a><a id="17494" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17497" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17498" class="Symbol">)(</a><a id="17500" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17503" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17504" class="Symbol">)</a> <a id="17506" class="Symbol">→</a> <a id="17508" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="17510" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="17512" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="17514" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
  <a id="17518" href="Base.Varieties.FreeAlgebras.html#17479" class="Function">𝔽∈𝕍</a> <a id="17522" href="Base.Varieties.FreeAlgebras.html#17522" class="Bound">hfe</a> <a id="17526" class="Symbol">=</a> <a id="17528" href="Base.Varieties.Preservation.html#8748" class="Function">SP⊆V&#39;</a> <a id="17534" class="Symbol">{</a><a id="17535" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17536" class="Symbol">}{</a><a id="17538" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="17541" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="17543" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17544" class="Symbol">}{</a><a id="17546" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="17549" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a> <a id="17552" href="Base.Varieties.FreeAlgebras.html#3035" class="Function">𝓕⁺</a><a id="17554" class="Symbol">}{</a><a id="17556" href="Base.Varieties.FreeAlgebras.html#9586" class="Bound">fe</a> <a id="17559" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a> <a id="17561" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="17562" class="Symbol">}{</a><a id="17564" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a><a id="17565" class="Symbol">}</a> <a id="17567" class="Symbol">(</a><a id="17568" href="Base.Varieties.FreeAlgebras.html#17373" class="Function">𝔽∈SP</a> <a id="17573" href="Base.Varieties.FreeAlgebras.html#17522" class="Bound">hfe</a><a id="17576" class="Symbol">)</a>
</pre>


#### The HSP Theorem

Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="17914" href="Base.Varieties.FreeAlgebras.html#17914" class="Function">Birkhoff</a> <a id="17923" class="Symbol">:</a> <a id="17925" href="Base.Equality.Truncation.html#3945" class="Function">hfunext</a> <a id="17933" class="Symbol">(</a><a id="17934" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17937" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17938" class="Symbol">)(</a><a id="17940" href="Base.Algebras.Products.html#3109" class="Function">ov</a> <a id="17943" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="17944" class="Symbol">)</a> <a id="17946" class="Symbol">→</a> <a id="17948" class="Symbol">(∀</a> <a id="17951" href="Base.Varieties.FreeAlgebras.html#17951" class="Bound">𝑨</a> <a id="17953" class="Symbol">→</a> <a id="17955" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a> <a id="17957" href="Base.Varieties.FreeAlgebras.html#14803" class="Function Operator">↠</a> <a id="17959" href="Base.Varieties.FreeAlgebras.html#17951" class="Bound">𝑨</a><a id="17960" class="Symbol">)</a> <a id="17962" class="Symbol">→</a> <a id="17964" href="Base.Varieties.EquationalLogic.html#3871" class="Function">Mod</a> <a id="17968" class="Symbol">(</a><a id="17969" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a> <a id="17972" class="Symbol">(</a><a id="17973" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="17975" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a><a id="17976" class="Symbol">))</a> <a id="17979" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="17981" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="17983" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a>
  <a id="17987" href="Base.Varieties.FreeAlgebras.html#17914" class="Function">Birkhoff</a> <a id="17996" href="Base.Varieties.FreeAlgebras.html#17996" class="Bound">hfe</a> <a id="18000" href="Base.Varieties.FreeAlgebras.html#18000" class="Bound">𝕏</a> <a id="18002" class="Symbol">{</a><a id="18003" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a><a id="18004" class="Symbol">}</a> <a id="18006" href="Base.Varieties.FreeAlgebras.html#18006" class="Bound">α</a> <a id="18008" class="Symbol">=</a> <a id="18010" href="Base.Varieties.Closure.html#5378" class="InductiveConstructor">vhimg</a><a id="18015" class="Symbol">{</a><a id="18016" class="Argument">𝑩</a> <a id="18018" class="Symbol">=</a> <a id="18020" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a><a id="18021" class="Symbol">}</a> <a id="18023" class="Symbol">(</a><a id="18024" href="Base.Varieties.FreeAlgebras.html#17479" class="Function">𝔽∈𝕍</a> <a id="18028" href="Base.Varieties.FreeAlgebras.html#17996" class="Bound">hfe</a><a id="18031" class="Symbol">)</a> <a id="18033" class="Symbol">(</a><a id="18034" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a> <a id="18036" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18038" href="Base.Homomorphisms.Basic.html#4774" class="Function">epi→hom</a> <a id="18046" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a> <a id="18048" href="Base.Varieties.FreeAlgebras.html#18077" class="Function">φE</a> <a id="18051" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18053" href="Base.Varieties.FreeAlgebras.html#1306" class="Field">snd</a> <a id="18057" href="Overture.Basic.html#4341" class="Function Operator">∥</a> <a id="18059" href="Base.Varieties.FreeAlgebras.html#18077" class="Function">φE</a> <a id="18062" href="Overture.Basic.html#4341" class="Function Operator">∥</a><a id="18063" class="Symbol">)</a>
   <a id="18068" class="Keyword">where</a>
   <a id="18077" href="Base.Varieties.FreeAlgebras.html#18077" class="Function">φE</a> <a id="18080" class="Symbol">:</a> <a id="18082" href="Base.Homomorphisms.Basic.html#4313" class="Function">epi</a> <a id="18086" href="Base.Varieties.FreeAlgebras.html#10819" class="Function">𝔽</a> <a id="18088" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a>
   <a id="18093" href="Base.Varieties.FreeAlgebras.html#18077" class="Function">φE</a> <a id="18096" class="Symbol">=</a> <a id="18098" href="Base.Varieties.FreeAlgebras.html#14888" class="Function">𝔽-ModTh-epi</a> <a id="18110" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a> <a id="18112" class="Symbol">(</a><a id="18113" href="Base.Varieties.FreeAlgebras.html#18000" class="Bound">𝕏</a> <a id="18115" href="Base.Varieties.FreeAlgebras.html#18003" class="Bound">𝑨</a><a id="18116" class="Symbol">)</a> <a id="18118" href="Base.Varieties.FreeAlgebras.html#18006" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="18376" href="Base.Varieties.FreeAlgebras.html#18376" class="Function">Birkhoff-converse</a> <a id="18394" class="Symbol">:</a> <a id="18396" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a><a id="18397" class="Symbol">{</a><a id="18398" href="Base.Varieties.FreeAlgebras.html#999" class="Bound">α</a><a id="18399" class="Symbol">}{</a><a id="18401" href="Base.Varieties.FreeAlgebras.html#3033" class="Function">𝓕</a><a id="18402" class="Symbol">}</a> <a id="18404" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a> <a id="18406" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18408" href="Base.Varieties.EquationalLogic.html#3871" class="Function">Mod</a><a id="18411" class="Symbol">{</a><a id="18412" class="Argument">X</a> <a id="18414" class="Symbol">=</a> <a id="18416" href="Base.Varieties.FreeAlgebras.html#9615" class="Bound">X</a><a id="18417" class="Symbol">}</a> <a id="18419" class="Symbol">(</a><a id="18420" href="Base.Varieties.EquationalLogic.html#3330" class="Function">Th</a> <a id="18423" class="Symbol">(</a><a id="18424" href="Base.Varieties.Closure.html#5094" class="Datatype">V</a> <a id="18426" href="Base.Varieties.FreeAlgebras.html#9628" class="Bound">𝒦</a><a id="18427" class="Symbol">))</a>
  <a id="18432" href="Base.Varieties.FreeAlgebras.html#18376" class="Function">Birkhoff-converse</a> <a id="18450" href="Base.Varieties.FreeAlgebras.html#18450" class="Bound">α</a> <a id="18452" href="Base.Varieties.FreeAlgebras.html#18452" class="Bound">p</a> <a id="18454" href="Base.Varieties.FreeAlgebras.html#18454" class="Bound">q</a> <a id="18456" href="Base.Varieties.FreeAlgebras.html#18456" class="Bound">pThq</a> <a id="18461" class="Symbol">=</a> <a id="18463" href="Base.Varieties.FreeAlgebras.html#18456" class="Bound">pThq</a> <a id="18468" href="Base.Varieties.FreeAlgebras.html#18450" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Base.Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.

--------------------------------

<span style="float:left;">[← Base.Varieties.Preservation](Base.Varieties.Preservation.html)</span>
<span style="float:right;">[Base.Structures →](Base.Structures.html)</span>

{% include UALib.Links.md %}
