---
layout: default
title : Varieties.FreeAlgebras module (Agda Universal Algebra Library)
date : 2021-03-01
author: [agda-algebras development team][]
---

## <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="799" class="Symbol">{-#</a> <a id="803" class="Keyword">OPTIONS</a> <a id="811" class="Pragma">--without-K</a> <a id="823" class="Pragma">--exact-split</a> <a id="837" class="Pragma">--safe</a> <a id="844" class="Symbol">#-}</a>


<a id="850" class="Keyword">open</a> <a id="855" class="Keyword">import</a> <a id="862" href="Level.html" class="Module">Level</a> <a id="868" class="Keyword">renaming</a> <a id="877" class="Symbol">(</a> <a id="879" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="883" class="Symbol">to</a> <a id="886" class="Primitive">lsuc</a> <a id="891" class="Symbol">)</a>
<a id="893" class="Keyword">open</a> <a id="898" class="Keyword">import</a> <a id="905" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="920" class="Keyword">using</a> <a id="926" class="Symbol">(</a> <a id="928" href="Algebras.Basic.html#1139" class="Generalizable">𝓞</a> <a id="930" class="Symbol">;</a> <a id="932" href="Algebras.Basic.html#1141" class="Generalizable">𝓥</a> <a id="934" class="Symbol">;</a> <a id="936" href="Algebras.Basic.html#3865" class="Function">Signature</a> <a id="946" class="Symbol">)</a>

<a id="949" class="Keyword">module</a> <a id="956" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="979" class="Symbol">{</a><a id="980" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="982" href="Varieties.FreeAlgebras.html#982" class="Bound">𝓞</a> <a id="984" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="986" class="Symbol">:</a> <a id="988" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="993" class="Symbol">}</a> <a id="995" class="Symbol">(</a><a id="996" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Algebras.Basic.html#3865" class="Function">Signature</a> <a id="1010" href="Varieties.FreeAlgebras.html#982" class="Bound">𝓞</a> <a id="1012" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a><a id="1013" class="Symbol">)</a> <a id="1015" class="Keyword">where</a>

<a id="1022" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1095" class="Keyword">open</a> <a id="1100" class="Keyword">import</a> <a id="1107" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1170" class="Keyword">using</a> <a id="1176" class="Symbol">()</a> <a id="1179" class="Keyword">renaming</a> <a id="1188" class="Symbol">(</a><a id="1189" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1204" class="Symbol">to</a> <a id="1207" class="Function">funext</a><a id="1213" class="Symbol">)</a>
<a id="1215" class="Keyword">open</a> <a id="1220" class="Keyword">import</a> <a id="1227" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1243" class="Keyword">using</a> <a id="1249" class="Symbol">(</a> <a id="1251" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1255" class="Symbol">)</a> <a id="1257" class="Keyword">renaming</a> <a id="1266" class="Symbol">(</a> <a id="1268" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1272" class="Symbol">to</a> <a id="1275" class="Primitive">Type</a> <a id="1280" class="Symbol">)</a>
<a id="1282" class="Keyword">open</a> <a id="1287" class="Keyword">import</a> <a id="1294" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1310" class="Keyword">using</a> <a id="1316" class="Symbol">(</a> <a id="1318" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1322" class="Symbol">;</a> <a id="1324" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1333" class="Symbol">;</a> <a id="1335" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1339" class="Symbol">)</a> <a id="1341" class="Keyword">renaming</a> <a id="1350" class="Symbol">(</a> <a id="1352" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1358" class="Symbol">to</a> <a id="1361" class="Field">fst</a> <a id="1365" class="Symbol">;</a> <a id="1367" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1373" class="Symbol">to</a> <a id="1376" class="Field">snd</a> <a id="1380" class="Symbol">)</a>
<a id="1382" class="Keyword">open</a> <a id="1387" class="Keyword">import</a> <a id="1394" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1410" class="Keyword">using</a> <a id="1416" class="Symbol">(</a> <a id="1418" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1422" class="Symbol">)</a>
<a id="1424" class="Keyword">open</a> <a id="1429" class="Keyword">import</a> <a id="1436" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1452" class="Keyword">using</a> <a id="1458" class="Symbol">(</a> <a id="1460" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1474" class="Symbol">)</a> <a id="1476" class="Keyword">renaming</a> <a id="1485" class="Symbol">(</a> <a id="1487" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1491" class="Symbol">to</a> <a id="1494" class="Function">BinRel</a> <a id="1501" class="Symbol">)</a>
<a id="1503" class="Keyword">open</a> <a id="1508" class="Keyword">import</a> <a id="1515" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1581" class="Keyword">using</a> <a id="1587" class="Symbol">(</a> <a id="1589" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1593" class="Symbol">;</a> <a id="1595" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1618" class="Symbol">;</a> <a id="1620" class="Keyword">module</a> <a id="1627" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1639" class="Symbol">)</a>
<a id="1641" class="Keyword">open</a> <a id="1646" class="Keyword">import</a> <a id="1653" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1669" class="Keyword">using</a>    <a id="1678" class="Symbol">(</a> <a id="1680" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1685" class="Symbol">;</a> <a id="1687" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1691" class="Symbol">;</a> <a id="1693" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1697" class="Symbol">;</a> <a id="1699" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1703" class="Symbol">;</a> <a id="1705" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1709" class="Symbol">)</a>

<a id="1712" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1807" class="Keyword">open</a> <a id="1812" class="Keyword">import</a> <a id="1819" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1854" class="Keyword">using</a> <a id="1860" class="Symbol">(</a> <a id="1862" href="Overture.Preliminaries.html#4524" class="Function Operator">∣_∣</a> <a id="1866" class="Symbol">;</a> <a id="1868" href="Overture.Preliminaries.html#4562" class="Function Operator">∥_∥</a> <a id="1872" class="Symbol">;</a> <a id="1874" href="Overture.Preliminaries.html#5554" class="Function Operator">_∙_</a> <a id="1878" class="Symbol">;</a> <a id="1880" href="Overture.Preliminaries.html#5228" class="Function Operator">_⁻¹</a> <a id="1884" class="Symbol">)</a>
<a id="1886" class="Keyword">open</a> <a id="1891" class="Keyword">import</a> <a id="1898" href="Overture.Inverses.html" class="Module">Overture.Inverses</a>                  <a id="1933" class="Keyword">using</a> <a id="1939" class="Symbol">(</a> <a id="1941" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="1954" class="Symbol">)</a>
<a id="1956" class="Keyword">open</a> <a id="1961" class="Keyword">import</a> <a id="1968" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2003" class="Keyword">using</a> <a id="2009" class="Symbol">(</a> <a id="2011" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="2018" class="Symbol">)</a>
<a id="2020" class="Keyword">open</a> <a id="2025" class="Keyword">import</a> <a id="2032" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2067" class="Keyword">using</a> <a id="2073" class="Symbol">(</a> <a id="2075" href="Relations.Quotients.html#5374" class="Function Operator">⟪_⟫</a> <a id="2079" class="Symbol">)</a>
<a id="2081" class="Keyword">open</a> <a id="2086" class="Keyword">import</a> <a id="2093" href="Foundations.Truncation.html" class="Module">Foundations.Truncation</a>             <a id="2128" class="Keyword">using</a> <a id="2134" class="Symbol">(</a> <a id="2136" href="Foundations.Truncation.html#6614" class="Function">is-set</a> <a id="2143" class="Symbol">;</a> <a id="2145" href="Foundations.Truncation.html#10869" class="Function">blk-uip</a> <a id="2153" class="Symbol">;</a> <a id="2155" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="2163" class="Symbol">)</a>
<a id="2165" class="Keyword">open</a> <a id="2170" class="Keyword">import</a> <a id="2177" href="Foundations.Welldefined.html" class="Module">Foundations.Welldefined</a>            <a id="2212" class="Keyword">using</a> <a id="2218" class="Symbol">(</a> <a id="2220" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a> <a id="2229" class="Symbol">;</a> <a id="2231" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="2240" class="Symbol">)</a>
<a id="2242" class="Keyword">open</a> <a id="2247" class="Keyword">import</a> <a id="2254" href="Foundations.Extensionality.html" class="Module">Foundations.Extensionality</a>         <a id="2289" class="Keyword">using</a> <a id="2295" class="Symbol">(</a> <a id="2297" href="Foundations.Extensionality.html#2463" class="Function">DFunExt</a><a id="2304" class="Symbol">;</a> <a id="2306" href="Foundations.Extensionality.html#3279" class="Function">pred-ext</a> <a id="2315" class="Symbol">)</a>
<a id="2317" class="Keyword">open</a> <a id="2322" class="Keyword">import</a> <a id="2329" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2364" class="Keyword">using</a> <a id="2370" class="Symbol">(</a> <a id="2372" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="2380" class="Symbol">;</a> <a id="2382" href="Algebras.Basic.html#10869" class="Function">Lift-Alg</a> <a id="2391" class="Symbol">;</a> <a id="2393" href="Algebras.Basic.html#12418" class="Function">compatible</a> <a id="2404" class="Symbol">;</a> <a id="2406" href="Algebras.Basic.html#9410" class="Function Operator">_̂_</a> <a id="2410" class="Symbol">)</a>
<a id="2412" class="Keyword">open</a> <a id="2417" class="Keyword">import</a> <a id="2424" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2451" class="Symbol">{</a><a id="2452" class="Argument">𝑆</a> <a id="2454" class="Symbol">=</a> <a id="2456" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2457" class="Symbol">}</a> <a id="2459" class="Keyword">using</a> <a id="2465" class="Symbol">(</a> <a id="2467" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="2470" class="Symbol">;</a> <a id="2472" href="Algebras.Products.html#1867" class="Function">⨅</a> <a id="2474" class="Symbol">)</a>
<a id="2476" class="Keyword">open</a> <a id="2481" class="Keyword">import</a> <a id="2488" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2515" class="Symbol">{</a><a id="2516" class="Argument">𝑆</a> <a id="2518" class="Symbol">=</a> <a id="2520" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2521" class="Symbol">}</a> <a id="2523" class="Keyword">using</a> <a id="2529" class="Symbol">(</a> <a id="2531" href="Algebras.Congruences.html#1986" class="Function">Con</a><a id="2534" class="Symbol">;</a> <a id="2536" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="2542" class="Symbol">;</a> <a id="2544" href="Algebras.Congruences.html#1800" class="Record">IsCongruence</a> <a id="2557" class="Symbol">)</a>
<a id="2559" class="Keyword">open</a> <a id="2564" class="Keyword">import</a> <a id="2571" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2598" class="Symbol">{</a><a id="2599" class="Argument">𝑆</a> <a id="2601" class="Symbol">=</a> <a id="2603" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2604" class="Symbol">}</a> <a id="2606" class="Keyword">using</a> <a id="2612" class="Symbol">(</a> <a id="2614" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="2618" class="Symbol">;</a> <a id="2620" href="Homomorphisms.Basic.html#10846" class="Function">⨅-hom-co</a> <a id="2629" class="Symbol">;</a> <a id="2631" href="Homomorphisms.Basic.html#8157" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2643" class="Symbol">;</a> <a id="2645" href="Homomorphisms.Basic.html#6073" class="Function">epi</a>
                                                     <a id="2702" class="Symbol">;</a> <a id="2704" href="Homomorphisms.Basic.html#9650" class="Function">πker</a> <a id="2709" class="Symbol">;</a> <a id="2711" href="Homomorphisms.Basic.html#6540" class="Function">epi-to-hom</a> <a id="2722" class="Symbol">;</a> <a id="2724" href="Homomorphisms.Basic.html#10159" class="Function">ker-in-con</a>
                                                     <a id="2788" class="Symbol">;</a>  <a id="2791" href="Homomorphisms.Basic.html#7749" class="Function">kercon</a> <a id="2798" class="Symbol">;</a> <a id="2800" href="Homomorphisms.Basic.html#3531" class="Function">∘-hom</a> <a id="2806" class="Symbol">)</a>
<a id="2808" class="Keyword">open</a> <a id="2813" class="Keyword">import</a> <a id="2820" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2847" class="Symbol">{</a><a id="2848" class="Argument">𝑆</a> <a id="2850" class="Symbol">=</a> <a id="2852" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2853" class="Symbol">}</a> <a id="2855" class="Keyword">using</a> <a id="2861" class="Symbol">(</a> <a id="2863" href="Homomorphisms.Noether.html#8601" class="Function">HomFactor</a> <a id="2873" class="Symbol">;</a> <a id="2875" href="Homomorphisms.Noether.html#9875" class="Function">HomFactorEpi</a> <a id="2888" class="Symbol">)</a>
<a id="2890" class="Keyword">open</a> <a id="2895" class="Keyword">import</a> <a id="2902" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2929" class="Symbol">{</a><a id="2930" class="Argument">𝑆</a> <a id="2932" class="Symbol">=</a> <a id="2934" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2935" class="Symbol">}</a> <a id="2937" class="Keyword">using</a> <a id="2943" class="Symbol">(</a> <a id="2945" href="Homomorphisms.Isomorphisms.html#2276" class="Record Operator">_≅_</a> <a id="2949" class="Symbol">;</a> <a id="2951" href="Homomorphisms.Isomorphisms.html#2816" class="Function">≅-refl</a> <a id="2958" class="Symbol">;</a> <a id="2960" href="Homomorphisms.Isomorphisms.html#2906" class="Function">≅-sym</a> <a id="2966" class="Symbol">;</a> <a id="2968" href="Homomorphisms.Isomorphisms.html#4349" class="Function">Lift-≅</a> <a id="2975" class="Symbol">)</a>
<a id="2977" class="Keyword">open</a> <a id="2982" class="Keyword">import</a> <a id="2989" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3016" class="Symbol">{</a><a id="3017" class="Argument">𝑆</a> <a id="3019" class="Symbol">=</a> <a id="3021" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3022" class="Symbol">}</a> <a id="3024" class="Keyword">using</a> <a id="3030" class="Symbol">(</a> <a id="3032" href="Terms.Basic.html#1987" class="Datatype">Term</a> <a id="3037" class="Symbol">;</a> <a id="3039" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="3041" class="Symbol">)</a>
<a id="3043" class="Keyword">open</a> <a id="3048" class="Keyword">import</a> <a id="3055" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3082" class="Symbol">{</a><a id="3083" class="Argument">𝑆</a> <a id="3085" class="Symbol">=</a> <a id="3087" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3088" class="Symbol">}</a> <a id="3090" class="Keyword">using</a> <a id="3096" class="Symbol">(</a> <a id="3098" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="3108" class="Symbol">;</a> <a id="3110" href="Terms.Properties.html#3177" class="Function">lift-hom</a>
                                                     <a id="3172" class="Symbol">;</a> <a id="3174" href="Terms.Properties.html#3576" class="Function">free-unique</a> <a id="3186" class="Symbol">;</a> <a id="3188" href="Terms.Properties.html#4782" class="Function">lift-of-epi-is-epi</a> <a id="3207" class="Symbol">)</a>
<a id="3209" class="Keyword">open</a> <a id="3214" class="Keyword">import</a> <a id="3221" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3248" class="Symbol">{</a><a id="3249" class="Argument">𝑆</a> <a id="3251" class="Symbol">=</a> <a id="3253" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3254" class="Symbol">}</a> <a id="3256" class="Keyword">using</a> <a id="3262" class="Symbol">(</a> <a id="3264" href="Terms.Operations.html#2574" class="Function Operator">_⟦_⟧</a><a id="3268" class="Symbol">;</a> <a id="3270" href="Terms.Operations.html#6579" class="Function">comm-hom-term</a><a id="3283" class="Symbol">;</a> <a id="3285" href="Terms.Operations.html#2885" class="Function">free-lift-interp</a> <a id="3302" class="Symbol">)</a>
<a id="3304" class="Keyword">open</a> <a id="3309" class="Keyword">import</a> <a id="3316" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3343" class="Symbol">{</a><a id="3344" class="Argument">𝑆</a> <a id="3346" class="Symbol">=</a> <a id="3348" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3349" class="Symbol">}</a> <a id="3351" class="Keyword">using</a> <a id="3357" class="Symbol">(</a> <a id="3359" href="Subalgebras.Subalgebras.html#2553" class="Function Operator">_≤_</a> <a id="3363" class="Symbol">;</a> <a id="3365" href="Subalgebras.Subalgebras.html#4384" class="Function">FirstHomCorollary|Set</a> <a id="3387" class="Symbol">)</a>
<a id="3389" class="Keyword">open</a> <a id="3394" class="Keyword">import</a> <a id="3401" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3428" class="Symbol">{</a><a id="3429" class="Argument">𝑆</a> <a id="3431" class="Symbol">=</a> <a id="3433" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3434" class="Symbol">}</a> <a id="3436" class="Keyword">using</a> <a id="3442" class="Symbol">(</a> <a id="3444" href="Varieties.EquationalLogic.html#2683" class="Function Operator">_⊫_≈_</a><a id="3449" class="Symbol">;</a> <a id="3451" href="Varieties.EquationalLogic.html#2605" class="Function Operator">_⊧_≈_</a><a id="3456" class="Symbol">;</a> <a id="3458" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a><a id="3460" class="Symbol">;</a> <a id="3462" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="3466" class="Symbol">)</a>
<a id="3468" class="Keyword">open</a> <a id="3473" class="Keyword">import</a> <a id="3480" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3507" class="Symbol">{</a><a id="3508" class="Argument">𝑆</a> <a id="3510" class="Symbol">=</a> <a id="3512" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3513" class="Symbol">}</a> <a id="3515" class="Keyword">using</a> <a id="3521" class="Symbol">(</a> <a id="3523" href="Varieties.Closure.html#3769" class="Datatype">S</a> <a id="3525" class="Symbol">;</a> <a id="3527" href="Varieties.Closure.html#4352" class="Datatype">P</a> <a id="3529" class="Symbol">;</a> <a id="3531" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="3533" class="Symbol">)</a>
<a id="3535" class="Keyword">open</a> <a id="3540" class="Keyword">import</a> <a id="3547" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3574" class="Symbol">{</a><a id="3575" class="Argument">𝑆</a> <a id="3577" class="Symbol">=</a> <a id="3579" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3580" class="Symbol">}</a> <a id="3582" class="Keyword">using</a> <a id="3588" class="Symbol">(</a> <a id="3590" class="Keyword">module</a> <a id="3597" href="Varieties.Preservation.html#10476" class="Module">class-products-with-maps</a>
                                                     <a id="3675" class="Symbol">;</a> <a id="3677" href="Varieties.Preservation.html#20383" class="Function">class-ids-⇒</a> <a id="3689" class="Symbol">;</a> <a id="3691" href="Varieties.Preservation.html#20496" class="Function">class-ids</a> <a id="3701" class="Symbol">;</a> <a id="3703" href="Varieties.Preservation.html#9292" class="Function">SP⊆V&#39;</a><a id="3708" class="Symbol">)</a>
<a id="3710" class="Keyword">open</a> <a id="3715" href="Terms.Basic.html#1987" class="Module">Term</a>
<a id="3720" class="Keyword">open</a> <a id="3725" href="Varieties.Closure.html#3769" class="Module">S</a>
<a id="3727" class="Keyword">open</a> <a id="3732" href="Varieties.Closure.html#5309" class="Module">V</a>

<a id="𝓕"></a><a id="3735" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3737" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="3740" class="Symbol">:</a> <a id="3742" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3748" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="3750" class="Symbol">=</a> <a id="3752" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="3755" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a>
<a id="3757" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="3760" class="Symbol">=</a> <a id="3762" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="3771" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="3772" class="Symbol">)</a>    <a id="3777" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.



### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6290" class="Keyword">module</a> <a id="6297" href="Varieties.FreeAlgebras.html#6297" class="Module">_</a> <a id="6299" class="Symbol">{</a><a id="6300" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6302" class="Symbol">:</a> <a id="6304" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="6309" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6310" class="Symbol">}(</a><a id="6312" href="Varieties.FreeAlgebras.html#6312" class="Bound">𝒦</a> <a id="6314" class="Symbol">:</a> <a id="6316" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6321" class="Symbol">(</a><a id="6322" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="6330" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6332" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="6333" class="Symbol">)</a> <a id="6335" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="6336" class="Symbol">)</a> <a id="6338" class="Keyword">where</a>

 <a id="6346" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6348" class="Symbol">:</a> <a id="6350" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6355" class="Symbol">(</a><a id="6356" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6358" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6360" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6362" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6364" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6366" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6368" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6370" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6372" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="6373" class="Symbol">)</a> <a id="6375" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a>
 <a id="6378" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6380" class="Symbol">(</a><a id="6381" href="Varieties.FreeAlgebras.html#6381" class="Bound">p</a> <a id="6383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6385" href="Varieties.FreeAlgebras.html#6385" class="Bound">q</a><a id="6386" class="Symbol">)</a> <a id="6388" class="Symbol">=</a> <a id="6390" class="Symbol">∀(</a><a id="6392" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6394" class="Symbol">:</a> <a id="6396" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="6404" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6406" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="6407" class="Symbol">)(</a><a id="6409" href="Varieties.FreeAlgebras.html#6409" class="Bound">sA</a> <a id="6412" class="Symbol">:</a> <a id="6414" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6416" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6418" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="6419" class="Symbol">{</a><a id="6420" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6421" class="Symbol">}{</a><a id="6423" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6424" class="Symbol">}</a> <a id="6426" href="Varieties.FreeAlgebras.html#6312" class="Bound">𝒦</a><a id="6427" class="Symbol">)(</a><a id="6429" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a> <a id="6431" class="Symbol">:</a> <a id="6433" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6435" class="Symbol">→</a> <a id="6437" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6439" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6441" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6443" class="Symbol">)</a>
                 <a id="6462" class="Symbol">→</a>  <a id="6465" class="Symbol">(</a><a id="6466" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="6476" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6478" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a><a id="6479" class="Symbol">)</a> <a id="6481" href="Varieties.FreeAlgebras.html#6381" class="Bound">p</a> <a id="6483" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6485" class="Symbol">(</a><a id="6486" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="6496" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6498" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a><a id="6499" class="Symbol">)</a> <a id="6501" href="Varieties.FreeAlgebras.html#6385" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6630" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="6635" class="Symbol">:</a> <a id="6637" href="Varieties.FreeAlgebras.html#1494" class="Function">BinRel</a> <a id="6644" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6646" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6648" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6650" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6652" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a>
 <a id="6655" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="6660" href="Varieties.FreeAlgebras.html#6660" class="Bound">p</a> <a id="6662" href="Varieties.FreeAlgebras.html#6662" class="Bound">q</a> <a id="6664" class="Symbol">=</a> <a id="6666" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6668" class="Symbol">(</a><a id="6669" href="Varieties.FreeAlgebras.html#6660" class="Bound">p</a> <a id="6671" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6673" href="Varieties.FreeAlgebras.html#6662" class="Bound">q</a><a id="6674" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6922" class="Keyword">open</a> <a id="6927" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6941" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="6953" class="Symbol">:</a> <a id="6955" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="6964" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="6966" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6968" class="Symbol">→</a> <a id="6970" href="Algebras.Basic.html#12418" class="Function">compatible</a> <a id="6981" class="Symbol">(</a><a id="6982" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6984" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="6985" class="Symbol">)</a> <a id="6987" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a>
 <a id="6993" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="7005" href="Varieties.FreeAlgebras.html#7005" class="Bound">wd</a> <a id="7008" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7010" class="Symbol">{</a><a id="7011" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7012" class="Symbol">}</a> <a id="7014" class="Symbol">{</a><a id="7015" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7016" class="Symbol">}</a> <a id="7018" href="Varieties.FreeAlgebras.html#7018" class="Bound">ψpq</a> <a id="7022" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7024" href="Varieties.FreeAlgebras.html#7024" class="Bound">sA</a> <a id="7027" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a> <a id="7029" class="Symbol">=</a> <a id="7031" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a>
  <a id="7035" class="Keyword">where</a>
  <a id="7043" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7045" class="Symbol">:</a> <a id="7047" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="7051" class="Symbol">(</a><a id="7052" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7054" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7055" class="Symbol">)</a> <a id="7057" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a>
  <a id="7061" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7063" class="Symbol">=</a> <a id="7065" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="7074" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7076" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a>

  <a id="7081" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a> <a id="7083" class="Symbol">:</a> <a id="7085" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7087" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7089" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7091" class="Symbol">((</a><a id="7093" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7095" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7097" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7099" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7100" class="Symbol">)</a> <a id="7102" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7103" class="Symbol">)</a> <a id="7105" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7107" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7109" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7111" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7113" class="Symbol">((</a><a id="7115" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7117" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7119" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7121" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7122" class="Symbol">)</a> <a id="7124" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7125" class="Symbol">)</a>

  <a id="7130" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a> <a id="7132" class="Symbol">=</a> <a id="7134" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7136" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7138" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7140" class="Symbol">((</a><a id="7142" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7144" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7146" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7148" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7149" class="Symbol">)</a> <a id="7151" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7152" class="Symbol">)</a>  <a id="7155" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7158" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7160" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7162" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7164" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7166" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a> <a id="7168" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7176" class="Symbol">(</a><a id="7177" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7179" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7181" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7182" class="Symbol">)</a> <a id="7184" class="Symbol">(</a><a id="7185" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7187" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7189" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7191" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7193" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7194" class="Symbol">)</a>  <a id="7197" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7200" href="Varieties.FreeAlgebras.html#7005" class="Bound">wd</a> <a id="7203" class="Symbol">(</a><a id="7204" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7206" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7208" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7209" class="Symbol">)(</a><a id="7211" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7213" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7215" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7217" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7219" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7220" class="Symbol">)(</a><a id="7222" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7224" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7226" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7228" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7230" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7231" class="Symbol">)(λ</a> <a id="7235" href="Varieties.FreeAlgebras.html#7235" class="Bound">x</a> <a id="7237" class="Symbol">→</a> <a id="7239" href="Varieties.FreeAlgebras.html#7018" class="Bound">ψpq</a> <a id="7243" href="Varieties.FreeAlgebras.html#7235" class="Bound">x</a> <a id="7245" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7247" href="Varieties.FreeAlgebras.html#7024" class="Bound">sA</a> <a id="7250" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a><a id="7251" class="Symbol">)</a> <a id="7253" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7261" class="Symbol">(</a><a id="7262" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7264" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7266" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7267" class="Symbol">)</a> <a id="7269" class="Symbol">(</a><a id="7270" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7272" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7274" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7276" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7278" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7279" class="Symbol">)</a>  <a id="7282" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7285" class="Symbol">(</a><a id="7286" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7288" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7290" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7292" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7294" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7295" class="Symbol">)</a><a id="7296" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="7299" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7307" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7309" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7311" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7313" class="Symbol">((</a><a id="7315" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7317" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7319" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7321" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7322" class="Symbol">)</a> <a id="7324" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7325" class="Symbol">)</a>  <a id="7328" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7332" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7347" class="Symbol">:</a> <a id="7349" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7363" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a>
 <a id="7369" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7384" class="Symbol">=</a> <a id="7386" class="Keyword">record</a> <a id="7393" class="Symbol">{</a> <a id="7395" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7400" class="Symbol">=</a> <a id="7402" class="Symbol">λ</a> <a id="7404" href="Varieties.FreeAlgebras.html#7404" class="Bound">𝑨</a> <a id="7406" href="Varieties.FreeAlgebras.html#7406" class="Bound">sA</a> <a id="7409" href="Varieties.FreeAlgebras.html#7409" class="Bound">h</a> <a id="7411" class="Symbol">→</a> <a id="7413" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7443" class="Symbol">;</a> <a id="7445" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7449" class="Symbol">=</a> <a id="7451" class="Symbol">λ</a> <a id="7453" href="Varieties.FreeAlgebras.html#7453" class="Bound">x</a> <a id="7455" href="Varieties.FreeAlgebras.html#7455" class="Bound">𝑨</a> <a id="7457" href="Varieties.FreeAlgebras.html#7457" class="Bound">sA</a> <a id="7460" href="Varieties.FreeAlgebras.html#7460" class="Bound">h</a> <a id="7462" class="Symbol">→</a> <a id="7464" class="Symbol">(</a><a id="7465" href="Varieties.FreeAlgebras.html#7453" class="Bound">x</a> <a id="7467" href="Varieties.FreeAlgebras.html#7455" class="Bound">𝑨</a> <a id="7469" href="Varieties.FreeAlgebras.html#7457" class="Bound">sA</a> <a id="7472" href="Varieties.FreeAlgebras.html#7460" class="Bound">h</a><a id="7473" class="Symbol">)</a><a id="7474" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>
                         <a id="7502" class="Symbol">;</a> <a id="7504" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7510" class="Symbol">=</a> <a id="7512" class="Symbol">λ</a> <a id="7514" href="Varieties.FreeAlgebras.html#7514" class="Bound">pψq</a> <a id="7518" href="Varieties.FreeAlgebras.html#7518" class="Bound">qψr</a> <a id="7522" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7524" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7527" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a> <a id="7529" class="Symbol">→</a> <a id="7531" class="Symbol">(</a><a id="7532" href="Varieties.FreeAlgebras.html#7514" class="Bound">pψq</a> <a id="7536" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7538" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7541" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a><a id="7542" class="Symbol">)</a> <a id="7544" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="7546" class="Symbol">(</a><a id="7547" href="Varieties.FreeAlgebras.html#7518" class="Bound">qψr</a> <a id="7551" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7553" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7556" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a><a id="7557" class="Symbol">)</a> <a id="7559" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7859" href="Varieties.FreeAlgebras.html#7859" class="Function">ψCon</a> <a id="7864" class="Symbol">:</a> <a id="7866" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="7875" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="7877" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="7879" class="Symbol">→</a> <a id="7881" href="Algebras.Congruences.html#1986" class="Function">Con</a> <a id="7885" class="Symbol">(</a><a id="7886" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7888" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7889" class="Symbol">)</a>
 <a id="7892" href="Varieties.FreeAlgebras.html#7859" class="Function">ψCon</a> <a id="7897" href="Varieties.FreeAlgebras.html#7897" class="Bound">wd</a> <a id="7900" class="Symbol">=</a> <a id="7902" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="7907" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7909" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="7915" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7930" class="Symbol">(</a><a id="7931" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="7943" href="Varieties.FreeAlgebras.html#7897" class="Bound">wd</a><a id="7945" class="Symbol">)</a>

</pre>



### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10398" class="Keyword">module</a> <a id="10405" href="Varieties.FreeAlgebras.html#10405" class="Module">_</a> <a id="10407" class="Symbol">{</a><a id="10408" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10411" class="Symbol">:</a> <a id="10413" href="Foundations.Extensionality.html#2463" class="Function">DFunExt</a><a id="10420" class="Symbol">}{</a><a id="10422" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="10425" class="Symbol">:</a> <a id="10427" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a><a id="10435" class="Symbol">}{</a><a id="10437" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="10439" class="Symbol">:</a> <a id="10441" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="10446" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="10447" class="Symbol">}</a> <a id="10449" class="Symbol">{</a><a id="10450" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="10452" class="Symbol">:</a> <a id="10454" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10459" class="Symbol">(</a><a id="10460" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="10468" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="10470" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="10471" class="Symbol">)</a> <a id="10473" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="10474" class="Symbol">}</a> <a id="10476" class="Keyword">where</a>

 <a id="10484" class="Keyword">open</a> <a id="10489" href="Varieties.Preservation.html#10476" class="Module">class-products-with-maps</a> <a id="10514" class="Symbol">{</a><a id="10515" class="Argument">X</a> <a id="10517" class="Symbol">=</a> <a id="10519" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="10520" class="Symbol">}{</a><a id="10522" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10525" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10527" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="10528" class="Symbol">}{</a><a id="10530" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10533" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="10536" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="10538" class="Symbol">}{</a><a id="10540" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10543" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10545" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="10546" class="Symbol">}</a> <a id="10548" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10763" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10821" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="10823" class="Symbol">:</a> <a id="10825" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="10833" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10835" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a>
 <a id="10838" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="10840" class="Symbol">=</a> <a id="10842" href="Algebras.Products.html#1867" class="Function">⨅</a> <a id="10844" href="Varieties.Preservation.html#11893" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="11008" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11013" class="Symbol">:</a> <a id="11015" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="11019" class="Symbol">(</a><a id="11020" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11022" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11023" class="Symbol">)</a> <a id="11025" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a>
 <a id="11028" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11033" class="Symbol">=</a> <a id="11035" href="Homomorphisms.Basic.html#10846" class="Function">⨅-hom-co</a> <a id="11044" href="Varieties.Preservation.html#11893" class="Function">𝔄&#39;</a> <a id="11047" class="Symbol">(</a><a id="11048" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="11051" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="11053" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11054" class="Symbol">){</a><a id="11056" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="11057" class="Symbol">}(</a><a id="11059" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11061" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11062" class="Symbol">)</a> <a id="11064" class="Symbol">λ</a> <a id="11066" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a> <a id="11068" class="Symbol">→</a> <a id="11070" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="11079" class="Symbol">(</a><a id="11080" href="Varieties.Preservation.html#11893" class="Function">𝔄&#39;</a> <a id="11083" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a><a id="11084" class="Symbol">)(</a><a id="11086" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="11090" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="11092" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a> <a id="11094" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a><a id="11095" class="Symbol">)</a>

</pre>


### <a id="the-free-algebra">The free algebra</a>

 As mentioned, the initial version of the [agda-algebras](https://github.com/ualib/agda-algebras) library used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11632" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="11634" class="Symbol">:</a> <a id="11636" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="11644" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="11647" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a>
 <a id="11650" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="11652" class="Symbol">=</a> <a id="11654" href="Homomorphisms.Basic.html#8157" class="Function Operator">ker[</a> <a id="11659" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11661" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="11663" href="Homomorphisms.Basic.html#8157" class="Function Operator">⇒</a> <a id="11665" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="11667" href="Homomorphisms.Basic.html#8157" class="Function Operator">]</a> <a id="11669" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11674" href="Homomorphisms.Basic.html#8157" class="Function Operator">↾</a> <a id="11676" class="Symbol">(</a><a id="11677" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="11680" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="11682" class="Symbol">(</a><a id="11683" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="11686" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11687" class="Symbol">))</a>

 <a id="11692" href="Varieties.FreeAlgebras.html#11692" class="Function">epi𝔽</a> <a id="11697" class="Symbol">:</a> <a id="11699" href="Homomorphisms.Basic.html#6073" class="Function">epi</a> <a id="11703" class="Symbol">(</a><a id="11704" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11706" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11707" class="Symbol">)</a> <a id="11709" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a>
 <a id="11712" href="Varieties.FreeAlgebras.html#11692" class="Function">epi𝔽</a> <a id="11717" class="Symbol">=</a> <a id="11719" href="Homomorphisms.Basic.html#9650" class="Function">πker</a> <a id="11724" class="Symbol">(</a><a id="11725" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="11728" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="11730" class="Symbol">(</a><a id="11731" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="11734" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11735" class="Symbol">))</a> <a id="11738" class="Symbol">{</a><a id="11739" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="11740" class="Symbol">}</a> <a id="11742" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a>

 <a id="11749" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="11754" class="Symbol">:</a> <a id="11756" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="11760" class="Symbol">(</a><a id="11761" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11763" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11764" class="Symbol">)</a> <a id="11766" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a>
 <a id="11769" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="11774" class="Symbol">=</a> <a id="11776" href="Homomorphisms.Basic.html#6540" class="Function">epi-to-hom</a> <a id="11787" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="11789" href="Varieties.FreeAlgebras.html#11692" class="Function">epi𝔽</a>

 <a id="11796" href="Varieties.FreeAlgebras.html#11796" class="Function">hom𝔽-is-epic</a> <a id="11809" class="Symbol">:</a> <a id="11811" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="11824" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11826" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="11831" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
 <a id="11834" href="Varieties.FreeAlgebras.html#11796" class="Function">hom𝔽-is-epic</a> <a id="11847" class="Symbol">=</a> <a id="11849" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="11853" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="11855" href="Varieties.FreeAlgebras.html#11692" class="Function">epi𝔽</a> <a id="11860" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11958" href="Varieties.FreeAlgebras.html#11958" class="Function">ψlemma0</a> <a id="11966" class="Symbol">:</a> <a id="11968" class="Symbol">∀</a> <a id="11970" href="Varieties.FreeAlgebras.html#11970" class="Bound">p</a> <a id="11972" href="Varieties.FreeAlgebras.html#11972" class="Bound">q</a> <a id="11974" class="Symbol">→</a>  <a id="11977" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11979" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11984" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11986" href="Varieties.FreeAlgebras.html#11970" class="Bound">p</a> <a id="11988" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11990" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11992" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11997" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11999" href="Varieties.FreeAlgebras.html#11972" class="Bound">q</a>  <a id="12002" class="Symbol">→</a> <a id="12004" class="Symbol">(</a><a id="12005" href="Varieties.FreeAlgebras.html#11970" class="Bound">p</a> <a id="12007" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12009" href="Varieties.FreeAlgebras.html#11972" class="Bound">q</a><a id="12010" class="Symbol">)</a> <a id="12012" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12014" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="12016" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="12019" href="Varieties.FreeAlgebras.html#11958" class="Function">ψlemma0</a> <a id="12027" href="Varieties.FreeAlgebras.html#12027" class="Bound">p</a> <a id="12029" href="Varieties.FreeAlgebras.html#12029" class="Bound">q</a> <a id="12031" href="Varieties.FreeAlgebras.html#12031" class="Bound">phomℭq</a> <a id="12038" href="Varieties.FreeAlgebras.html#12038" class="Bound">𝑨</a> <a id="12040" href="Varieties.FreeAlgebras.html#12040" class="Bound">sA</a> <a id="12043" href="Varieties.FreeAlgebras.html#12043" class="Bound">h</a> <a id="12045" class="Symbol">=</a> <a id="12047" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="12056" href="Varieties.FreeAlgebras.html#12031" class="Bound">phomℭq</a> <a id="12063" class="Symbol">(</a><a id="12064" href="Varieties.FreeAlgebras.html#12038" class="Bound">𝑨</a> <a id="12066" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12068" href="Varieties.FreeAlgebras.html#12040" class="Bound">sA</a> <a id="12071" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12073" href="Varieties.FreeAlgebras.html#12043" class="Bound">h</a><a id="12074" class="Symbol">)</a>

 <a id="12078" href="Varieties.FreeAlgebras.html#12078" class="Function">ψlemma0-ap</a> <a id="12089" class="Symbol">:</a> <a id="12091" class="Symbol">{</a><a id="12092" href="Varieties.FreeAlgebras.html#12092" class="Bound">𝑨</a> <a id="12094" class="Symbol">:</a> <a id="12096" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="12104" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="12106" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="12107" class="Symbol">}{</a><a id="12109" href="Varieties.FreeAlgebras.html#12109" class="Bound">h</a> <a id="12111" class="Symbol">:</a> <a id="12113" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="12115" class="Symbol">→</a> <a id="12117" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12119" href="Varieties.FreeAlgebras.html#12092" class="Bound">𝑨</a> <a id="12121" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="12122" class="Symbol">}</a> <a id="12124" class="Symbol">→</a> <a id="12126" href="Varieties.FreeAlgebras.html#12092" class="Bound">𝑨</a> <a id="12128" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12130" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="12131" class="Symbol">{</a><a id="12132" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12133" class="Symbol">}{</a><a id="12135" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12136" class="Symbol">}</a> <a id="12138" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="12142" class="Symbol">→</a>           <a id="12154" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="12161" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12163" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="12168" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12170" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="12172" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="12179" class="Symbol">(</a><a id="12180" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12190" href="Varieties.FreeAlgebras.html#12092" class="Bound">𝑨</a> <a id="12192" href="Varieties.FreeAlgebras.html#12109" class="Bound">h</a><a id="12193" class="Symbol">)</a>

 <a id="12197" href="Varieties.FreeAlgebras.html#12078" class="Function">ψlemma0-ap</a> <a id="12208" class="Symbol">{</a><a id="12209" href="Varieties.FreeAlgebras.html#12209" class="Bound">𝑨</a><a id="12210" class="Symbol">}{</a><a id="12212" href="Varieties.FreeAlgebras.html#12212" class="Bound">h</a><a id="12213" class="Symbol">}</a> <a id="12215" href="Varieties.FreeAlgebras.html#12215" class="Bound">skA</a> <a id="12219" class="Symbol">{</a><a id="12220" href="Varieties.FreeAlgebras.html#12220" class="Bound">p</a> <a id="12222" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12224" href="Varieties.FreeAlgebras.html#12224" class="Bound">q</a><a id="12225" class="Symbol">}</a> <a id="12227" href="Varieties.FreeAlgebras.html#12227" class="Bound">x</a> <a id="12229" class="Symbol">=</a> <a id="12231" href="Varieties.FreeAlgebras.html#12374" class="Function">γ</a> <a id="12233" class="Keyword">where</a>

  <a id="12242" href="Varieties.FreeAlgebras.html#12242" class="Function">ν</a> <a id="12244" class="Symbol">:</a> <a id="12246" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12248" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="12253" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12255" href="Varieties.FreeAlgebras.html#12220" class="Bound">p</a> <a id="12257" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12259" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12261" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="12266" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12268" href="Varieties.FreeAlgebras.html#12224" class="Bound">q</a>
  <a id="12272" href="Varieties.FreeAlgebras.html#12242" class="Function">ν</a> <a id="12274" class="Symbol">=</a> <a id="12276" href="Homomorphisms.Basic.html#10159" class="Function">ker-in-con</a> <a id="12287" class="Symbol">{</a><a id="12288" class="Argument">α</a> <a id="12290" class="Symbol">=</a> <a id="12292" class="Symbol">(</a><a id="12293" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="12296" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12297" class="Symbol">)}{</a><a id="12300" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="12303" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12304" class="Symbol">}{</a><a id="12306" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="12308" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="12309" class="Symbol">}{</a><a id="12311" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12314" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12316" class="Symbol">(</a><a id="12317" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="12322" class="Symbol">(</a><a id="12323" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="12326" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12327" class="Symbol">))}(</a><a id="12331" href="Homomorphisms.Basic.html#7749" class="Function">kercon</a> <a id="12338" class="Symbol">(</a><a id="12339" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12342" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12344" class="Symbol">(</a><a id="12345" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="12348" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12349" class="Symbol">))</a> <a id="12352" class="Symbol">{</a><a id="12353" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="12354" class="Symbol">}</a> <a id="12356" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a><a id="12360" class="Symbol">)</a> <a id="12362" class="Symbol">{</a><a id="12363" href="Varieties.FreeAlgebras.html#12220" class="Bound">p</a><a id="12364" class="Symbol">}{</a><a id="12366" href="Varieties.FreeAlgebras.html#12224" class="Bound">q</a><a id="12367" class="Symbol">}</a> <a id="12369" href="Varieties.FreeAlgebras.html#12227" class="Bound">x</a>

  <a id="12374" href="Varieties.FreeAlgebras.html#12374" class="Function">γ</a> <a id="12376" class="Symbol">:</a> <a id="12378" class="Symbol">(</a><a id="12379" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12389" href="Varieties.FreeAlgebras.html#12209" class="Bound">𝑨</a> <a id="12391" href="Varieties.FreeAlgebras.html#12212" class="Bound">h</a><a id="12392" class="Symbol">)</a> <a id="12394" href="Varieties.FreeAlgebras.html#12220" class="Bound">p</a> <a id="12396" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12398" class="Symbol">(</a><a id="12399" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12409" href="Varieties.FreeAlgebras.html#12209" class="Bound">𝑨</a> <a id="12411" href="Varieties.FreeAlgebras.html#12212" class="Bound">h</a><a id="12412" class="Symbol">)</a> <a id="12414" href="Varieties.FreeAlgebras.html#12224" class="Bound">q</a>
  <a id="12418" href="Varieties.FreeAlgebras.html#12374" class="Function">γ</a> <a id="12420" class="Symbol">=</a> <a id="12422" class="Symbol">((</a><a id="12424" href="Varieties.FreeAlgebras.html#11958" class="Function">ψlemma0</a> <a id="12432" href="Varieties.FreeAlgebras.html#12220" class="Bound">p</a> <a id="12434" href="Varieties.FreeAlgebras.html#12224" class="Bound">q</a><a id="12435" class="Symbol">)</a> <a id="12437" href="Varieties.FreeAlgebras.html#12242" class="Function">ν</a><a id="12438" class="Symbol">)</a> <a id="12440" href="Varieties.FreeAlgebras.html#12209" class="Bound">𝑨</a> <a id="12442" href="Varieties.FreeAlgebras.html#12215" class="Bound">skA</a> <a id="12446" href="Varieties.FreeAlgebras.html#12212" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12627" href="Varieties.FreeAlgebras.html#12627" class="Function">𝔽-lift-hom</a> <a id="12638" class="Symbol">:</a> <a id="12640" class="Symbol">(</a><a id="12641" href="Varieties.FreeAlgebras.html#12641" class="Bound">𝑨</a> <a id="12643" class="Symbol">:</a> <a id="12645" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="12653" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="12655" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="12656" class="Symbol">)</a> <a id="12658" class="Symbol">→</a> <a id="12660" href="Varieties.FreeAlgebras.html#12641" class="Bound">𝑨</a> <a id="12662" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12664" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="12665" class="Symbol">{</a><a id="12666" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12667" class="Symbol">}{</a><a id="12669" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12670" class="Symbol">}</a> <a id="12672" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="12674" class="Symbol">→</a> <a id="12676" class="Symbol">(</a><a id="12677" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="12679" class="Symbol">→</a> <a id="12681" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12683" href="Varieties.FreeAlgebras.html#12641" class="Bound">𝑨</a> <a id="12685" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="12686" class="Symbol">)</a> <a id="12688" class="Symbol">→</a> <a id="12690" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="12694" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="12696" href="Varieties.FreeAlgebras.html#12641" class="Bound">𝑨</a>
 <a id="12699" href="Varieties.FreeAlgebras.html#12627" class="Function">𝔽-lift-hom</a> <a id="12710" href="Varieties.FreeAlgebras.html#12710" class="Bound">𝑨</a> <a id="12712" href="Varieties.FreeAlgebras.html#12712" class="Bound">skA</a> <a id="12716" href="Varieties.FreeAlgebras.html#12716" class="Bound">h</a> <a id="12718" class="Symbol">=</a> <a id="12720" href="Varieties.FreeAlgebras.html#1361" class="Field">fst</a><a id="12723" class="Symbol">(</a><a id="12724" href="Homomorphisms.Noether.html#8601" class="Function">HomFactor</a> <a id="12734" class="Symbol">(</a><a id="12735" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12738" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12740" class="Symbol">(</a><a id="12741" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="12746" class="Symbol">(</a><a id="12747" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="12750" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12751" class="Symbol">)))</a>  <a id="12756" href="Varieties.FreeAlgebras.html#12710" class="Bound">𝑨</a> <a id="12758" class="Symbol">(</a><a id="12759" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="12768" href="Varieties.FreeAlgebras.html#12710" class="Bound">𝑨</a> <a id="12770" href="Varieties.FreeAlgebras.html#12716" class="Bound">h</a><a id="12771" class="Symbol">)</a> <a id="12773" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="12778" class="Symbol">(</a><a id="12779" href="Varieties.FreeAlgebras.html#12078" class="Function">ψlemma0-ap</a> <a id="12790" href="Varieties.FreeAlgebras.html#12712" class="Bound">skA</a><a id="12793" class="Symbol">)</a> <a id="12795" href="Varieties.FreeAlgebras.html#11796" class="Function">hom𝔽-is-epic</a><a id="12807" class="Symbol">)</a>

</pre>


### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="13191" class="Keyword">open</a> <a id="13196" href="Algebras.Congruences.html#1800" class="Module">IsCongruence</a>

 <a id="13211" href="Varieties.FreeAlgebras.html#13211" class="Function">X↪𝔽</a> <a id="13215" class="Symbol">:</a> <a id="13217" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="13219" class="Symbol">→</a> <a id="13221" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13223" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="13225" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
 <a id="13228" href="Varieties.FreeAlgebras.html#13211" class="Function">X↪𝔽</a> <a id="13232" href="Varieties.FreeAlgebras.html#13232" class="Bound">x</a> <a id="13234" class="Symbol">=</a> <a id="13236" href="Relations.Quotients.html#5374" class="Function Operator">⟪</a> <a id="13238" href="Terms.Basic.html#2028" class="InductiveConstructor">ℊ</a> <a id="13240" href="Varieties.FreeAlgebras.html#13232" class="Bound">x</a> <a id="13242" href="Relations.Quotients.html#5374" class="Function Operator">⟫</a> <a id="13244" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13310" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13312" class="Symbol">:</a> <a id="13314" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="13318" class="Symbol">(</a><a id="13319" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="13321" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="13322" class="Symbol">)</a> <a id="13324" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a>
 <a id="13327" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13329" class="Symbol">=</a> <a id="13331" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="13340" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="13342" href="Varieties.FreeAlgebras.html#13211" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13445" class="Keyword">open</a> <a id="13450" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13464" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a> <a id="13481" class="Symbol">:</a> <a id="13483" class="Symbol">∀</a> <a id="13485" href="Varieties.FreeAlgebras.html#13485" class="Bound">p</a> <a id="13487" class="Symbol">→</a> <a id="13489" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13491" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13493" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13495" href="Varieties.FreeAlgebras.html#13485" class="Bound">p</a> <a id="13497" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13499" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13501" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="13506" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13508" href="Varieties.FreeAlgebras.html#13485" class="Bound">p</a>
 <a id="13511" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a> <a id="13528" class="Symbol">(</a><a id="13529" href="Terms.Basic.html#2028" class="InductiveConstructor">ℊ</a> <a id="13531" href="Varieties.FreeAlgebras.html#13531" class="Bound">x</a><a id="13532" class="Symbol">)</a> <a id="13534" class="Symbol">=</a> <a id="13536" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13542" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a> <a id="13559" class="Symbol">(</a><a id="13560" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13565" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13567" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a><a id="13568" class="Symbol">)</a> <a id="13570" class="Symbol">=</a>
  <a id="13574" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13576" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13578" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13580" class="Symbol">(</a><a id="13581" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13586" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13588" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a><a id="13589" class="Symbol">)</a>              <a id="13604" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13607" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13609" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13611" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13613" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13615" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13617" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13621" class="Symbol">(</a><a id="13622" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13624" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13626" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a><a id="13627" class="Symbol">)(λ</a> <a id="13631" href="Varieties.FreeAlgebras.html#13631" class="Bound">i</a> <a id="13633" class="Symbol">→</a> <a id="13635" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13637" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13639" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="13640" class="Symbol">(</a><a id="13641" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13643" href="Varieties.FreeAlgebras.html#13631" class="Bound">i</a><a id="13644" class="Symbol">))</a>     <a id="13651" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13654" href="Varieties.FreeAlgebras.html#13762" class="Function">wd-proof</a> <a id="13663" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13667" class="Symbol">(</a><a id="13668" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13670" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13672" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a><a id="13673" class="Symbol">)(λ</a> <a id="13677" href="Varieties.FreeAlgebras.html#13677" class="Bound">i</a> <a id="13679" class="Symbol">→</a> <a id="13681" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13683" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="13688" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13690" class="Symbol">(</a><a id="13691" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13693" href="Varieties.FreeAlgebras.html#13677" class="Bound">i</a><a id="13694" class="Symbol">))</a> <a id="13697" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13700" class="Symbol">(</a><a id="13701" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13703" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="13708" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13710" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13712" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a><a id="13713" class="Symbol">)</a><a id="13714" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="13717" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13721" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13723" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="13728" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13730" class="Symbol">(</a><a id="13731" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13736" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13738" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a><a id="13739" class="Symbol">)</a>           <a id="13751" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13756" class="Keyword">where</a> <a id="13762" href="Varieties.FreeAlgebras.html#13762" class="Function">wd-proof</a> <a id="13771" class="Symbol">=</a> <a id="13773" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="13776" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="13778" class="Symbol">(</a><a id="13779" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="13784" class="Symbol">(</a><a id="13785" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="13788" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="13789" class="Symbol">))</a>
                    <a id="13812" class="Symbol">(</a><a id="13813" href="Varieties.FreeAlgebras.html#13565" class="Bound">𝑓</a> <a id="13815" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13817" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a><a id="13818" class="Symbol">)</a> <a id="13820" class="Symbol">(λ</a> <a id="13823" href="Varieties.FreeAlgebras.html#13823" class="Bound">i</a> <a id="13825" class="Symbol">→</a> <a id="13827" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13829" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="13831" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="13832" class="Symbol">(</a><a id="13833" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13835" href="Varieties.FreeAlgebras.html#13823" class="Bound">i</a><a id="13836" class="Symbol">))</a> <a id="13839" class="Symbol">(λ</a> <a id="13842" href="Varieties.FreeAlgebras.html#13842" class="Bound">i</a> <a id="13844" class="Symbol">→</a> <a id="13846" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13848" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="13853" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13855" class="Symbol">(</a><a id="13856" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13858" href="Varieties.FreeAlgebras.html#13842" class="Bound">i</a><a id="13859" class="Symbol">))</a>
                    <a id="13882" class="Symbol">(λ</a> <a id="13885" href="Varieties.FreeAlgebras.html#13885" class="Bound">x</a> <a id="13887" class="Symbol">→</a> <a id="13889" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a><a id="13905" class="Symbol">(</a><a id="13906" href="Varieties.FreeAlgebras.html#13567" class="Bound">𝒕</a> <a id="13908" href="Varieties.FreeAlgebras.html#13885" class="Bound">x</a><a id="13909" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="14013" href="Varieties.FreeAlgebras.html#14013" class="Function">ψlemma1</a> <a id="14021" class="Symbol">:</a> <a id="14023" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="14030" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14032" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="14034" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14036" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14038" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="14040" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="14043" href="Varieties.FreeAlgebras.html#14013" class="Function">ψlemma1</a> <a id="14051" class="Symbol">{</a><a id="14052" href="Varieties.FreeAlgebras.html#14052" class="Bound">p</a> <a id="14054" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14056" href="Varieties.FreeAlgebras.html#14056" class="Bound">q</a><a id="14057" class="Symbol">}</a> <a id="14059" href="Varieties.FreeAlgebras.html#14059" class="Bound">𝔑pq</a> <a id="14063" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a> <a id="14065" href="Varieties.FreeAlgebras.html#14065" class="Bound">sA</a> <a id="14068" href="Varieties.FreeAlgebras.html#14068" class="Bound">h</a> <a id="14070" class="Symbol">=</a> <a id="14072" href="Varieties.FreeAlgebras.html#14293" class="Function">γ</a>
  <a id="14076" class="Keyword">where</a>
   <a id="14085" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14087" class="Symbol">:</a> <a id="14089" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="14093" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="14095" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a>
   <a id="14100" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14102" class="Symbol">=</a> <a id="14104" href="Varieties.FreeAlgebras.html#12627" class="Function">𝔽-lift-hom</a> <a id="14115" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a> <a id="14117" href="Varieties.FreeAlgebras.html#14065" class="Bound">sA</a> <a id="14120" href="Varieties.FreeAlgebras.html#14068" class="Bound">h</a>

   <a id="14126" href="Varieties.FreeAlgebras.html#14126" class="Function">h&#39;</a> <a id="14129" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14131" class="Symbol">:</a> <a id="14133" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="14137" class="Symbol">(</a><a id="14138" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="14140" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14141" class="Symbol">)</a> <a id="14143" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a>
   <a id="14148" href="Varieties.FreeAlgebras.html#14126" class="Function">h&#39;</a> <a id="14151" class="Symbol">=</a> <a id="14153" href="Homomorphisms.Basic.html#3531" class="Function">∘-hom</a> <a id="14159" class="Symbol">(</a><a id="14160" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="14162" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14163" class="Symbol">)</a> <a id="14165" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a> <a id="14167" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="14169" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a>
   <a id="14174" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14176" class="Symbol">=</a> <a id="14178" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="14187" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a> <a id="14189" href="Varieties.FreeAlgebras.html#14068" class="Bound">h</a>

   <a id="14195" href="Varieties.FreeAlgebras.html#14195" class="Function">h≡φ</a> <a id="14199" class="Symbol">:</a> <a id="14201" class="Symbol">∀</a> <a id="14203" href="Varieties.FreeAlgebras.html#14203" class="Bound">t</a> <a id="14205" class="Symbol">→</a> <a id="14207" class="Symbol">(</a><a id="14208" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14210" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14212" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14214" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14216" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14218" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="14220" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="14221" class="Symbol">)</a> <a id="14223" href="Varieties.FreeAlgebras.html#14203" class="Bound">t</a> <a id="14225" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14227" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14229" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14231" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14233" href="Varieties.FreeAlgebras.html#14203" class="Bound">t</a>
   <a id="14238" href="Varieties.FreeAlgebras.html#14195" class="Function">h≡φ</a> <a id="14242" href="Varieties.FreeAlgebras.html#14242" class="Bound">t</a> <a id="14244" class="Symbol">=</a> <a id="14246" href="Terms.Properties.html#3576" class="Function">free-unique</a> <a id="14258" class="Symbol">(</a><a id="14259" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14262" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14264" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14265" class="Symbol">)</a> <a id="14267" href="Varieties.FreeAlgebras.html#14063" class="Bound">𝑨</a> <a id="14269" href="Varieties.FreeAlgebras.html#14126" class="Function">h&#39;</a> <a id="14272" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14274" class="Symbol">(λ</a> <a id="14277" href="Varieties.FreeAlgebras.html#14277" class="Bound">x</a> <a id="14279" class="Symbol">→</a> <a id="14281" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14285" class="Symbol">)</a> <a id="14287" href="Varieties.FreeAlgebras.html#14242" class="Bound">t</a>

   <a id="14293" href="Varieties.FreeAlgebras.html#14293" class="Function">γ</a> <a id="14295" class="Symbol">:</a> <a id="14297" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14299" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14301" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14303" href="Varieties.FreeAlgebras.html#14052" class="Bound">p</a> <a id="14305" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14307" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14309" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14311" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14313" href="Varieties.FreeAlgebras.html#14056" class="Bound">q</a>
   <a id="14318" href="Varieties.FreeAlgebras.html#14293" class="Function">γ</a> <a id="14320" class="Symbol">=</a> <a id="14322" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14324" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14326" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14328" href="Varieties.FreeAlgebras.html#14052" class="Bound">p</a>             <a id="14342" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14345" class="Symbol">(</a><a id="14346" href="Varieties.FreeAlgebras.html#14195" class="Function">h≡φ</a> <a id="14350" href="Varieties.FreeAlgebras.html#14052" class="Bound">p</a><a id="14351" class="Symbol">)</a><a id="14352" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="14355" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14364" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14366" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14368" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14370" class="Symbol">(</a> <a id="14372" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14374" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="14376" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14378" href="Varieties.FreeAlgebras.html#14052" class="Bound">p</a> <a id="14380" class="Symbol">)</a>   <a id="14384" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14387" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14392" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14394" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14396" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14398" href="Varieties.FreeAlgebras.html#14059" class="Bound">𝔑pq</a> <a id="14402" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14411" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14413" href="Varieties.FreeAlgebras.html#14085" class="Function">f</a> <a id="14415" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14417" class="Symbol">(</a> <a id="14419" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14421" href="Varieties.FreeAlgebras.html#13310" class="Function">𝔑</a> <a id="14423" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14425" href="Varieties.FreeAlgebras.html#14056" class="Bound">q</a> <a id="14427" class="Symbol">)</a>   <a id="14431" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14434" href="Varieties.FreeAlgebras.html#14195" class="Function">h≡φ</a> <a id="14438" href="Varieties.FreeAlgebras.html#14056" class="Bound">q</a> <a id="14440" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14449" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14451" href="Varieties.FreeAlgebras.html#14129" class="Function">φ</a> <a id="14453" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14455" href="Varieties.FreeAlgebras.html#14056" class="Bound">q</a>             <a id="14469" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14474" href="Varieties.FreeAlgebras.html#14474" class="Function">ψlemma2</a> <a id="14482" class="Symbol">:</a> <a id="14484" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="14491" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14493" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="14498" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14500" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14502" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="14504" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="14507" href="Varieties.FreeAlgebras.html#14474" class="Function">ψlemma2</a> <a id="14515" class="Symbol">{</a><a id="14516" href="Varieties.FreeAlgebras.html#14516" class="Bound">p</a> <a id="14518" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14520" href="Varieties.FreeAlgebras.html#14520" class="Bound">q</a><a id="14521" class="Symbol">}</a> <a id="14523" href="Varieties.FreeAlgebras.html#14523" class="Bound">x</a> <a id="14525" class="Symbol">=</a> <a id="14527" href="Varieties.FreeAlgebras.html#14013" class="Function">ψlemma1</a> <a id="14535" class="Symbol">{</a><a id="14536" href="Varieties.FreeAlgebras.html#14516" class="Bound">p</a> <a id="14538" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14540" href="Varieties.FreeAlgebras.html#14520" class="Bound">q</a><a id="14541" class="Symbol">}</a> <a id="14543" href="Varieties.FreeAlgebras.html#14558" class="Function">γ</a>
   <a id="14548" class="Keyword">where</a>
    <a id="14558" href="Varieties.FreeAlgebras.html#14558" class="Function">γ</a> <a id="14560" class="Symbol">:</a> <a id="14562" class="Symbol">(</a><a id="14563" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14573" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="14575" href="Varieties.FreeAlgebras.html#13211" class="Function">X↪𝔽</a><a id="14578" class="Symbol">)</a> <a id="14580" href="Varieties.FreeAlgebras.html#14516" class="Bound">p</a> <a id="14582" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14584" class="Symbol">(</a><a id="14585" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14595" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="14597" href="Varieties.FreeAlgebras.html#13211" class="Function">X↪𝔽</a><a id="14600" class="Symbol">)</a> <a id="14602" href="Varieties.FreeAlgebras.html#14520" class="Bound">q</a>
    <a id="14608" href="Varieties.FreeAlgebras.html#14558" class="Function">γ</a> <a id="14610" class="Symbol">=</a> <a id="14612" class="Symbol">(</a><a id="14613" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a> <a id="14630" href="Varieties.FreeAlgebras.html#14516" class="Bound">p</a><a id="14631" class="Symbol">)</a> <a id="14633" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="14635" href="Varieties.FreeAlgebras.html#14523" class="Bound">x</a> <a id="14637" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="14639" class="Symbol">(</a><a id="14640" href="Varieties.FreeAlgebras.html#13464" class="Function">hom𝔽-is-lift-hom</a> <a id="14657" href="Varieties.FreeAlgebras.html#14520" class="Bound">q</a><a id="14658" class="Symbol">)</a><a id="14659" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>


 <a id="14665" href="Varieties.FreeAlgebras.html#14665" class="Function">ψlemma3</a> <a id="14673" class="Symbol">:</a> <a id="14675" class="Symbol">∀</a> <a id="14677" href="Varieties.FreeAlgebras.html#14677" class="Bound">p</a> <a id="14679" href="Varieties.FreeAlgebras.html#14679" class="Bound">q</a> <a id="14681" class="Symbol">→</a> <a id="14683" class="Symbol">(</a><a id="14684" href="Varieties.FreeAlgebras.html#14677" class="Bound">p</a> <a id="14686" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14688" href="Varieties.FreeAlgebras.html#14679" class="Bound">q</a><a id="14689" class="Symbol">)</a> <a id="14691" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14693" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a><a id="14694" class="Symbol">{</a><a id="14695" class="Argument">X</a> <a id="14697" class="Symbol">=</a> <a id="14699" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14700" class="Symbol">}</a> <a id="14702" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="14704" class="Symbol">→</a> <a id="14706" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="14708" href="Varieties.EquationalLogic.html#2683" class="Function Operator">⊫</a> <a id="14710" href="Varieties.FreeAlgebras.html#14677" class="Bound">p</a> <a id="14712" href="Varieties.EquationalLogic.html#2683" class="Function Operator">≈</a> <a id="14714" href="Varieties.FreeAlgebras.html#14679" class="Bound">q</a>
 <a id="14717" href="Varieties.FreeAlgebras.html#14665" class="Function">ψlemma3</a> <a id="14725" href="Varieties.FreeAlgebras.html#14725" class="Bound">p</a> <a id="14727" href="Varieties.FreeAlgebras.html#14727" class="Bound">q</a> <a id="14729" href="Varieties.FreeAlgebras.html#14729" class="Bound">pψq</a> <a id="14733" class="Symbol">{</a><a id="14734" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a><a id="14735" class="Symbol">}</a> <a id="14737" href="Varieties.FreeAlgebras.html#14737" class="Bound">kA</a> <a id="14740" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a> <a id="14742" class="Symbol">=</a> <a id="14744" href="Varieties.FreeAlgebras.html#14761" class="Function">goal</a>
   <a id="14752" class="Keyword">where</a>
   <a id="14761" href="Varieties.FreeAlgebras.html#14761" class="Function">goal</a> <a id="14766" class="Symbol">:</a> <a id="14768" class="Symbol">(</a><a id="14769" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14771" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="14773" href="Varieties.FreeAlgebras.html#14725" class="Bound">p</a> <a id="14775" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="14776" class="Symbol">)</a> <a id="14778" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a> <a id="14780" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14782" class="Symbol">(</a><a id="14783" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14785" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="14787" href="Varieties.FreeAlgebras.html#14727" class="Bound">q</a> <a id="14789" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="14790" class="Symbol">)</a> <a id="14792" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a>
   <a id="14797" href="Varieties.FreeAlgebras.html#14761" class="Function">goal</a> <a id="14802" class="Symbol">=</a> <a id="14804" class="Symbol">(</a><a id="14805" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14807" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="14809" href="Varieties.FreeAlgebras.html#14725" class="Bound">p</a> <a id="14811" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="14812" class="Symbol">)</a> <a id="14814" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a>       <a id="14822" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14825" href="Terms.Operations.html#2885" class="Function">free-lift-interp</a> <a id="14842" class="Symbol">(</a><a id="14843" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14846" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14848" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14849" class="Symbol">)</a> <a id="14851" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14853" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a> <a id="14855" href="Varieties.FreeAlgebras.html#14725" class="Bound">p</a> <a id="14857" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14869" class="Symbol">(</a><a id="14870" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14880" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14882" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a><a id="14883" class="Symbol">)</a> <a id="14885" href="Varieties.FreeAlgebras.html#14725" class="Bound">p</a> <a id="14887" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14890" href="Varieties.FreeAlgebras.html#14729" class="Bound">pψq</a> <a id="14894" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14896" class="Symbol">(</a><a id="14897" href="Varieties.Closure.html#4055" class="InductiveConstructor">siso</a> <a id="14902" class="Symbol">(</a><a id="14903" href="Varieties.Closure.html#3857" class="InductiveConstructor">sbase</a> <a id="14909" href="Varieties.FreeAlgebras.html#14737" class="Bound">kA</a><a id="14911" class="Symbol">)</a> <a id="14913" class="Symbol">(</a><a id="14914" href="Homomorphisms.Isomorphisms.html#2906" class="Function">≅-sym</a> <a id="14920" href="Homomorphisms.Isomorphisms.html#4349" class="Function">Lift-≅</a><a id="14926" class="Symbol">))</a> <a id="14929" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a> <a id="14931" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14943" class="Symbol">(</a><a id="14944" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14954" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14956" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a><a id="14957" class="Symbol">)</a> <a id="14959" href="Varieties.FreeAlgebras.html#14727" class="Bound">q</a> <a id="14961" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14964" class="Symbol">(</a><a id="14965" href="Terms.Operations.html#2885" class="Function">free-lift-interp</a> <a id="14982" class="Symbol">(</a><a id="14983" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14986" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14988" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14989" class="Symbol">)</a> <a id="14991" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="14993" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a> <a id="14995" href="Varieties.FreeAlgebras.html#14727" class="Bound">q</a><a id="14996" class="Symbol">)</a><a id="14997" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>  <a id="15001" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="15013" class="Symbol">(</a><a id="15014" href="Varieties.FreeAlgebras.html#14734" class="Bound">𝑨</a> <a id="15016" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="15018" href="Varieties.FreeAlgebras.html#14727" class="Bound">q</a> <a id="15020" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="15021" class="Symbol">)</a> <a id="15023" href="Varieties.FreeAlgebras.html#14740" class="Bound">h</a>       <a id="15031" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="15154" href="Varieties.FreeAlgebras.html#15154" class="Function">class-models-kernel</a> <a id="15174" class="Symbol">:</a> <a id="15176" class="Symbol">∀</a> <a id="15178" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15180" href="Varieties.FreeAlgebras.html#15180" class="Bound">q</a> <a id="15182" class="Symbol">→</a> <a id="15184" class="Symbol">(</a><a id="15185" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15187" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15189" href="Varieties.FreeAlgebras.html#15180" class="Bound">q</a><a id="15190" class="Symbol">)</a> <a id="15192" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15194" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15201" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15203" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="15208" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15210" class="Symbol">→</a> <a id="15212" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="15214" href="Varieties.EquationalLogic.html#2683" class="Function Operator">⊫</a> <a id="15216" href="Varieties.FreeAlgebras.html#15178" class="Bound">p</a> <a id="15218" href="Varieties.EquationalLogic.html#2683" class="Function Operator">≈</a> <a id="15220" href="Varieties.FreeAlgebras.html#15180" class="Bound">q</a>
 <a id="15223" href="Varieties.FreeAlgebras.html#15154" class="Function">class-models-kernel</a> <a id="15243" href="Varieties.FreeAlgebras.html#15243" class="Bound">p</a> <a id="15245" href="Varieties.FreeAlgebras.html#15245" class="Bound">q</a> <a id="15247" href="Varieties.FreeAlgebras.html#15247" class="Bound">x</a> <a id="15249" class="Symbol">=</a> <a id="15251" href="Varieties.FreeAlgebras.html#14665" class="Function">ψlemma3</a> <a id="15259" href="Varieties.FreeAlgebras.html#15243" class="Bound">p</a> <a id="15261" href="Varieties.FreeAlgebras.html#15245" class="Bound">q</a> <a id="15263" class="Symbol">(</a><a id="15264" href="Varieties.FreeAlgebras.html#14474" class="Function">ψlemma2</a> <a id="15272" href="Varieties.FreeAlgebras.html#15247" class="Bound">x</a><a id="15273" class="Symbol">)</a>

 <a id="15277" href="Varieties.FreeAlgebras.html#15277" class="Function">𝕍𝒦</a> <a id="15280" class="Symbol">:</a> <a id="15282" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15287" class="Symbol">(</a><a id="15288" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15296" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15299" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="15300" class="Symbol">)</a> <a id="15302" class="Symbol">(</a><a id="15303" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="15308" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="15310" class="Symbol">)</a>
 <a id="15313" href="Varieties.FreeAlgebras.html#15277" class="Function">𝕍𝒦</a> <a id="15316" class="Symbol">=</a> <a id="15318" href="Varieties.Closure.html#5309" class="Datatype">V</a><a id="15319" class="Symbol">{</a><a id="15320" class="Argument">α</a> <a id="15322" class="Symbol">=</a> <a id="15324" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="15325" class="Symbol">}{</a><a id="15327" class="Argument">β</a> <a id="15329" class="Symbol">=</a> <a id="15331" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="15333" class="Symbol">}</a> <a id="15335" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>

 <a id="15339" href="Varieties.FreeAlgebras.html#15339" class="Function">kernel-in-theory&#39;</a> <a id="15357" class="Symbol">:</a> <a id="15359" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15366" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15368" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="15373" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15375" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15377" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15380" class="Symbol">(</a><a id="15381" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="15383" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="15384" class="Symbol">)</a>
 <a id="15387" href="Varieties.FreeAlgebras.html#15339" class="Function">kernel-in-theory&#39;</a> <a id="15405" class="Symbol">{</a><a id="15406" href="Varieties.FreeAlgebras.html#15406" class="Bound">p</a> <a id="15408" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15410" href="Varieties.FreeAlgebras.html#15410" class="Bound">q</a><a id="15411" class="Symbol">}</a> <a id="15413" href="Varieties.FreeAlgebras.html#15413" class="Bound">pKq</a> <a id="15417" class="Symbol">=</a> <a id="15419" class="Symbol">(</a><a id="15420" href="Varieties.Preservation.html#20383" class="Function">class-ids-⇒</a> <a id="15432" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="15435" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="15438" href="Varieties.FreeAlgebras.html#15406" class="Bound">p</a> <a id="15440" href="Varieties.FreeAlgebras.html#15410" class="Bound">q</a> <a id="15442" class="Symbol">(</a><a id="15443" href="Varieties.FreeAlgebras.html#15154" class="Function">class-models-kernel</a> <a id="15463" href="Varieties.FreeAlgebras.html#15406" class="Bound">p</a> <a id="15465" href="Varieties.FreeAlgebras.html#15410" class="Bound">q</a> <a id="15467" href="Varieties.FreeAlgebras.html#15413" class="Bound">pKq</a><a id="15470" class="Symbol">))</a>

 <a id="15475" href="Varieties.FreeAlgebras.html#15475" class="Function">kernel-in-theory</a> <a id="15492" class="Symbol">:</a> <a id="15494" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15501" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15503" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="15508" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15510" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15512" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15515" href="Varieties.FreeAlgebras.html#15277" class="Function">𝕍𝒦</a>
 <a id="15519" href="Varieties.FreeAlgebras.html#15475" class="Function">kernel-in-theory</a> <a id="15536" class="Symbol">{</a><a id="15537" href="Varieties.FreeAlgebras.html#15537" class="Bound">p</a> <a id="15539" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15541" href="Varieties.FreeAlgebras.html#15541" class="Bound">q</a><a id="15542" class="Symbol">}</a> <a id="15544" href="Varieties.FreeAlgebras.html#15544" class="Bound">pKq</a> <a id="15548" href="Varieties.FreeAlgebras.html#15548" class="Bound">vkA</a> <a id="15552" href="Varieties.FreeAlgebras.html#15552" class="Bound">x</a> <a id="15554" class="Symbol">=</a> <a id="15556" href="Varieties.Preservation.html#20496" class="Function">class-ids</a> <a id="15566" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="15569" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="15572" href="Varieties.FreeAlgebras.html#15537" class="Bound">p</a> <a id="15574" href="Varieties.FreeAlgebras.html#15541" class="Bound">q</a> <a id="15576" class="Symbol">(</a><a id="15577" href="Varieties.FreeAlgebras.html#15154" class="Function">class-models-kernel</a> <a id="15597" href="Varieties.FreeAlgebras.html#15537" class="Bound">p</a> <a id="15599" href="Varieties.FreeAlgebras.html#15541" class="Bound">q</a> <a id="15601" href="Varieties.FreeAlgebras.html#15544" class="Bound">pKq</a><a id="15604" class="Symbol">)</a> <a id="15606" href="Varieties.FreeAlgebras.html#15548" class="Bound">vkA</a> <a id="15610" href="Varieties.FreeAlgebras.html#15552" class="Bound">x</a>

 <a id="15614" href="Varieties.FreeAlgebras.html#15614" class="Function Operator">_↠_</a> <a id="15618" class="Symbol">:</a> <a id="15620" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="15625" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="15627" class="Symbol">→</a> <a id="15629" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15637" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15640" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a> <a id="15642" class="Symbol">→</a> <a id="15644" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="15649" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a>
 <a id="15653" href="Varieties.FreeAlgebras.html#15653" class="Bound">X</a> <a id="15655" href="Varieties.FreeAlgebras.html#15614" class="Function Operator">↠</a> <a id="15657" href="Varieties.FreeAlgebras.html#15657" class="Bound">𝑨</a> <a id="15659" class="Symbol">=</a> <a id="15661" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15664" href="Varieties.FreeAlgebras.html#15664" class="Bound">h</a> <a id="15666" href="Data.Product.html#916" class="Function">∈</a> <a id="15668" class="Symbol">(</a><a id="15669" href="Varieties.FreeAlgebras.html#15653" class="Bound">X</a> <a id="15671" class="Symbol">→</a> <a id="15673" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15675" href="Varieties.FreeAlgebras.html#15657" class="Bound">𝑨</a> <a id="15677" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="15678" class="Symbol">)</a> <a id="15680" href="Data.Product.html#916" class="Function">]</a> <a id="15682" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="15695" href="Varieties.FreeAlgebras.html#15664" class="Bound">h</a>

 <a id="15699" href="Varieties.FreeAlgebras.html#15699" class="Function">𝔽-ModTh-epi</a> <a id="15711" class="Symbol">:</a> <a id="15713" class="Symbol">(</a><a id="15714" href="Varieties.FreeAlgebras.html#15714" class="Bound">𝑨</a> <a id="15716" class="Symbol">:</a> <a id="15718" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15726" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15729" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="15730" class="Symbol">)</a> <a id="15732" class="Symbol">→</a> <a id="15734" class="Symbol">(</a><a id="15735" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="15737" href="Varieties.FreeAlgebras.html#15614" class="Function Operator">↠</a> <a id="15739" href="Varieties.FreeAlgebras.html#15714" class="Bound">𝑨</a><a id="15740" class="Symbol">)</a> <a id="15742" class="Symbol">→</a> <a id="15744" href="Varieties.FreeAlgebras.html#15714" class="Bound">𝑨</a> <a id="15746" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15748" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="15752" class="Symbol">(</a><a id="15753" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15756" href="Varieties.FreeAlgebras.html#15277" class="Function">𝕍𝒦</a><a id="15758" class="Symbol">)</a> <a id="15760" class="Symbol">→</a> <a id="15762" href="Homomorphisms.Basic.html#6073" class="Function">epi</a> <a id="15766" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="15768" href="Varieties.FreeAlgebras.html#15714" class="Bound">𝑨</a>
 <a id="15771" href="Varieties.FreeAlgebras.html#15699" class="Function">𝔽-ModTh-epi</a> <a id="15783" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="15785" class="Symbol">(</a><a id="15786" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a> <a id="15788" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15790" href="Varieties.FreeAlgebras.html#15790" class="Bound">ηE</a><a id="15792" class="Symbol">)</a> <a id="15794" href="Varieties.FreeAlgebras.html#15794" class="Bound">AinMTV</a> <a id="15801" class="Symbol">=</a> <a id="15803" href="Varieties.FreeAlgebras.html#16315" class="Function">goal</a>
  <a id="15810" class="Keyword">where</a>
  <a id="15818" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="15820" class="Symbol">:</a> <a id="15822" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="15826" class="Symbol">(</a><a id="15827" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="15829" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="15830" class="Symbol">)</a> <a id="15832" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a>
  <a id="15836" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="15838" class="Symbol">=</a> <a id="15840" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="15849" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="15851" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a>

  <a id="15856" href="Varieties.FreeAlgebras.html#15856" class="Function">φE</a> <a id="15859" class="Symbol">:</a> <a id="15861" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="15874" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15876" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="15878" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
  <a id="15882" href="Varieties.FreeAlgebras.html#15856" class="Function">φE</a> <a id="15885" class="Symbol">=</a> <a id="15887" href="Terms.Properties.html#4782" class="Function">lift-of-epi-is-epi</a> <a id="15906" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="15908" href="Varieties.FreeAlgebras.html#15790" class="Bound">ηE</a>

  <a id="15914" href="Varieties.FreeAlgebras.html#15914" class="Function">pqlem2</a> <a id="15921" class="Symbol">:</a> <a id="15923" class="Symbol">∀</a> <a id="15925" href="Varieties.FreeAlgebras.html#15925" class="Bound">p</a> <a id="15927" href="Varieties.FreeAlgebras.html#15927" class="Bound">q</a> <a id="15929" class="Symbol">→</a> <a id="15931" class="Symbol">(</a><a id="15932" href="Varieties.FreeAlgebras.html#15925" class="Bound">p</a> <a id="15934" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15936" href="Varieties.FreeAlgebras.html#15927" class="Bound">q</a><a id="15937" class="Symbol">)</a> <a id="15939" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15941" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15948" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15950" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="15955" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15957" class="Symbol">→</a> <a id="15959" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="15961" href="Varieties.EquationalLogic.html#2605" class="Function Operator">⊧</a> <a id="15963" href="Varieties.FreeAlgebras.html#15925" class="Bound">p</a> <a id="15965" href="Varieties.EquationalLogic.html#2605" class="Function Operator">≈</a> <a id="15967" href="Varieties.FreeAlgebras.html#15927" class="Bound">q</a>
  <a id="15971" href="Varieties.FreeAlgebras.html#15914" class="Function">pqlem2</a> <a id="15978" href="Varieties.FreeAlgebras.html#15978" class="Bound">p</a> <a id="15980" href="Varieties.FreeAlgebras.html#15980" class="Bound">q</a> <a id="15982" href="Varieties.FreeAlgebras.html#15982" class="Bound">z</a> <a id="15984" class="Symbol">=</a> <a id="15986" class="Symbol">λ</a> <a id="15988" href="Varieties.FreeAlgebras.html#15988" class="Bound">x</a> <a id="15990" class="Symbol">→</a> <a id="15992" href="Varieties.FreeAlgebras.html#15794" class="Bound">AinMTV</a> <a id="15999" href="Varieties.FreeAlgebras.html#15978" class="Bound">p</a> <a id="16001" href="Varieties.FreeAlgebras.html#15980" class="Bound">q</a> <a id="16003" class="Symbol">(</a><a id="16004" href="Varieties.FreeAlgebras.html#15475" class="Function">kernel-in-theory</a> <a id="16021" href="Varieties.FreeAlgebras.html#15982" class="Bound">z</a><a id="16022" class="Symbol">)</a> <a id="16024" href="Varieties.FreeAlgebras.html#15988" class="Bound">x</a>

  <a id="16029" href="Varieties.FreeAlgebras.html#16029" class="Function">kerincl</a> <a id="16037" class="Symbol">:</a> <a id="16039" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="16046" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16048" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="16053" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16055" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="16057" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="16064" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16066" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="16068" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
  <a id="16072" href="Varieties.FreeAlgebras.html#16029" class="Function">kerincl</a> <a id="16080" class="Symbol">{</a><a id="16081" href="Varieties.FreeAlgebras.html#16081" class="Bound">p</a> <a id="16083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16085" href="Varieties.FreeAlgebras.html#16085" class="Bound">q</a><a id="16086" class="Symbol">}</a> <a id="16088" href="Varieties.FreeAlgebras.html#16088" class="Bound">x</a> <a id="16090" class="Symbol">=</a> <a id="16092" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16094" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="16096" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16098" href="Varieties.FreeAlgebras.html#16081" class="Bound">p</a>      <a id="16105" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16108" class="Symbol">(</a><a id="16109" href="Terms.Operations.html#2885" class="Function">free-lift-interp</a> <a id="16126" class="Symbol">(</a><a id="16127" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16130" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16132" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="16134" class="Symbol">)</a> <a id="16136" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="16138" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a> <a id="16140" href="Varieties.FreeAlgebras.html#16081" class="Bound">p</a><a id="16141" class="Symbol">)</a><a id="16142" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="16145" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16169" class="Symbol">(</a><a id="16170" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="16172" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="16174" href="Varieties.FreeAlgebras.html#16081" class="Bound">p</a> <a id="16176" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="16177" class="Symbol">)</a> <a id="16179" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a>  <a id="16182" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16185" href="Varieties.FreeAlgebras.html#15914" class="Function">pqlem2</a> <a id="16192" href="Varieties.FreeAlgebras.html#16081" class="Bound">p</a> <a id="16194" href="Varieties.FreeAlgebras.html#16085" class="Bound">q</a> <a id="16196" href="Varieties.FreeAlgebras.html#16088" class="Bound">x</a> <a id="16198" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a> <a id="16200" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16224" class="Symbol">(</a><a id="16225" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="16227" href="Terms.Operations.html#2574" class="Function Operator">⟦</a> <a id="16229" href="Varieties.FreeAlgebras.html#16085" class="Bound">q</a> <a id="16231" href="Terms.Operations.html#2574" class="Function Operator">⟧</a><a id="16232" class="Symbol">)</a> <a id="16234" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a>  <a id="16237" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16240" href="Terms.Operations.html#2885" class="Function">free-lift-interp</a> <a id="16257" class="Symbol">(</a><a id="16258" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16261" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16263" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="16265" class="Symbol">)</a> <a id="16267" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="16269" href="Varieties.FreeAlgebras.html#15786" class="Bound">η</a> <a id="16271" href="Varieties.FreeAlgebras.html#16085" class="Bound">q</a> <a id="16273" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16297" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16299" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="16301" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16303" href="Varieties.FreeAlgebras.html#16085" class="Bound">q</a>      <a id="16310" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16315" href="Varieties.FreeAlgebras.html#16315" class="Function">goal</a> <a id="16320" class="Symbol">:</a> <a id="16322" href="Homomorphisms.Basic.html#6073" class="Function">epi</a> <a id="16326" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="16328" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a>
  <a id="16332" href="Varieties.FreeAlgebras.html#16315" class="Function">goal</a> <a id="16337" class="Symbol">=</a> <a id="16339" href="Varieties.FreeAlgebras.html#1361" class="Field">fst</a> <a id="16343" class="Symbol">(</a><a id="16344" href="Homomorphisms.Noether.html#9875" class="Function">HomFactorEpi</a> <a id="16357" class="Symbol">(</a><a id="16358" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16361" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16363" class="Symbol">(</a><a id="16364" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="16369" class="Symbol">(</a><a id="16370" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="16373" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16374" class="Symbol">)))</a> <a id="16378" href="Varieties.FreeAlgebras.html#15783" class="Bound">𝑨</a> <a id="16380" href="Varieties.FreeAlgebras.html#15818" class="Function">φ</a> <a id="16382" href="Varieties.FreeAlgebras.html#11749" class="Function">hom𝔽</a> <a id="16387" href="Varieties.FreeAlgebras.html#16029" class="Function">kerincl</a> <a id="16395" href="Varieties.FreeAlgebras.html#11796" class="Function">hom𝔽-is-epic</a> <a id="16408" href="Varieties.FreeAlgebras.html#15856" class="Function">φE</a><a id="16410" class="Symbol">)</a>

</pre>



### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16769" class="Keyword">module</a> <a id="16776" href="Varieties.FreeAlgebras.html#16776" class="Module">_</a> <a id="16778" class="Symbol">(</a><a id="16779" href="Varieties.FreeAlgebras.html#16779" class="Bound">pe</a> <a id="16782" class="Symbol">:</a> <a id="16784" href="Foundations.Extensionality.html#3279" class="Function">pred-ext</a> <a id="16793" class="Symbol">(</a><a id="16794" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="16797" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16798" class="Symbol">)(</a><a id="16800" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="16803" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16804" class="Symbol">))(</a><a id="16807" href="Varieties.FreeAlgebras.html#16807" class="Bound">wd</a> <a id="16810" class="Symbol">:</a> <a id="16812" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a><a id="16820" class="Symbol">)</a> <a id="16822" class="Comment">-- extensionality assumptions</a>
          <a id="16862" class="Symbol">(</a><a id="16863" href="Varieties.FreeAlgebras.html#16863" class="Bound">Cset</a> <a id="16868" class="Symbol">:</a> <a id="16870" href="Foundations.Truncation.html#6614" class="Function">is-set</a> <a id="16877" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16879" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="16881" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="16882" class="Symbol">)</a>                       <a id="16906" class="Comment">-- truncation assumptions</a>
          <a id="16942" class="Symbol">(</a><a id="16943" href="Varieties.FreeAlgebras.html#16943" class="Bound">kuip</a> <a id="16948" class="Symbol">:</a> <a id="16950" href="Foundations.Truncation.html#10869" class="Function">blk-uip</a><a id="16957" class="Symbol">(</a><a id="16958" href="Terms.Basic.html#1987" class="Datatype">Term</a> <a id="16963" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="16964" class="Symbol">)</a><a id="16965" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16967" href="Homomorphisms.Basic.html#7749" class="Function">kercon</a> <a id="16974" class="Symbol">(</a><a id="16975" href="Varieties.FreeAlgebras.html#16807" class="Bound">wd</a> <a id="16978" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16980" class="Symbol">(</a><a id="16981" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="16984" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16985" class="Symbol">)){</a><a id="16988" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="16989" class="Symbol">}</a><a id="16990" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="16995" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="16996" class="Symbol">)</a>
  <a id="17000" class="Keyword">where</a>

  <a id="17009" href="Varieties.FreeAlgebras.html#17009" class="Function">𝔽≤ℭ</a> <a id="17013" class="Symbol">:</a> <a id="17015" class="Symbol">(</a><a id="17016" href="Homomorphisms.Basic.html#8157" class="Function Operator">ker[</a> <a id="17021" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="17023" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="17025" href="Homomorphisms.Basic.html#8157" class="Function Operator">⇒</a> <a id="17027" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="17029" href="Homomorphisms.Basic.html#8157" class="Function Operator">]</a> <a id="17031" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="17036" href="Homomorphisms.Basic.html#8157" class="Function Operator">↾</a> <a id="17038" class="Symbol">(</a><a id="17039" href="Varieties.FreeAlgebras.html#16807" class="Bound">wd</a> <a id="17042" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="17044" class="Symbol">(</a><a id="17045" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="17048" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="17049" class="Symbol">)))</a> <a id="17053" href="Subalgebras.Subalgebras.html#2553" class="Function Operator">≤</a> <a id="17055" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a>
  <a id="17059" href="Varieties.FreeAlgebras.html#17009" class="Function">𝔽≤ℭ</a> <a id="17063" class="Symbol">=</a> <a id="17065" href="Subalgebras.Subalgebras.html#4384" class="Function">FirstHomCorollary|Set</a> <a id="17087" class="Symbol">(</a><a id="17088" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="17090" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="17091" class="Symbol">)</a> <a id="17093" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="17095" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="17100" href="Varieties.FreeAlgebras.html#16779" class="Bound">pe</a> <a id="17103" class="Symbol">(</a><a id="17104" href="Varieties.FreeAlgebras.html#16807" class="Bound">wd</a> <a id="17107" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="17109" class="Symbol">(</a><a id="17110" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="17113" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="17114" class="Symbol">))</a> <a id="17117" href="Varieties.FreeAlgebras.html#16863" class="Bound">Cset</a> <a id="17122" href="Varieties.FreeAlgebras.html#16943" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="18184" href="Varieties.FreeAlgebras.html#18184" class="Function">𝔽∈SP</a> <a id="18189" class="Symbol">:</a> <a id="18191" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18199" class="Symbol">(</a><a id="18200" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18203" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18204" class="Symbol">)(</a><a id="18206" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18209" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18210" class="Symbol">)</a> <a id="18212" class="Symbol">→</a> <a id="18214" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="18216" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18218" class="Symbol">(</a><a id="18219" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="18220" class="Symbol">{</a><a id="18221" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18222" class="Symbol">}{</a><a id="18224" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="18226" class="Symbol">}</a> <a id="18228" class="Symbol">(</a><a id="18229" href="Varieties.Closure.html#4352" class="Datatype">P</a><a id="18230" class="Symbol">{</a><a id="18231" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18232" class="Symbol">}{</a><a id="18234" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18235" class="Symbol">}</a> <a id="18237" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18238" class="Symbol">))</a>
  <a id="18243" href="Varieties.FreeAlgebras.html#18184" class="Function">𝔽∈SP</a> <a id="18248" href="Varieties.FreeAlgebras.html#18248" class="Bound">hfe</a> <a id="18252" class="Symbol">=</a> <a id="18254" href="Varieties.Closure.html#3977" class="InductiveConstructor">ssub</a> <a id="18259" class="Symbol">(</a><a id="18260" href="Varieties.Preservation.html#12998" class="Function">class-prod-s-∈-sp</a> <a id="18278" href="Varieties.FreeAlgebras.html#18248" class="Bound">hfe</a><a id="18281" class="Symbol">)</a> <a id="18283" href="Varieties.FreeAlgebras.html#17009" class="Function">𝔽≤ℭ</a>

  <a id="18290" href="Varieties.FreeAlgebras.html#18290" class="Function">𝔽∈𝕍</a> <a id="18294" class="Symbol">:</a> <a id="18296" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18304" class="Symbol">(</a><a id="18305" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18308" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18309" class="Symbol">)(</a><a id="18311" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18314" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18315" class="Symbol">)</a> <a id="18317" class="Symbol">→</a> <a id="18319" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="18321" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18323" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18325" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="18329" href="Varieties.FreeAlgebras.html#18290" class="Function">𝔽∈𝕍</a> <a id="18333" href="Varieties.FreeAlgebras.html#18333" class="Bound">hfe</a> <a id="18337" class="Symbol">=</a> <a id="18339" href="Varieties.Preservation.html#9292" class="Function">SP⊆V&#39;</a> <a id="18345" class="Symbol">{</a><a id="18346" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18347" class="Symbol">}{</a><a id="18349" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18352" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="18354" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18355" class="Symbol">}{</a><a id="18357" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18360" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="18363" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="18365" class="Symbol">}{</a><a id="18367" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18370" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="18372" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18373" class="Symbol">}{</a><a id="18375" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18376" class="Symbol">}</a> <a id="18378" class="Symbol">(</a><a id="18379" href="Varieties.FreeAlgebras.html#18184" class="Function">𝔽∈SP</a> <a id="18384" href="Varieties.FreeAlgebras.html#18333" class="Bound">hfe</a><a id="18387" class="Symbol">)</a>

</pre>

### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18723" href="Varieties.FreeAlgebras.html#18723" class="Function">Birkhoff</a> <a id="18732" class="Symbol">:</a> <a id="18734" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18742" class="Symbol">(</a><a id="18743" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18746" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18747" class="Symbol">)(</a><a id="18749" href="Algebras.Products.html#3133" class="Function">ov</a> <a id="18752" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18753" class="Symbol">)</a> <a id="18755" class="Symbol">→</a> <a id="18757" class="Symbol">(∀</a> <a id="18760" href="Varieties.FreeAlgebras.html#18760" class="Bound">𝑨</a> <a id="18762" class="Symbol">→</a> <a id="18764" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="18766" href="Varieties.FreeAlgebras.html#15614" class="Function Operator">↠</a> <a id="18768" href="Varieties.FreeAlgebras.html#18760" class="Bound">𝑨</a><a id="18769" class="Symbol">)</a> <a id="18771" class="Symbol">→</a> <a id="18773" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="18777" class="Symbol">(</a><a id="18778" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="18781" class="Symbol">(</a><a id="18782" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18784" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18785" class="Symbol">))</a> <a id="18788" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18790" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18792" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="18796" href="Varieties.FreeAlgebras.html#18723" class="Function">Birkhoff</a> <a id="18805" href="Varieties.FreeAlgebras.html#18805" class="Bound">hfe</a> <a id="18809" href="Varieties.FreeAlgebras.html#18809" class="Bound">𝕏</a> <a id="18811" class="Symbol">{</a><a id="18812" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a><a id="18813" class="Symbol">}</a> <a id="18815" href="Varieties.FreeAlgebras.html#18815" class="Bound">α</a> <a id="18817" class="Symbol">=</a> <a id="18819" href="Varieties.Closure.html#5590" class="InductiveConstructor">vhimg</a><a id="18824" class="Symbol">{</a><a id="18825" class="Argument">𝑩</a> <a id="18827" class="Symbol">=</a> <a id="18829" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a><a id="18830" class="Symbol">}</a> <a id="18832" class="Symbol">(</a><a id="18833" href="Varieties.FreeAlgebras.html#18290" class="Function">𝔽∈𝕍</a> <a id="18837" href="Varieties.FreeAlgebras.html#18805" class="Bound">hfe</a><a id="18840" class="Symbol">)</a> <a id="18842" class="Symbol">(</a><a id="18843" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a> <a id="18845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18847" href="Homomorphisms.Basic.html#6540" class="Function">epi-to-hom</a> <a id="18858" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a> <a id="18860" href="Varieties.FreeAlgebras.html#18889" class="Function">φE</a> <a id="18863" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18865" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="18869" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="18871" href="Varieties.FreeAlgebras.html#18889" class="Function">φE</a> <a id="18874" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a><a id="18875" class="Symbol">)</a>
   <a id="18880" class="Keyword">where</a>
   <a id="18889" href="Varieties.FreeAlgebras.html#18889" class="Function">φE</a> <a id="18892" class="Symbol">:</a> <a id="18894" href="Homomorphisms.Basic.html#6073" class="Function">epi</a> <a id="18898" href="Varieties.FreeAlgebras.html#11632" class="Function">𝔽</a> <a id="18900" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a>
   <a id="18905" href="Varieties.FreeAlgebras.html#18889" class="Function">φE</a> <a id="18908" class="Symbol">=</a> <a id="18910" href="Varieties.FreeAlgebras.html#15699" class="Function">𝔽-ModTh-epi</a> <a id="18922" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a> <a id="18924" class="Symbol">(</a><a id="18925" href="Varieties.FreeAlgebras.html#18809" class="Bound">𝕏</a> <a id="18927" href="Varieties.FreeAlgebras.html#18812" class="Bound">𝑨</a><a id="18928" class="Symbol">)</a> <a id="18930" href="Varieties.FreeAlgebras.html#18815" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="19188" href="Varieties.FreeAlgebras.html#19188" class="Function">Birkhoff-converse</a> <a id="19206" class="Symbol">:</a> <a id="19208" href="Varieties.Closure.html#5309" class="Datatype">V</a><a id="19209" class="Symbol">{</a><a id="19210" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="19211" class="Symbol">}{</a><a id="19213" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="19214" class="Symbol">}</a> <a id="19216" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="19218" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19220" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a><a id="19223" class="Symbol">{</a><a id="19224" class="Argument">X</a> <a id="19226" class="Symbol">=</a> <a id="19228" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="19229" class="Symbol">}</a> <a id="19231" class="Symbol">(</a><a id="19232" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="19235" class="Symbol">(</a><a id="19236" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="19238" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="19239" class="Symbol">))</a>
  <a id="19244" href="Varieties.FreeAlgebras.html#19188" class="Function">Birkhoff-converse</a> <a id="19262" href="Varieties.FreeAlgebras.html#19262" class="Bound">α</a> <a id="19264" href="Varieties.FreeAlgebras.html#19264" class="Bound">p</a> <a id="19266" href="Varieties.FreeAlgebras.html#19266" class="Bound">q</a> <a id="19268" href="Varieties.FreeAlgebras.html#19268" class="Bound">pThq</a> <a id="19273" class="Symbol">=</a> <a id="19275" href="Varieties.FreeAlgebras.html#19268" class="Bound">pThq</a> <a id="19280" href="Varieties.FreeAlgebras.html#19262" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.





--------------------------------

<span style="float:left;">[← Varieties.Preservation](Varieties.Preservation.html)</span>
<span style="float:right;">[Varieties.Setoid →](Varieties.Setoid.html)</span>

{% include UALib.Links.md %}

[agda-algebras development team]: https://github.com/ualib/agda-algebras#the-agda-algebras-development-team
