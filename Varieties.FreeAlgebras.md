---
layout: default
title : "Varieties.FreeAlgebras module (Agda Universal Algebra Library)"
date : "2021-03-01"
author: "the agda-algebras development team"
---

### <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="806" class="Symbol">{-#</a> <a id="810" class="Keyword">OPTIONS</a> <a id="818" class="Pragma">--without-K</a> <a id="830" class="Pragma">--exact-split</a> <a id="844" class="Pragma">--safe</a> <a id="851" class="Symbol">#-}</a>


<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Level.html" class="Module">Level</a> <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a> <a id="886" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="890" class="Symbol">to</a> <a id="893" class="Primitive">lsuc</a> <a id="898" class="Symbol">)</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a> <a id="935" href="Algebras.Basic.html#1130" class="Generalizable">𝓞</a> <a id="937" class="Symbol">;</a> <a id="939" href="Algebras.Basic.html#1132" class="Generalizable">𝓥</a> <a id="941" class="Symbol">;</a> <a id="943" href="Algebras.Basic.html#3858" class="Function">Signature</a> <a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">module</a> <a id="963" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="986" class="Symbol">{</a><a id="987" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="989" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="991" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="1000" class="Symbol">}</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="1005" class="Symbol">:</a> <a id="1007" href="Algebras.Basic.html#3858" class="Function">Signature</a> <a id="1017" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="1019" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a><a id="1020" class="Symbol">)</a> <a id="1022" class="Keyword">where</a>

<a id="1029" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">()</a> <a id="1186" class="Keyword">renaming</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1211" class="Symbol">to</a> <a id="1214" class="Function">funext</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1250" class="Keyword">using</a> <a id="1256" class="Symbol">(</a> <a id="1258" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1262" class="Symbol">)</a> <a id="1264" class="Keyword">renaming</a> <a id="1273" class="Symbol">(</a> <a id="1275" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1279" class="Symbol">to</a> <a id="1282" class="Primitive">Type</a> <a id="1287" class="Symbol">)</a>
<a id="1289" class="Keyword">open</a> <a id="1294" class="Keyword">import</a> <a id="1301" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1317" class="Keyword">using</a> <a id="1323" class="Symbol">(</a> <a id="1325" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1329" class="Symbol">;</a> <a id="1331" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1340" class="Symbol">;</a> <a id="1342" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1346" class="Symbol">)</a> <a id="1348" class="Keyword">renaming</a> <a id="1357" class="Symbol">(</a> <a id="1359" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1365" class="Symbol">to</a> <a id="1368" class="Field">fst</a> <a id="1372" class="Symbol">;</a> <a id="1374" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1380" class="Symbol">to</a> <a id="1383" class="Field">snd</a> <a id="1387" class="Symbol">)</a>
<a id="1389" class="Keyword">open</a> <a id="1394" class="Keyword">import</a> <a id="1401" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1417" class="Keyword">using</a> <a id="1423" class="Symbol">(</a> <a id="1425" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1429" class="Symbol">)</a>
<a id="1431" class="Keyword">open</a> <a id="1436" class="Keyword">import</a> <a id="1443" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1459" class="Keyword">using</a> <a id="1465" class="Symbol">(</a> <a id="1467" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1481" class="Symbol">)</a> <a id="1483" class="Keyword">renaming</a> <a id="1492" class="Symbol">(</a> <a id="1494" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1498" class="Symbol">to</a> <a id="1501" class="Function">BinRel</a> <a id="1508" class="Symbol">)</a>
<a id="1510" class="Keyword">open</a> <a id="1515" class="Keyword">import</a> <a id="1522" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1588" class="Keyword">using</a> <a id="1594" class="Symbol">(</a> <a id="1596" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1614" class="Symbol">;</a> <a id="1616" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1625" class="Symbol">;</a> <a id="1627" class="Keyword">module</a> <a id="1634" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1646" class="Symbol">)</a>
<a id="1648" class="Keyword">open</a> <a id="1653" class="Keyword">import</a> <a id="1660" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1676" class="Keyword">using</a>    <a id="1685" class="Symbol">(</a> <a id="1687" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1692" class="Symbol">;</a> <a id="1694" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1698" class="Symbol">;</a> <a id="1700" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1704" class="Symbol">;</a> <a id="1706" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1710" class="Symbol">;</a> <a id="1712" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1716" class="Symbol">)</a>

<a id="1719" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1814" class="Keyword">open</a> <a id="1819" class="Keyword">import</a> <a id="1826" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1861" class="Keyword">using</a> <a id="1867" class="Symbol">(</a> <a id="1869" href="Overture.Preliminaries.html#4383" class="Function Operator">∣_∣</a> <a id="1873" class="Symbol">;</a> <a id="1875" href="Overture.Preliminaries.html#4421" class="Function Operator">∥_∥</a> <a id="1879" class="Symbol">;</a> <a id="1881" href="Overture.Preliminaries.html#5410" class="Function Operator">_∙_</a> <a id="1885" class="Symbol">;</a> <a id="1887" href="Overture.Preliminaries.html#5086" class="Function Operator">_⁻¹</a> <a id="1891" class="Symbol">)</a>
<a id="1893" class="Keyword">open</a> <a id="1898" class="Keyword">import</a> <a id="1905" href="Overture.Surjective.html" class="Module">Overture.Surjective</a>                <a id="1940" class="Keyword">using</a> <a id="1946" class="Symbol">(</a> <a id="1948" href="Overture.Surjective.html#1391" class="Function">IsSurjective</a> <a id="1961" class="Symbol">)</a>
<a id="1963" class="Keyword">open</a> <a id="1968" class="Keyword">import</a> <a id="1975" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2010" class="Keyword">using</a> <a id="2016" class="Symbol">(</a> <a id="2018" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="2025" class="Symbol">)</a>
<a id="2027" class="Keyword">open</a> <a id="2032" class="Keyword">import</a> <a id="2039" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2074" class="Keyword">using</a> <a id="2080" class="Symbol">(</a> <a id="2082" href="Relations.Quotients.html#5376" class="Function Operator">⟪_⟫</a> <a id="2086" class="Symbol">)</a>
<a id="2088" class="Keyword">open</a> <a id="2093" class="Keyword">import</a> <a id="2100" href="Equality.Welldefined.html" class="Module">Equality.Welldefined</a>               <a id="2135" class="Keyword">using</a> <a id="2141" class="Symbol">(</a> <a id="2143" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a> <a id="2152" class="Symbol">;</a> <a id="2154" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="2163" class="Symbol">)</a>
<a id="2165" class="Keyword">open</a> <a id="2170" class="Keyword">import</a> <a id="2177" href="Equality.Truncation.html" class="Module">Equality.Truncation</a>                <a id="2212" class="Keyword">using</a> <a id="2218" class="Symbol">(</a> <a id="2220" href="Equality.Truncation.html#6610" class="Function">is-set</a> <a id="2227" class="Symbol">;</a> <a id="2229" href="Equality.Truncation.html#10868" class="Function">blk-uip</a> <a id="2237" class="Symbol">;</a> <a id="2239" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="2247" class="Symbol">)</a>
<a id="2249" class="Keyword">open</a> <a id="2254" class="Keyword">import</a> <a id="2261" href="Equality.Extensionality.html" class="Module">Equality.Extensionality</a>            <a id="2296" class="Keyword">using</a> <a id="2302" class="Symbol">(</a> <a id="2304" href="Equality.Extensionality.html#2264" class="Function">DFunExt</a><a id="2311" class="Symbol">;</a> <a id="2313" href="Equality.Extensionality.html#3081" class="Function">pred-ext</a> <a id="2322" class="Symbol">)</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2371" class="Keyword">using</a> <a id="2377" class="Symbol">(</a> <a id="2379" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="2387" class="Symbol">;</a> <a id="2389" href="Algebras.Basic.html#10858" class="Function">Lift-Alg</a> <a id="2398" class="Symbol">;</a> <a id="2400" href="Algebras.Basic.html#12408" class="Function">compatible</a> <a id="2411" class="Symbol">;</a> <a id="2413" href="Algebras.Basic.html#9397" class="Function Operator">_̂_</a> <a id="2417" class="Symbol">)</a>
<a id="2419" class="Keyword">open</a> <a id="2424" class="Keyword">import</a> <a id="2431" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2458" class="Symbol">{</a><a id="2459" class="Argument">𝑆</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2464" class="Symbol">}</a> <a id="2466" class="Keyword">using</a> <a id="2472" class="Symbol">(</a> <a id="2474" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="2477" class="Symbol">;</a> <a id="2479" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="2481" class="Symbol">)</a>
<a id="2483" class="Keyword">open</a> <a id="2488" class="Keyword">import</a> <a id="2495" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2522" class="Symbol">{</a><a id="2523" class="Argument">𝑆</a> <a id="2525" class="Symbol">=</a> <a id="2527" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2528" class="Symbol">}</a> <a id="2530" class="Keyword">using</a> <a id="2536" class="Symbol">(</a> <a id="2538" href="Algebras.Congruences.html#1986" class="Function">Con</a><a id="2541" class="Symbol">;</a> <a id="2543" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="2549" class="Symbol">;</a> <a id="2551" href="Algebras.Congruences.html#1800" class="Record">IsCongruence</a> <a id="2564" class="Symbol">)</a>
<a id="2566" class="Keyword">open</a> <a id="2571" class="Keyword">import</a> <a id="2578" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2605" class="Symbol">{</a><a id="2606" class="Argument">𝑆</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2611" class="Symbol">}</a> <a id="2613" class="Keyword">using</a> <a id="2619" class="Symbol">(</a> <a id="2621" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="2625" class="Symbol">;</a> <a id="2627" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="2631" class="Symbol">;</a> <a id="2633" href="Homomorphisms.Basic.html#4758" class="Function">epi-to-hom</a> <a id="2644" class="Symbol">)</a>
<a id="2646" class="Keyword">open</a> <a id="2651" class="Keyword">import</a> <a id="2658" href="Homomorphisms.Kernels.html" class="Module">Homomorphisms.Kernels</a>      <a id="2685" class="Symbol">{</a><a id="2686" class="Argument">𝑆</a> <a id="2688" class="Symbol">=</a> <a id="2690" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2691" class="Symbol">}</a> <a id="2693" class="Keyword">using</a> <a id="2699" class="Symbol">(</a> <a id="2701" href="Homomorphisms.Kernels.html#2620" class="Function">kercon</a> <a id="2708" class="Symbol">;</a> <a id="2710" href="Homomorphisms.Kernels.html#5029" class="Function">ker-in-con</a> <a id="2721" class="Symbol">;</a> <a id="2723" href="Homomorphisms.Kernels.html#4520" class="Function">πker</a> <a id="2728" class="Symbol">;</a> <a id="2730" href="Homomorphisms.Kernels.html#3028" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2742" class="Symbol">)</a>
<a id="2744" class="Keyword">open</a> <a id="2749" class="Keyword">import</a> <a id="2756" href="Homomorphisms.Products.html" class="Module">Homomorphisms.Products</a>     <a id="2783" class="Symbol">{</a><a id="2784" class="Argument">𝑆</a> <a id="2786" class="Symbol">=</a> <a id="2788" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2789" class="Symbol">}</a> <a id="2791" class="Keyword">using</a> <a id="2797" class="Symbol">(</a> <a id="2799" href="Homomorphisms.Products.html#1616" class="Function">⨅-hom-co</a> <a id="2808" class="Symbol">)</a>
<a id="2810" class="Keyword">open</a> <a id="2815" class="Keyword">import</a> <a id="2822" href="Homomorphisms.Properties.html" class="Module">Homomorphisms.Properties</a>   <a id="2849" class="Symbol">{</a><a id="2850" class="Argument">𝑆</a> <a id="2852" class="Symbol">=</a> <a id="2854" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2855" class="Symbol">}</a> <a id="2857" class="Keyword">using</a> <a id="2863" class="Symbol">(</a> <a id="2865" href="Homomorphisms.Properties.html#1366" class="Function">∘-hom</a> <a id="2871" class="Symbol">)</a>
<a id="2873" class="Keyword">open</a> <a id="2878" class="Keyword">import</a> <a id="2885" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2912" class="Symbol">{</a><a id="2913" class="Argument">𝑆</a> <a id="2915" class="Symbol">=</a> <a id="2917" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2918" class="Symbol">}</a> <a id="2920" class="Keyword">using</a> <a id="2926" class="Symbol">(</a> <a id="2928" href="Homomorphisms.Noether.html#8611" class="Function">HomFactor</a> <a id="2938" class="Symbol">;</a> <a id="2940" href="Homomorphisms.Noether.html#9885" class="Function">HomFactorEpi</a> <a id="2953" class="Symbol">)</a>
<a id="2955" class="Keyword">open</a> <a id="2960" class="Keyword">import</a> <a id="2967" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2994" class="Symbol">{</a><a id="2995" class="Argument">𝑆</a> <a id="2997" class="Symbol">=</a> <a id="2999" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3000" class="Symbol">}</a> <a id="3002" class="Keyword">using</a> <a id="3008" class="Symbol">(</a> <a id="3010" href="Homomorphisms.Isomorphisms.html#2333" class="Record Operator">_≅_</a> <a id="3014" class="Symbol">;</a> <a id="3016" href="Homomorphisms.Isomorphisms.html#2874" class="Function">≅-refl</a> <a id="3023" class="Symbol">;</a> <a id="3025" href="Homomorphisms.Isomorphisms.html#2964" class="Function">≅-sym</a> <a id="3031" class="Symbol">;</a> <a id="3033" href="Homomorphisms.Isomorphisms.html#4408" class="Function">Lift-≅</a> <a id="3040" class="Symbol">)</a>
<a id="3042" class="Keyword">open</a> <a id="3047" class="Keyword">import</a> <a id="3054" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3081" class="Symbol">{</a><a id="3082" class="Argument">𝑆</a> <a id="3084" class="Symbol">=</a> <a id="3086" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3087" class="Symbol">}</a> <a id="3089" class="Keyword">using</a> <a id="3095" class="Symbol">(</a> <a id="3097" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="3102" class="Symbol">;</a> <a id="3104" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="3106" class="Symbol">)</a>
<a id="3108" class="Keyword">open</a> <a id="3113" class="Keyword">import</a> <a id="3120" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3147" class="Symbol">{</a><a id="3148" class="Argument">𝑆</a> <a id="3150" class="Symbol">=</a> <a id="3152" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3153" class="Symbol">}</a> <a id="3155" class="Keyword">using</a> <a id="3161" class="Symbol">(</a> <a id="3163" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="3173" class="Symbol">;</a> <a id="3175" href="Terms.Properties.html#3236" class="Function">lift-hom</a>
                                                     <a id="3237" class="Symbol">;</a> <a id="3239" href="Terms.Properties.html#3635" class="Function">free-unique</a> <a id="3251" class="Symbol">;</a> <a id="3253" href="Terms.Properties.html#4841" class="Function">lift-of-epi-is-epi</a> <a id="3272" class="Symbol">)</a>
<a id="3274" class="Keyword">open</a> <a id="3279" class="Keyword">import</a> <a id="3286" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3313" class="Symbol">{</a><a id="3314" class="Argument">𝑆</a> <a id="3316" class="Symbol">=</a> <a id="3318" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3319" class="Symbol">}</a> <a id="3321" class="Keyword">using</a> <a id="3327" class="Symbol">(</a> <a id="3329" href="Terms.Operations.html#2577" class="Function Operator">_⟦_⟧</a><a id="3333" class="Symbol">;</a> <a id="3335" href="Terms.Operations.html#6584" class="Function">comm-hom-term</a><a id="3348" class="Symbol">;</a> <a id="3350" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="3367" class="Symbol">)</a>
<a id="3369" class="Keyword">open</a> <a id="3374" class="Keyword">import</a> <a id="3381" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3408" class="Symbol">{</a><a id="3409" class="Argument">𝑆</a> <a id="3411" class="Symbol">=</a> <a id="3413" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3414" class="Symbol">}</a> <a id="3416" class="Keyword">using</a> <a id="3422" class="Symbol">(</a> <a id="3424" href="Subalgebras.Subalgebras.html#2186" class="Function Operator">_≤_</a> <a id="3428" class="Symbol">;</a> <a id="3430" href="Subalgebras.Subalgebras.html#4012" class="Function">FirstHomCorollary|Set</a> <a id="3452" class="Symbol">)</a>
<a id="3454" class="Keyword">open</a> <a id="3459" class="Keyword">import</a> <a id="3466" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3493" class="Symbol">{</a><a id="3494" class="Argument">𝑆</a> <a id="3496" class="Symbol">=</a> <a id="3498" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3499" class="Symbol">}</a> <a id="3501" class="Keyword">using</a> <a id="3507" class="Symbol">(</a> <a id="3509" href="Varieties.EquationalLogic.html#2716" class="Function Operator">_⊫_≈_</a><a id="3514" class="Symbol">;</a> <a id="3516" href="Varieties.EquationalLogic.html#2638" class="Function Operator">_⊧_≈_</a><a id="3521" class="Symbol">;</a> <a id="3523" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a><a id="3525" class="Symbol">;</a> <a id="3527" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="3531" class="Symbol">)</a>
<a id="3533" class="Keyword">open</a> <a id="3538" class="Keyword">import</a> <a id="3545" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3572" class="Symbol">{</a><a id="3573" class="Argument">𝑆</a> <a id="3575" class="Symbol">=</a> <a id="3577" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3578" class="Symbol">}</a> <a id="3580" class="Keyword">using</a> <a id="3586" class="Symbol">(</a> <a id="3588" href="Varieties.Closure.html#3774" class="Datatype">S</a> <a id="3590" class="Symbol">;</a> <a id="3592" href="Varieties.Closure.html#4358" class="Datatype">P</a> <a id="3594" class="Symbol">;</a> <a id="3596" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="3598" class="Symbol">)</a>
<a id="3600" class="Keyword">open</a> <a id="3605" class="Keyword">import</a> <a id="3612" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3639" class="Symbol">{</a><a id="3640" class="Argument">𝑆</a> <a id="3642" class="Symbol">=</a> <a id="3644" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3645" class="Symbol">}</a> <a id="3647" class="Keyword">using</a> <a id="3653" class="Symbol">(</a> <a id="3655" class="Keyword">module</a> <a id="3662" href="Varieties.Preservation.html#10544" class="Module">class-products-with-maps</a>
                                                     <a id="3740" class="Symbol">;</a> <a id="3742" href="Varieties.Preservation.html#20465" class="Function">class-ids-⇒</a> <a id="3754" class="Symbol">;</a> <a id="3756" href="Varieties.Preservation.html#20578" class="Function">class-ids</a> <a id="3766" class="Symbol">;</a> <a id="3768" href="Varieties.Preservation.html#9359" class="Function">SP⊆V&#39;</a><a id="3773" class="Symbol">)</a>
<a id="3775" class="Keyword">open</a> <a id="3780" href="Terms.Basic.html#1991" class="Module">Term</a>
<a id="3785" class="Keyword">open</a> <a id="3790" href="Varieties.Closure.html#3774" class="Module">S</a>
<a id="3792" class="Keyword">open</a> <a id="3797" href="Varieties.Closure.html#5316" class="Module">V</a>

<a id="𝓕"></a><a id="3800" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3802" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="3805" class="Symbol">:</a> <a id="3807" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3813" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="3815" class="Symbol">=</a> <a id="3817" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3820" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a>
<a id="3822" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="3825" class="Symbol">=</a> <a id="3827" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="3832" class="Symbol">(</a><a id="3833" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3836" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="3837" class="Symbol">)</a>    <a id="3842" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.



#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6357" class="Keyword">module</a> <a id="6364" href="Varieties.FreeAlgebras.html#6364" class="Module">_</a> <a id="6366" class="Symbol">{</a><a id="6367" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a> <a id="6369" class="Symbol">:</a> <a id="6371" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="6376" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6377" class="Symbol">}(</a><a id="6379" href="Varieties.FreeAlgebras.html#6379" class="Bound">𝒦</a> <a id="6381" class="Symbol">:</a> <a id="6383" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6388" class="Symbol">(</a><a id="6389" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="6397" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6399" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6400" class="Symbol">)</a> <a id="6402" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="6403" class="Symbol">)</a> <a id="6405" class="Keyword">where</a>

 <a id="6413" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="6415" class="Symbol">:</a> <a id="6417" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6422" class="Symbol">(</a><a id="6423" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6425" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6427" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a> <a id="6429" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6431" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6433" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6435" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6437" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a> <a id="6439" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="6440" class="Symbol">)</a> <a id="6442" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a>
 <a id="6445" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="6447" class="Symbol">(</a><a id="6448" href="Varieties.FreeAlgebras.html#6448" class="Bound">p</a> <a id="6450" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6452" href="Varieties.FreeAlgebras.html#6452" class="Bound">q</a><a id="6453" class="Symbol">)</a> <a id="6455" class="Symbol">=</a> <a id="6457" class="Symbol">∀(</a><a id="6459" href="Varieties.FreeAlgebras.html#6459" class="Bound">𝑨</a> <a id="6461" class="Symbol">:</a> <a id="6463" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="6471" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6473" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6474" class="Symbol">)(</a><a id="6476" href="Varieties.FreeAlgebras.html#6476" class="Bound">sA</a> <a id="6479" class="Symbol">:</a> <a id="6481" href="Varieties.FreeAlgebras.html#6459" class="Bound">𝑨</a> <a id="6483" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6485" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="6486" class="Symbol">{</a><a id="6487" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6488" class="Symbol">}{</a><a id="6490" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6491" class="Symbol">}</a> <a id="6493" href="Varieties.FreeAlgebras.html#6379" class="Bound">𝒦</a><a id="6494" class="Symbol">)(</a><a id="6496" href="Varieties.FreeAlgebras.html#6496" class="Bound">h</a> <a id="6498" class="Symbol">:</a> <a id="6500" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a> <a id="6502" class="Symbol">→</a> <a id="6504" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6506" href="Varieties.FreeAlgebras.html#6459" class="Bound">𝑨</a> <a id="6508" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6510" class="Symbol">)</a>
                 <a id="6529" class="Symbol">→</a>  <a id="6532" class="Symbol">(</a><a id="6533" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="6543" href="Varieties.FreeAlgebras.html#6459" class="Bound">𝑨</a> <a id="6545" href="Varieties.FreeAlgebras.html#6496" class="Bound">h</a><a id="6546" class="Symbol">)</a> <a id="6548" href="Varieties.FreeAlgebras.html#6448" class="Bound">p</a> <a id="6550" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6552" class="Symbol">(</a><a id="6553" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="6563" href="Varieties.FreeAlgebras.html#6459" class="Bound">𝑨</a> <a id="6565" href="Varieties.FreeAlgebras.html#6496" class="Bound">h</a><a id="6566" class="Symbol">)</a> <a id="6568" href="Varieties.FreeAlgebras.html#6452" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6697" href="Varieties.FreeAlgebras.html#6697" class="Function">ψRel</a> <a id="6702" class="Symbol">:</a> <a id="6704" href="Varieties.FreeAlgebras.html#1501" class="Function">BinRel</a> <a id="6711" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6713" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6715" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a> <a id="6717" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="6719" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a>
 <a id="6722" href="Varieties.FreeAlgebras.html#6697" class="Function">ψRel</a> <a id="6727" href="Varieties.FreeAlgebras.html#6727" class="Bound">p</a> <a id="6729" href="Varieties.FreeAlgebras.html#6729" class="Bound">q</a> <a id="6731" class="Symbol">=</a> <a id="6733" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="6735" class="Symbol">(</a><a id="6736" href="Varieties.FreeAlgebras.html#6727" class="Bound">p</a> <a id="6738" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6740" href="Varieties.FreeAlgebras.html#6729" class="Bound">q</a><a id="6741" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6989" class="Keyword">open</a> <a id="6994" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="7008" href="Varieties.FreeAlgebras.html#7008" class="Function">ψcompatible</a> <a id="7020" class="Symbol">:</a> <a id="7022" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="7031" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="7033" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="7035" class="Symbol">→</a> <a id="7037" href="Algebras.Basic.html#12408" class="Function">compatible</a> <a id="7048" class="Symbol">(</a><a id="7049" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7051" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7052" class="Symbol">)</a> <a id="7054" href="Varieties.FreeAlgebras.html#6697" class="Function">ψRel</a>
 <a id="7060" href="Varieties.FreeAlgebras.html#7008" class="Function">ψcompatible</a> <a id="7072" href="Varieties.FreeAlgebras.html#7072" class="Bound">wd</a> <a id="7075" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7077" class="Symbol">{</a><a id="7078" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a><a id="7079" class="Symbol">}</a> <a id="7081" class="Symbol">{</a><a id="7082" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7083" class="Symbol">}</a> <a id="7085" href="Varieties.FreeAlgebras.html#7085" class="Bound">ψpq</a> <a id="7089" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a> <a id="7091" href="Varieties.FreeAlgebras.html#7091" class="Bound">sA</a> <a id="7094" href="Varieties.FreeAlgebras.html#7094" class="Bound">h</a> <a id="7096" class="Symbol">=</a> <a id="7098" href="Varieties.FreeAlgebras.html#7148" class="Function">γ</a>
  <a id="7102" class="Keyword">where</a>
  <a id="7110" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7112" class="Symbol">:</a> <a id="7114" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="7118" class="Symbol">(</a><a id="7119" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7121" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7122" class="Symbol">)</a> <a id="7124" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a>
  <a id="7128" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7130" class="Symbol">=</a> <a id="7132" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="7141" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a> <a id="7143" href="Varieties.FreeAlgebras.html#7094" class="Bound">h</a>

  <a id="7148" href="Varieties.FreeAlgebras.html#7148" class="Function">γ</a> <a id="7150" class="Symbol">:</a> <a id="7152" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7154" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7156" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7158" class="Symbol">((</a><a id="7160" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7162" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7164" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7166" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7167" class="Symbol">)</a> <a id="7169" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a><a id="7170" class="Symbol">)</a> <a id="7172" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7174" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7176" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7178" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7180" class="Symbol">((</a><a id="7182" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7184" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7186" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7188" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7189" class="Symbol">)</a> <a id="7191" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7192" class="Symbol">)</a>

  <a id="7197" href="Varieties.FreeAlgebras.html#7148" class="Function">γ</a> <a id="7199" class="Symbol">=</a> <a id="7201" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7203" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7205" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7207" class="Symbol">((</a><a id="7209" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7211" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7213" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7215" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7216" class="Symbol">)</a> <a id="7218" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a><a id="7219" class="Symbol">)</a>  <a id="7222" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7225" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="7227" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7229" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="7231" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7233" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a> <a id="7235" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7243" class="Symbol">(</a><a id="7244" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7246" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7248" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a><a id="7249" class="Symbol">)</a> <a id="7251" class="Symbol">(</a><a id="7252" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7254" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7256" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7258" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7260" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a><a id="7261" class="Symbol">)</a>  <a id="7264" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7267" href="Varieties.FreeAlgebras.html#7072" class="Bound">wd</a> <a id="7270" class="Symbol">(</a><a id="7271" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7273" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7275" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a><a id="7276" class="Symbol">)(</a><a id="7278" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7280" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7282" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7284" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7286" href="Varieties.FreeAlgebras.html#7078" class="Bound">p</a><a id="7287" class="Symbol">)(</a><a id="7289" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7291" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7293" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7295" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7297" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7298" class="Symbol">)(λ</a> <a id="7302" href="Varieties.FreeAlgebras.html#7302" class="Bound">x</a> <a id="7304" class="Symbol">→</a> <a id="7306" href="Varieties.FreeAlgebras.html#7085" class="Bound">ψpq</a> <a id="7310" href="Varieties.FreeAlgebras.html#7302" class="Bound">x</a> <a id="7312" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a> <a id="7314" href="Varieties.FreeAlgebras.html#7091" class="Bound">sA</a> <a id="7317" href="Varieties.FreeAlgebras.html#7094" class="Bound">h</a><a id="7318" class="Symbol">)</a> <a id="7320" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7328" class="Symbol">(</a><a id="7329" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7331" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7333" href="Varieties.FreeAlgebras.html#7089" class="Bound">𝑨</a><a id="7334" class="Symbol">)</a> <a id="7336" class="Symbol">(</a><a id="7337" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7339" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7341" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7343" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7345" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7346" class="Symbol">)</a>  <a id="7349" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7352" class="Symbol">(</a><a id="7353" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="7355" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7357" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="7359" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7361" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7362" class="Symbol">)</a><a id="7363" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a> <a id="7366" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7374" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7376" href="Varieties.FreeAlgebras.html#7110" class="Function">φ</a> <a id="7378" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="7380" class="Symbol">((</a><a id="7382" href="Varieties.FreeAlgebras.html#7075" class="Bound">𝑓</a> <a id="7384" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7386" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7388" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7389" class="Symbol">)</a> <a id="7391" href="Varieties.FreeAlgebras.html#7082" class="Bound">q</a><a id="7392" class="Symbol">)</a>  <a id="7395" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7399" href="Varieties.FreeAlgebras.html#7399" class="Function">ψIsEquivalence</a> <a id="7414" class="Symbol">:</a> <a id="7416" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7430" href="Varieties.FreeAlgebras.html#6697" class="Function">ψRel</a>
 <a id="7436" href="Varieties.FreeAlgebras.html#7399" class="Function">ψIsEquivalence</a> <a id="7451" class="Symbol">=</a> <a id="7453" class="Keyword">record</a> <a id="7460" class="Symbol">{</a> <a id="7462" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7467" class="Symbol">=</a> <a id="7469" class="Symbol">λ</a> <a id="7471" href="Varieties.FreeAlgebras.html#7471" class="Bound">𝑨</a> <a id="7473" href="Varieties.FreeAlgebras.html#7473" class="Bound">sA</a> <a id="7476" href="Varieties.FreeAlgebras.html#7476" class="Bound">h</a> <a id="7478" class="Symbol">→</a> <a id="7480" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7510" class="Symbol">;</a> <a id="7512" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7516" class="Symbol">=</a> <a id="7518" class="Symbol">λ</a> <a id="7520" href="Varieties.FreeAlgebras.html#7520" class="Bound">x</a> <a id="7522" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7524" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7527" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a> <a id="7529" class="Symbol">→</a> <a id="7531" class="Symbol">(</a><a id="7532" href="Varieties.FreeAlgebras.html#7520" class="Bound">x</a> <a id="7534" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7536" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7539" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a><a id="7540" class="Symbol">)</a><a id="7541" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a>
                         <a id="7569" class="Symbol">;</a> <a id="7571" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7577" class="Symbol">=</a> <a id="7579" class="Symbol">λ</a> <a id="7581" href="Varieties.FreeAlgebras.html#7581" class="Bound">pψq</a> <a id="7585" href="Varieties.FreeAlgebras.html#7585" class="Bound">qψr</a> <a id="7589" href="Varieties.FreeAlgebras.html#7589" class="Bound">𝑨</a> <a id="7591" href="Varieties.FreeAlgebras.html#7591" class="Bound">sA</a> <a id="7594" href="Varieties.FreeAlgebras.html#7594" class="Bound">h</a> <a id="7596" class="Symbol">→</a> <a id="7598" class="Symbol">(</a><a id="7599" href="Varieties.FreeAlgebras.html#7581" class="Bound">pψq</a> <a id="7603" href="Varieties.FreeAlgebras.html#7589" class="Bound">𝑨</a> <a id="7605" href="Varieties.FreeAlgebras.html#7591" class="Bound">sA</a> <a id="7608" href="Varieties.FreeAlgebras.html#7594" class="Bound">h</a><a id="7609" class="Symbol">)</a> <a id="7611" href="Overture.Preliminaries.html#5410" class="Function Operator">∙</a> <a id="7613" class="Symbol">(</a><a id="7614" href="Varieties.FreeAlgebras.html#7585" class="Bound">qψr</a> <a id="7618" href="Varieties.FreeAlgebras.html#7589" class="Bound">𝑨</a> <a id="7620" href="Varieties.FreeAlgebras.html#7591" class="Bound">sA</a> <a id="7623" href="Varieties.FreeAlgebras.html#7594" class="Bound">h</a><a id="7624" class="Symbol">)</a> <a id="7626" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7926" href="Varieties.FreeAlgebras.html#7926" class="Function">ψCon</a> <a id="7931" class="Symbol">:</a> <a id="7933" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="7942" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="7944" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="7946" class="Symbol">→</a> <a id="7948" href="Algebras.Congruences.html#1986" class="Function">Con</a> <a id="7952" class="Symbol">(</a><a id="7953" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7955" href="Varieties.FreeAlgebras.html#6367" class="Bound">X</a><a id="7956" class="Symbol">)</a>
 <a id="7959" href="Varieties.FreeAlgebras.html#7926" class="Function">ψCon</a> <a id="7964" href="Varieties.FreeAlgebras.html#7964" class="Bound">wd</a> <a id="7967" class="Symbol">=</a> <a id="7969" href="Varieties.FreeAlgebras.html#6697" class="Function">ψRel</a> <a id="7974" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7976" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="7982" href="Varieties.FreeAlgebras.html#7399" class="Function">ψIsEquivalence</a> <a id="7997" class="Symbol">(</a><a id="7998" href="Varieties.FreeAlgebras.html#7008" class="Function">ψcompatible</a> <a id="8010" href="Varieties.FreeAlgebras.html#7964" class="Bound">wd</a><a id="8012" class="Symbol">)</a>

</pre>



#### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10467" class="Keyword">module</a> <a id="10474" href="Varieties.FreeAlgebras.html#10474" class="Module">_</a> <a id="10476" class="Symbol">{</a><a id="10477" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="10480" class="Symbol">:</a> <a id="10482" href="Equality.Extensionality.html#2264" class="Function">DFunExt</a><a id="10489" class="Symbol">}{</a><a id="10491" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="10494" class="Symbol">:</a> <a id="10496" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="10504" class="Symbol">}{</a><a id="10506" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="10508" class="Symbol">:</a> <a id="10510" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="10515" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10516" class="Symbol">}</a> <a id="10518" class="Symbol">{</a><a id="10519" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="10521" class="Symbol">:</a> <a id="10523" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10528" class="Symbol">(</a><a id="10529" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="10537" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="10539" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="10540" class="Symbol">)</a> <a id="10542" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="10543" class="Symbol">}</a> <a id="10545" class="Keyword">where</a>

 <a id="10553" class="Keyword">open</a> <a id="10558" href="Varieties.Preservation.html#10544" class="Module">class-products-with-maps</a> <a id="10583" class="Symbol">{</a><a id="10584" class="Argument">X</a> <a id="10586" class="Symbol">=</a> <a id="10588" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="10589" class="Symbol">}{</a><a id="10591" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="10594" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="10596" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10597" class="Symbol">}{</a><a id="10599" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="10602" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="10605" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="10607" class="Symbol">}{</a><a id="10609" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="10612" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="10614" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="10615" class="Symbol">}</a> <a id="10617" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10832" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10890" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="10892" class="Symbol">:</a> <a id="10894" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="10902" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="10904" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="10907" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="10909" class="Symbol">=</a> <a id="10911" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="10913" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="11077" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="11082" class="Symbol">:</a> <a id="11084" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="11088" class="Symbol">(</a><a id="11089" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11091" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="11092" class="Symbol">)</a> <a id="11094" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a>
 <a id="11097" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="11102" class="Symbol">=</a> <a id="11104" href="Homomorphisms.Products.html#1616" class="Function">⨅-hom-co</a> <a id="11113" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a> <a id="11116" class="Symbol">(</a><a id="11117" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="11120" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="11122" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11123" class="Symbol">){</a><a id="11125" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="11126" class="Symbol">}(</a><a id="11128" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11130" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="11131" class="Symbol">)</a> <a id="11133" class="Symbol">λ</a> <a id="11135" href="Varieties.FreeAlgebras.html#11135" class="Bound">i</a> <a id="11137" class="Symbol">→</a> <a id="11139" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="11148" class="Symbol">(</a><a id="11149" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a> <a id="11152" href="Varieties.FreeAlgebras.html#11135" class="Bound">i</a><a id="11153" class="Symbol">)(</a><a id="11155" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11159" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="11161" href="Varieties.FreeAlgebras.html#11135" class="Bound">i</a> <a id="11163" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a><a id="11164" class="Symbol">)</a>

</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned, the initial version of the [agda-algebras](https://github.com/ualib/agda-algebras) library used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11702" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="11704" class="Symbol">:</a> <a id="11706" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="11714" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="11717" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="11720" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="11722" class="Symbol">=</a> <a id="11724" href="Homomorphisms.Kernels.html#3028" class="Function Operator">ker[</a> <a id="11729" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11731" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="11733" href="Homomorphisms.Kernels.html#3028" class="Function Operator">⇒</a> <a id="11735" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="11737" href="Homomorphisms.Kernels.html#3028" class="Function Operator">]</a> <a id="11739" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="11744" href="Homomorphisms.Kernels.html#3028" class="Function Operator">↾</a> <a id="11746" class="Symbol">(</a><a id="11747" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="11750" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11752" class="Symbol">(</a><a id="11753" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11756" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11757" class="Symbol">))</a>

 <a id="11762" href="Varieties.FreeAlgebras.html#11762" class="Function">epi𝔽</a> <a id="11767" class="Symbol">:</a> <a id="11769" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="11773" class="Symbol">(</a><a id="11774" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11776" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="11777" class="Symbol">)</a> <a id="11779" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a>
 <a id="11782" href="Varieties.FreeAlgebras.html#11762" class="Function">epi𝔽</a> <a id="11787" class="Symbol">=</a> <a id="11789" href="Homomorphisms.Kernels.html#4520" class="Function">πker</a> <a id="11794" class="Symbol">(</a><a id="11795" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="11798" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11800" class="Symbol">(</a><a id="11801" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11804" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11805" class="Symbol">))</a> <a id="11808" class="Symbol">{</a><a id="11809" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a><a id="11810" class="Symbol">}</a> <a id="11812" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a>

 <a id="11819" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="11824" class="Symbol">:</a> <a id="11826" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="11830" class="Symbol">(</a><a id="11831" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11833" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="11834" class="Symbol">)</a> <a id="11836" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a>
 <a id="11839" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="11844" class="Symbol">=</a> <a id="11846" href="Homomorphisms.Basic.html#4758" class="Function">epi-to-hom</a> <a id="11857" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="11859" href="Varieties.FreeAlgebras.html#11762" class="Function">epi𝔽</a>

 <a id="11866" href="Varieties.FreeAlgebras.html#11866" class="Function">hom𝔽-is-epic</a> <a id="11879" class="Symbol">:</a> <a id="11881" href="Overture.Surjective.html#1391" class="Function">IsSurjective</a> <a id="11894" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="11896" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="11901" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a>
 <a id="11904" href="Varieties.FreeAlgebras.html#11866" class="Function">hom𝔽-is-epic</a> <a id="11917" class="Symbol">=</a> <a id="11919" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11923" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="11925" href="Varieties.FreeAlgebras.html#11762" class="Function">epi𝔽</a> <a id="11930" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="12028" href="Varieties.FreeAlgebras.html#12028" class="Function">ψlemma0</a> <a id="12036" class="Symbol">:</a> <a id="12038" class="Symbol">∀</a> <a id="12040" href="Varieties.FreeAlgebras.html#12040" class="Bound">p</a> <a id="12042" href="Varieties.FreeAlgebras.html#12042" class="Bound">q</a> <a id="12044" class="Symbol">→</a>  <a id="12047" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12049" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="12054" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12056" href="Varieties.FreeAlgebras.html#12040" class="Bound">p</a> <a id="12058" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12060" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12062" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="12067" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12069" href="Varieties.FreeAlgebras.html#12042" class="Bound">q</a>  <a id="12072" class="Symbol">→</a> <a id="12074" class="Symbol">(</a><a id="12075" href="Varieties.FreeAlgebras.html#12040" class="Bound">p</a> <a id="12077" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12079" href="Varieties.FreeAlgebras.html#12042" class="Bound">q</a><a id="12080" class="Symbol">)</a> <a id="12082" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12084" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="12086" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
 <a id="12089" href="Varieties.FreeAlgebras.html#12028" class="Function">ψlemma0</a> <a id="12097" href="Varieties.FreeAlgebras.html#12097" class="Bound">p</a> <a id="12099" href="Varieties.FreeAlgebras.html#12099" class="Bound">q</a> <a id="12101" href="Varieties.FreeAlgebras.html#12101" class="Bound">phomℭq</a> <a id="12108" href="Varieties.FreeAlgebras.html#12108" class="Bound">𝑨</a> <a id="12110" href="Varieties.FreeAlgebras.html#12110" class="Bound">sA</a> <a id="12113" href="Varieties.FreeAlgebras.html#12113" class="Bound">h</a> <a id="12115" class="Symbol">=</a> <a id="12117" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="12126" href="Varieties.FreeAlgebras.html#12101" class="Bound">phomℭq</a> <a id="12133" class="Symbol">(</a><a id="12134" href="Varieties.FreeAlgebras.html#12108" class="Bound">𝑨</a> <a id="12136" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12138" href="Varieties.FreeAlgebras.html#12110" class="Bound">sA</a> <a id="12141" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12143" href="Varieties.FreeAlgebras.html#12113" class="Bound">h</a><a id="12144" class="Symbol">)</a>

 <a id="12148" href="Varieties.FreeAlgebras.html#12148" class="Function">ψlemma0-ap</a> <a id="12159" class="Symbol">:</a> <a id="12161" class="Symbol">{</a><a id="12162" href="Varieties.FreeAlgebras.html#12162" class="Bound">𝑨</a> <a id="12164" class="Symbol">:</a> <a id="12166" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="12174" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12176" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12177" class="Symbol">}{</a><a id="12179" href="Varieties.FreeAlgebras.html#12179" class="Bound">h</a> <a id="12181" class="Symbol">:</a> <a id="12183" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="12185" class="Symbol">→</a> <a id="12187" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12189" href="Varieties.FreeAlgebras.html#12162" class="Bound">𝑨</a> <a id="12191" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="12192" class="Symbol">}</a> <a id="12194" class="Symbol">→</a> <a id="12196" href="Varieties.FreeAlgebras.html#12162" class="Bound">𝑨</a> <a id="12198" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12200" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="12201" class="Symbol">{</a><a id="12202" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12203" class="Symbol">}{</a><a id="12205" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12206" class="Symbol">}</a> <a id="12208" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
  <a id="12212" class="Symbol">→</a>           <a id="12224" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="12231" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12233" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="12238" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12240" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="12242" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="12249" class="Symbol">(</a><a id="12250" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12260" href="Varieties.FreeAlgebras.html#12162" class="Bound">𝑨</a> <a id="12262" href="Varieties.FreeAlgebras.html#12179" class="Bound">h</a><a id="12263" class="Symbol">)</a>

 <a id="12267" href="Varieties.FreeAlgebras.html#12148" class="Function">ψlemma0-ap</a> <a id="12278" class="Symbol">{</a><a id="12279" href="Varieties.FreeAlgebras.html#12279" class="Bound">𝑨</a><a id="12280" class="Symbol">}{</a><a id="12282" href="Varieties.FreeAlgebras.html#12282" class="Bound">h</a><a id="12283" class="Symbol">}</a> <a id="12285" href="Varieties.FreeAlgebras.html#12285" class="Bound">skA</a> <a id="12289" class="Symbol">{</a><a id="12290" href="Varieties.FreeAlgebras.html#12290" class="Bound">p</a> <a id="12292" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12294" href="Varieties.FreeAlgebras.html#12294" class="Bound">q</a><a id="12295" class="Symbol">}</a> <a id="12297" href="Varieties.FreeAlgebras.html#12297" class="Bound">x</a> <a id="12299" class="Symbol">=</a> <a id="12301" href="Varieties.FreeAlgebras.html#12444" class="Function">γ</a> <a id="12303" class="Keyword">where</a>

  <a id="12312" href="Varieties.FreeAlgebras.html#12312" class="Function">ν</a> <a id="12314" class="Symbol">:</a> <a id="12316" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12318" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="12323" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12325" href="Varieties.FreeAlgebras.html#12290" class="Bound">p</a> <a id="12327" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12329" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12331" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="12336" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12338" href="Varieties.FreeAlgebras.html#12294" class="Bound">q</a>
  <a id="12342" href="Varieties.FreeAlgebras.html#12312" class="Function">ν</a> <a id="12344" class="Symbol">=</a> <a id="12346" href="Homomorphisms.Kernels.html#5029" class="Function">ker-in-con</a> <a id="12357" class="Symbol">{</a><a id="12358" class="Argument">α</a> <a id="12360" class="Symbol">=</a> <a id="12362" class="Symbol">(</a><a id="12363" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12366" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12367" class="Symbol">)}{</a><a id="12370" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12373" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12374" class="Symbol">}{</a><a id="12376" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="12378" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="12379" class="Symbol">}{</a><a id="12381" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="12384" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12386" class="Symbol">(</a><a id="12387" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12392" class="Symbol">(</a><a id="12393" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12396" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12397" class="Symbol">))}(</a><a id="12401" href="Homomorphisms.Kernels.html#2620" class="Function">kercon</a> <a id="12408" class="Symbol">(</a><a id="12409" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="12412" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12414" class="Symbol">(</a><a id="12415" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12418" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12419" class="Symbol">))</a> <a id="12422" class="Symbol">{</a><a id="12423" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a><a id="12424" class="Symbol">}</a> <a id="12426" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a><a id="12430" class="Symbol">)</a> <a id="12432" class="Symbol">{</a><a id="12433" href="Varieties.FreeAlgebras.html#12290" class="Bound">p</a><a id="12434" class="Symbol">}{</a><a id="12436" href="Varieties.FreeAlgebras.html#12294" class="Bound">q</a><a id="12437" class="Symbol">}</a> <a id="12439" href="Varieties.FreeAlgebras.html#12297" class="Bound">x</a>

  <a id="12444" href="Varieties.FreeAlgebras.html#12444" class="Function">γ</a> <a id="12446" class="Symbol">:</a> <a id="12448" class="Symbol">(</a><a id="12449" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12459" href="Varieties.FreeAlgebras.html#12279" class="Bound">𝑨</a> <a id="12461" href="Varieties.FreeAlgebras.html#12282" class="Bound">h</a><a id="12462" class="Symbol">)</a> <a id="12464" href="Varieties.FreeAlgebras.html#12290" class="Bound">p</a> <a id="12466" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12468" class="Symbol">(</a><a id="12469" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12479" href="Varieties.FreeAlgebras.html#12279" class="Bound">𝑨</a> <a id="12481" href="Varieties.FreeAlgebras.html#12282" class="Bound">h</a><a id="12482" class="Symbol">)</a> <a id="12484" href="Varieties.FreeAlgebras.html#12294" class="Bound">q</a>
  <a id="12488" href="Varieties.FreeAlgebras.html#12444" class="Function">γ</a> <a id="12490" class="Symbol">=</a> <a id="12492" class="Symbol">((</a><a id="12494" href="Varieties.FreeAlgebras.html#12028" class="Function">ψlemma0</a> <a id="12502" href="Varieties.FreeAlgebras.html#12290" class="Bound">p</a> <a id="12504" href="Varieties.FreeAlgebras.html#12294" class="Bound">q</a><a id="12505" class="Symbol">)</a> <a id="12507" href="Varieties.FreeAlgebras.html#12312" class="Function">ν</a><a id="12508" class="Symbol">)</a> <a id="12510" href="Varieties.FreeAlgebras.html#12279" class="Bound">𝑨</a> <a id="12512" href="Varieties.FreeAlgebras.html#12285" class="Bound">skA</a> <a id="12516" href="Varieties.FreeAlgebras.html#12282" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12697" href="Varieties.FreeAlgebras.html#12697" class="Function">𝔽-lift-hom</a> <a id="12708" class="Symbol">:</a> <a id="12710" class="Symbol">(</a><a id="12711" href="Varieties.FreeAlgebras.html#12711" class="Bound">𝑨</a> <a id="12713" class="Symbol">:</a> <a id="12715" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="12723" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12725" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12726" class="Symbol">)</a> <a id="12728" class="Symbol">→</a> <a id="12730" href="Varieties.FreeAlgebras.html#12711" class="Bound">𝑨</a> <a id="12732" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12734" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="12735" class="Symbol">{</a><a id="12736" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12737" class="Symbol">}{</a><a id="12739" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12740" class="Symbol">}</a> <a id="12742" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="12744" class="Symbol">→</a> <a id="12746" class="Symbol">(</a><a id="12747" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="12749" class="Symbol">→</a> <a id="12751" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="12753" href="Varieties.FreeAlgebras.html#12711" class="Bound">𝑨</a> <a id="12755" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="12756" class="Symbol">)</a> <a id="12758" class="Symbol">→</a> <a id="12760" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="12764" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="12766" href="Varieties.FreeAlgebras.html#12711" class="Bound">𝑨</a>
 <a id="12769" href="Varieties.FreeAlgebras.html#12697" class="Function">𝔽-lift-hom</a> <a id="12780" href="Varieties.FreeAlgebras.html#12780" class="Bound">𝑨</a> <a id="12782" href="Varieties.FreeAlgebras.html#12782" class="Bound">skA</a> <a id="12786" href="Varieties.FreeAlgebras.html#12786" class="Bound">h</a> <a id="12788" class="Symbol">=</a> <a id="12790" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a><a id="12793" class="Symbol">(</a><a id="12794" href="Homomorphisms.Noether.html#8611" class="Function">HomFactor</a> <a id="12804" class="Symbol">(</a><a id="12805" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="12808" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12810" class="Symbol">(</a><a id="12811" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12816" class="Symbol">(</a><a id="12817" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12820" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12821" class="Symbol">)))</a>  <a id="12826" href="Varieties.FreeAlgebras.html#12780" class="Bound">𝑨</a> <a id="12828" class="Symbol">(</a><a id="12829" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="12838" href="Varieties.FreeAlgebras.html#12780" class="Bound">𝑨</a> <a id="12840" href="Varieties.FreeAlgebras.html#12786" class="Bound">h</a><a id="12841" class="Symbol">)</a> <a id="12843" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="12848" class="Symbol">(</a><a id="12849" href="Varieties.FreeAlgebras.html#12148" class="Function">ψlemma0-ap</a> <a id="12860" href="Varieties.FreeAlgebras.html#12782" class="Bound">skA</a><a id="12863" class="Symbol">)</a> <a id="12865" href="Varieties.FreeAlgebras.html#11866" class="Function">hom𝔽-is-epic</a><a id="12877" class="Symbol">)</a>

</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="13262" class="Keyword">open</a> <a id="13267" href="Algebras.Congruences.html#1800" class="Module">IsCongruence</a>

 <a id="13282" href="Varieties.FreeAlgebras.html#13282" class="Function">X↪𝔽</a> <a id="13286" class="Symbol">:</a> <a id="13288" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="13290" class="Symbol">→</a> <a id="13292" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13294" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="13296" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a>
 <a id="13299" href="Varieties.FreeAlgebras.html#13282" class="Function">X↪𝔽</a> <a id="13303" href="Varieties.FreeAlgebras.html#13303" class="Bound">x</a> <a id="13305" class="Symbol">=</a> <a id="13307" href="Relations.Quotients.html#5376" class="Function Operator">⟪</a> <a id="13309" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13311" href="Varieties.FreeAlgebras.html#13303" class="Bound">x</a> <a id="13313" href="Relations.Quotients.html#5376" class="Function Operator">⟫</a> <a id="13315" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13381" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13383" class="Symbol">:</a> <a id="13385" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="13389" class="Symbol">(</a><a id="13390" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="13392" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="13393" class="Symbol">)</a> <a id="13395" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a>
 <a id="13398" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13400" class="Symbol">=</a> <a id="13402" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="13411" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="13413" href="Varieties.FreeAlgebras.html#13282" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13516" class="Keyword">open</a> <a id="13521" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13535" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a> <a id="13552" class="Symbol">:</a> <a id="13554" class="Symbol">∀</a> <a id="13556" href="Varieties.FreeAlgebras.html#13556" class="Bound">p</a> <a id="13558" class="Symbol">→</a> <a id="13560" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13562" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13564" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13566" href="Varieties.FreeAlgebras.html#13556" class="Bound">p</a> <a id="13568" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13570" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13572" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="13577" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13579" href="Varieties.FreeAlgebras.html#13556" class="Bound">p</a>
 <a id="13582" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a> <a id="13599" class="Symbol">(</a><a id="13600" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13602" href="Varieties.FreeAlgebras.html#13602" class="Bound">x</a><a id="13603" class="Symbol">)</a> <a id="13605" class="Symbol">=</a> <a id="13607" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13613" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a> <a id="13630" class="Symbol">(</a><a id="13631" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13636" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13638" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a><a id="13639" class="Symbol">)</a> <a id="13641" class="Symbol">=</a>
  <a id="13645" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13647" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13649" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13651" class="Symbol">(</a><a id="13652" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13657" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13659" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a><a id="13660" class="Symbol">)</a>              <a id="13675" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13678" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="13680" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13682" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="13684" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13686" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13688" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13692" class="Symbol">(</a><a id="13693" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13695" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13697" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a><a id="13698" class="Symbol">)(λ</a> <a id="13702" href="Varieties.FreeAlgebras.html#13702" class="Bound">i</a> <a id="13704" class="Symbol">→</a> <a id="13706" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13708" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13710" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="13711" class="Symbol">(</a><a id="13712" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13714" href="Varieties.FreeAlgebras.html#13702" class="Bound">i</a><a id="13715" class="Symbol">))</a>     <a id="13722" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13725" href="Varieties.FreeAlgebras.html#13833" class="Function">wd-proof</a> <a id="13734" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13738" class="Symbol">(</a><a id="13739" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13741" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13743" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a><a id="13744" class="Symbol">)(λ</a> <a id="13748" href="Varieties.FreeAlgebras.html#13748" class="Bound">i</a> <a id="13750" class="Symbol">→</a> <a id="13752" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13754" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="13759" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13761" class="Symbol">(</a><a id="13762" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13764" href="Varieties.FreeAlgebras.html#13748" class="Bound">i</a><a id="13765" class="Symbol">))</a> <a id="13768" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13771" class="Symbol">(</a><a id="13772" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="13774" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="13779" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="13781" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13783" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a><a id="13784" class="Symbol">)</a><a id="13785" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a> <a id="13788" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13792" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13794" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="13799" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13801" class="Symbol">(</a><a id="13802" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13807" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13809" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a><a id="13810" class="Symbol">)</a>           <a id="13822" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13827" class="Keyword">where</a> <a id="13833" href="Varieties.FreeAlgebras.html#13833" class="Function">wd-proof</a> <a id="13842" class="Symbol">=</a> <a id="13844" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="13847" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="13849" class="Symbol">(</a><a id="13850" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="13855" class="Symbol">(</a><a id="13856" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="13859" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="13860" class="Symbol">))</a>
                    <a id="13883" class="Symbol">(</a><a id="13884" href="Varieties.FreeAlgebras.html#13636" class="Bound">𝑓</a> <a id="13886" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13888" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a><a id="13889" class="Symbol">)</a> <a id="13891" class="Symbol">(λ</a> <a id="13894" href="Varieties.FreeAlgebras.html#13894" class="Bound">i</a> <a id="13896" class="Symbol">→</a> <a id="13898" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13900" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="13902" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="13903" class="Symbol">(</a><a id="13904" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13906" href="Varieties.FreeAlgebras.html#13894" class="Bound">i</a><a id="13907" class="Symbol">))</a> <a id="13910" class="Symbol">(λ</a> <a id="13913" href="Varieties.FreeAlgebras.html#13913" class="Bound">i</a> <a id="13915" class="Symbol">→</a> <a id="13917" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13919" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="13924" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="13926" class="Symbol">(</a><a id="13927" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13929" href="Varieties.FreeAlgebras.html#13913" class="Bound">i</a><a id="13930" class="Symbol">))</a>
                    <a id="13953" class="Symbol">(λ</a> <a id="13956" href="Varieties.FreeAlgebras.html#13956" class="Bound">x</a> <a id="13958" class="Symbol">→</a> <a id="13960" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a><a id="13976" class="Symbol">(</a><a id="13977" href="Varieties.FreeAlgebras.html#13638" class="Bound">𝒕</a> <a id="13979" href="Varieties.FreeAlgebras.html#13956" class="Bound">x</a><a id="13980" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="14084" href="Varieties.FreeAlgebras.html#14084" class="Function">ψlemma1</a> <a id="14092" class="Symbol">:</a> <a id="14094" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="14101" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14103" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="14105" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14107" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14109" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="14111" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
 <a id="14114" href="Varieties.FreeAlgebras.html#14084" class="Function">ψlemma1</a> <a id="14122" class="Symbol">{</a><a id="14123" href="Varieties.FreeAlgebras.html#14123" class="Bound">p</a> <a id="14125" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14127" href="Varieties.FreeAlgebras.html#14127" class="Bound">q</a><a id="14128" class="Symbol">}</a> <a id="14130" href="Varieties.FreeAlgebras.html#14130" class="Bound">𝔑pq</a> <a id="14134" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a> <a id="14136" href="Varieties.FreeAlgebras.html#14136" class="Bound">sA</a> <a id="14139" href="Varieties.FreeAlgebras.html#14139" class="Bound">h</a> <a id="14141" class="Symbol">=</a> <a id="14143" href="Varieties.FreeAlgebras.html#14364" class="Function">γ</a>
  <a id="14147" class="Keyword">where</a>
   <a id="14156" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14158" class="Symbol">:</a> <a id="14160" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="14164" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="14166" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a>
   <a id="14171" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14173" class="Symbol">=</a> <a id="14175" href="Varieties.FreeAlgebras.html#12697" class="Function">𝔽-lift-hom</a> <a id="14186" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a> <a id="14188" href="Varieties.FreeAlgebras.html#14136" class="Bound">sA</a> <a id="14191" href="Varieties.FreeAlgebras.html#14139" class="Bound">h</a>

   <a id="14197" href="Varieties.FreeAlgebras.html#14197" class="Function">h&#39;</a> <a id="14200" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14202" class="Symbol">:</a> <a id="14204" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="14208" class="Symbol">(</a><a id="14209" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="14211" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="14212" class="Symbol">)</a> <a id="14214" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a>
   <a id="14219" href="Varieties.FreeAlgebras.html#14197" class="Function">h&#39;</a> <a id="14222" class="Symbol">=</a> <a id="14224" href="Homomorphisms.Properties.html#1366" class="Function">∘-hom</a> <a id="14230" class="Symbol">(</a><a id="14231" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="14233" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="14234" class="Symbol">)</a> <a id="14236" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a> <a id="14238" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="14240" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a>
   <a id="14245" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14247" class="Symbol">=</a> <a id="14249" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="14258" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a> <a id="14260" href="Varieties.FreeAlgebras.html#14139" class="Bound">h</a>

   <a id="14266" href="Varieties.FreeAlgebras.html#14266" class="Function">h≡φ</a> <a id="14270" class="Symbol">:</a> <a id="14272" class="Symbol">∀</a> <a id="14274" href="Varieties.FreeAlgebras.html#14274" class="Bound">t</a> <a id="14276" class="Symbol">→</a> <a id="14278" class="Symbol">(</a><a id="14279" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14281" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14283" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14285" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14287" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14289" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="14291" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="14292" class="Symbol">)</a> <a id="14294" href="Varieties.FreeAlgebras.html#14274" class="Bound">t</a> <a id="14296" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14298" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14300" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14302" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14304" href="Varieties.FreeAlgebras.html#14274" class="Bound">t</a>
   <a id="14309" href="Varieties.FreeAlgebras.html#14266" class="Function">h≡φ</a> <a id="14313" href="Varieties.FreeAlgebras.html#14313" class="Bound">t</a> <a id="14315" class="Symbol">=</a> <a id="14317" href="Terms.Properties.html#3635" class="Function">free-unique</a> <a id="14329" class="Symbol">(</a><a id="14330" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="14333" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14335" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14336" class="Symbol">)</a> <a id="14338" href="Varieties.FreeAlgebras.html#14134" class="Bound">𝑨</a> <a id="14340" href="Varieties.FreeAlgebras.html#14197" class="Function">h&#39;</a> <a id="14343" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14345" class="Symbol">(λ</a> <a id="14348" href="Varieties.FreeAlgebras.html#14348" class="Bound">x</a> <a id="14350" class="Symbol">→</a> <a id="14352" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14356" class="Symbol">)</a> <a id="14358" href="Varieties.FreeAlgebras.html#14313" class="Bound">t</a>

   <a id="14364" href="Varieties.FreeAlgebras.html#14364" class="Function">γ</a> <a id="14366" class="Symbol">:</a> <a id="14368" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14370" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14372" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14374" href="Varieties.FreeAlgebras.html#14123" class="Bound">p</a> <a id="14376" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14378" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14380" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14382" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14384" href="Varieties.FreeAlgebras.html#14127" class="Bound">q</a>
   <a id="14389" href="Varieties.FreeAlgebras.html#14364" class="Function">γ</a> <a id="14391" class="Symbol">=</a> <a id="14393" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14395" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14397" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14399" href="Varieties.FreeAlgebras.html#14123" class="Bound">p</a>             <a id="14413" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14416" class="Symbol">(</a><a id="14417" href="Varieties.FreeAlgebras.html#14266" class="Function">h≡φ</a> <a id="14421" href="Varieties.FreeAlgebras.html#14123" class="Bound">p</a><a id="14422" class="Symbol">)</a><a id="14423" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a> <a id="14426" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14435" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14437" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14439" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14441" class="Symbol">(</a> <a id="14443" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14445" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="14447" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14449" href="Varieties.FreeAlgebras.html#14123" class="Bound">p</a> <a id="14451" class="Symbol">)</a>   <a id="14455" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14458" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14463" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14465" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14467" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14469" href="Varieties.FreeAlgebras.html#14130" class="Bound">𝔑pq</a> <a id="14473" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14482" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14484" href="Varieties.FreeAlgebras.html#14156" class="Function">f</a> <a id="14486" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14488" class="Symbol">(</a> <a id="14490" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14492" href="Varieties.FreeAlgebras.html#13381" class="Function">𝔑</a> <a id="14494" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14496" href="Varieties.FreeAlgebras.html#14127" class="Bound">q</a> <a id="14498" class="Symbol">)</a>   <a id="14502" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14505" href="Varieties.FreeAlgebras.html#14266" class="Function">h≡φ</a> <a id="14509" href="Varieties.FreeAlgebras.html#14127" class="Bound">q</a> <a id="14511" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14520" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14522" href="Varieties.FreeAlgebras.html#14200" class="Function">φ</a> <a id="14524" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14526" href="Varieties.FreeAlgebras.html#14127" class="Bound">q</a>             <a id="14540" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14545" href="Varieties.FreeAlgebras.html#14545" class="Function">ψlemma2</a> <a id="14553" class="Symbol">:</a> <a id="14555" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="14562" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14564" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="14569" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="14571" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14573" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a> <a id="14575" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
 <a id="14578" href="Varieties.FreeAlgebras.html#14545" class="Function">ψlemma2</a> <a id="14586" class="Symbol">{</a><a id="14587" href="Varieties.FreeAlgebras.html#14587" class="Bound">p</a> <a id="14589" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14591" href="Varieties.FreeAlgebras.html#14591" class="Bound">q</a><a id="14592" class="Symbol">}</a> <a id="14594" href="Varieties.FreeAlgebras.html#14594" class="Bound">x</a> <a id="14596" class="Symbol">=</a> <a id="14598" href="Varieties.FreeAlgebras.html#14084" class="Function">ψlemma1</a> <a id="14606" class="Symbol">{</a><a id="14607" href="Varieties.FreeAlgebras.html#14587" class="Bound">p</a> <a id="14609" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14611" href="Varieties.FreeAlgebras.html#14591" class="Bound">q</a><a id="14612" class="Symbol">}</a> <a id="14614" href="Varieties.FreeAlgebras.html#14629" class="Function">γ</a>
   <a id="14619" class="Keyword">where</a>
    <a id="14629" href="Varieties.FreeAlgebras.html#14629" class="Function">γ</a> <a id="14631" class="Symbol">:</a> <a id="14633" class="Symbol">(</a><a id="14634" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14644" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="14646" href="Varieties.FreeAlgebras.html#13282" class="Function">X↪𝔽</a><a id="14649" class="Symbol">)</a> <a id="14651" href="Varieties.FreeAlgebras.html#14587" class="Bound">p</a> <a id="14653" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14655" class="Symbol">(</a><a id="14656" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14666" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="14668" href="Varieties.FreeAlgebras.html#13282" class="Function">X↪𝔽</a><a id="14671" class="Symbol">)</a> <a id="14673" href="Varieties.FreeAlgebras.html#14591" class="Bound">q</a>
    <a id="14679" href="Varieties.FreeAlgebras.html#14629" class="Function">γ</a> <a id="14681" class="Symbol">=</a> <a id="14683" class="Symbol">(</a><a id="14684" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a> <a id="14701" href="Varieties.FreeAlgebras.html#14587" class="Bound">p</a><a id="14702" class="Symbol">)</a> <a id="14704" href="Overture.Preliminaries.html#5410" class="Function Operator">∙</a> <a id="14706" href="Varieties.FreeAlgebras.html#14594" class="Bound">x</a> <a id="14708" href="Overture.Preliminaries.html#5410" class="Function Operator">∙</a> <a id="14710" class="Symbol">(</a><a id="14711" href="Varieties.FreeAlgebras.html#13535" class="Function">hom𝔽-is-lift-hom</a> <a id="14728" href="Varieties.FreeAlgebras.html#14591" class="Bound">q</a><a id="14729" class="Symbol">)</a><a id="14730" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a>


 <a id="14736" href="Varieties.FreeAlgebras.html#14736" class="Function">ψlemma3</a> <a id="14744" class="Symbol">:</a> <a id="14746" class="Symbol">∀</a> <a id="14748" href="Varieties.FreeAlgebras.html#14748" class="Bound">p</a> <a id="14750" href="Varieties.FreeAlgebras.html#14750" class="Bound">q</a> <a id="14752" class="Symbol">→</a> <a id="14754" class="Symbol">(</a><a id="14755" href="Varieties.FreeAlgebras.html#14748" class="Bound">p</a> <a id="14757" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14759" href="Varieties.FreeAlgebras.html#14750" class="Bound">q</a><a id="14760" class="Symbol">)</a> <a id="14762" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14764" href="Varieties.FreeAlgebras.html#6413" class="Function">ψ</a><a id="14765" class="Symbol">{</a><a id="14766" class="Argument">X</a> <a id="14768" class="Symbol">=</a> <a id="14770" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="14771" class="Symbol">}</a> <a id="14773" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="14775" class="Symbol">→</a> <a id="14777" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="14779" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="14781" href="Varieties.FreeAlgebras.html#14748" class="Bound">p</a> <a id="14783" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="14785" href="Varieties.FreeAlgebras.html#14750" class="Bound">q</a>
 <a id="14788" href="Varieties.FreeAlgebras.html#14736" class="Function">ψlemma3</a> <a id="14796" href="Varieties.FreeAlgebras.html#14796" class="Bound">p</a> <a id="14798" href="Varieties.FreeAlgebras.html#14798" class="Bound">q</a> <a id="14800" href="Varieties.FreeAlgebras.html#14800" class="Bound">pψq</a> <a id="14804" class="Symbol">{</a><a id="14805" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a><a id="14806" class="Symbol">}</a> <a id="14808" href="Varieties.FreeAlgebras.html#14808" class="Bound">kA</a> <a id="14811" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a> <a id="14813" class="Symbol">=</a> <a id="14815" href="Varieties.FreeAlgebras.html#14832" class="Function">goal</a>
   <a id="14823" class="Keyword">where</a>
   <a id="14832" href="Varieties.FreeAlgebras.html#14832" class="Function">goal</a> <a id="14837" class="Symbol">:</a> <a id="14839" class="Symbol">(</a><a id="14840" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14842" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14844" href="Varieties.FreeAlgebras.html#14796" class="Bound">p</a> <a id="14846" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14847" class="Symbol">)</a> <a id="14849" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a> <a id="14851" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14853" class="Symbol">(</a><a id="14854" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14856" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14858" href="Varieties.FreeAlgebras.html#14798" class="Bound">q</a> <a id="14860" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14861" class="Symbol">)</a> <a id="14863" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a>
   <a id="14868" href="Varieties.FreeAlgebras.html#14832" class="Function">goal</a> <a id="14873" class="Symbol">=</a> <a id="14875" class="Symbol">(</a><a id="14876" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14878" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14880" href="Varieties.FreeAlgebras.html#14796" class="Bound">p</a> <a id="14882" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14883" class="Symbol">)</a> <a id="14885" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a>       <a id="14893" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14896" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="14913" class="Symbol">(</a><a id="14914" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="14917" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14919" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14920" class="Symbol">)</a> <a id="14922" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14924" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a> <a id="14926" href="Varieties.FreeAlgebras.html#14796" class="Bound">p</a> <a id="14928" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14940" class="Symbol">(</a><a id="14941" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14951" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14953" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a><a id="14954" class="Symbol">)</a> <a id="14956" href="Varieties.FreeAlgebras.html#14796" class="Bound">p</a> <a id="14958" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14961" href="Varieties.FreeAlgebras.html#14800" class="Bound">pψq</a> <a id="14965" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="14967" class="Symbol">(</a><a id="14968" href="Varieties.Closure.html#4060" class="InductiveConstructor">siso</a> <a id="14973" class="Symbol">(</a><a id="14974" href="Varieties.Closure.html#3862" class="InductiveConstructor">sbase</a> <a id="14980" href="Varieties.FreeAlgebras.html#14808" class="Bound">kA</a><a id="14982" class="Symbol">)</a> <a id="14984" class="Symbol">(</a><a id="14985" href="Homomorphisms.Isomorphisms.html#2964" class="Function">≅-sym</a> <a id="14991" href="Homomorphisms.Isomorphisms.html#4408" class="Function">Lift-≅</a><a id="14997" class="Symbol">))</a> <a id="15000" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a> <a id="15002" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="15014" class="Symbol">(</a><a id="15015" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="15025" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="15027" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a><a id="15028" class="Symbol">)</a> <a id="15030" href="Varieties.FreeAlgebras.html#14798" class="Bound">q</a> <a id="15032" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15035" class="Symbol">(</a><a id="15036" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="15053" class="Symbol">(</a><a id="15054" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="15057" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="15059" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15060" class="Symbol">)</a> <a id="15062" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="15064" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a> <a id="15066" href="Varieties.FreeAlgebras.html#14798" class="Bound">q</a><a id="15067" class="Symbol">)</a><a id="15068" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a>  <a id="15072" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="15084" class="Symbol">(</a><a id="15085" href="Varieties.FreeAlgebras.html#14805" class="Bound">𝑨</a> <a id="15087" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="15089" href="Varieties.FreeAlgebras.html#14798" class="Bound">q</a> <a id="15091" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="15092" class="Symbol">)</a> <a id="15094" href="Varieties.FreeAlgebras.html#14811" class="Bound">h</a>       <a id="15102" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="15225" href="Varieties.FreeAlgebras.html#15225" class="Function">class-models-kernel</a> <a id="15245" class="Symbol">:</a> <a id="15247" class="Symbol">∀</a> <a id="15249" href="Varieties.FreeAlgebras.html#15249" class="Bound">p</a> <a id="15251" href="Varieties.FreeAlgebras.html#15251" class="Bound">q</a> <a id="15253" class="Symbol">→</a> <a id="15255" class="Symbol">(</a><a id="15256" href="Varieties.FreeAlgebras.html#15249" class="Bound">p</a> <a id="15258" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15260" href="Varieties.FreeAlgebras.html#15251" class="Bound">q</a><a id="15261" class="Symbol">)</a> <a id="15263" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15265" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15272" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15274" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="15279" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15281" class="Symbol">→</a> <a id="15283" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="15285" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="15287" href="Varieties.FreeAlgebras.html#15249" class="Bound">p</a> <a id="15289" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="15291" href="Varieties.FreeAlgebras.html#15251" class="Bound">q</a>
 <a id="15294" href="Varieties.FreeAlgebras.html#15225" class="Function">class-models-kernel</a> <a id="15314" href="Varieties.FreeAlgebras.html#15314" class="Bound">p</a> <a id="15316" href="Varieties.FreeAlgebras.html#15316" class="Bound">q</a> <a id="15318" href="Varieties.FreeAlgebras.html#15318" class="Bound">x</a> <a id="15320" class="Symbol">=</a> <a id="15322" href="Varieties.FreeAlgebras.html#14736" class="Function">ψlemma3</a> <a id="15330" href="Varieties.FreeAlgebras.html#15314" class="Bound">p</a> <a id="15332" href="Varieties.FreeAlgebras.html#15316" class="Bound">q</a> <a id="15334" class="Symbol">(</a><a id="15335" href="Varieties.FreeAlgebras.html#14545" class="Function">ψlemma2</a> <a id="15343" href="Varieties.FreeAlgebras.html#15318" class="Bound">x</a><a id="15344" class="Symbol">)</a>

 <a id="15348" href="Varieties.FreeAlgebras.html#15348" class="Function">𝕍𝒦</a> <a id="15351" class="Symbol">:</a> <a id="15353" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15358" class="Symbol">(</a><a id="15359" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15367" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="15370" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15371" class="Symbol">)</a> <a id="15373" class="Symbol">(</a><a id="15374" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="15379" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="15381" class="Symbol">)</a>
 <a id="15384" href="Varieties.FreeAlgebras.html#15348" class="Function">𝕍𝒦</a> <a id="15387" class="Symbol">=</a> <a id="15389" href="Varieties.Closure.html#5316" class="Datatype">V</a><a id="15390" class="Symbol">{</a><a id="15391" class="Argument">α</a> <a id="15393" class="Symbol">=</a> <a id="15395" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15396" class="Symbol">}{</a><a id="15398" class="Argument">β</a> <a id="15400" class="Symbol">=</a> <a id="15402" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="15404" class="Symbol">}</a> <a id="15406" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>

 <a id="15410" href="Varieties.FreeAlgebras.html#15410" class="Function">kernel-in-theory&#39;</a> <a id="15428" class="Symbol">:</a> <a id="15430" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15437" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15439" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="15444" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15446" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15448" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15451" class="Symbol">(</a><a id="15452" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="15454" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a><a id="15455" class="Symbol">)</a>
 <a id="15458" href="Varieties.FreeAlgebras.html#15410" class="Function">kernel-in-theory&#39;</a> <a id="15476" class="Symbol">{</a><a id="15477" href="Varieties.FreeAlgebras.html#15477" class="Bound">p</a> <a id="15479" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15481" href="Varieties.FreeAlgebras.html#15481" class="Bound">q</a><a id="15482" class="Symbol">}</a> <a id="15484" href="Varieties.FreeAlgebras.html#15484" class="Bound">pKq</a> <a id="15488" class="Symbol">=</a> <a id="15490" class="Symbol">(</a><a id="15491" href="Varieties.Preservation.html#20465" class="Function">class-ids-⇒</a> <a id="15503" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="15506" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="15509" href="Varieties.FreeAlgebras.html#15477" class="Bound">p</a> <a id="15511" href="Varieties.FreeAlgebras.html#15481" class="Bound">q</a> <a id="15513" class="Symbol">(</a><a id="15514" href="Varieties.FreeAlgebras.html#15225" class="Function">class-models-kernel</a> <a id="15534" href="Varieties.FreeAlgebras.html#15477" class="Bound">p</a> <a id="15536" href="Varieties.FreeAlgebras.html#15481" class="Bound">q</a> <a id="15538" href="Varieties.FreeAlgebras.html#15484" class="Bound">pKq</a><a id="15541" class="Symbol">))</a>

 <a id="15546" href="Varieties.FreeAlgebras.html#15546" class="Function">kernel-in-theory</a> <a id="15563" class="Symbol">:</a> <a id="15565" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15572" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15574" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="15579" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15581" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15583" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15586" href="Varieties.FreeAlgebras.html#15348" class="Function">𝕍𝒦</a>
 <a id="15590" href="Varieties.FreeAlgebras.html#15546" class="Function">kernel-in-theory</a> <a id="15607" class="Symbol">{</a><a id="15608" href="Varieties.FreeAlgebras.html#15608" class="Bound">p</a> <a id="15610" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15612" href="Varieties.FreeAlgebras.html#15612" class="Bound">q</a><a id="15613" class="Symbol">}</a> <a id="15615" href="Varieties.FreeAlgebras.html#15615" class="Bound">pKq</a> <a id="15619" href="Varieties.FreeAlgebras.html#15619" class="Bound">vkA</a> <a id="15623" href="Varieties.FreeAlgebras.html#15623" class="Bound">x</a> <a id="15625" class="Symbol">=</a> <a id="15627" href="Varieties.Preservation.html#20578" class="Function">class-ids</a> <a id="15637" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="15640" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="15643" href="Varieties.FreeAlgebras.html#15608" class="Bound">p</a> <a id="15645" href="Varieties.FreeAlgebras.html#15612" class="Bound">q</a> <a id="15647" class="Symbol">(</a><a id="15648" href="Varieties.FreeAlgebras.html#15225" class="Function">class-models-kernel</a> <a id="15668" href="Varieties.FreeAlgebras.html#15608" class="Bound">p</a> <a id="15670" href="Varieties.FreeAlgebras.html#15612" class="Bound">q</a> <a id="15672" href="Varieties.FreeAlgebras.html#15615" class="Bound">pKq</a><a id="15675" class="Symbol">)</a> <a id="15677" href="Varieties.FreeAlgebras.html#15619" class="Bound">vkA</a> <a id="15681" href="Varieties.FreeAlgebras.html#15623" class="Bound">x</a>

 <a id="15685" href="Varieties.FreeAlgebras.html#15685" class="Function Operator">_↠_</a> <a id="15689" class="Symbol">:</a> <a id="15691" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15696" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="15698" class="Symbol">→</a> <a id="15700" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15708" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="15711" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="15713" class="Symbol">→</a> <a id="15715" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15720" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a>
 <a id="15724" href="Varieties.FreeAlgebras.html#15724" class="Bound">X</a> <a id="15726" href="Varieties.FreeAlgebras.html#15685" class="Function Operator">↠</a> <a id="15728" href="Varieties.FreeAlgebras.html#15728" class="Bound">𝑨</a> <a id="15730" class="Symbol">=</a> <a id="15732" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15735" href="Varieties.FreeAlgebras.html#15735" class="Bound">h</a> <a id="15737" href="Data.Product.html#916" class="Function">∈</a> <a id="15739" class="Symbol">(</a><a id="15740" href="Varieties.FreeAlgebras.html#15724" class="Bound">X</a> <a id="15742" class="Symbol">→</a> <a id="15744" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15746" href="Varieties.FreeAlgebras.html#15728" class="Bound">𝑨</a> <a id="15748" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="15749" class="Symbol">)</a> <a id="15751" href="Data.Product.html#916" class="Function">]</a> <a id="15753" href="Overture.Surjective.html#1391" class="Function">IsSurjective</a> <a id="15766" href="Varieties.FreeAlgebras.html#15735" class="Bound">h</a>

 <a id="15770" href="Varieties.FreeAlgebras.html#15770" class="Function">𝔽-ModTh-epi</a> <a id="15782" class="Symbol">:</a> <a id="15784" class="Symbol">(</a><a id="15785" href="Varieties.FreeAlgebras.html#15785" class="Bound">𝑨</a> <a id="15787" class="Symbol">:</a> <a id="15789" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15797" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="15800" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15801" class="Symbol">)</a> <a id="15803" class="Symbol">→</a> <a id="15805" class="Symbol">(</a><a id="15806" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="15808" href="Varieties.FreeAlgebras.html#15685" class="Function Operator">↠</a> <a id="15810" href="Varieties.FreeAlgebras.html#15785" class="Bound">𝑨</a><a id="15811" class="Symbol">)</a> <a id="15813" class="Symbol">→</a> <a id="15815" href="Varieties.FreeAlgebras.html#15785" class="Bound">𝑨</a> <a id="15817" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15819" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="15823" class="Symbol">(</a><a id="15824" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15827" href="Varieties.FreeAlgebras.html#15348" class="Function">𝕍𝒦</a><a id="15829" class="Symbol">)</a> <a id="15831" class="Symbol">→</a> <a id="15833" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="15837" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="15839" href="Varieties.FreeAlgebras.html#15785" class="Bound">𝑨</a>
 <a id="15842" href="Varieties.FreeAlgebras.html#15770" class="Function">𝔽-ModTh-epi</a> <a id="15854" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="15856" class="Symbol">(</a><a id="15857" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a> <a id="15859" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15861" href="Varieties.FreeAlgebras.html#15861" class="Bound">ηE</a><a id="15863" class="Symbol">)</a> <a id="15865" href="Varieties.FreeAlgebras.html#15865" class="Bound">AinMTV</a> <a id="15872" class="Symbol">=</a> <a id="15874" href="Varieties.FreeAlgebras.html#16386" class="Function">goal</a>
  <a id="15881" class="Keyword">where</a>
  <a id="15889" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="15891" class="Symbol">:</a> <a id="15893" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="15897" class="Symbol">(</a><a id="15898" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="15900" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="15901" class="Symbol">)</a> <a id="15903" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a>
  <a id="15907" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="15909" class="Symbol">=</a> <a id="15911" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="15920" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="15922" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a>

  <a id="15927" href="Varieties.FreeAlgebras.html#15927" class="Function">φE</a> <a id="15930" class="Symbol">:</a> <a id="15932" href="Overture.Surjective.html#1391" class="Function">IsSurjective</a> <a id="15945" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="15947" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="15949" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a>
  <a id="15953" href="Varieties.FreeAlgebras.html#15927" class="Function">φE</a> <a id="15956" class="Symbol">=</a> <a id="15958" href="Terms.Properties.html#4841" class="Function">lift-of-epi-is-epi</a> <a id="15977" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="15979" href="Varieties.FreeAlgebras.html#15861" class="Bound">ηE</a>

  <a id="15985" href="Varieties.FreeAlgebras.html#15985" class="Function">pqlem2</a> <a id="15992" class="Symbol">:</a> <a id="15994" class="Symbol">∀</a> <a id="15996" href="Varieties.FreeAlgebras.html#15996" class="Bound">p</a> <a id="15998" href="Varieties.FreeAlgebras.html#15998" class="Bound">q</a> <a id="16000" class="Symbol">→</a> <a id="16002" class="Symbol">(</a><a id="16003" href="Varieties.FreeAlgebras.html#15996" class="Bound">p</a> <a id="16005" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16007" href="Varieties.FreeAlgebras.html#15998" class="Bound">q</a><a id="16008" class="Symbol">)</a> <a id="16010" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="16012" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="16019" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16021" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="16026" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16028" class="Symbol">→</a> <a id="16030" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16032" href="Varieties.EquationalLogic.html#2638" class="Function Operator">⊧</a> <a id="16034" href="Varieties.FreeAlgebras.html#15996" class="Bound">p</a> <a id="16036" href="Varieties.EquationalLogic.html#2638" class="Function Operator">≈</a> <a id="16038" href="Varieties.FreeAlgebras.html#15998" class="Bound">q</a>
  <a id="16042" href="Varieties.FreeAlgebras.html#15985" class="Function">pqlem2</a> <a id="16049" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a> <a id="16051" href="Varieties.FreeAlgebras.html#16051" class="Bound">q</a> <a id="16053" href="Varieties.FreeAlgebras.html#16053" class="Bound">z</a> <a id="16055" class="Symbol">=</a> <a id="16057" class="Symbol">λ</a> <a id="16059" href="Varieties.FreeAlgebras.html#16059" class="Bound">x</a> <a id="16061" class="Symbol">→</a> <a id="16063" href="Varieties.FreeAlgebras.html#15865" class="Bound">AinMTV</a> <a id="16070" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a> <a id="16072" href="Varieties.FreeAlgebras.html#16051" class="Bound">q</a> <a id="16074" class="Symbol">(</a><a id="16075" href="Varieties.FreeAlgebras.html#15546" class="Function">kernel-in-theory</a> <a id="16092" href="Varieties.FreeAlgebras.html#16053" class="Bound">z</a><a id="16093" class="Symbol">)</a> <a id="16095" href="Varieties.FreeAlgebras.html#16059" class="Bound">x</a>

  <a id="16100" href="Varieties.FreeAlgebras.html#16100" class="Function">kerincl</a> <a id="16108" class="Symbol">:</a> <a id="16110" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="16117" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16119" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="16124" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16126" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="16128" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="16135" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16137" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="16139" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a>
  <a id="16143" href="Varieties.FreeAlgebras.html#16100" class="Function">kerincl</a> <a id="16151" class="Symbol">{</a><a id="16152" href="Varieties.FreeAlgebras.html#16152" class="Bound">p</a> <a id="16154" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16156" href="Varieties.FreeAlgebras.html#16156" class="Bound">q</a><a id="16157" class="Symbol">}</a> <a id="16159" href="Varieties.FreeAlgebras.html#16159" class="Bound">x</a> <a id="16161" class="Symbol">=</a> <a id="16163" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16165" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="16167" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16169" href="Varieties.FreeAlgebras.html#16152" class="Bound">p</a>      <a id="16176" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16179" class="Symbol">(</a><a id="16180" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16197" class="Symbol">(</a><a id="16198" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="16201" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16203" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="16205" class="Symbol">)</a> <a id="16207" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16209" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a> <a id="16211" href="Varieties.FreeAlgebras.html#16152" class="Bound">p</a><a id="16212" class="Symbol">)</a><a id="16213" href="Overture.Preliminaries.html#5086" class="Function Operator">⁻¹</a> <a id="16216" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16240" class="Symbol">(</a><a id="16241" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16243" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16245" href="Varieties.FreeAlgebras.html#16152" class="Bound">p</a> <a id="16247" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16248" class="Symbol">)</a> <a id="16250" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a>  <a id="16253" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16256" href="Varieties.FreeAlgebras.html#15985" class="Function">pqlem2</a> <a id="16263" href="Varieties.FreeAlgebras.html#16152" class="Bound">p</a> <a id="16265" href="Varieties.FreeAlgebras.html#16156" class="Bound">q</a> <a id="16267" href="Varieties.FreeAlgebras.html#16159" class="Bound">x</a> <a id="16269" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a> <a id="16271" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16295" class="Symbol">(</a><a id="16296" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16298" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16300" href="Varieties.FreeAlgebras.html#16156" class="Bound">q</a> <a id="16302" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16303" class="Symbol">)</a> <a id="16305" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a>  <a id="16308" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16311" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16328" class="Symbol">(</a><a id="16329" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="16332" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16334" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="16336" class="Symbol">)</a> <a id="16338" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16340" href="Varieties.FreeAlgebras.html#15857" class="Bound">η</a> <a id="16342" href="Varieties.FreeAlgebras.html#16156" class="Bound">q</a> <a id="16344" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16368" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16370" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="16372" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16374" href="Varieties.FreeAlgebras.html#16156" class="Bound">q</a>      <a id="16381" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16386" href="Varieties.FreeAlgebras.html#16386" class="Function">goal</a> <a id="16391" class="Symbol">:</a> <a id="16393" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="16397" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="16399" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a>
  <a id="16403" href="Varieties.FreeAlgebras.html#16386" class="Function">goal</a> <a id="16408" class="Symbol">=</a> <a id="16410" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a> <a id="16414" class="Symbol">(</a><a id="16415" href="Homomorphisms.Noether.html#9885" class="Function">HomFactorEpi</a> <a id="16428" class="Symbol">(</a><a id="16429" href="Varieties.FreeAlgebras.html#10491" class="Bound">wd</a> <a id="16432" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16434" class="Symbol">(</a><a id="16435" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="16440" class="Symbol">(</a><a id="16441" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16444" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16445" class="Symbol">)))</a> <a id="16449" href="Varieties.FreeAlgebras.html#15854" class="Bound">𝑨</a> <a id="16451" href="Varieties.FreeAlgebras.html#15889" class="Function">φ</a> <a id="16453" href="Varieties.FreeAlgebras.html#11819" class="Function">hom𝔽</a> <a id="16458" href="Varieties.FreeAlgebras.html#16100" class="Function">kerincl</a> <a id="16466" href="Varieties.FreeAlgebras.html#11866" class="Function">hom𝔽-is-epic</a> <a id="16479" href="Varieties.FreeAlgebras.html#15927" class="Function">φE</a><a id="16481" class="Symbol">)</a>

</pre>



#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16841" class="Keyword">module</a> <a id="16848" href="Varieties.FreeAlgebras.html#16848" class="Module">_</a> <a id="16850" class="Symbol">(</a><a id="16851" href="Varieties.FreeAlgebras.html#16851" class="Bound">pe</a> <a id="16854" class="Symbol">:</a> <a id="16856" href="Equality.Extensionality.html#3081" class="Function">pred-ext</a> <a id="16865" class="Symbol">(</a><a id="16866" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16869" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16870" class="Symbol">)(</a><a id="16872" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16875" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16876" class="Symbol">))(</a><a id="16879" href="Varieties.FreeAlgebras.html#16879" class="Bound">wd</a> <a id="16882" class="Symbol">:</a> <a id="16884" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="16892" class="Symbol">)</a> <a id="16894" class="Comment">-- extensionality assumptions</a>
          <a id="16934" class="Symbol">(</a><a id="16935" href="Varieties.FreeAlgebras.html#16935" class="Bound">Cset</a> <a id="16940" class="Symbol">:</a> <a id="16942" href="Equality.Truncation.html#6610" class="Function">is-set</a> <a id="16949" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="16951" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="16953" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="16954" class="Symbol">)</a>                       <a id="16978" class="Comment">-- truncation assumptions</a>
          <a id="17014" class="Symbol">(</a><a id="17015" href="Varieties.FreeAlgebras.html#17015" class="Bound">kuip</a> <a id="17020" class="Symbol">:</a> <a id="17022" href="Equality.Truncation.html#10868" class="Function">blk-uip</a><a id="17029" class="Symbol">(</a><a id="17030" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="17035" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="17036" class="Symbol">)</a><a id="17037" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a> <a id="17039" href="Homomorphisms.Kernels.html#2620" class="Function">kercon</a> <a id="17046" class="Symbol">(</a><a id="17047" href="Varieties.FreeAlgebras.html#16879" class="Bound">wd</a> <a id="17050" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17052" class="Symbol">(</a><a id="17053" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17056" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17057" class="Symbol">)){</a><a id="17060" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a><a id="17061" class="Symbol">}</a><a id="17062" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="17067" href="Overture.Preliminaries.html#4383" class="Function Operator">∣</a><a id="17068" class="Symbol">)</a>
  <a id="17072" class="Keyword">where</a>

  <a id="17081" href="Varieties.FreeAlgebras.html#17081" class="Function">𝔽≤ℭ</a> <a id="17085" class="Symbol">:</a> <a id="17087" class="Symbol">(</a><a id="17088" href="Homomorphisms.Kernels.html#3028" class="Function Operator">ker[</a> <a id="17093" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="17095" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="17097" href="Homomorphisms.Kernels.html#3028" class="Function Operator">⇒</a> <a id="17099" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="17101" href="Homomorphisms.Kernels.html#3028" class="Function Operator">]</a> <a id="17103" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="17108" href="Homomorphisms.Kernels.html#3028" class="Function Operator">↾</a> <a id="17110" class="Symbol">(</a><a id="17111" href="Varieties.FreeAlgebras.html#16879" class="Bound">wd</a> <a id="17114" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17116" class="Symbol">(</a><a id="17117" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17120" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17121" class="Symbol">)))</a> <a id="17125" href="Subalgebras.Subalgebras.html#2186" class="Function Operator">≤</a> <a id="17127" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a>
  <a id="17131" href="Varieties.FreeAlgebras.html#17081" class="Function">𝔽≤ℭ</a> <a id="17135" class="Symbol">=</a> <a id="17137" href="Subalgebras.Subalgebras.html#4012" class="Function">FirstHomCorollary|Set</a> <a id="17159" class="Symbol">(</a><a id="17160" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="17162" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="17163" class="Symbol">)</a> <a id="17165" href="Varieties.FreeAlgebras.html#10890" class="Function">ℭ</a> <a id="17167" href="Varieties.FreeAlgebras.html#11077" class="Function">homℭ</a> <a id="17172" href="Varieties.FreeAlgebras.html#16851" class="Bound">pe</a> <a id="17175" class="Symbol">(</a><a id="17176" href="Varieties.FreeAlgebras.html#16879" class="Bound">wd</a> <a id="17179" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17181" class="Symbol">(</a><a id="17182" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17185" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17186" class="Symbol">))</a> <a id="17189" href="Varieties.FreeAlgebras.html#16935" class="Bound">Cset</a> <a id="17194" href="Varieties.FreeAlgebras.html#17015" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="18257" href="Varieties.FreeAlgebras.html#18257" class="Function">𝔽∈SP</a> <a id="18262" class="Symbol">:</a> <a id="18264" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18272" class="Symbol">(</a><a id="18273" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18276" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18277" class="Symbol">)(</a><a id="18279" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18282" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18283" class="Symbol">)</a> <a id="18285" class="Symbol">→</a> <a id="18287" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="18289" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18291" class="Symbol">(</a><a id="18292" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="18293" class="Symbol">{</a><a id="18294" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="18295" class="Symbol">}{</a><a id="18297" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="18299" class="Symbol">}</a> <a id="18301" class="Symbol">(</a><a id="18302" href="Varieties.Closure.html#4358" class="Datatype">P</a><a id="18303" class="Symbol">{</a><a id="18304" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18305" class="Symbol">}{</a><a id="18307" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="18308" class="Symbol">}</a> <a id="18310" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a><a id="18311" class="Symbol">))</a>
  <a id="18316" href="Varieties.FreeAlgebras.html#18257" class="Function">𝔽∈SP</a> <a id="18321" href="Varieties.FreeAlgebras.html#18321" class="Bound">hfe</a> <a id="18325" class="Symbol">=</a> <a id="18327" href="Varieties.Closure.html#3982" class="InductiveConstructor">ssub</a> <a id="18332" class="Symbol">(</a><a id="18333" href="Varieties.Preservation.html#13066" class="Function">class-prod-s-∈-sp</a> <a id="18351" href="Varieties.FreeAlgebras.html#18321" class="Bound">hfe</a><a id="18354" class="Symbol">)</a> <a id="18356" href="Varieties.FreeAlgebras.html#17081" class="Function">𝔽≤ℭ</a>

  <a id="18363" href="Varieties.FreeAlgebras.html#18363" class="Function">𝔽∈𝕍</a> <a id="18367" class="Symbol">:</a> <a id="18369" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18377" class="Symbol">(</a><a id="18378" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18381" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18382" class="Symbol">)(</a><a id="18384" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18387" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18388" class="Symbol">)</a> <a id="18390" class="Symbol">→</a> <a id="18392" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="18394" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18396" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18398" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
  <a id="18402" href="Varieties.FreeAlgebras.html#18363" class="Function">𝔽∈𝕍</a> <a id="18406" href="Varieties.FreeAlgebras.html#18406" class="Bound">hfe</a> <a id="18410" class="Symbol">=</a> <a id="18412" href="Varieties.Preservation.html#9359" class="Function">SP⊆V&#39;</a> <a id="18418" class="Symbol">{</a><a id="18419" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18420" class="Symbol">}{</a><a id="18422" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="18425" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="18427" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18428" class="Symbol">}{</a><a id="18430" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="18433" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a> <a id="18436" href="Varieties.FreeAlgebras.html#3802" class="Function">𝓕⁺</a><a id="18438" class="Symbol">}{</a><a id="18440" href="Varieties.FreeAlgebras.html#10477" class="Bound">fe</a> <a id="18443" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a> <a id="18445" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="18446" class="Symbol">}{</a><a id="18448" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a><a id="18449" class="Symbol">}</a> <a id="18451" class="Symbol">(</a><a id="18452" href="Varieties.FreeAlgebras.html#18257" class="Function">𝔽∈SP</a> <a id="18457" href="Varieties.FreeAlgebras.html#18406" class="Bound">hfe</a><a id="18460" class="Symbol">)</a>

</pre>

#### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18797" href="Varieties.FreeAlgebras.html#18797" class="Function">Birkhoff</a> <a id="18806" class="Symbol">:</a> <a id="18808" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18816" class="Symbol">(</a><a id="18817" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18820" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18821" class="Symbol">)(</a><a id="18823" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18826" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18827" class="Symbol">)</a> <a id="18829" class="Symbol">→</a> <a id="18831" class="Symbol">(∀</a> <a id="18834" href="Varieties.FreeAlgebras.html#18834" class="Bound">𝑨</a> <a id="18836" class="Symbol">→</a> <a id="18838" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a> <a id="18840" href="Varieties.FreeAlgebras.html#15685" class="Function Operator">↠</a> <a id="18842" href="Varieties.FreeAlgebras.html#18834" class="Bound">𝑨</a><a id="18843" class="Symbol">)</a> <a id="18845" class="Symbol">→</a> <a id="18847" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="18851" class="Symbol">(</a><a id="18852" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="18855" class="Symbol">(</a><a id="18856" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18858" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a><a id="18859" class="Symbol">))</a> <a id="18862" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18864" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18866" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a>
  <a id="18870" href="Varieties.FreeAlgebras.html#18797" class="Function">Birkhoff</a> <a id="18879" href="Varieties.FreeAlgebras.html#18879" class="Bound">hfe</a> <a id="18883" href="Varieties.FreeAlgebras.html#18883" class="Bound">𝕏</a> <a id="18885" class="Symbol">{</a><a id="18886" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a><a id="18887" class="Symbol">}</a> <a id="18889" href="Varieties.FreeAlgebras.html#18889" class="Bound">α</a> <a id="18891" class="Symbol">=</a> <a id="18893" href="Varieties.Closure.html#5597" class="InductiveConstructor">vhimg</a><a id="18898" class="Symbol">{</a><a id="18899" class="Argument">𝑩</a> <a id="18901" class="Symbol">=</a> <a id="18903" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a><a id="18904" class="Symbol">}</a> <a id="18906" class="Symbol">(</a><a id="18907" href="Varieties.FreeAlgebras.html#18363" class="Function">𝔽∈𝕍</a> <a id="18911" href="Varieties.FreeAlgebras.html#18879" class="Bound">hfe</a><a id="18914" class="Symbol">)</a> <a id="18916" class="Symbol">(</a><a id="18917" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a> <a id="18919" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18921" href="Homomorphisms.Basic.html#4758" class="Function">epi-to-hom</a> <a id="18932" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a> <a id="18934" href="Varieties.FreeAlgebras.html#18963" class="Function">φE</a> <a id="18937" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18939" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="18943" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a> <a id="18945" href="Varieties.FreeAlgebras.html#18963" class="Function">φE</a> <a id="18948" href="Overture.Preliminaries.html#4421" class="Function Operator">∥</a><a id="18949" class="Symbol">)</a>
   <a id="18954" class="Keyword">where</a>
   <a id="18963" href="Varieties.FreeAlgebras.html#18963" class="Function">φE</a> <a id="18966" class="Symbol">:</a> <a id="18968" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="18972" href="Varieties.FreeAlgebras.html#11702" class="Function">𝔽</a> <a id="18974" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a>
   <a id="18979" href="Varieties.FreeAlgebras.html#18963" class="Function">φE</a> <a id="18982" class="Symbol">=</a> <a id="18984" href="Varieties.FreeAlgebras.html#15770" class="Function">𝔽-ModTh-epi</a> <a id="18996" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a> <a id="18998" class="Symbol">(</a><a id="18999" href="Varieties.FreeAlgebras.html#18883" class="Bound">𝕏</a> <a id="19001" href="Varieties.FreeAlgebras.html#18886" class="Bound">𝑨</a><a id="19002" class="Symbol">)</a> <a id="19004" href="Varieties.FreeAlgebras.html#18889" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="19262" href="Varieties.FreeAlgebras.html#19262" class="Function">Birkhoff-converse</a> <a id="19280" class="Symbol">:</a> <a id="19282" href="Varieties.Closure.html#5316" class="Datatype">V</a><a id="19283" class="Symbol">{</a><a id="19284" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="19285" class="Symbol">}{</a><a id="19287" href="Varieties.FreeAlgebras.html#3800" class="Function">𝓕</a><a id="19288" class="Symbol">}</a> <a id="19290" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a> <a id="19292" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19294" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a><a id="19297" class="Symbol">{</a><a id="19298" class="Argument">X</a> <a id="19300" class="Symbol">=</a> <a id="19302" href="Varieties.FreeAlgebras.html#10506" class="Bound">X</a><a id="19303" class="Symbol">}</a> <a id="19305" class="Symbol">(</a><a id="19306" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="19309" class="Symbol">(</a><a id="19310" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="19312" href="Varieties.FreeAlgebras.html#10519" class="Bound">𝒦</a><a id="19313" class="Symbol">))</a>
  <a id="19318" href="Varieties.FreeAlgebras.html#19262" class="Function">Birkhoff-converse</a> <a id="19336" href="Varieties.FreeAlgebras.html#19336" class="Bound">α</a> <a id="19338" href="Varieties.FreeAlgebras.html#19338" class="Bound">p</a> <a id="19340" href="Varieties.FreeAlgebras.html#19340" class="Bound">q</a> <a id="19342" href="Varieties.FreeAlgebras.html#19342" class="Bound">pThq</a> <a id="19347" class="Symbol">=</a> <a id="19349" href="Varieties.FreeAlgebras.html#19342" class="Bound">pThq</a> <a id="19354" href="Varieties.FreeAlgebras.html#19336" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.

--------------------------------

<span style="float:left;">[← Varieties.Preservation](Varieties.Preservation.html)</span>
<span style="float:right;">[Varieties.Setoid →](Varieties.Setoid.html)</span>

{% include UALib.Links.md %}
