---
layout: default
title : "Varieties.FreeAlgebras module (Agda Universal Algebra Library)"
date : "2021-03-01"
author: "the agda-algebras development team"
---

### <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="806" class="Symbol">{-#</a> <a id="810" class="Keyword">OPTIONS</a> <a id="818" class="Pragma">--without-K</a> <a id="830" class="Pragma">--exact-split</a> <a id="844" class="Pragma">--safe</a> <a id="851" class="Symbol">#-}</a>


<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Level.html" class="Module">Level</a> <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a> <a id="886" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="890" class="Symbol">to</a> <a id="893" class="Primitive">lsuc</a> <a id="898" class="Symbol">)</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a> <a id="935" href="Algebras.Basic.html#1142" class="Generalizable">𝓞</a> <a id="937" class="Symbol">;</a> <a id="939" href="Algebras.Basic.html#1144" class="Generalizable">𝓥</a> <a id="941" class="Symbol">;</a> <a id="943" href="Algebras.Basic.html#3870" class="Function">Signature</a> <a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">module</a> <a id="963" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="986" class="Symbol">{</a><a id="987" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="989" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="991" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="1000" class="Symbol">}</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="1005" class="Symbol">:</a> <a id="1007" href="Algebras.Basic.html#3870" class="Function">Signature</a> <a id="1017" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="1019" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a><a id="1020" class="Symbol">)</a> <a id="1022" class="Keyword">where</a>

<a id="1029" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">()</a> <a id="1186" class="Keyword">renaming</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1211" class="Symbol">to</a> <a id="1214" class="Function">funext</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1250" class="Keyword">using</a> <a id="1256" class="Symbol">(</a> <a id="1258" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1262" class="Symbol">)</a> <a id="1264" class="Keyword">renaming</a> <a id="1273" class="Symbol">(</a> <a id="1275" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1279" class="Symbol">to</a> <a id="1282" class="Primitive">Type</a> <a id="1287" class="Symbol">)</a>
<a id="1289" class="Keyword">open</a> <a id="1294" class="Keyword">import</a> <a id="1301" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1317" class="Keyword">using</a> <a id="1323" class="Symbol">(</a> <a id="1325" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1329" class="Symbol">;</a> <a id="1331" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1340" class="Symbol">;</a> <a id="1342" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1346" class="Symbol">)</a> <a id="1348" class="Keyword">renaming</a> <a id="1357" class="Symbol">(</a> <a id="1359" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1365" class="Symbol">to</a> <a id="1368" class="Field">fst</a> <a id="1372" class="Symbol">;</a> <a id="1374" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1380" class="Symbol">to</a> <a id="1383" class="Field">snd</a> <a id="1387" class="Symbol">)</a>
<a id="1389" class="Keyword">open</a> <a id="1394" class="Keyword">import</a> <a id="1401" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1417" class="Keyword">using</a> <a id="1423" class="Symbol">(</a> <a id="1425" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1429" class="Symbol">)</a>
<a id="1431" class="Keyword">open</a> <a id="1436" class="Keyword">import</a> <a id="1443" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1459" class="Keyword">using</a> <a id="1465" class="Symbol">(</a> <a id="1467" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1481" class="Symbol">)</a> <a id="1483" class="Keyword">renaming</a> <a id="1492" class="Symbol">(</a> <a id="1494" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1498" class="Symbol">to</a> <a id="1501" class="Function">BinRel</a> <a id="1508" class="Symbol">)</a>
<a id="1510" class="Keyword">open</a> <a id="1515" class="Keyword">import</a> <a id="1522" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1588" class="Keyword">using</a> <a id="1594" class="Symbol">(</a> <a id="1596" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1614" class="Symbol">;</a> <a id="1616" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1625" class="Symbol">;</a> <a id="1627" class="Keyword">module</a> <a id="1634" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1646" class="Symbol">)</a>
<a id="1648" class="Keyword">open</a> <a id="1653" class="Keyword">import</a> <a id="1660" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1676" class="Keyword">using</a>    <a id="1685" class="Symbol">(</a> <a id="1687" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1692" class="Symbol">;</a> <a id="1694" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1698" class="Symbol">;</a> <a id="1700" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1704" class="Symbol">;</a> <a id="1706" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1710" class="Symbol">;</a> <a id="1712" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1716" class="Symbol">)</a>

<a id="1719" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1814" class="Keyword">open</a> <a id="1819" class="Keyword">import</a> <a id="1826" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1861" class="Keyword">using</a> <a id="1867" class="Symbol">(</a> <a id="1869" href="Overture.Preliminaries.html#4379" class="Function Operator">∣_∣</a> <a id="1873" class="Symbol">;</a> <a id="1875" href="Overture.Preliminaries.html#4417" class="Function Operator">∥_∥</a> <a id="1879" class="Symbol">;</a> <a id="1881" href="Overture.Preliminaries.html#5406" class="Function Operator">_∙_</a> <a id="1885" class="Symbol">;</a> <a id="1887" href="Overture.Preliminaries.html#5082" class="Function Operator">_⁻¹</a> <a id="1891" class="Symbol">)</a>
<a id="1893" class="Keyword">open</a> <a id="1898" class="Keyword">import</a> <a id="1905" href="Overture.Inverses.html" class="Module">Overture.Inverses</a>                  <a id="1940" class="Keyword">using</a> <a id="1946" class="Symbol">(</a> <a id="1948" href="Overture.Inverses.html#3374" class="Function">IsSurjective</a> <a id="1961" class="Symbol">)</a>
<a id="1963" class="Keyword">open</a> <a id="1968" class="Keyword">import</a> <a id="1975" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2010" class="Keyword">using</a> <a id="2016" class="Symbol">(</a> <a id="2018" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="2025" class="Symbol">)</a>
<a id="2027" class="Keyword">open</a> <a id="2032" class="Keyword">import</a> <a id="2039" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2074" class="Keyword">using</a> <a id="2080" class="Symbol">(</a> <a id="2082" href="Relations.Quotients.html#5384" class="Function Operator">⟪_⟫</a> <a id="2086" class="Symbol">)</a>
<a id="2088" class="Keyword">open</a> <a id="2093" class="Keyword">import</a> <a id="2100" href="Equality.Welldefined.html" class="Module">Equality.Welldefined</a>               <a id="2135" class="Keyword">using</a> <a id="2141" class="Symbol">(</a> <a id="2143" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a> <a id="2152" class="Symbol">;</a> <a id="2154" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="2163" class="Symbol">)</a>
<a id="2165" class="Keyword">open</a> <a id="2170" class="Keyword">import</a> <a id="2177" href="Equality.Truncation.html" class="Module">Equality.Truncation</a>                <a id="2212" class="Keyword">using</a> <a id="2218" class="Symbol">(</a> <a id="2220" href="Equality.Truncation.html#6610" class="Function">is-set</a> <a id="2227" class="Symbol">;</a> <a id="2229" href="Equality.Truncation.html#10868" class="Function">blk-uip</a> <a id="2237" class="Symbol">;</a> <a id="2239" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="2247" class="Symbol">)</a>
<a id="2249" class="Keyword">open</a> <a id="2254" class="Keyword">import</a> <a id="2261" href="Equality.Extensionality.html" class="Module">Equality.Extensionality</a>            <a id="2296" class="Keyword">using</a> <a id="2302" class="Symbol">(</a> <a id="2304" href="Equality.Extensionality.html#2455" class="Function">DFunExt</a><a id="2311" class="Symbol">;</a> <a id="2313" href="Equality.Extensionality.html#3272" class="Function">pred-ext</a> <a id="2322" class="Symbol">)</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2371" class="Keyword">using</a> <a id="2377" class="Symbol">(</a> <a id="2379" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="2387" class="Symbol">;</a> <a id="2389" href="Algebras.Basic.html#10870" class="Function">Lift-Alg</a> <a id="2398" class="Symbol">;</a> <a id="2400" href="Algebras.Basic.html#12420" class="Function">compatible</a> <a id="2411" class="Symbol">;</a> <a id="2413" href="Algebras.Basic.html#9409" class="Function Operator">_̂_</a> <a id="2417" class="Symbol">)</a>
<a id="2419" class="Keyword">open</a> <a id="2424" class="Keyword">import</a> <a id="2431" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2458" class="Symbol">{</a><a id="2459" class="Argument">𝑆</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2464" class="Symbol">}</a> <a id="2466" class="Keyword">using</a> <a id="2472" class="Symbol">(</a> <a id="2474" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="2477" class="Symbol">;</a> <a id="2479" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="2481" class="Symbol">)</a>
<a id="2483" class="Keyword">open</a> <a id="2488" class="Keyword">import</a> <a id="2495" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2522" class="Symbol">{</a><a id="2523" class="Argument">𝑆</a> <a id="2525" class="Symbol">=</a> <a id="2527" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2528" class="Symbol">}</a> <a id="2530" class="Keyword">using</a> <a id="2536" class="Symbol">(</a> <a id="2538" href="Algebras.Congruences.html#1986" class="Function">Con</a><a id="2541" class="Symbol">;</a> <a id="2543" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="2549" class="Symbol">;</a> <a id="2551" href="Algebras.Congruences.html#1800" class="Record">IsCongruence</a> <a id="2564" class="Symbol">)</a>
<a id="2566" class="Keyword">open</a> <a id="2571" class="Keyword">import</a> <a id="2578" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2605" class="Symbol">{</a><a id="2606" class="Argument">𝑆</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2611" class="Symbol">}</a> <a id="2613" class="Keyword">using</a> <a id="2619" class="Symbol">(</a> <a id="2621" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="2625" class="Symbol">;</a> <a id="2627" href="Homomorphisms.Basic.html#11253" class="Function">⨅-hom-co</a> <a id="2636" class="Symbol">;</a> <a id="2638" href="Homomorphisms.Basic.html#8562" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2650" class="Symbol">;</a> <a id="2652" href="Homomorphisms.Basic.html#6477" class="Function">epi</a>
                                                     <a id="2709" class="Symbol">;</a> <a id="2711" href="Homomorphisms.Basic.html#10056" class="Function">πker</a> <a id="2716" class="Symbol">;</a> <a id="2718" href="Homomorphisms.Basic.html#6944" class="Function">epi-to-hom</a> <a id="2729" class="Symbol">;</a> <a id="2731" href="Homomorphisms.Basic.html#10565" class="Function">ker-in-con</a>
                                                     <a id="2795" class="Symbol">;</a>  <a id="2798" href="Homomorphisms.Basic.html#8154" class="Function">kercon</a> <a id="2805" class="Symbol">;</a> <a id="2807" href="Homomorphisms.Basic.html#3506" class="Function">∘-hom</a> <a id="2813" class="Symbol">)</a>
<a id="2815" class="Keyword">open</a> <a id="2820" class="Keyword">import</a> <a id="2827" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2854" class="Symbol">{</a><a id="2855" class="Argument">𝑆</a> <a id="2857" class="Symbol">=</a> <a id="2859" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2860" class="Symbol">}</a> <a id="2862" class="Keyword">using</a> <a id="2868" class="Symbol">(</a> <a id="2870" href="Homomorphisms.Noether.html#8578" class="Function">HomFactor</a> <a id="2880" class="Symbol">;</a> <a id="2882" href="Homomorphisms.Noether.html#9852" class="Function">HomFactorEpi</a> <a id="2895" class="Symbol">)</a>
<a id="2897" class="Keyword">open</a> <a id="2902" class="Keyword">import</a> <a id="2909" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2936" class="Symbol">{</a><a id="2937" class="Argument">𝑆</a> <a id="2939" class="Symbol">=</a> <a id="2941" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2942" class="Symbol">}</a> <a id="2944" class="Keyword">using</a> <a id="2950" class="Symbol">(</a> <a id="2952" href="Homomorphisms.Isomorphisms.html#2280" class="Record Operator">_≅_</a> <a id="2956" class="Symbol">;</a> <a id="2958" href="Homomorphisms.Isomorphisms.html#2821" class="Function">≅-refl</a> <a id="2965" class="Symbol">;</a> <a id="2967" href="Homomorphisms.Isomorphisms.html#2911" class="Function">≅-sym</a> <a id="2973" class="Symbol">;</a> <a id="2975" href="Homomorphisms.Isomorphisms.html#4355" class="Function">Lift-≅</a> <a id="2982" class="Symbol">)</a>
<a id="2984" class="Keyword">open</a> <a id="2989" class="Keyword">import</a> <a id="2996" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3023" class="Symbol">{</a><a id="3024" class="Argument">𝑆</a> <a id="3026" class="Symbol">=</a> <a id="3028" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3029" class="Symbol">}</a> <a id="3031" class="Keyword">using</a> <a id="3037" class="Symbol">(</a> <a id="3039" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="3044" class="Symbol">;</a> <a id="3046" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="3048" class="Symbol">)</a>
<a id="3050" class="Keyword">open</a> <a id="3055" class="Keyword">import</a> <a id="3062" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3089" class="Symbol">{</a><a id="3090" class="Argument">𝑆</a> <a id="3092" class="Symbol">=</a> <a id="3094" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3095" class="Symbol">}</a> <a id="3097" class="Keyword">using</a> <a id="3103" class="Symbol">(</a> <a id="3105" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="3115" class="Symbol">;</a> <a id="3117" href="Terms.Properties.html#3183" class="Function">lift-hom</a>
                                                     <a id="3179" class="Symbol">;</a> <a id="3181" href="Terms.Properties.html#3582" class="Function">free-unique</a> <a id="3193" class="Symbol">;</a> <a id="3195" href="Terms.Properties.html#4788" class="Function">lift-of-epi-is-epi</a> <a id="3214" class="Symbol">)</a>
<a id="3216" class="Keyword">open</a> <a id="3221" class="Keyword">import</a> <a id="3228" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3255" class="Symbol">{</a><a id="3256" class="Argument">𝑆</a> <a id="3258" class="Symbol">=</a> <a id="3260" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3261" class="Symbol">}</a> <a id="3263" class="Keyword">using</a> <a id="3269" class="Symbol">(</a> <a id="3271" href="Terms.Operations.html#2577" class="Function Operator">_⟦_⟧</a><a id="3275" class="Symbol">;</a> <a id="3277" href="Terms.Operations.html#6584" class="Function">comm-hom-term</a><a id="3290" class="Symbol">;</a> <a id="3292" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="3309" class="Symbol">)</a>
<a id="3311" class="Keyword">open</a> <a id="3316" class="Keyword">import</a> <a id="3323" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3350" class="Symbol">{</a><a id="3351" class="Argument">𝑆</a> <a id="3353" class="Symbol">=</a> <a id="3355" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3356" class="Symbol">}</a> <a id="3358" class="Keyword">using</a> <a id="3364" class="Symbol">(</a> <a id="3366" href="Subalgebras.Subalgebras.html#2483" class="Function Operator">_≤_</a> <a id="3370" class="Symbol">;</a> <a id="3372" href="Subalgebras.Subalgebras.html#4309" class="Function">FirstHomCorollary|Set</a> <a id="3394" class="Symbol">)</a>
<a id="3396" class="Keyword">open</a> <a id="3401" class="Keyword">import</a> <a id="3408" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3435" class="Symbol">{</a><a id="3436" class="Argument">𝑆</a> <a id="3438" class="Symbol">=</a> <a id="3440" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3441" class="Symbol">}</a> <a id="3443" class="Keyword">using</a> <a id="3449" class="Symbol">(</a> <a id="3451" href="Varieties.EquationalLogic.html#2716" class="Function Operator">_⊫_≈_</a><a id="3456" class="Symbol">;</a> <a id="3458" href="Varieties.EquationalLogic.html#2638" class="Function Operator">_⊧_≈_</a><a id="3463" class="Symbol">;</a> <a id="3465" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a><a id="3467" class="Symbol">;</a> <a id="3469" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="3473" class="Symbol">)</a>
<a id="3475" class="Keyword">open</a> <a id="3480" class="Keyword">import</a> <a id="3487" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3514" class="Symbol">{</a><a id="3515" class="Argument">𝑆</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3520" class="Symbol">}</a> <a id="3522" class="Keyword">using</a> <a id="3528" class="Symbol">(</a> <a id="3530" href="Varieties.Closure.html#3774" class="Datatype">S</a> <a id="3532" class="Symbol">;</a> <a id="3534" href="Varieties.Closure.html#4358" class="Datatype">P</a> <a id="3536" class="Symbol">;</a> <a id="3538" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="3540" class="Symbol">)</a>
<a id="3542" class="Keyword">open</a> <a id="3547" class="Keyword">import</a> <a id="3554" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3581" class="Symbol">{</a><a id="3582" class="Argument">𝑆</a> <a id="3584" class="Symbol">=</a> <a id="3586" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3587" class="Symbol">}</a> <a id="3589" class="Keyword">using</a> <a id="3595" class="Symbol">(</a> <a id="3597" class="Keyword">module</a> <a id="3604" href="Varieties.Preservation.html#10484" class="Module">class-products-with-maps</a>
                                                     <a id="3682" class="Symbol">;</a> <a id="3684" href="Varieties.Preservation.html#20396" class="Function">class-ids-⇒</a> <a id="3696" class="Symbol">;</a> <a id="3698" href="Varieties.Preservation.html#20509" class="Function">class-ids</a> <a id="3708" class="Symbol">;</a> <a id="3710" href="Varieties.Preservation.html#9299" class="Function">SP⊆V&#39;</a><a id="3715" class="Symbol">)</a>
<a id="3717" class="Keyword">open</a> <a id="3722" href="Terms.Basic.html#1991" class="Module">Term</a>
<a id="3727" class="Keyword">open</a> <a id="3732" href="Varieties.Closure.html#3774" class="Module">S</a>
<a id="3734" class="Keyword">open</a> <a id="3739" href="Varieties.Closure.html#5316" class="Module">V</a>

<a id="𝓕"></a><a id="3742" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3744" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="3747" class="Symbol">:</a> <a id="3749" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3755" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="3757" class="Symbol">=</a> <a id="3759" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3762" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a>
<a id="3764" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="3767" class="Symbol">=</a> <a id="3769" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="3774" class="Symbol">(</a><a id="3775" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3778" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="3779" class="Symbol">)</a>    <a id="3784" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.



#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6299" class="Keyword">module</a> <a id="6306" href="Varieties.FreeAlgebras.html#6306" class="Module">_</a> <a id="6308" class="Symbol">{</a><a id="6309" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a> <a id="6311" class="Symbol">:</a> <a id="6313" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="6318" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6319" class="Symbol">}(</a><a id="6321" href="Varieties.FreeAlgebras.html#6321" class="Bound">𝒦</a> <a id="6323" class="Symbol">:</a> <a id="6325" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6330" class="Symbol">(</a><a id="6331" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="6339" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6341" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6342" class="Symbol">)</a> <a id="6344" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="6345" class="Symbol">)</a> <a id="6347" class="Keyword">where</a>

 <a id="6355" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="6357" class="Symbol">:</a> <a id="6359" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6364" class="Symbol">(</a><a id="6365" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6367" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6369" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a> <a id="6371" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6373" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6375" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6377" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6379" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a> <a id="6381" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="6382" class="Symbol">)</a> <a id="6384" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a>
 <a id="6387" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="6389" class="Symbol">(</a><a id="6390" href="Varieties.FreeAlgebras.html#6390" class="Bound">p</a> <a id="6392" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6394" href="Varieties.FreeAlgebras.html#6394" class="Bound">q</a><a id="6395" class="Symbol">)</a> <a id="6397" class="Symbol">=</a> <a id="6399" class="Symbol">∀(</a><a id="6401" href="Varieties.FreeAlgebras.html#6401" class="Bound">𝑨</a> <a id="6403" class="Symbol">:</a> <a id="6405" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="6413" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6415" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6416" class="Symbol">)(</a><a id="6418" href="Varieties.FreeAlgebras.html#6418" class="Bound">sA</a> <a id="6421" class="Symbol">:</a> <a id="6423" href="Varieties.FreeAlgebras.html#6401" class="Bound">𝑨</a> <a id="6425" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6427" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="6428" class="Symbol">{</a><a id="6429" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6430" class="Symbol">}{</a><a id="6432" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6433" class="Symbol">}</a> <a id="6435" href="Varieties.FreeAlgebras.html#6321" class="Bound">𝒦</a><a id="6436" class="Symbol">)(</a><a id="6438" href="Varieties.FreeAlgebras.html#6438" class="Bound">h</a> <a id="6440" class="Symbol">:</a> <a id="6442" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a> <a id="6444" class="Symbol">→</a> <a id="6446" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6448" href="Varieties.FreeAlgebras.html#6401" class="Bound">𝑨</a> <a id="6450" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6452" class="Symbol">)</a>
                 <a id="6471" class="Symbol">→</a>  <a id="6474" class="Symbol">(</a><a id="6475" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="6485" href="Varieties.FreeAlgebras.html#6401" class="Bound">𝑨</a> <a id="6487" href="Varieties.FreeAlgebras.html#6438" class="Bound">h</a><a id="6488" class="Symbol">)</a> <a id="6490" href="Varieties.FreeAlgebras.html#6390" class="Bound">p</a> <a id="6492" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6494" class="Symbol">(</a><a id="6495" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="6505" href="Varieties.FreeAlgebras.html#6401" class="Bound">𝑨</a> <a id="6507" href="Varieties.FreeAlgebras.html#6438" class="Bound">h</a><a id="6508" class="Symbol">)</a> <a id="6510" href="Varieties.FreeAlgebras.html#6394" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6639" href="Varieties.FreeAlgebras.html#6639" class="Function">ψRel</a> <a id="6644" class="Symbol">:</a> <a id="6646" href="Varieties.FreeAlgebras.html#1501" class="Function">BinRel</a> <a id="6653" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6655" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6657" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a> <a id="6659" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="6661" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a>
 <a id="6664" href="Varieties.FreeAlgebras.html#6639" class="Function">ψRel</a> <a id="6669" href="Varieties.FreeAlgebras.html#6669" class="Bound">p</a> <a id="6671" href="Varieties.FreeAlgebras.html#6671" class="Bound">q</a> <a id="6673" class="Symbol">=</a> <a id="6675" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="6677" class="Symbol">(</a><a id="6678" href="Varieties.FreeAlgebras.html#6669" class="Bound">p</a> <a id="6680" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6682" href="Varieties.FreeAlgebras.html#6671" class="Bound">q</a><a id="6683" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6931" class="Keyword">open</a> <a id="6936" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6950" href="Varieties.FreeAlgebras.html#6950" class="Function">ψcompatible</a> <a id="6962" class="Symbol">:</a> <a id="6964" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="6973" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="6975" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6977" class="Symbol">→</a> <a id="6979" href="Algebras.Basic.html#12420" class="Function">compatible</a> <a id="6990" class="Symbol">(</a><a id="6991" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="6993" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="6994" class="Symbol">)</a> <a id="6996" href="Varieties.FreeAlgebras.html#6639" class="Function">ψRel</a>
 <a id="7002" href="Varieties.FreeAlgebras.html#6950" class="Function">ψcompatible</a> <a id="7014" href="Varieties.FreeAlgebras.html#7014" class="Bound">wd</a> <a id="7017" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7019" class="Symbol">{</a><a id="7020" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a><a id="7021" class="Symbol">}</a> <a id="7023" class="Symbol">{</a><a id="7024" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7025" class="Symbol">}</a> <a id="7027" href="Varieties.FreeAlgebras.html#7027" class="Bound">ψpq</a> <a id="7031" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a> <a id="7033" href="Varieties.FreeAlgebras.html#7033" class="Bound">sA</a> <a id="7036" href="Varieties.FreeAlgebras.html#7036" class="Bound">h</a> <a id="7038" class="Symbol">=</a> <a id="7040" href="Varieties.FreeAlgebras.html#7090" class="Function">γ</a>
  <a id="7044" class="Keyword">where</a>
  <a id="7052" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7054" class="Symbol">:</a> <a id="7056" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="7060" class="Symbol">(</a><a id="7061" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7063" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7064" class="Symbol">)</a> <a id="7066" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a>
  <a id="7070" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7072" class="Symbol">=</a> <a id="7074" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="7083" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a> <a id="7085" href="Varieties.FreeAlgebras.html#7036" class="Bound">h</a>

  <a id="7090" href="Varieties.FreeAlgebras.html#7090" class="Function">γ</a> <a id="7092" class="Symbol">:</a> <a id="7094" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7096" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7098" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7100" class="Symbol">((</a><a id="7102" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7104" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7106" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7108" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7109" class="Symbol">)</a> <a id="7111" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a><a id="7112" class="Symbol">)</a> <a id="7114" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7116" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7118" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7120" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7122" class="Symbol">((</a><a id="7124" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7126" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7128" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7130" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7131" class="Symbol">)</a> <a id="7133" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7134" class="Symbol">)</a>

  <a id="7139" href="Varieties.FreeAlgebras.html#7090" class="Function">γ</a> <a id="7141" class="Symbol">=</a> <a id="7143" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7145" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7147" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7149" class="Symbol">((</a><a id="7151" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7153" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7155" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7157" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7158" class="Symbol">)</a> <a id="7160" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a><a id="7161" class="Symbol">)</a>  <a id="7164" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7167" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="7169" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7171" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="7173" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7175" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a> <a id="7177" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7185" class="Symbol">(</a><a id="7186" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7188" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7190" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a><a id="7191" class="Symbol">)</a> <a id="7193" class="Symbol">(</a><a id="7194" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7196" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7198" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7200" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7202" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a><a id="7203" class="Symbol">)</a>  <a id="7206" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7209" href="Varieties.FreeAlgebras.html#7014" class="Bound">wd</a> <a id="7212" class="Symbol">(</a><a id="7213" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7215" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7217" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a><a id="7218" class="Symbol">)(</a><a id="7220" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7222" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7224" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7226" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7228" href="Varieties.FreeAlgebras.html#7020" class="Bound">p</a><a id="7229" class="Symbol">)(</a><a id="7231" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7233" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7235" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7237" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7239" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7240" class="Symbol">)(λ</a> <a id="7244" href="Varieties.FreeAlgebras.html#7244" class="Bound">x</a> <a id="7246" class="Symbol">→</a> <a id="7248" href="Varieties.FreeAlgebras.html#7027" class="Bound">ψpq</a> <a id="7252" href="Varieties.FreeAlgebras.html#7244" class="Bound">x</a> <a id="7254" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a> <a id="7256" href="Varieties.FreeAlgebras.html#7033" class="Bound">sA</a> <a id="7259" href="Varieties.FreeAlgebras.html#7036" class="Bound">h</a><a id="7260" class="Symbol">)</a> <a id="7262" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7270" class="Symbol">(</a><a id="7271" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7273" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7275" href="Varieties.FreeAlgebras.html#7031" class="Bound">𝑨</a><a id="7276" class="Symbol">)</a> <a id="7278" class="Symbol">(</a><a id="7279" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7281" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7283" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7285" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7287" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7288" class="Symbol">)</a>  <a id="7291" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7294" class="Symbol">(</a><a id="7295" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="7297" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7299" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="7301" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7303" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7304" class="Symbol">)</a><a id="7305" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a> <a id="7308" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7316" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7318" href="Varieties.FreeAlgebras.html#7052" class="Function">φ</a> <a id="7320" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="7322" class="Symbol">((</a><a id="7324" href="Varieties.FreeAlgebras.html#7017" class="Bound">𝑓</a> <a id="7326" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="7328" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7330" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7331" class="Symbol">)</a> <a id="7333" href="Varieties.FreeAlgebras.html#7024" class="Bound">q</a><a id="7334" class="Symbol">)</a>  <a id="7337" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7341" href="Varieties.FreeAlgebras.html#7341" class="Function">ψIsEquivalence</a> <a id="7356" class="Symbol">:</a> <a id="7358" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7372" href="Varieties.FreeAlgebras.html#6639" class="Function">ψRel</a>
 <a id="7378" href="Varieties.FreeAlgebras.html#7341" class="Function">ψIsEquivalence</a> <a id="7393" class="Symbol">=</a> <a id="7395" class="Keyword">record</a> <a id="7402" class="Symbol">{</a> <a id="7404" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7409" class="Symbol">=</a> <a id="7411" class="Symbol">λ</a> <a id="7413" href="Varieties.FreeAlgebras.html#7413" class="Bound">𝑨</a> <a id="7415" href="Varieties.FreeAlgebras.html#7415" class="Bound">sA</a> <a id="7418" href="Varieties.FreeAlgebras.html#7418" class="Bound">h</a> <a id="7420" class="Symbol">→</a> <a id="7422" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7452" class="Symbol">;</a> <a id="7454" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7458" class="Symbol">=</a> <a id="7460" class="Symbol">λ</a> <a id="7462" href="Varieties.FreeAlgebras.html#7462" class="Bound">x</a> <a id="7464" href="Varieties.FreeAlgebras.html#7464" class="Bound">𝑨</a> <a id="7466" href="Varieties.FreeAlgebras.html#7466" class="Bound">sA</a> <a id="7469" href="Varieties.FreeAlgebras.html#7469" class="Bound">h</a> <a id="7471" class="Symbol">→</a> <a id="7473" class="Symbol">(</a><a id="7474" href="Varieties.FreeAlgebras.html#7462" class="Bound">x</a> <a id="7476" href="Varieties.FreeAlgebras.html#7464" class="Bound">𝑨</a> <a id="7478" href="Varieties.FreeAlgebras.html#7466" class="Bound">sA</a> <a id="7481" href="Varieties.FreeAlgebras.html#7469" class="Bound">h</a><a id="7482" class="Symbol">)</a><a id="7483" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a>
                         <a id="7511" class="Symbol">;</a> <a id="7513" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7519" class="Symbol">=</a> <a id="7521" class="Symbol">λ</a> <a id="7523" href="Varieties.FreeAlgebras.html#7523" class="Bound">pψq</a> <a id="7527" href="Varieties.FreeAlgebras.html#7527" class="Bound">qψr</a> <a id="7531" href="Varieties.FreeAlgebras.html#7531" class="Bound">𝑨</a> <a id="7533" href="Varieties.FreeAlgebras.html#7533" class="Bound">sA</a> <a id="7536" href="Varieties.FreeAlgebras.html#7536" class="Bound">h</a> <a id="7538" class="Symbol">→</a> <a id="7540" class="Symbol">(</a><a id="7541" href="Varieties.FreeAlgebras.html#7523" class="Bound">pψq</a> <a id="7545" href="Varieties.FreeAlgebras.html#7531" class="Bound">𝑨</a> <a id="7547" href="Varieties.FreeAlgebras.html#7533" class="Bound">sA</a> <a id="7550" href="Varieties.FreeAlgebras.html#7536" class="Bound">h</a><a id="7551" class="Symbol">)</a> <a id="7553" href="Overture.Preliminaries.html#5406" class="Function Operator">∙</a> <a id="7555" class="Symbol">(</a><a id="7556" href="Varieties.FreeAlgebras.html#7527" class="Bound">qψr</a> <a id="7560" href="Varieties.FreeAlgebras.html#7531" class="Bound">𝑨</a> <a id="7562" href="Varieties.FreeAlgebras.html#7533" class="Bound">sA</a> <a id="7565" href="Varieties.FreeAlgebras.html#7536" class="Bound">h</a><a id="7566" class="Symbol">)</a> <a id="7568" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7868" href="Varieties.FreeAlgebras.html#7868" class="Function">ψCon</a> <a id="7873" class="Symbol">:</a> <a id="7875" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="7884" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="7886" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="7888" class="Symbol">→</a> <a id="7890" href="Algebras.Congruences.html#1986" class="Function">Con</a> <a id="7894" class="Symbol">(</a><a id="7895" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="7897" href="Varieties.FreeAlgebras.html#6309" class="Bound">X</a><a id="7898" class="Symbol">)</a>
 <a id="7901" href="Varieties.FreeAlgebras.html#7868" class="Function">ψCon</a> <a id="7906" href="Varieties.FreeAlgebras.html#7906" class="Bound">wd</a> <a id="7909" class="Symbol">=</a> <a id="7911" href="Varieties.FreeAlgebras.html#6639" class="Function">ψRel</a> <a id="7916" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7918" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="7924" href="Varieties.FreeAlgebras.html#7341" class="Function">ψIsEquivalence</a> <a id="7939" class="Symbol">(</a><a id="7940" href="Varieties.FreeAlgebras.html#6950" class="Function">ψcompatible</a> <a id="7952" href="Varieties.FreeAlgebras.html#7906" class="Bound">wd</a><a id="7954" class="Symbol">)</a>

</pre>



#### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10409" class="Keyword">module</a> <a id="10416" href="Varieties.FreeAlgebras.html#10416" class="Module">_</a> <a id="10418" class="Symbol">{</a><a id="10419" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="10422" class="Symbol">:</a> <a id="10424" href="Equality.Extensionality.html#2455" class="Function">DFunExt</a><a id="10431" class="Symbol">}{</a><a id="10433" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="10436" class="Symbol">:</a> <a id="10438" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="10446" class="Symbol">}{</a><a id="10448" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="10450" class="Symbol">:</a> <a id="10452" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="10457" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10458" class="Symbol">}</a> <a id="10460" class="Symbol">{</a><a id="10461" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="10463" class="Symbol">:</a> <a id="10465" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10470" class="Symbol">(</a><a id="10471" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="10479" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="10481" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="10482" class="Symbol">)</a> <a id="10484" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="10485" class="Symbol">}</a> <a id="10487" class="Keyword">where</a>

 <a id="10495" class="Keyword">open</a> <a id="10500" href="Varieties.Preservation.html#10484" class="Module">class-products-with-maps</a> <a id="10525" class="Symbol">{</a><a id="10526" class="Argument">X</a> <a id="10528" class="Symbol">=</a> <a id="10530" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="10531" class="Symbol">}{</a><a id="10533" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="10536" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10538" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10539" class="Symbol">}{</a><a id="10541" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="10544" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="10547" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="10549" class="Symbol">}{</a><a id="10551" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="10554" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10556" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="10557" class="Symbol">}</a> <a id="10559" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10774" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10832" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="10834" class="Symbol">:</a> <a id="10836" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="10844" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10846" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="10849" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="10851" class="Symbol">=</a> <a id="10853" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="10855" href="Varieties.Preservation.html#11901" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="11019" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="11024" class="Symbol">:</a> <a id="11026" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="11030" class="Symbol">(</a><a id="11031" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11033" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="11034" class="Symbol">)</a> <a id="11036" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a>
 <a id="11039" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="11044" class="Symbol">=</a> <a id="11046" href="Homomorphisms.Basic.html#11253" class="Function">⨅-hom-co</a> <a id="11055" href="Varieties.Preservation.html#11901" class="Function">𝔄&#39;</a> <a id="11058" class="Symbol">(</a><a id="11059" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="11062" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="11064" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11065" class="Symbol">){</a><a id="11067" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="11068" class="Symbol">}(</a><a id="11070" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11072" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="11073" class="Symbol">)</a> <a id="11075" class="Symbol">λ</a> <a id="11077" href="Varieties.FreeAlgebras.html#11077" class="Bound">i</a> <a id="11079" class="Symbol">→</a> <a id="11081" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="11090" class="Symbol">(</a><a id="11091" href="Varieties.Preservation.html#11901" class="Function">𝔄&#39;</a> <a id="11094" href="Varieties.FreeAlgebras.html#11077" class="Bound">i</a><a id="11095" class="Symbol">)(</a><a id="11097" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11101" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="11103" href="Varieties.FreeAlgebras.html#11077" class="Bound">i</a> <a id="11105" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a><a id="11106" class="Symbol">)</a>

</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned, the initial version of the [agda-algebras](https://github.com/ualib/agda-algebras) library used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11644" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="11646" class="Symbol">:</a> <a id="11648" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="11656" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="11659" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="11662" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="11664" class="Symbol">=</a> <a id="11666" href="Homomorphisms.Basic.html#8562" class="Function Operator">ker[</a> <a id="11671" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11673" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="11675" href="Homomorphisms.Basic.html#8562" class="Function Operator">⇒</a> <a id="11677" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="11679" href="Homomorphisms.Basic.html#8562" class="Function Operator">]</a> <a id="11681" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="11686" href="Homomorphisms.Basic.html#8562" class="Function Operator">↾</a> <a id="11688" class="Symbol">(</a><a id="11689" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="11692" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11694" class="Symbol">(</a><a id="11695" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11698" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11699" class="Symbol">))</a>

 <a id="11704" href="Varieties.FreeAlgebras.html#11704" class="Function">epi𝔽</a> <a id="11709" class="Symbol">:</a> <a id="11711" href="Homomorphisms.Basic.html#6477" class="Function">epi</a> <a id="11715" class="Symbol">(</a><a id="11716" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11718" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="11719" class="Symbol">)</a> <a id="11721" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a>
 <a id="11724" href="Varieties.FreeAlgebras.html#11704" class="Function">epi𝔽</a> <a id="11729" class="Symbol">=</a> <a id="11731" href="Homomorphisms.Basic.html#10056" class="Function">πker</a> <a id="11736" class="Symbol">(</a><a id="11737" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="11740" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11742" class="Symbol">(</a><a id="11743" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11746" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11747" class="Symbol">))</a> <a id="11750" class="Symbol">{</a><a id="11751" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a><a id="11752" class="Symbol">}</a> <a id="11754" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a>

 <a id="11761" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="11766" class="Symbol">:</a> <a id="11768" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="11772" class="Symbol">(</a><a id="11773" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="11775" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="11776" class="Symbol">)</a> <a id="11778" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a>
 <a id="11781" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="11786" class="Symbol">=</a> <a id="11788" href="Homomorphisms.Basic.html#6944" class="Function">epi-to-hom</a> <a id="11799" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="11801" href="Varieties.FreeAlgebras.html#11704" class="Function">epi𝔽</a>

 <a id="11808" href="Varieties.FreeAlgebras.html#11808" class="Function">hom𝔽-is-epic</a> <a id="11821" class="Symbol">:</a> <a id="11823" href="Overture.Inverses.html#3374" class="Function">IsSurjective</a> <a id="11836" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="11838" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="11843" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a>
 <a id="11846" href="Varieties.FreeAlgebras.html#11808" class="Function">hom𝔽-is-epic</a> <a id="11859" class="Symbol">=</a> <a id="11861" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11865" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="11867" href="Varieties.FreeAlgebras.html#11704" class="Function">epi𝔽</a> <a id="11872" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11970" href="Varieties.FreeAlgebras.html#11970" class="Function">ψlemma0</a> <a id="11978" class="Symbol">:</a> <a id="11980" class="Symbol">∀</a> <a id="11982" href="Varieties.FreeAlgebras.html#11982" class="Bound">p</a> <a id="11984" href="Varieties.FreeAlgebras.html#11984" class="Bound">q</a> <a id="11986" class="Symbol">→</a>  <a id="11989" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="11991" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="11996" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="11998" href="Varieties.FreeAlgebras.html#11982" class="Bound">p</a> <a id="12000" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12002" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12004" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="12009" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12011" href="Varieties.FreeAlgebras.html#11984" class="Bound">q</a>  <a id="12014" class="Symbol">→</a> <a id="12016" class="Symbol">(</a><a id="12017" href="Varieties.FreeAlgebras.html#11982" class="Bound">p</a> <a id="12019" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12021" href="Varieties.FreeAlgebras.html#11984" class="Bound">q</a><a id="12022" class="Symbol">)</a> <a id="12024" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12026" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="12028" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
 <a id="12031" href="Varieties.FreeAlgebras.html#11970" class="Function">ψlemma0</a> <a id="12039" href="Varieties.FreeAlgebras.html#12039" class="Bound">p</a> <a id="12041" href="Varieties.FreeAlgebras.html#12041" class="Bound">q</a> <a id="12043" href="Varieties.FreeAlgebras.html#12043" class="Bound">phomℭq</a> <a id="12050" href="Varieties.FreeAlgebras.html#12050" class="Bound">𝑨</a> <a id="12052" href="Varieties.FreeAlgebras.html#12052" class="Bound">sA</a> <a id="12055" href="Varieties.FreeAlgebras.html#12055" class="Bound">h</a> <a id="12057" class="Symbol">=</a> <a id="12059" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="12068" href="Varieties.FreeAlgebras.html#12043" class="Bound">phomℭq</a> <a id="12075" class="Symbol">(</a><a id="12076" href="Varieties.FreeAlgebras.html#12050" class="Bound">𝑨</a> <a id="12078" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12080" href="Varieties.FreeAlgebras.html#12052" class="Bound">sA</a> <a id="12083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12085" href="Varieties.FreeAlgebras.html#12055" class="Bound">h</a><a id="12086" class="Symbol">)</a>

 <a id="12090" href="Varieties.FreeAlgebras.html#12090" class="Function">ψlemma0-ap</a> <a id="12101" class="Symbol">:</a> <a id="12103" class="Symbol">{</a><a id="12104" href="Varieties.FreeAlgebras.html#12104" class="Bound">𝑨</a> <a id="12106" class="Symbol">:</a> <a id="12108" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="12116" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12118" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12119" class="Symbol">}{</a><a id="12121" href="Varieties.FreeAlgebras.html#12121" class="Bound">h</a> <a id="12123" class="Symbol">:</a> <a id="12125" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="12127" class="Symbol">→</a> <a id="12129" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12131" href="Varieties.FreeAlgebras.html#12104" class="Bound">𝑨</a> <a id="12133" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="12134" class="Symbol">}</a> <a id="12136" class="Symbol">→</a> <a id="12138" href="Varieties.FreeAlgebras.html#12104" class="Bound">𝑨</a> <a id="12140" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12142" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="12143" class="Symbol">{</a><a id="12144" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12145" class="Symbol">}{</a><a id="12147" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12148" class="Symbol">}</a> <a id="12150" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
  <a id="12154" class="Symbol">→</a>           <a id="12166" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="12173" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12175" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="12180" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12182" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="12184" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="12191" class="Symbol">(</a><a id="12192" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="12202" href="Varieties.FreeAlgebras.html#12104" class="Bound">𝑨</a> <a id="12204" href="Varieties.FreeAlgebras.html#12121" class="Bound">h</a><a id="12205" class="Symbol">)</a>

 <a id="12209" href="Varieties.FreeAlgebras.html#12090" class="Function">ψlemma0-ap</a> <a id="12220" class="Symbol">{</a><a id="12221" href="Varieties.FreeAlgebras.html#12221" class="Bound">𝑨</a><a id="12222" class="Symbol">}{</a><a id="12224" href="Varieties.FreeAlgebras.html#12224" class="Bound">h</a><a id="12225" class="Symbol">}</a> <a id="12227" href="Varieties.FreeAlgebras.html#12227" class="Bound">skA</a> <a id="12231" class="Symbol">{</a><a id="12232" href="Varieties.FreeAlgebras.html#12232" class="Bound">p</a> <a id="12234" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12236" href="Varieties.FreeAlgebras.html#12236" class="Bound">q</a><a id="12237" class="Symbol">}</a> <a id="12239" href="Varieties.FreeAlgebras.html#12239" class="Bound">x</a> <a id="12241" class="Symbol">=</a> <a id="12243" href="Varieties.FreeAlgebras.html#12386" class="Function">γ</a> <a id="12245" class="Keyword">where</a>

  <a id="12254" href="Varieties.FreeAlgebras.html#12254" class="Function">ν</a> <a id="12256" class="Symbol">:</a> <a id="12258" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12260" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="12265" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12267" href="Varieties.FreeAlgebras.html#12232" class="Bound">p</a> <a id="12269" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12271" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12273" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="12278" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12280" href="Varieties.FreeAlgebras.html#12236" class="Bound">q</a>
  <a id="12284" href="Varieties.FreeAlgebras.html#12254" class="Function">ν</a> <a id="12286" class="Symbol">=</a> <a id="12288" href="Homomorphisms.Basic.html#10565" class="Function">ker-in-con</a> <a id="12299" class="Symbol">{</a><a id="12300" class="Argument">α</a> <a id="12302" class="Symbol">=</a> <a id="12304" class="Symbol">(</a><a id="12305" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12308" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12309" class="Symbol">)}{</a><a id="12312" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12315" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12316" class="Symbol">}{</a><a id="12318" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="12320" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="12321" class="Symbol">}{</a><a id="12323" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="12326" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12328" class="Symbol">(</a><a id="12329" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12334" class="Symbol">(</a><a id="12335" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12338" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12339" class="Symbol">))}(</a><a id="12343" href="Homomorphisms.Basic.html#8154" class="Function">kercon</a> <a id="12350" class="Symbol">(</a><a id="12351" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="12354" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12356" class="Symbol">(</a><a id="12357" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12360" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12361" class="Symbol">))</a> <a id="12364" class="Symbol">{</a><a id="12365" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a><a id="12366" class="Symbol">}</a> <a id="12368" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a><a id="12372" class="Symbol">)</a> <a id="12374" class="Symbol">{</a><a id="12375" href="Varieties.FreeAlgebras.html#12232" class="Bound">p</a><a id="12376" class="Symbol">}{</a><a id="12378" href="Varieties.FreeAlgebras.html#12236" class="Bound">q</a><a id="12379" class="Symbol">}</a> <a id="12381" href="Varieties.FreeAlgebras.html#12239" class="Bound">x</a>

  <a id="12386" href="Varieties.FreeAlgebras.html#12386" class="Function">γ</a> <a id="12388" class="Symbol">:</a> <a id="12390" class="Symbol">(</a><a id="12391" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="12401" href="Varieties.FreeAlgebras.html#12221" class="Bound">𝑨</a> <a id="12403" href="Varieties.FreeAlgebras.html#12224" class="Bound">h</a><a id="12404" class="Symbol">)</a> <a id="12406" href="Varieties.FreeAlgebras.html#12232" class="Bound">p</a> <a id="12408" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12410" class="Symbol">(</a><a id="12411" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="12421" href="Varieties.FreeAlgebras.html#12221" class="Bound">𝑨</a> <a id="12423" href="Varieties.FreeAlgebras.html#12224" class="Bound">h</a><a id="12424" class="Symbol">)</a> <a id="12426" href="Varieties.FreeAlgebras.html#12236" class="Bound">q</a>
  <a id="12430" href="Varieties.FreeAlgebras.html#12386" class="Function">γ</a> <a id="12432" class="Symbol">=</a> <a id="12434" class="Symbol">((</a><a id="12436" href="Varieties.FreeAlgebras.html#11970" class="Function">ψlemma0</a> <a id="12444" href="Varieties.FreeAlgebras.html#12232" class="Bound">p</a> <a id="12446" href="Varieties.FreeAlgebras.html#12236" class="Bound">q</a><a id="12447" class="Symbol">)</a> <a id="12449" href="Varieties.FreeAlgebras.html#12254" class="Function">ν</a><a id="12450" class="Symbol">)</a> <a id="12452" href="Varieties.FreeAlgebras.html#12221" class="Bound">𝑨</a> <a id="12454" href="Varieties.FreeAlgebras.html#12227" class="Bound">skA</a> <a id="12458" href="Varieties.FreeAlgebras.html#12224" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12639" href="Varieties.FreeAlgebras.html#12639" class="Function">𝔽-lift-hom</a> <a id="12650" class="Symbol">:</a> <a id="12652" class="Symbol">(</a><a id="12653" href="Varieties.FreeAlgebras.html#12653" class="Bound">𝑨</a> <a id="12655" class="Symbol">:</a> <a id="12657" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="12665" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12667" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12668" class="Symbol">)</a> <a id="12670" class="Symbol">→</a> <a id="12672" href="Varieties.FreeAlgebras.html#12653" class="Bound">𝑨</a> <a id="12674" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12676" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="12677" class="Symbol">{</a><a id="12678" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12679" class="Symbol">}{</a><a id="12681" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12682" class="Symbol">}</a> <a id="12684" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="12686" class="Symbol">→</a> <a id="12688" class="Symbol">(</a><a id="12689" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="12691" class="Symbol">→</a> <a id="12693" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="12695" href="Varieties.FreeAlgebras.html#12653" class="Bound">𝑨</a> <a id="12697" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="12698" class="Symbol">)</a> <a id="12700" class="Symbol">→</a> <a id="12702" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="12706" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="12708" href="Varieties.FreeAlgebras.html#12653" class="Bound">𝑨</a>
 <a id="12711" href="Varieties.FreeAlgebras.html#12639" class="Function">𝔽-lift-hom</a> <a id="12722" href="Varieties.FreeAlgebras.html#12722" class="Bound">𝑨</a> <a id="12724" href="Varieties.FreeAlgebras.html#12724" class="Bound">skA</a> <a id="12728" href="Varieties.FreeAlgebras.html#12728" class="Bound">h</a> <a id="12730" class="Symbol">=</a> <a id="12732" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a><a id="12735" class="Symbol">(</a><a id="12736" href="Homomorphisms.Noether.html#8578" class="Function">HomFactor</a> <a id="12746" class="Symbol">(</a><a id="12747" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="12750" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12752" class="Symbol">(</a><a id="12753" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12758" class="Symbol">(</a><a id="12759" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12762" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12763" class="Symbol">)))</a>  <a id="12768" href="Varieties.FreeAlgebras.html#12722" class="Bound">𝑨</a> <a id="12770" class="Symbol">(</a><a id="12771" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="12780" href="Varieties.FreeAlgebras.html#12722" class="Bound">𝑨</a> <a id="12782" href="Varieties.FreeAlgebras.html#12728" class="Bound">h</a><a id="12783" class="Symbol">)</a> <a id="12785" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="12790" class="Symbol">(</a><a id="12791" href="Varieties.FreeAlgebras.html#12090" class="Function">ψlemma0-ap</a> <a id="12802" href="Varieties.FreeAlgebras.html#12724" class="Bound">skA</a><a id="12805" class="Symbol">)</a> <a id="12807" href="Varieties.FreeAlgebras.html#11808" class="Function">hom𝔽-is-epic</a><a id="12819" class="Symbol">)</a>

</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="13204" class="Keyword">open</a> <a id="13209" href="Algebras.Congruences.html#1800" class="Module">IsCongruence</a>

 <a id="13224" href="Varieties.FreeAlgebras.html#13224" class="Function">X↪𝔽</a> <a id="13228" class="Symbol">:</a> <a id="13230" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="13232" class="Symbol">→</a> <a id="13234" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13236" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="13238" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a>
 <a id="13241" href="Varieties.FreeAlgebras.html#13224" class="Function">X↪𝔽</a> <a id="13245" href="Varieties.FreeAlgebras.html#13245" class="Bound">x</a> <a id="13247" class="Symbol">=</a> <a id="13249" href="Relations.Quotients.html#5384" class="Function Operator">⟪</a> <a id="13251" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13253" href="Varieties.FreeAlgebras.html#13245" class="Bound">x</a> <a id="13255" href="Relations.Quotients.html#5384" class="Function Operator">⟫</a> <a id="13257" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13323" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13325" class="Symbol">:</a> <a id="13327" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="13331" class="Symbol">(</a><a id="13332" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="13334" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="13335" class="Symbol">)</a> <a id="13337" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a>
 <a id="13340" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13342" class="Symbol">=</a> <a id="13344" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="13353" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="13355" href="Varieties.FreeAlgebras.html#13224" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13458" class="Keyword">open</a> <a id="13463" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13477" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a> <a id="13494" class="Symbol">:</a> <a id="13496" class="Symbol">∀</a> <a id="13498" href="Varieties.FreeAlgebras.html#13498" class="Bound">p</a> <a id="13500" class="Symbol">→</a> <a id="13502" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13504" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13506" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13508" href="Varieties.FreeAlgebras.html#13498" class="Bound">p</a> <a id="13510" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13512" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13514" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="13519" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13521" href="Varieties.FreeAlgebras.html#13498" class="Bound">p</a>
 <a id="13524" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a> <a id="13541" class="Symbol">(</a><a id="13542" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13544" href="Varieties.FreeAlgebras.html#13544" class="Bound">x</a><a id="13545" class="Symbol">)</a> <a id="13547" class="Symbol">=</a> <a id="13549" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13555" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a> <a id="13572" class="Symbol">(</a><a id="13573" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13578" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13580" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a><a id="13581" class="Symbol">)</a> <a id="13583" class="Symbol">=</a>
  <a id="13587" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13589" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13591" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13593" class="Symbol">(</a><a id="13594" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13599" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13601" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a><a id="13602" class="Symbol">)</a>              <a id="13617" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13620" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="13622" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13624" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="13626" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13628" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13630" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13634" class="Symbol">(</a><a id="13635" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13637" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="13639" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a><a id="13640" class="Symbol">)(λ</a> <a id="13644" href="Varieties.FreeAlgebras.html#13644" class="Bound">i</a> <a id="13646" class="Symbol">→</a> <a id="13648" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13650" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13652" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="13653" class="Symbol">(</a><a id="13654" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13656" href="Varieties.FreeAlgebras.html#13644" class="Bound">i</a><a id="13657" class="Symbol">))</a>     <a id="13664" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13667" href="Varieties.FreeAlgebras.html#13775" class="Function">wd-proof</a> <a id="13676" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13680" class="Symbol">(</a><a id="13681" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13683" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="13685" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a><a id="13686" class="Symbol">)(λ</a> <a id="13690" href="Varieties.FreeAlgebras.html#13690" class="Bound">i</a> <a id="13692" class="Symbol">→</a> <a id="13694" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13696" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="13701" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13703" class="Symbol">(</a><a id="13704" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13706" href="Varieties.FreeAlgebras.html#13690" class="Bound">i</a><a id="13707" class="Symbol">))</a> <a id="13710" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13713" class="Symbol">(</a><a id="13714" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="13716" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="13721" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="13723" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13725" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a><a id="13726" class="Symbol">)</a><a id="13727" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a> <a id="13730" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13734" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13736" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="13741" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13743" class="Symbol">(</a><a id="13744" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13749" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13751" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a><a id="13752" class="Symbol">)</a>           <a id="13764" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13769" class="Keyword">where</a> <a id="13775" href="Varieties.FreeAlgebras.html#13775" class="Function">wd-proof</a> <a id="13784" class="Symbol">=</a> <a id="13786" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="13789" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="13791" class="Symbol">(</a><a id="13792" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="13797" class="Symbol">(</a><a id="13798" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="13801" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="13802" class="Symbol">))</a>
                    <a id="13825" class="Symbol">(</a><a id="13826" href="Varieties.FreeAlgebras.html#13578" class="Bound">𝑓</a> <a id="13828" href="Algebras.Basic.html#9409" class="Function Operator">̂</a> <a id="13830" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a><a id="13831" class="Symbol">)</a> <a id="13833" class="Symbol">(λ</a> <a id="13836" href="Varieties.FreeAlgebras.html#13836" class="Bound">i</a> <a id="13838" class="Symbol">→</a> <a id="13840" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13842" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="13844" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="13845" class="Symbol">(</a><a id="13846" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13848" href="Varieties.FreeAlgebras.html#13836" class="Bound">i</a><a id="13849" class="Symbol">))</a> <a id="13852" class="Symbol">(λ</a> <a id="13855" href="Varieties.FreeAlgebras.html#13855" class="Bound">i</a> <a id="13857" class="Symbol">→</a> <a id="13859" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13861" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="13866" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="13868" class="Symbol">(</a><a id="13869" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13871" href="Varieties.FreeAlgebras.html#13855" class="Bound">i</a><a id="13872" class="Symbol">))</a>
                    <a id="13895" class="Symbol">(λ</a> <a id="13898" href="Varieties.FreeAlgebras.html#13898" class="Bound">x</a> <a id="13900" class="Symbol">→</a> <a id="13902" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a><a id="13918" class="Symbol">(</a><a id="13919" href="Varieties.FreeAlgebras.html#13580" class="Bound">𝒕</a> <a id="13921" href="Varieties.FreeAlgebras.html#13898" class="Bound">x</a><a id="13922" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="14026" href="Varieties.FreeAlgebras.html#14026" class="Function">ψlemma1</a> <a id="14034" class="Symbol">:</a> <a id="14036" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="14043" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14045" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="14047" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14049" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14051" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="14053" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
 <a id="14056" href="Varieties.FreeAlgebras.html#14026" class="Function">ψlemma1</a> <a id="14064" class="Symbol">{</a><a id="14065" href="Varieties.FreeAlgebras.html#14065" class="Bound">p</a> <a id="14067" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14069" href="Varieties.FreeAlgebras.html#14069" class="Bound">q</a><a id="14070" class="Symbol">}</a> <a id="14072" href="Varieties.FreeAlgebras.html#14072" class="Bound">𝔑pq</a> <a id="14076" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a> <a id="14078" href="Varieties.FreeAlgebras.html#14078" class="Bound">sA</a> <a id="14081" href="Varieties.FreeAlgebras.html#14081" class="Bound">h</a> <a id="14083" class="Symbol">=</a> <a id="14085" href="Varieties.FreeAlgebras.html#14306" class="Function">γ</a>
  <a id="14089" class="Keyword">where</a>
   <a id="14098" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14100" class="Symbol">:</a> <a id="14102" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="14106" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="14108" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a>
   <a id="14113" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14115" class="Symbol">=</a> <a id="14117" href="Varieties.FreeAlgebras.html#12639" class="Function">𝔽-lift-hom</a> <a id="14128" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a> <a id="14130" href="Varieties.FreeAlgebras.html#14078" class="Bound">sA</a> <a id="14133" href="Varieties.FreeAlgebras.html#14081" class="Bound">h</a>

   <a id="14139" href="Varieties.FreeAlgebras.html#14139" class="Function">h&#39;</a> <a id="14142" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14144" class="Symbol">:</a> <a id="14146" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="14150" class="Symbol">(</a><a id="14151" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="14153" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="14154" class="Symbol">)</a> <a id="14156" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a>
   <a id="14161" href="Varieties.FreeAlgebras.html#14139" class="Function">h&#39;</a> <a id="14164" class="Symbol">=</a> <a id="14166" href="Homomorphisms.Basic.html#3506" class="Function">∘-hom</a> <a id="14172" class="Symbol">(</a><a id="14173" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="14175" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="14176" class="Symbol">)</a> <a id="14178" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a> <a id="14180" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="14182" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a>
   <a id="14187" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14189" class="Symbol">=</a> <a id="14191" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="14200" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a> <a id="14202" href="Varieties.FreeAlgebras.html#14081" class="Bound">h</a>

   <a id="14208" href="Varieties.FreeAlgebras.html#14208" class="Function">h≡φ</a> <a id="14212" class="Symbol">:</a> <a id="14214" class="Symbol">∀</a> <a id="14216" href="Varieties.FreeAlgebras.html#14216" class="Bound">t</a> <a id="14218" class="Symbol">→</a> <a id="14220" class="Symbol">(</a><a id="14221" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14223" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14225" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14227" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14229" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14231" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="14233" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="14234" class="Symbol">)</a> <a id="14236" href="Varieties.FreeAlgebras.html#14216" class="Bound">t</a> <a id="14238" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14240" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14242" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14244" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14246" href="Varieties.FreeAlgebras.html#14216" class="Bound">t</a>
   <a id="14251" href="Varieties.FreeAlgebras.html#14208" class="Function">h≡φ</a> <a id="14255" href="Varieties.FreeAlgebras.html#14255" class="Bound">t</a> <a id="14257" class="Symbol">=</a> <a id="14259" href="Terms.Properties.html#3582" class="Function">free-unique</a> <a id="14271" class="Symbol">(</a><a id="14272" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="14275" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14277" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14278" class="Symbol">)</a> <a id="14280" href="Varieties.FreeAlgebras.html#14076" class="Bound">𝑨</a> <a id="14282" href="Varieties.FreeAlgebras.html#14139" class="Function">h&#39;</a> <a id="14285" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14287" class="Symbol">(λ</a> <a id="14290" href="Varieties.FreeAlgebras.html#14290" class="Bound">x</a> <a id="14292" class="Symbol">→</a> <a id="14294" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14298" class="Symbol">)</a> <a id="14300" href="Varieties.FreeAlgebras.html#14255" class="Bound">t</a>

   <a id="14306" href="Varieties.FreeAlgebras.html#14306" class="Function">γ</a> <a id="14308" class="Symbol">:</a> <a id="14310" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14312" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14314" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14316" href="Varieties.FreeAlgebras.html#14065" class="Bound">p</a> <a id="14318" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14320" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14322" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14324" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14326" href="Varieties.FreeAlgebras.html#14069" class="Bound">q</a>
   <a id="14331" href="Varieties.FreeAlgebras.html#14306" class="Function">γ</a> <a id="14333" class="Symbol">=</a> <a id="14335" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14337" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14339" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14341" href="Varieties.FreeAlgebras.html#14065" class="Bound">p</a>             <a id="14355" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14358" class="Symbol">(</a><a id="14359" href="Varieties.FreeAlgebras.html#14208" class="Function">h≡φ</a> <a id="14363" href="Varieties.FreeAlgebras.html#14065" class="Bound">p</a><a id="14364" class="Symbol">)</a><a id="14365" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a> <a id="14368" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14377" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14379" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14381" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14383" class="Symbol">(</a> <a id="14385" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14387" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="14389" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14391" href="Varieties.FreeAlgebras.html#14065" class="Bound">p</a> <a id="14393" class="Symbol">)</a>   <a id="14397" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14400" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14405" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14407" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14409" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14411" href="Varieties.FreeAlgebras.html#14072" class="Bound">𝔑pq</a> <a id="14415" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14424" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14426" href="Varieties.FreeAlgebras.html#14098" class="Function">f</a> <a id="14428" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14430" class="Symbol">(</a> <a id="14432" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14434" href="Varieties.FreeAlgebras.html#13323" class="Function">𝔑</a> <a id="14436" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14438" href="Varieties.FreeAlgebras.html#14069" class="Bound">q</a> <a id="14440" class="Symbol">)</a>   <a id="14444" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14447" href="Varieties.FreeAlgebras.html#14208" class="Function">h≡φ</a> <a id="14451" href="Varieties.FreeAlgebras.html#14069" class="Bound">q</a> <a id="14453" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14462" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14464" href="Varieties.FreeAlgebras.html#14142" class="Function">φ</a> <a id="14466" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14468" href="Varieties.FreeAlgebras.html#14069" class="Bound">q</a>             <a id="14482" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14487" href="Varieties.FreeAlgebras.html#14487" class="Function">ψlemma2</a> <a id="14495" class="Symbol">:</a> <a id="14497" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="14504" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14506" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="14511" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="14513" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14515" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a> <a id="14517" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
 <a id="14520" href="Varieties.FreeAlgebras.html#14487" class="Function">ψlemma2</a> <a id="14528" class="Symbol">{</a><a id="14529" href="Varieties.FreeAlgebras.html#14529" class="Bound">p</a> <a id="14531" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14533" href="Varieties.FreeAlgebras.html#14533" class="Bound">q</a><a id="14534" class="Symbol">}</a> <a id="14536" href="Varieties.FreeAlgebras.html#14536" class="Bound">x</a> <a id="14538" class="Symbol">=</a> <a id="14540" href="Varieties.FreeAlgebras.html#14026" class="Function">ψlemma1</a> <a id="14548" class="Symbol">{</a><a id="14549" href="Varieties.FreeAlgebras.html#14529" class="Bound">p</a> <a id="14551" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14553" href="Varieties.FreeAlgebras.html#14533" class="Bound">q</a><a id="14554" class="Symbol">}</a> <a id="14556" href="Varieties.FreeAlgebras.html#14571" class="Function">γ</a>
   <a id="14561" class="Keyword">where</a>
    <a id="14571" href="Varieties.FreeAlgebras.html#14571" class="Function">γ</a> <a id="14573" class="Symbol">:</a> <a id="14575" class="Symbol">(</a><a id="14576" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="14586" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="14588" href="Varieties.FreeAlgebras.html#13224" class="Function">X↪𝔽</a><a id="14591" class="Symbol">)</a> <a id="14593" href="Varieties.FreeAlgebras.html#14529" class="Bound">p</a> <a id="14595" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14597" class="Symbol">(</a><a id="14598" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="14608" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="14610" href="Varieties.FreeAlgebras.html#13224" class="Function">X↪𝔽</a><a id="14613" class="Symbol">)</a> <a id="14615" href="Varieties.FreeAlgebras.html#14533" class="Bound">q</a>
    <a id="14621" href="Varieties.FreeAlgebras.html#14571" class="Function">γ</a> <a id="14623" class="Symbol">=</a> <a id="14625" class="Symbol">(</a><a id="14626" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a> <a id="14643" href="Varieties.FreeAlgebras.html#14529" class="Bound">p</a><a id="14644" class="Symbol">)</a> <a id="14646" href="Overture.Preliminaries.html#5406" class="Function Operator">∙</a> <a id="14648" href="Varieties.FreeAlgebras.html#14536" class="Bound">x</a> <a id="14650" href="Overture.Preliminaries.html#5406" class="Function Operator">∙</a> <a id="14652" class="Symbol">(</a><a id="14653" href="Varieties.FreeAlgebras.html#13477" class="Function">hom𝔽-is-lift-hom</a> <a id="14670" href="Varieties.FreeAlgebras.html#14533" class="Bound">q</a><a id="14671" class="Symbol">)</a><a id="14672" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a>


 <a id="14678" href="Varieties.FreeAlgebras.html#14678" class="Function">ψlemma3</a> <a id="14686" class="Symbol">:</a> <a id="14688" class="Symbol">∀</a> <a id="14690" href="Varieties.FreeAlgebras.html#14690" class="Bound">p</a> <a id="14692" href="Varieties.FreeAlgebras.html#14692" class="Bound">q</a> <a id="14694" class="Symbol">→</a> <a id="14696" class="Symbol">(</a><a id="14697" href="Varieties.FreeAlgebras.html#14690" class="Bound">p</a> <a id="14699" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14701" href="Varieties.FreeAlgebras.html#14692" class="Bound">q</a><a id="14702" class="Symbol">)</a> <a id="14704" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14706" href="Varieties.FreeAlgebras.html#6355" class="Function">ψ</a><a id="14707" class="Symbol">{</a><a id="14708" class="Argument">X</a> <a id="14710" class="Symbol">=</a> <a id="14712" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="14713" class="Symbol">}</a> <a id="14715" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="14717" class="Symbol">→</a> <a id="14719" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="14721" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="14723" href="Varieties.FreeAlgebras.html#14690" class="Bound">p</a> <a id="14725" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="14727" href="Varieties.FreeAlgebras.html#14692" class="Bound">q</a>
 <a id="14730" href="Varieties.FreeAlgebras.html#14678" class="Function">ψlemma3</a> <a id="14738" href="Varieties.FreeAlgebras.html#14738" class="Bound">p</a> <a id="14740" href="Varieties.FreeAlgebras.html#14740" class="Bound">q</a> <a id="14742" href="Varieties.FreeAlgebras.html#14742" class="Bound">pψq</a> <a id="14746" class="Symbol">{</a><a id="14747" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a><a id="14748" class="Symbol">}</a> <a id="14750" href="Varieties.FreeAlgebras.html#14750" class="Bound">kA</a> <a id="14753" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a> <a id="14755" class="Symbol">=</a> <a id="14757" href="Varieties.FreeAlgebras.html#14774" class="Function">goal</a>
   <a id="14765" class="Keyword">where</a>
   <a id="14774" href="Varieties.FreeAlgebras.html#14774" class="Function">goal</a> <a id="14779" class="Symbol">:</a> <a id="14781" class="Symbol">(</a><a id="14782" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14784" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14786" href="Varieties.FreeAlgebras.html#14738" class="Bound">p</a> <a id="14788" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14789" class="Symbol">)</a> <a id="14791" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a> <a id="14793" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14795" class="Symbol">(</a><a id="14796" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14798" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14800" href="Varieties.FreeAlgebras.html#14740" class="Bound">q</a> <a id="14802" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14803" class="Symbol">)</a> <a id="14805" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a>
   <a id="14810" href="Varieties.FreeAlgebras.html#14774" class="Function">goal</a> <a id="14815" class="Symbol">=</a> <a id="14817" class="Symbol">(</a><a id="14818" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14820" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14822" href="Varieties.FreeAlgebras.html#14738" class="Bound">p</a> <a id="14824" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14825" class="Symbol">)</a> <a id="14827" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a>       <a id="14835" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14838" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="14855" class="Symbol">(</a><a id="14856" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="14859" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14861" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14862" class="Symbol">)</a> <a id="14864" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14866" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a> <a id="14868" href="Varieties.FreeAlgebras.html#14738" class="Bound">p</a> <a id="14870" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14882" class="Symbol">(</a><a id="14883" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="14893" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14895" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a><a id="14896" class="Symbol">)</a> <a id="14898" href="Varieties.FreeAlgebras.html#14738" class="Bound">p</a> <a id="14900" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14903" href="Varieties.FreeAlgebras.html#14742" class="Bound">pψq</a> <a id="14907" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14909" class="Symbol">(</a><a id="14910" href="Varieties.Closure.html#4060" class="InductiveConstructor">siso</a> <a id="14915" class="Symbol">(</a><a id="14916" href="Varieties.Closure.html#3862" class="InductiveConstructor">sbase</a> <a id="14922" href="Varieties.FreeAlgebras.html#14750" class="Bound">kA</a><a id="14924" class="Symbol">)</a> <a id="14926" class="Symbol">(</a><a id="14927" href="Homomorphisms.Isomorphisms.html#2911" class="Function">≅-sym</a> <a id="14933" href="Homomorphisms.Isomorphisms.html#4355" class="Function">Lift-≅</a><a id="14939" class="Symbol">))</a> <a id="14942" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a> <a id="14944" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14956" class="Symbol">(</a><a id="14957" href="Terms.Properties.html#2476" class="Function">free-lift</a> <a id="14967" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="14969" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a><a id="14970" class="Symbol">)</a> <a id="14972" href="Varieties.FreeAlgebras.html#14740" class="Bound">q</a> <a id="14974" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14977" class="Symbol">(</a><a id="14978" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="14995" class="Symbol">(</a><a id="14996" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="14999" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="15001" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15002" class="Symbol">)</a> <a id="15004" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="15006" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a> <a id="15008" href="Varieties.FreeAlgebras.html#14740" class="Bound">q</a><a id="15009" class="Symbol">)</a><a id="15010" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a>  <a id="15014" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="15026" class="Symbol">(</a><a id="15027" href="Varieties.FreeAlgebras.html#14747" class="Bound">𝑨</a> <a id="15029" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="15031" href="Varieties.FreeAlgebras.html#14740" class="Bound">q</a> <a id="15033" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="15034" class="Symbol">)</a> <a id="15036" href="Varieties.FreeAlgebras.html#14753" class="Bound">h</a>       <a id="15044" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="15167" href="Varieties.FreeAlgebras.html#15167" class="Function">class-models-kernel</a> <a id="15187" class="Symbol">:</a> <a id="15189" class="Symbol">∀</a> <a id="15191" href="Varieties.FreeAlgebras.html#15191" class="Bound">p</a> <a id="15193" href="Varieties.FreeAlgebras.html#15193" class="Bound">q</a> <a id="15195" class="Symbol">→</a> <a id="15197" class="Symbol">(</a><a id="15198" href="Varieties.FreeAlgebras.html#15191" class="Bound">p</a> <a id="15200" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15202" href="Varieties.FreeAlgebras.html#15193" class="Bound">q</a><a id="15203" class="Symbol">)</a> <a id="15205" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15207" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="15214" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15216" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="15221" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15223" class="Symbol">→</a> <a id="15225" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="15227" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="15229" href="Varieties.FreeAlgebras.html#15191" class="Bound">p</a> <a id="15231" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="15233" href="Varieties.FreeAlgebras.html#15193" class="Bound">q</a>
 <a id="15236" href="Varieties.FreeAlgebras.html#15167" class="Function">class-models-kernel</a> <a id="15256" href="Varieties.FreeAlgebras.html#15256" class="Bound">p</a> <a id="15258" href="Varieties.FreeAlgebras.html#15258" class="Bound">q</a> <a id="15260" href="Varieties.FreeAlgebras.html#15260" class="Bound">x</a> <a id="15262" class="Symbol">=</a> <a id="15264" href="Varieties.FreeAlgebras.html#14678" class="Function">ψlemma3</a> <a id="15272" href="Varieties.FreeAlgebras.html#15256" class="Bound">p</a> <a id="15274" href="Varieties.FreeAlgebras.html#15258" class="Bound">q</a> <a id="15276" class="Symbol">(</a><a id="15277" href="Varieties.FreeAlgebras.html#14487" class="Function">ψlemma2</a> <a id="15285" href="Varieties.FreeAlgebras.html#15260" class="Bound">x</a><a id="15286" class="Symbol">)</a>

 <a id="15290" href="Varieties.FreeAlgebras.html#15290" class="Function">𝕍𝒦</a> <a id="15293" class="Symbol">:</a> <a id="15295" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15300" class="Symbol">(</a><a id="15301" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="15309" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15312" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15313" class="Symbol">)</a> <a id="15315" class="Symbol">(</a><a id="15316" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="15321" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="15323" class="Symbol">)</a>
 <a id="15326" href="Varieties.FreeAlgebras.html#15290" class="Function">𝕍𝒦</a> <a id="15329" class="Symbol">=</a> <a id="15331" href="Varieties.Closure.html#5316" class="Datatype">V</a><a id="15332" class="Symbol">{</a><a id="15333" class="Argument">α</a> <a id="15335" class="Symbol">=</a> <a id="15337" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15338" class="Symbol">}{</a><a id="15340" class="Argument">β</a> <a id="15342" class="Symbol">=</a> <a id="15344" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="15346" class="Symbol">}</a> <a id="15348" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>

 <a id="15352" href="Varieties.FreeAlgebras.html#15352" class="Function">kernel-in-theory&#39;</a> <a id="15370" class="Symbol">:</a> <a id="15372" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="15379" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15381" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="15386" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15388" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15390" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15393" class="Symbol">(</a><a id="15394" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="15396" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a><a id="15397" class="Symbol">)</a>
 <a id="15400" href="Varieties.FreeAlgebras.html#15352" class="Function">kernel-in-theory&#39;</a> <a id="15418" class="Symbol">{</a><a id="15419" href="Varieties.FreeAlgebras.html#15419" class="Bound">p</a> <a id="15421" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15423" href="Varieties.FreeAlgebras.html#15423" class="Bound">q</a><a id="15424" class="Symbol">}</a> <a id="15426" href="Varieties.FreeAlgebras.html#15426" class="Bound">pKq</a> <a id="15430" class="Symbol">=</a> <a id="15432" class="Symbol">(</a><a id="15433" href="Varieties.Preservation.html#20396" class="Function">class-ids-⇒</a> <a id="15445" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="15448" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="15451" href="Varieties.FreeAlgebras.html#15419" class="Bound">p</a> <a id="15453" href="Varieties.FreeAlgebras.html#15423" class="Bound">q</a> <a id="15455" class="Symbol">(</a><a id="15456" href="Varieties.FreeAlgebras.html#15167" class="Function">class-models-kernel</a> <a id="15476" href="Varieties.FreeAlgebras.html#15419" class="Bound">p</a> <a id="15478" href="Varieties.FreeAlgebras.html#15423" class="Bound">q</a> <a id="15480" href="Varieties.FreeAlgebras.html#15426" class="Bound">pKq</a><a id="15483" class="Symbol">))</a>

 <a id="15488" href="Varieties.FreeAlgebras.html#15488" class="Function">kernel-in-theory</a> <a id="15505" class="Symbol">:</a> <a id="15507" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="15514" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15516" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="15521" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15523" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15525" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15528" href="Varieties.FreeAlgebras.html#15290" class="Function">𝕍𝒦</a>
 <a id="15532" href="Varieties.FreeAlgebras.html#15488" class="Function">kernel-in-theory</a> <a id="15549" class="Symbol">{</a><a id="15550" href="Varieties.FreeAlgebras.html#15550" class="Bound">p</a> <a id="15552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15554" href="Varieties.FreeAlgebras.html#15554" class="Bound">q</a><a id="15555" class="Symbol">}</a> <a id="15557" href="Varieties.FreeAlgebras.html#15557" class="Bound">pKq</a> <a id="15561" href="Varieties.FreeAlgebras.html#15561" class="Bound">vkA</a> <a id="15565" href="Varieties.FreeAlgebras.html#15565" class="Bound">x</a> <a id="15567" class="Symbol">=</a> <a id="15569" href="Varieties.Preservation.html#20509" class="Function">class-ids</a> <a id="15579" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="15582" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="15585" href="Varieties.FreeAlgebras.html#15550" class="Bound">p</a> <a id="15587" href="Varieties.FreeAlgebras.html#15554" class="Bound">q</a> <a id="15589" class="Symbol">(</a><a id="15590" href="Varieties.FreeAlgebras.html#15167" class="Function">class-models-kernel</a> <a id="15610" href="Varieties.FreeAlgebras.html#15550" class="Bound">p</a> <a id="15612" href="Varieties.FreeAlgebras.html#15554" class="Bound">q</a> <a id="15614" href="Varieties.FreeAlgebras.html#15557" class="Bound">pKq</a><a id="15617" class="Symbol">)</a> <a id="15619" href="Varieties.FreeAlgebras.html#15561" class="Bound">vkA</a> <a id="15623" href="Varieties.FreeAlgebras.html#15565" class="Bound">x</a>

 <a id="15627" href="Varieties.FreeAlgebras.html#15627" class="Function Operator">_↠_</a> <a id="15631" class="Symbol">:</a> <a id="15633" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15638" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="15640" class="Symbol">→</a> <a id="15642" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="15650" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15653" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="15655" class="Symbol">→</a> <a id="15657" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15662" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a>
 <a id="15666" href="Varieties.FreeAlgebras.html#15666" class="Bound">X</a> <a id="15668" href="Varieties.FreeAlgebras.html#15627" class="Function Operator">↠</a> <a id="15670" href="Varieties.FreeAlgebras.html#15670" class="Bound">𝑨</a> <a id="15672" class="Symbol">=</a> <a id="15674" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15677" href="Varieties.FreeAlgebras.html#15677" class="Bound">h</a> <a id="15679" href="Data.Product.html#916" class="Function">∈</a> <a id="15681" class="Symbol">(</a><a id="15682" href="Varieties.FreeAlgebras.html#15666" class="Bound">X</a> <a id="15684" class="Symbol">→</a> <a id="15686" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15688" href="Varieties.FreeAlgebras.html#15670" class="Bound">𝑨</a> <a id="15690" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="15691" class="Symbol">)</a> <a id="15693" href="Data.Product.html#916" class="Function">]</a> <a id="15695" href="Overture.Inverses.html#3374" class="Function">IsSurjective</a> <a id="15708" href="Varieties.FreeAlgebras.html#15677" class="Bound">h</a>

 <a id="15712" href="Varieties.FreeAlgebras.html#15712" class="Function">𝔽-ModTh-epi</a> <a id="15724" class="Symbol">:</a> <a id="15726" class="Symbol">(</a><a id="15727" href="Varieties.FreeAlgebras.html#15727" class="Bound">𝑨</a> <a id="15729" class="Symbol">:</a> <a id="15731" href="Algebras.Basic.html#6234" class="Function">Algebra</a> <a id="15739" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15742" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15743" class="Symbol">)</a> <a id="15745" class="Symbol">→</a> <a id="15747" class="Symbol">(</a><a id="15748" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="15750" href="Varieties.FreeAlgebras.html#15627" class="Function Operator">↠</a> <a id="15752" href="Varieties.FreeAlgebras.html#15727" class="Bound">𝑨</a><a id="15753" class="Symbol">)</a> <a id="15755" class="Symbol">→</a> <a id="15757" href="Varieties.FreeAlgebras.html#15727" class="Bound">𝑨</a> <a id="15759" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15761" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="15765" class="Symbol">(</a><a id="15766" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="15769" href="Varieties.FreeAlgebras.html#15290" class="Function">𝕍𝒦</a><a id="15771" class="Symbol">)</a> <a id="15773" class="Symbol">→</a> <a id="15775" href="Homomorphisms.Basic.html#6477" class="Function">epi</a> <a id="15779" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="15781" href="Varieties.FreeAlgebras.html#15727" class="Bound">𝑨</a>
 <a id="15784" href="Varieties.FreeAlgebras.html#15712" class="Function">𝔽-ModTh-epi</a> <a id="15796" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="15798" class="Symbol">(</a><a id="15799" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a> <a id="15801" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15803" href="Varieties.FreeAlgebras.html#15803" class="Bound">ηE</a><a id="15805" class="Symbol">)</a> <a id="15807" href="Varieties.FreeAlgebras.html#15807" class="Bound">AinMTV</a> <a id="15814" class="Symbol">=</a> <a id="15816" href="Varieties.FreeAlgebras.html#16328" class="Function">goal</a>
  <a id="15823" class="Keyword">where</a>
  <a id="15831" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="15833" class="Symbol">:</a> <a id="15835" href="Homomorphisms.Basic.html#3144" class="Function">hom</a> <a id="15839" class="Symbol">(</a><a id="15840" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="15842" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="15843" class="Symbol">)</a> <a id="15845" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a>
  <a id="15849" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="15851" class="Symbol">=</a> <a id="15853" href="Terms.Properties.html#3183" class="Function">lift-hom</a> <a id="15862" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="15864" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a>

  <a id="15869" href="Varieties.FreeAlgebras.html#15869" class="Function">φE</a> <a id="15872" class="Symbol">:</a> <a id="15874" href="Overture.Inverses.html#3374" class="Function">IsSurjective</a> <a id="15887" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15889" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="15891" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a>
  <a id="15895" href="Varieties.FreeAlgebras.html#15869" class="Function">φE</a> <a id="15898" class="Symbol">=</a> <a id="15900" href="Terms.Properties.html#4788" class="Function">lift-of-epi-is-epi</a> <a id="15919" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="15921" href="Varieties.FreeAlgebras.html#15803" class="Bound">ηE</a>

  <a id="15927" href="Varieties.FreeAlgebras.html#15927" class="Function">pqlem2</a> <a id="15934" class="Symbol">:</a> <a id="15936" class="Symbol">∀</a> <a id="15938" href="Varieties.FreeAlgebras.html#15938" class="Bound">p</a> <a id="15940" href="Varieties.FreeAlgebras.html#15940" class="Bound">q</a> <a id="15942" class="Symbol">→</a> <a id="15944" class="Symbol">(</a><a id="15945" href="Varieties.FreeAlgebras.html#15938" class="Bound">p</a> <a id="15947" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15949" href="Varieties.FreeAlgebras.html#15940" class="Bound">q</a><a id="15950" class="Symbol">)</a> <a id="15952" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15954" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="15961" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15963" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="15968" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="15970" class="Symbol">→</a> <a id="15972" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="15974" href="Varieties.EquationalLogic.html#2638" class="Function Operator">⊧</a> <a id="15976" href="Varieties.FreeAlgebras.html#15938" class="Bound">p</a> <a id="15978" href="Varieties.EquationalLogic.html#2638" class="Function Operator">≈</a> <a id="15980" href="Varieties.FreeAlgebras.html#15940" class="Bound">q</a>
  <a id="15984" href="Varieties.FreeAlgebras.html#15927" class="Function">pqlem2</a> <a id="15991" href="Varieties.FreeAlgebras.html#15991" class="Bound">p</a> <a id="15993" href="Varieties.FreeAlgebras.html#15993" class="Bound">q</a> <a id="15995" href="Varieties.FreeAlgebras.html#15995" class="Bound">z</a> <a id="15997" class="Symbol">=</a> <a id="15999" class="Symbol">λ</a> <a id="16001" href="Varieties.FreeAlgebras.html#16001" class="Bound">x</a> <a id="16003" class="Symbol">→</a> <a id="16005" href="Varieties.FreeAlgebras.html#15807" class="Bound">AinMTV</a> <a id="16012" href="Varieties.FreeAlgebras.html#15991" class="Bound">p</a> <a id="16014" href="Varieties.FreeAlgebras.html#15993" class="Bound">q</a> <a id="16016" class="Symbol">(</a><a id="16017" href="Varieties.FreeAlgebras.html#15488" class="Function">kernel-in-theory</a> <a id="16034" href="Varieties.FreeAlgebras.html#15995" class="Bound">z</a><a id="16035" class="Symbol">)</a> <a id="16037" href="Varieties.FreeAlgebras.html#16001" class="Bound">x</a>

  <a id="16042" href="Varieties.FreeAlgebras.html#16042" class="Function">kerincl</a> <a id="16050" class="Symbol">:</a> <a id="16052" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="16059" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16061" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="16066" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16068" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="16070" href="Relations.Discrete.html#4051" class="Function">kernel</a> <a id="16077" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16079" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="16081" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a>
  <a id="16085" href="Varieties.FreeAlgebras.html#16042" class="Function">kerincl</a> <a id="16093" class="Symbol">{</a><a id="16094" href="Varieties.FreeAlgebras.html#16094" class="Bound">p</a> <a id="16096" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16098" href="Varieties.FreeAlgebras.html#16098" class="Bound">q</a><a id="16099" class="Symbol">}</a> <a id="16101" href="Varieties.FreeAlgebras.html#16101" class="Bound">x</a> <a id="16103" class="Symbol">=</a> <a id="16105" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16107" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="16109" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16111" href="Varieties.FreeAlgebras.html#16094" class="Bound">p</a>      <a id="16118" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16121" class="Symbol">(</a><a id="16122" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16139" class="Symbol">(</a><a id="16140" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="16143" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16145" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="16147" class="Symbol">)</a> <a id="16149" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="16151" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a> <a id="16153" href="Varieties.FreeAlgebras.html#16094" class="Bound">p</a><a id="16154" class="Symbol">)</a><a id="16155" href="Overture.Preliminaries.html#5082" class="Function Operator">⁻¹</a> <a id="16158" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16182" class="Symbol">(</a><a id="16183" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="16185" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16187" href="Varieties.FreeAlgebras.html#16094" class="Bound">p</a> <a id="16189" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16190" class="Symbol">)</a> <a id="16192" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a>  <a id="16195" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16198" href="Varieties.FreeAlgebras.html#15927" class="Function">pqlem2</a> <a id="16205" href="Varieties.FreeAlgebras.html#16094" class="Bound">p</a> <a id="16207" href="Varieties.FreeAlgebras.html#16098" class="Bound">q</a> <a id="16209" href="Varieties.FreeAlgebras.html#16101" class="Bound">x</a> <a id="16211" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a> <a id="16213" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16237" class="Symbol">(</a><a id="16238" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="16240" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16242" href="Varieties.FreeAlgebras.html#16098" class="Bound">q</a> <a id="16244" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16245" class="Symbol">)</a> <a id="16247" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a>  <a id="16250" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16253" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16270" class="Symbol">(</a><a id="16271" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="16274" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16276" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="16278" class="Symbol">)</a> <a id="16280" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="16282" href="Varieties.FreeAlgebras.html#15799" class="Bound">η</a> <a id="16284" href="Varieties.FreeAlgebras.html#16098" class="Bound">q</a> <a id="16286" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16310" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16312" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="16314" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16316" href="Varieties.FreeAlgebras.html#16098" class="Bound">q</a>      <a id="16323" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16328" href="Varieties.FreeAlgebras.html#16328" class="Function">goal</a> <a id="16333" class="Symbol">:</a> <a id="16335" href="Homomorphisms.Basic.html#6477" class="Function">epi</a> <a id="16339" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="16341" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a>
  <a id="16345" href="Varieties.FreeAlgebras.html#16328" class="Function">goal</a> <a id="16350" class="Symbol">=</a> <a id="16352" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a> <a id="16356" class="Symbol">(</a><a id="16357" href="Homomorphisms.Noether.html#9852" class="Function">HomFactorEpi</a> <a id="16370" class="Symbol">(</a><a id="16371" href="Varieties.FreeAlgebras.html#10433" class="Bound">wd</a> <a id="16374" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16376" class="Symbol">(</a><a id="16377" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="16382" class="Symbol">(</a><a id="16383" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16386" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16387" class="Symbol">)))</a> <a id="16391" href="Varieties.FreeAlgebras.html#15796" class="Bound">𝑨</a> <a id="16393" href="Varieties.FreeAlgebras.html#15831" class="Function">φ</a> <a id="16395" href="Varieties.FreeAlgebras.html#11761" class="Function">hom𝔽</a> <a id="16400" href="Varieties.FreeAlgebras.html#16042" class="Function">kerincl</a> <a id="16408" href="Varieties.FreeAlgebras.html#11808" class="Function">hom𝔽-is-epic</a> <a id="16421" href="Varieties.FreeAlgebras.html#15869" class="Function">φE</a><a id="16423" class="Symbol">)</a>

</pre>



#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16783" class="Keyword">module</a> <a id="16790" href="Varieties.FreeAlgebras.html#16790" class="Module">_</a> <a id="16792" class="Symbol">(</a><a id="16793" href="Varieties.FreeAlgebras.html#16793" class="Bound">pe</a> <a id="16796" class="Symbol">:</a> <a id="16798" href="Equality.Extensionality.html#3272" class="Function">pred-ext</a> <a id="16807" class="Symbol">(</a><a id="16808" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16811" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16812" class="Symbol">)(</a><a id="16814" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16817" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16818" class="Symbol">))(</a><a id="16821" href="Varieties.FreeAlgebras.html#16821" class="Bound">wd</a> <a id="16824" class="Symbol">:</a> <a id="16826" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="16834" class="Symbol">)</a> <a id="16836" class="Comment">-- extensionality assumptions</a>
          <a id="16876" class="Symbol">(</a><a id="16877" href="Varieties.FreeAlgebras.html#16877" class="Bound">Cset</a> <a id="16882" class="Symbol">:</a> <a id="16884" href="Equality.Truncation.html#6610" class="Function">is-set</a> <a id="16891" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16893" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="16895" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="16896" class="Symbol">)</a>                       <a id="16920" class="Comment">-- truncation assumptions</a>
          <a id="16956" class="Symbol">(</a><a id="16957" href="Varieties.FreeAlgebras.html#16957" class="Bound">kuip</a> <a id="16962" class="Symbol">:</a> <a id="16964" href="Equality.Truncation.html#10868" class="Function">blk-uip</a><a id="16971" class="Symbol">(</a><a id="16972" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="16977" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="16978" class="Symbol">)</a><a id="16979" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a> <a id="16981" href="Homomorphisms.Basic.html#8154" class="Function">kercon</a> <a id="16988" class="Symbol">(</a><a id="16989" href="Varieties.FreeAlgebras.html#16821" class="Bound">wd</a> <a id="16992" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16994" class="Symbol">(</a><a id="16995" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16998" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16999" class="Symbol">)){</a><a id="17002" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a><a id="17003" class="Symbol">}</a><a id="17004" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="17009" href="Overture.Preliminaries.html#4379" class="Function Operator">∣</a><a id="17010" class="Symbol">)</a>
  <a id="17014" class="Keyword">where</a>

  <a id="17023" href="Varieties.FreeAlgebras.html#17023" class="Function">𝔽≤ℭ</a> <a id="17027" class="Symbol">:</a> <a id="17029" class="Symbol">(</a><a id="17030" href="Homomorphisms.Basic.html#8562" class="Function Operator">ker[</a> <a id="17035" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="17037" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="17039" href="Homomorphisms.Basic.html#8562" class="Function Operator">⇒</a> <a id="17041" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="17043" href="Homomorphisms.Basic.html#8562" class="Function Operator">]</a> <a id="17045" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="17050" href="Homomorphisms.Basic.html#8562" class="Function Operator">↾</a> <a id="17052" class="Symbol">(</a><a id="17053" href="Varieties.FreeAlgebras.html#16821" class="Bound">wd</a> <a id="17056" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17058" class="Symbol">(</a><a id="17059" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17062" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17063" class="Symbol">)))</a> <a id="17067" href="Subalgebras.Subalgebras.html#2483" class="Function Operator">≤</a> <a id="17069" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a>
  <a id="17073" href="Varieties.FreeAlgebras.html#17023" class="Function">𝔽≤ℭ</a> <a id="17077" class="Symbol">=</a> <a id="17079" href="Subalgebras.Subalgebras.html#4309" class="Function">FirstHomCorollary|Set</a> <a id="17101" class="Symbol">(</a><a id="17102" href="Terms.Basic.html#3263" class="Function">𝑻</a> <a id="17104" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="17105" class="Symbol">)</a> <a id="17107" href="Varieties.FreeAlgebras.html#10832" class="Function">ℭ</a> <a id="17109" href="Varieties.FreeAlgebras.html#11019" class="Function">homℭ</a> <a id="17114" href="Varieties.FreeAlgebras.html#16793" class="Bound">pe</a> <a id="17117" class="Symbol">(</a><a id="17118" href="Varieties.FreeAlgebras.html#16821" class="Bound">wd</a> <a id="17121" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17123" class="Symbol">(</a><a id="17124" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17127" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17128" class="Symbol">))</a> <a id="17131" href="Varieties.FreeAlgebras.html#16877" class="Bound">Cset</a> <a id="17136" href="Varieties.FreeAlgebras.html#16957" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="18199" href="Varieties.FreeAlgebras.html#18199" class="Function">𝔽∈SP</a> <a id="18204" class="Symbol">:</a> <a id="18206" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18214" class="Symbol">(</a><a id="18215" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18218" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18219" class="Symbol">)(</a><a id="18221" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18224" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18225" class="Symbol">)</a> <a id="18227" class="Symbol">→</a> <a id="18229" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="18231" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18233" class="Symbol">(</a><a id="18234" href="Varieties.Closure.html#3774" class="Datatype">S</a><a id="18235" class="Symbol">{</a><a id="18236" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18237" class="Symbol">}{</a><a id="18239" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="18241" class="Symbol">}</a> <a id="18243" class="Symbol">(</a><a id="18244" href="Varieties.Closure.html#4358" class="Datatype">P</a><a id="18245" class="Symbol">{</a><a id="18246" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18247" class="Symbol">}{</a><a id="18249" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18250" class="Symbol">}</a> <a id="18252" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a><a id="18253" class="Symbol">))</a>
  <a id="18258" href="Varieties.FreeAlgebras.html#18199" class="Function">𝔽∈SP</a> <a id="18263" href="Varieties.FreeAlgebras.html#18263" class="Bound">hfe</a> <a id="18267" class="Symbol">=</a> <a id="18269" href="Varieties.Closure.html#3982" class="InductiveConstructor">ssub</a> <a id="18274" class="Symbol">(</a><a id="18275" href="Varieties.Preservation.html#13006" class="Function">class-prod-s-∈-sp</a> <a id="18293" href="Varieties.FreeAlgebras.html#18263" class="Bound">hfe</a><a id="18296" class="Symbol">)</a> <a id="18298" href="Varieties.FreeAlgebras.html#17023" class="Function">𝔽≤ℭ</a>

  <a id="18305" href="Varieties.FreeAlgebras.html#18305" class="Function">𝔽∈𝕍</a> <a id="18309" class="Symbol">:</a> <a id="18311" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18319" class="Symbol">(</a><a id="18320" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18323" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18324" class="Symbol">)(</a><a id="18326" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18329" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18330" class="Symbol">)</a> <a id="18332" class="Symbol">→</a> <a id="18334" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="18336" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18338" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18340" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
  <a id="18344" href="Varieties.FreeAlgebras.html#18305" class="Function">𝔽∈𝕍</a> <a id="18348" href="Varieties.FreeAlgebras.html#18348" class="Bound">hfe</a> <a id="18352" class="Symbol">=</a> <a id="18354" href="Varieties.Preservation.html#9299" class="Function">SP⊆V&#39;</a> <a id="18360" class="Symbol">{</a><a id="18361" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18362" class="Symbol">}{</a><a id="18364" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="18367" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="18369" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18370" class="Symbol">}{</a><a id="18372" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="18375" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="18378" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="18380" class="Symbol">}{</a><a id="18382" href="Varieties.FreeAlgebras.html#10419" class="Bound">fe</a> <a id="18385" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="18387" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18388" class="Symbol">}{</a><a id="18390" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a><a id="18391" class="Symbol">}</a> <a id="18393" class="Symbol">(</a><a id="18394" href="Varieties.FreeAlgebras.html#18199" class="Function">𝔽∈SP</a> <a id="18399" href="Varieties.FreeAlgebras.html#18348" class="Bound">hfe</a><a id="18402" class="Symbol">)</a>

</pre>

#### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18739" href="Varieties.FreeAlgebras.html#18739" class="Function">Birkhoff</a> <a id="18748" class="Symbol">:</a> <a id="18750" href="Equality.Truncation.html#3959" class="Function">hfunext</a> <a id="18758" class="Symbol">(</a><a id="18759" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18762" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18763" class="Symbol">)(</a><a id="18765" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18768" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18769" class="Symbol">)</a> <a id="18771" class="Symbol">→</a> <a id="18773" class="Symbol">(∀</a> <a id="18776" href="Varieties.FreeAlgebras.html#18776" class="Bound">𝑨</a> <a id="18778" class="Symbol">→</a> <a id="18780" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a> <a id="18782" href="Varieties.FreeAlgebras.html#15627" class="Function Operator">↠</a> <a id="18784" href="Varieties.FreeAlgebras.html#18776" class="Bound">𝑨</a><a id="18785" class="Symbol">)</a> <a id="18787" class="Symbol">→</a> <a id="18789" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a> <a id="18793" class="Symbol">(</a><a id="18794" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="18797" class="Symbol">(</a><a id="18798" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18800" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a><a id="18801" class="Symbol">))</a> <a id="18804" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18806" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="18808" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a>
  <a id="18812" href="Varieties.FreeAlgebras.html#18739" class="Function">Birkhoff</a> <a id="18821" href="Varieties.FreeAlgebras.html#18821" class="Bound">hfe</a> <a id="18825" href="Varieties.FreeAlgebras.html#18825" class="Bound">𝕏</a> <a id="18827" class="Symbol">{</a><a id="18828" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a><a id="18829" class="Symbol">}</a> <a id="18831" href="Varieties.FreeAlgebras.html#18831" class="Bound">α</a> <a id="18833" class="Symbol">=</a> <a id="18835" href="Varieties.Closure.html#5597" class="InductiveConstructor">vhimg</a><a id="18840" class="Symbol">{</a><a id="18841" class="Argument">𝑩</a> <a id="18843" class="Symbol">=</a> <a id="18845" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a><a id="18846" class="Symbol">}</a> <a id="18848" class="Symbol">(</a><a id="18849" href="Varieties.FreeAlgebras.html#18305" class="Function">𝔽∈𝕍</a> <a id="18853" href="Varieties.FreeAlgebras.html#18821" class="Bound">hfe</a><a id="18856" class="Symbol">)</a> <a id="18858" class="Symbol">(</a><a id="18859" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a> <a id="18861" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18863" href="Homomorphisms.Basic.html#6944" class="Function">epi-to-hom</a> <a id="18874" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a> <a id="18876" href="Varieties.FreeAlgebras.html#18905" class="Function">φE</a> <a id="18879" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18881" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="18885" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a> <a id="18887" href="Varieties.FreeAlgebras.html#18905" class="Function">φE</a> <a id="18890" href="Overture.Preliminaries.html#4417" class="Function Operator">∥</a><a id="18891" class="Symbol">)</a>
   <a id="18896" class="Keyword">where</a>
   <a id="18905" href="Varieties.FreeAlgebras.html#18905" class="Function">φE</a> <a id="18908" class="Symbol">:</a> <a id="18910" href="Homomorphisms.Basic.html#6477" class="Function">epi</a> <a id="18914" href="Varieties.FreeAlgebras.html#11644" class="Function">𝔽</a> <a id="18916" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a>
   <a id="18921" href="Varieties.FreeAlgebras.html#18905" class="Function">φE</a> <a id="18924" class="Symbol">=</a> <a id="18926" href="Varieties.FreeAlgebras.html#15712" class="Function">𝔽-ModTh-epi</a> <a id="18938" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a> <a id="18940" class="Symbol">(</a><a id="18941" href="Varieties.FreeAlgebras.html#18825" class="Bound">𝕏</a> <a id="18943" href="Varieties.FreeAlgebras.html#18828" class="Bound">𝑨</a><a id="18944" class="Symbol">)</a> <a id="18946" href="Varieties.FreeAlgebras.html#18831" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="19204" href="Varieties.FreeAlgebras.html#19204" class="Function">Birkhoff-converse</a> <a id="19222" class="Symbol">:</a> <a id="19224" href="Varieties.Closure.html#5316" class="Datatype">V</a><a id="19225" class="Symbol">{</a><a id="19226" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="19227" class="Symbol">}{</a><a id="19229" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="19230" class="Symbol">}</a> <a id="19232" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a> <a id="19234" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19236" href="Varieties.EquationalLogic.html#4016" class="Function">Mod</a><a id="19239" class="Symbol">{</a><a id="19240" class="Argument">X</a> <a id="19242" class="Symbol">=</a> <a id="19244" href="Varieties.FreeAlgebras.html#10448" class="Bound">X</a><a id="19245" class="Symbol">}</a> <a id="19247" class="Symbol">(</a><a id="19248" href="Varieties.EquationalLogic.html#3442" class="Function">Th</a> <a id="19251" class="Symbol">(</a><a id="19252" href="Varieties.Closure.html#5316" class="Datatype">V</a> <a id="19254" href="Varieties.FreeAlgebras.html#10461" class="Bound">𝒦</a><a id="19255" class="Symbol">))</a>
  <a id="19260" href="Varieties.FreeAlgebras.html#19204" class="Function">Birkhoff-converse</a> <a id="19278" href="Varieties.FreeAlgebras.html#19278" class="Bound">α</a> <a id="19280" href="Varieties.FreeAlgebras.html#19280" class="Bound">p</a> <a id="19282" href="Varieties.FreeAlgebras.html#19282" class="Bound">q</a> <a id="19284" href="Varieties.FreeAlgebras.html#19284" class="Bound">pThq</a> <a id="19289" class="Symbol">=</a> <a id="19291" href="Varieties.FreeAlgebras.html#19284" class="Bound">pThq</a> <a id="19296" href="Varieties.FreeAlgebras.html#19278" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.

--------------------------------

<span style="float:left;">[← Varieties.Preservation](Varieties.Preservation.html)</span>
<span style="float:right;">[Varieties.Setoid →](Varieties.Setoid.html)</span>

{% include UALib.Links.md %}
