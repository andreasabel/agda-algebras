---
layout: default
title : Varieties.FreeAlgebras module (Agda Universal Algebra Library)
date : 2021-03-01
author: [agda-algebras development team][]
---

### <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras.Basic][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="806" class="Symbol">{-#</a> <a id="810" class="Keyword">OPTIONS</a> <a id="818" class="Pragma">--without-K</a> <a id="830" class="Pragma">--exact-split</a> <a id="844" class="Pragma">--safe</a> <a id="851" class="Symbol">#-}</a>


<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Level.html" class="Module">Level</a> <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a> <a id="886" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="890" class="Symbol">to</a> <a id="893" class="Primitive">lsuc</a> <a id="898" class="Symbol">)</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a> <a id="935" href="Algebras.Basic.html#1155" class="Generalizable">𝓞</a> <a id="937" class="Symbol">;</a> <a id="939" href="Algebras.Basic.html#1157" class="Generalizable">𝓥</a> <a id="941" class="Symbol">;</a> <a id="943" href="Algebras.Basic.html#3581" class="Function">Signature</a> <a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">module</a> <a id="963" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="986" class="Symbol">{</a><a id="987" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="989" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="991" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="1000" class="Symbol">}</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="1005" class="Symbol">:</a> <a id="1007" href="Algebras.Basic.html#3581" class="Function">Signature</a> <a id="1017" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="1019" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a><a id="1020" class="Symbol">)</a> <a id="1022" class="Keyword">where</a>

<a id="1029" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">()</a> <a id="1186" class="Keyword">renaming</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1211" class="Symbol">to</a> <a id="1214" class="Function">funext</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1250" class="Keyword">using</a> <a id="1256" class="Symbol">(</a> <a id="1258" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1262" class="Symbol">)</a> <a id="1264" class="Keyword">renaming</a> <a id="1273" class="Symbol">(</a> <a id="1275" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1279" class="Symbol">to</a> <a id="1282" class="Primitive">Type</a> <a id="1287" class="Symbol">)</a>
<a id="1289" class="Keyword">open</a> <a id="1294" class="Keyword">import</a> <a id="1301" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1317" class="Keyword">using</a> <a id="1323" class="Symbol">(</a> <a id="1325" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1329" class="Symbol">;</a> <a id="1331" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1340" class="Symbol">;</a> <a id="1342" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1346" class="Symbol">)</a> <a id="1348" class="Keyword">renaming</a> <a id="1357" class="Symbol">(</a> <a id="1359" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1365" class="Symbol">to</a> <a id="1368" class="Field">fst</a> <a id="1372" class="Symbol">;</a> <a id="1374" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1380" class="Symbol">to</a> <a id="1383" class="Field">snd</a> <a id="1387" class="Symbol">)</a>
<a id="1389" class="Keyword">open</a> <a id="1394" class="Keyword">import</a> <a id="1401" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1417" class="Keyword">using</a> <a id="1423" class="Symbol">(</a> <a id="1425" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1429" class="Symbol">)</a>
<a id="1431" class="Keyword">open</a> <a id="1436" class="Keyword">import</a> <a id="1443" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1459" class="Keyword">using</a> <a id="1465" class="Symbol">(</a> <a id="1467" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1481" class="Symbol">)</a> <a id="1483" class="Keyword">renaming</a> <a id="1492" class="Symbol">(</a> <a id="1494" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1498" class="Symbol">to</a> <a id="1501" class="Function">BinRel</a> <a id="1508" class="Symbol">)</a>
<a id="1510" class="Keyword">open</a> <a id="1515" class="Keyword">import</a> <a id="1522" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1588" class="Keyword">using</a> <a id="1594" class="Symbol">(</a> <a id="1596" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1614" class="Symbol">;</a> <a id="1616" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1625" class="Symbol">;</a> <a id="1627" class="Keyword">module</a> <a id="1634" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1646" class="Symbol">)</a>
<a id="1648" class="Keyword">open</a> <a id="1653" class="Keyword">import</a> <a id="1660" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1676" class="Keyword">using</a>    <a id="1685" class="Symbol">(</a> <a id="1687" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1692" class="Symbol">;</a> <a id="1694" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1698" class="Symbol">;</a> <a id="1700" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1704" class="Symbol">;</a> <a id="1706" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1710" class="Symbol">;</a> <a id="1712" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1716" class="Symbol">)</a>

<a id="1719" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1814" class="Keyword">open</a> <a id="1819" class="Keyword">import</a> <a id="1826" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1861" class="Keyword">using</a> <a id="1867" class="Symbol">(</a> <a id="1869" href="Overture.Preliminaries.html#4245" class="Function Operator">∣_∣</a> <a id="1873" class="Symbol">;</a> <a id="1875" href="Overture.Preliminaries.html#4283" class="Function Operator">∥_∥</a> <a id="1879" class="Symbol">;</a> <a id="1881" href="Overture.Preliminaries.html#5275" class="Function Operator">_∙_</a> <a id="1885" class="Symbol">;</a> <a id="1887" href="Overture.Preliminaries.html#4949" class="Function Operator">_⁻¹</a> <a id="1891" class="Symbol">)</a>
<a id="1893" class="Keyword">open</a> <a id="1898" class="Keyword">import</a> <a id="1905" href="Overture.Inverses.html" class="Module">Overture.Inverses</a>                  <a id="1940" class="Keyword">using</a> <a id="1946" class="Symbol">(</a> <a id="1948" href="Overture.Inverses.html#3227" class="Function">IsSurjective</a> <a id="1961" class="Symbol">)</a>
<a id="1963" class="Keyword">open</a> <a id="1968" class="Keyword">import</a> <a id="1975" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2010" class="Keyword">using</a> <a id="2016" class="Symbol">(</a> <a id="2018" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="2025" class="Symbol">)</a>
<a id="2027" class="Keyword">open</a> <a id="2032" class="Keyword">import</a> <a id="2039" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2074" class="Keyword">using</a> <a id="2080" class="Symbol">(</a> <a id="2082" href="Relations.Quotients.html#5179" class="Function Operator">⟪_⟫</a> <a id="2086" class="Symbol">)</a>
<a id="2088" class="Keyword">open</a> <a id="2093" class="Keyword">import</a> <a id="2100" href="Foundations.Truncation.html" class="Module">Foundations.Truncation</a>             <a id="2135" class="Keyword">using</a> <a id="2141" class="Symbol">(</a> <a id="2143" href="Foundations.Truncation.html#6586" class="Function">is-set</a> <a id="2150" class="Symbol">;</a> <a id="2152" href="Foundations.Truncation.html#10844" class="Function">blk-uip</a> <a id="2160" class="Symbol">;</a> <a id="2162" href="Foundations.Truncation.html#3935" class="Function">hfunext</a> <a id="2170" class="Symbol">)</a>
<a id="2172" class="Keyword">open</a> <a id="2177" class="Keyword">import</a> <a id="2184" href="Foundations.Welldefined.html" class="Module">Foundations.Welldefined</a>            <a id="2219" class="Keyword">using</a> <a id="2225" class="Symbol">(</a> <a id="2227" href="Foundations.Welldefined.html#3233" class="Function">SwellDef</a> <a id="2236" class="Symbol">;</a> <a id="2238" href="Foundations.Welldefined.html#2935" class="Function">swelldef</a> <a id="2247" class="Symbol">)</a>
<a id="2249" class="Keyword">open</a> <a id="2254" class="Keyword">import</a> <a id="2261" href="Foundations.Extensionality.html" class="Module">Foundations.Extensionality</a>         <a id="2296" class="Keyword">using</a> <a id="2302" class="Symbol">(</a> <a id="2304" href="Foundations.Extensionality.html#2528" class="Function">DFunExt</a><a id="2311" class="Symbol">;</a> <a id="2313" href="Foundations.Extensionality.html#4368" class="Function">pred-ext</a> <a id="2322" class="Symbol">)</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2371" class="Keyword">using</a> <a id="2377" class="Symbol">(</a> <a id="2379" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="2387" class="Symbol">;</a> <a id="2389" href="Algebras.Basic.html#9813" class="Function">Lift-Alg</a> <a id="2398" class="Symbol">;</a> <a id="2400" href="Algebras.Basic.html#11366" class="Function">compatible</a> <a id="2411" class="Symbol">;</a> <a id="2413" href="Algebras.Basic.html#8352" class="Function Operator">_̂_</a> <a id="2417" class="Symbol">)</a>
<a id="2419" class="Keyword">open</a> <a id="2424" class="Keyword">import</a> <a id="2431" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2458" class="Symbol">{</a><a id="2459" class="Argument">𝑆</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2464" class="Symbol">}</a> <a id="2466" class="Keyword">using</a> <a id="2472" class="Symbol">(</a> <a id="2474" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="2477" class="Symbol">;</a> <a id="2479" href="Algebras.Products.html#1808" class="Function">⨅</a> <a id="2481" class="Symbol">)</a>
<a id="2483" class="Keyword">open</a> <a id="2488" class="Keyword">import</a> <a id="2495" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2522" class="Symbol">{</a><a id="2523" class="Argument">𝑆</a> <a id="2525" class="Symbol">=</a> <a id="2527" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2528" class="Symbol">}</a> <a id="2530" class="Keyword">using</a> <a id="2536" class="Symbol">(</a> <a id="2538" href="Algebras.Congruences.html#1985" class="Function">Con</a><a id="2541" class="Symbol">;</a> <a id="2543" href="Algebras.Congruences.html#1887" class="InductiveConstructor">mkcon</a> <a id="2549" class="Symbol">;</a> <a id="2551" href="Algebras.Congruences.html#1799" class="Record">IsCongruence</a> <a id="2564" class="Symbol">)</a>
<a id="2566" class="Keyword">open</a> <a id="2571" class="Keyword">import</a> <a id="2578" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2605" class="Symbol">{</a><a id="2606" class="Argument">𝑆</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2611" class="Symbol">}</a> <a id="2613" class="Keyword">using</a> <a id="2619" class="Symbol">(</a> <a id="2621" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="2625" class="Symbol">;</a> <a id="2627" href="Homomorphisms.Basic.html#10716" class="Function">⨅-hom-co</a> <a id="2636" class="Symbol">;</a> <a id="2638" href="Homomorphisms.Basic.html#8060" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2650" class="Symbol">;</a> <a id="2652" href="Homomorphisms.Basic.html#5975" class="Function">epi</a>
                                                     <a id="2709" class="Symbol">;</a> <a id="2711" href="Homomorphisms.Basic.html#9519" class="Function">πker</a> <a id="2716" class="Symbol">;</a> <a id="2718" href="Homomorphisms.Basic.html#6442" class="Function">epi-to-hom</a> <a id="2729" class="Symbol">;</a> <a id="2731" href="Homomorphisms.Basic.html#10028" class="Function">ker-in-con</a>
                                                     <a id="2795" class="Symbol">;</a>  <a id="2798" href="Homomorphisms.Basic.html#7652" class="Function">kercon</a> <a id="2805" class="Symbol">;</a> <a id="2807" href="Homomorphisms.Basic.html#3466" class="Function">∘-hom</a> <a id="2813" class="Symbol">)</a>
<a id="2815" class="Keyword">open</a> <a id="2820" class="Keyword">import</a> <a id="2827" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2854" class="Symbol">{</a><a id="2855" class="Argument">𝑆</a> <a id="2857" class="Symbol">=</a> <a id="2859" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2860" class="Symbol">}</a> <a id="2862" class="Keyword">using</a> <a id="2868" class="Symbol">(</a> <a id="2870" href="Homomorphisms.Noether.html#8579" class="Function">HomFactor</a> <a id="2880" class="Symbol">;</a> <a id="2882" href="Homomorphisms.Noether.html#9853" class="Function">HomFactorEpi</a> <a id="2895" class="Symbol">)</a>
<a id="2897" class="Keyword">open</a> <a id="2902" class="Keyword">import</a> <a id="2909" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2936" class="Symbol">{</a><a id="2937" class="Argument">𝑆</a> <a id="2939" class="Symbol">=</a> <a id="2941" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2942" class="Symbol">}</a> <a id="2944" class="Keyword">using</a> <a id="2950" class="Symbol">(</a> <a id="2952" href="Homomorphisms.Isomorphisms.html#2293" class="Record Operator">_≅_</a> <a id="2956" class="Symbol">;</a> <a id="2958" href="Homomorphisms.Isomorphisms.html#2836" class="Function">≅-refl</a> <a id="2965" class="Symbol">;</a> <a id="2967" href="Homomorphisms.Isomorphisms.html#2926" class="Function">≅-sym</a> <a id="2973" class="Symbol">;</a> <a id="2975" href="Homomorphisms.Isomorphisms.html#4397" class="Function">Lift-≅</a> <a id="2982" class="Symbol">)</a>
<a id="2984" class="Keyword">open</a> <a id="2989" class="Keyword">import</a> <a id="2996" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3023" class="Symbol">{</a><a id="3024" class="Argument">𝑆</a> <a id="3026" class="Symbol">=</a> <a id="3028" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3029" class="Symbol">}</a> <a id="3031" class="Keyword">using</a> <a id="3037" class="Symbol">(</a> <a id="3039" href="Terms.Basic.html#1853" class="Datatype">Term</a> <a id="3044" class="Symbol">;</a> <a id="3046" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="3048" class="Symbol">)</a>
<a id="3050" class="Keyword">open</a> <a id="3055" class="Keyword">import</a> <a id="3062" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3089" class="Symbol">{</a><a id="3090" class="Argument">𝑆</a> <a id="3092" class="Symbol">=</a> <a id="3094" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3095" class="Symbol">}</a> <a id="3097" class="Keyword">using</a> <a id="3103" class="Symbol">(</a> <a id="3105" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="3115" class="Symbol">;</a> <a id="3117" href="Terms.Properties.html#3164" class="Function">lift-hom</a>
                                                     <a id="3179" class="Symbol">;</a> <a id="3181" href="Terms.Properties.html#3563" class="Function">free-unique</a> <a id="3193" class="Symbol">;</a> <a id="3195" href="Terms.Properties.html#4769" class="Function">lift-of-epi-is-epi</a> <a id="3214" class="Symbol">)</a>
<a id="3216" class="Keyword">open</a> <a id="3221" class="Keyword">import</a> <a id="3228" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3255" class="Symbol">{</a><a id="3256" class="Argument">𝑆</a> <a id="3258" class="Symbol">=</a> <a id="3260" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3261" class="Symbol">}</a> <a id="3263" class="Keyword">using</a> <a id="3269" class="Symbol">(</a> <a id="3271" href="Terms.Operations.html#2527" class="Function Operator">_⟦_⟧</a><a id="3275" class="Symbol">;</a> <a id="3277" href="Terms.Operations.html#6534" class="Function">comm-hom-term</a><a id="3290" class="Symbol">;</a> <a id="3292" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="3309" class="Symbol">)</a>
<a id="3311" class="Keyword">open</a> <a id="3316" class="Keyword">import</a> <a id="3323" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3350" class="Symbol">{</a><a id="3351" class="Argument">𝑆</a> <a id="3353" class="Symbol">=</a> <a id="3355" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3356" class="Symbol">}</a> <a id="3358" class="Keyword">using</a> <a id="3364" class="Symbol">(</a> <a id="3366" href="Subalgebras.Subalgebras.html#2513" class="Function Operator">_≤_</a> <a id="3370" class="Symbol">;</a> <a id="3372" href="Subalgebras.Subalgebras.html#4345" class="Function">FirstHomCorollary|Set</a> <a id="3394" class="Symbol">)</a>
<a id="3396" class="Keyword">open</a> <a id="3401" class="Keyword">import</a> <a id="3408" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3435" class="Symbol">{</a><a id="3436" class="Argument">𝑆</a> <a id="3438" class="Symbol">=</a> <a id="3440" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3441" class="Symbol">}</a> <a id="3443" class="Keyword">using</a> <a id="3449" class="Symbol">(</a> <a id="3451" href="Varieties.EquationalLogic.html#2728" class="Function Operator">_⊫_≈_</a><a id="3456" class="Symbol">;</a> <a id="3458" href="Varieties.EquationalLogic.html#2650" class="Function Operator">_⊧_≈_</a><a id="3463" class="Symbol">;</a> <a id="3465" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a><a id="3467" class="Symbol">;</a> <a id="3469" href="Varieties.EquationalLogic.html#4029" class="Function">Mod</a> <a id="3473" class="Symbol">)</a>
<a id="3475" class="Keyword">open</a> <a id="3480" class="Keyword">import</a> <a id="3487" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3514" class="Symbol">{</a><a id="3515" class="Argument">𝑆</a> <a id="3517" class="Symbol">=</a> <a id="3519" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3520" class="Symbol">}</a> <a id="3522" class="Keyword">using</a> <a id="3528" class="Symbol">(</a> <a id="3530" href="Varieties.Closure.html#3790" class="Datatype">S</a> <a id="3532" class="Symbol">;</a> <a id="3534" href="Varieties.Closure.html#4374" class="Datatype">P</a> <a id="3536" class="Symbol">;</a> <a id="3538" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="3540" class="Symbol">)</a>
<a id="3542" class="Keyword">open</a> <a id="3547" class="Keyword">import</a> <a id="3554" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3581" class="Symbol">{</a><a id="3582" class="Argument">𝑆</a> <a id="3584" class="Symbol">=</a> <a id="3586" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3587" class="Symbol">}</a> <a id="3589" class="Keyword">using</a> <a id="3595" class="Symbol">(</a> <a id="3597" class="Keyword">module</a> <a id="3604" href="Varieties.Preservation.html#10417" class="Module">class-products-with-maps</a>
                                                     <a id="3682" class="Symbol">;</a> <a id="3684" href="Varieties.Preservation.html#20329" class="Function">class-ids-⇒</a> <a id="3696" class="Symbol">;</a> <a id="3698" href="Varieties.Preservation.html#20442" class="Function">class-ids</a> <a id="3708" class="Symbol">;</a> <a id="3710" href="Varieties.Preservation.html#9267" class="Function">SP⊆V&#39;</a><a id="3715" class="Symbol">)</a>
<a id="3717" class="Keyword">open</a> <a id="3722" href="Terms.Basic.html#1853" class="Module">Term</a>
<a id="3727" class="Keyword">open</a> <a id="3732" href="Varieties.Closure.html#3790" class="Module">S</a>
<a id="3734" class="Keyword">open</a> <a id="3739" href="Varieties.Closure.html#5334" class="Module">V</a>

<a id="𝓕"></a><a id="3742" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3744" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="3747" class="Symbol">:</a> <a id="3749" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3755" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="3757" class="Symbol">=</a> <a id="3759" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="3762" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a>
<a id="3764" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="3767" class="Symbol">=</a> <a id="3769" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="3774" class="Symbol">(</a><a id="3775" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="3778" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="3779" class="Symbol">)</a>    <a id="3784" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the **free algebra over** `𝒦` **generated by** `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.<sup>[1](Varieties.FreeAlgebras.html#fn1)</sup>


#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6087" class="Keyword">module</a> <a id="6094" href="Varieties.FreeAlgebras.html#6094" class="Module">_</a> <a id="6096" class="Symbol">{</a><a id="6097" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a> <a id="6099" class="Symbol">:</a> <a id="6101" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="6106" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6107" class="Symbol">}(</a><a id="6109" href="Varieties.FreeAlgebras.html#6109" class="Bound">𝒦</a> <a id="6111" class="Symbol">:</a> <a id="6113" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6118" class="Symbol">(</a><a id="6119" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="6127" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6129" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6130" class="Symbol">)</a> <a id="6132" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="6133" class="Symbol">)</a> <a id="6135" class="Keyword">where</a>

 <a id="6143" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="6145" class="Symbol">:</a> <a id="6147" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6152" class="Symbol">(</a><a id="6153" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6155" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6157" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a> <a id="6159" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6161" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6163" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6165" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6167" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a> <a id="6169" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="6170" class="Symbol">)</a> <a id="6172" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a>
 <a id="6175" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="6177" class="Symbol">(</a><a id="6178" href="Varieties.FreeAlgebras.html#6178" class="Bound">p</a> <a id="6180" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6182" href="Varieties.FreeAlgebras.html#6182" class="Bound">q</a><a id="6183" class="Symbol">)</a> <a id="6185" class="Symbol">=</a> <a id="6187" class="Symbol">∀(</a><a id="6189" href="Varieties.FreeAlgebras.html#6189" class="Bound">𝑨</a> <a id="6191" class="Symbol">:</a> <a id="6193" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="6201" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6203" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6204" class="Symbol">)(</a><a id="6206" href="Varieties.FreeAlgebras.html#6206" class="Bound">sA</a> <a id="6209" class="Symbol">:</a> <a id="6211" href="Varieties.FreeAlgebras.html#6189" class="Bound">𝑨</a> <a id="6213" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6215" href="Varieties.Closure.html#3790" class="Datatype">S</a><a id="6216" class="Symbol">{</a><a id="6217" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6218" class="Symbol">}{</a><a id="6220" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6221" class="Symbol">}</a> <a id="6223" href="Varieties.FreeAlgebras.html#6109" class="Bound">𝒦</a><a id="6224" class="Symbol">)(</a><a id="6226" href="Varieties.FreeAlgebras.html#6226" class="Bound">h</a> <a id="6228" class="Symbol">:</a> <a id="6230" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a> <a id="6232" class="Symbol">→</a> <a id="6234" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6236" href="Varieties.FreeAlgebras.html#6189" class="Bound">𝑨</a> <a id="6238" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6240" class="Symbol">)</a>
                 <a id="6259" class="Symbol">→</a>  <a id="6262" class="Symbol">(</a><a id="6263" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="6273" href="Varieties.FreeAlgebras.html#6189" class="Bound">𝑨</a> <a id="6275" href="Varieties.FreeAlgebras.html#6226" class="Bound">h</a><a id="6276" class="Symbol">)</a> <a id="6278" href="Varieties.FreeAlgebras.html#6178" class="Bound">p</a> <a id="6280" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6282" class="Symbol">(</a><a id="6283" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="6293" href="Varieties.FreeAlgebras.html#6189" class="Bound">𝑨</a> <a id="6295" href="Varieties.FreeAlgebras.html#6226" class="Bound">h</a><a id="6296" class="Symbol">)</a> <a id="6298" href="Varieties.FreeAlgebras.html#6182" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6427" href="Varieties.FreeAlgebras.html#6427" class="Function">ψRel</a> <a id="6432" class="Symbol">:</a> <a id="6434" href="Varieties.FreeAlgebras.html#1501" class="Function">BinRel</a> <a id="6441" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6443" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6445" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a> <a id="6447" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6449" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a>
 <a id="6452" href="Varieties.FreeAlgebras.html#6427" class="Function">ψRel</a> <a id="6457" href="Varieties.FreeAlgebras.html#6457" class="Bound">p</a> <a id="6459" href="Varieties.FreeAlgebras.html#6459" class="Bound">q</a> <a id="6461" class="Symbol">=</a> <a id="6463" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="6465" class="Symbol">(</a><a id="6466" href="Varieties.FreeAlgebras.html#6457" class="Bound">p</a> <a id="6468" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6470" href="Varieties.FreeAlgebras.html#6459" class="Bound">q</a><a id="6471" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6719" class="Keyword">open</a> <a id="6724" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6738" href="Varieties.FreeAlgebras.html#6738" class="Function">ψcompatible</a> <a id="6750" class="Symbol">:</a> <a id="6752" href="Foundations.Welldefined.html#2935" class="Function">swelldef</a> <a id="6761" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="6763" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6765" class="Symbol">→</a> <a id="6767" href="Algebras.Basic.html#11366" class="Function">compatible</a> <a id="6778" class="Symbol">(</a><a id="6779" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6781" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="6782" class="Symbol">)</a> <a id="6784" href="Varieties.FreeAlgebras.html#6427" class="Function">ψRel</a>
 <a id="6790" href="Varieties.FreeAlgebras.html#6738" class="Function">ψcompatible</a> <a id="6802" href="Varieties.FreeAlgebras.html#6802" class="Bound">wd</a> <a id="6805" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6807" class="Symbol">{</a><a id="6808" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a><a id="6809" class="Symbol">}</a> <a id="6811" class="Symbol">{</a><a id="6812" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="6813" class="Symbol">}</a> <a id="6815" href="Varieties.FreeAlgebras.html#6815" class="Bound">ψpq</a> <a id="6819" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a> <a id="6821" href="Varieties.FreeAlgebras.html#6821" class="Bound">sA</a> <a id="6824" href="Varieties.FreeAlgebras.html#6824" class="Bound">h</a> <a id="6826" class="Symbol">=</a> <a id="6828" href="Varieties.FreeAlgebras.html#6878" class="Function">γ</a>
  <a id="6832" class="Keyword">where</a>
  <a id="6840" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6842" class="Symbol">:</a> <a id="6844" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="6848" class="Symbol">(</a><a id="6849" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6851" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="6852" class="Symbol">)</a> <a id="6854" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a>
  <a id="6858" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6860" class="Symbol">=</a> <a id="6862" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="6871" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a> <a id="6873" href="Varieties.FreeAlgebras.html#6824" class="Bound">h</a>

  <a id="6878" href="Varieties.FreeAlgebras.html#6878" class="Function">γ</a> <a id="6880" class="Symbol">:</a> <a id="6882" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6884" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6886" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6888" class="Symbol">((</a><a id="6890" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6892" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="6894" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6896" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="6897" class="Symbol">)</a> <a id="6899" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a><a id="6900" class="Symbol">)</a> <a id="6902" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6904" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6906" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6908" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6910" class="Symbol">((</a><a id="6912" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6914" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="6916" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6918" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="6919" class="Symbol">)</a> <a id="6921" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="6922" class="Symbol">)</a>

  <a id="6927" href="Varieties.FreeAlgebras.html#6878" class="Function">γ</a> <a id="6929" class="Symbol">=</a> <a id="6931" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6933" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6935" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6937" class="Symbol">((</a><a id="6939" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6941" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="6943" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="6945" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="6946" class="Symbol">)</a> <a id="6948" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a><a id="6949" class="Symbol">)</a>  <a id="6952" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6955" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="6957" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6959" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="6961" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6963" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a> <a id="6965" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="6973" class="Symbol">(</a><a id="6974" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="6976" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="6978" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a><a id="6979" class="Symbol">)</a> <a id="6981" class="Symbol">(</a><a id="6982" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6984" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="6986" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="6988" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6990" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a><a id="6991" class="Symbol">)</a>  <a id="6994" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="6997" href="Varieties.FreeAlgebras.html#6802" class="Bound">wd</a> <a id="7000" class="Symbol">(</a><a id="7001" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="7003" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="7005" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a><a id="7006" class="Symbol">)(</a><a id="7008" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7010" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="7012" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7014" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7016" href="Varieties.FreeAlgebras.html#6808" class="Bound">p</a><a id="7017" class="Symbol">)(</a><a id="7019" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7021" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="7023" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7025" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7027" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="7028" class="Symbol">)(λ</a> <a id="7032" href="Varieties.FreeAlgebras.html#7032" class="Bound">x</a> <a id="7034" class="Symbol">→</a> <a id="7036" href="Varieties.FreeAlgebras.html#6815" class="Bound">ψpq</a> <a id="7040" href="Varieties.FreeAlgebras.html#7032" class="Bound">x</a> <a id="7042" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a> <a id="7044" href="Varieties.FreeAlgebras.html#6821" class="Bound">sA</a> <a id="7047" href="Varieties.FreeAlgebras.html#6824" class="Bound">h</a><a id="7048" class="Symbol">)</a> <a id="7050" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7058" class="Symbol">(</a><a id="7059" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="7061" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="7063" href="Varieties.FreeAlgebras.html#6819" class="Bound">𝑨</a><a id="7064" class="Symbol">)</a> <a id="7066" class="Symbol">(</a><a id="7067" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7069" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="7071" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7073" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7075" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="7076" class="Symbol">)</a>  <a id="7079" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7082" class="Symbol">(</a><a id="7083" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="7085" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="7087" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="7089" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="7091" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="7092" class="Symbol">)</a><a id="7093" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a> <a id="7096" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7104" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7106" href="Varieties.FreeAlgebras.html#6840" class="Function">φ</a> <a id="7108" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="7110" class="Symbol">((</a><a id="7112" href="Varieties.FreeAlgebras.html#6805" class="Bound">𝑓</a> <a id="7114" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="7116" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="7118" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="7119" class="Symbol">)</a> <a id="7121" href="Varieties.FreeAlgebras.html#6812" class="Bound">q</a><a id="7122" class="Symbol">)</a>  <a id="7125" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7129" href="Varieties.FreeAlgebras.html#7129" class="Function">ψIsEquivalence</a> <a id="7144" class="Symbol">:</a> <a id="7146" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7160" href="Varieties.FreeAlgebras.html#6427" class="Function">ψRel</a>
 <a id="7166" href="Varieties.FreeAlgebras.html#7129" class="Function">ψIsEquivalence</a> <a id="7181" class="Symbol">=</a> <a id="7183" class="Keyword">record</a> <a id="7190" class="Symbol">{</a> <a id="7192" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7197" class="Symbol">=</a> <a id="7199" class="Symbol">λ</a> <a id="7201" href="Varieties.FreeAlgebras.html#7201" class="Bound">𝑨</a> <a id="7203" href="Varieties.FreeAlgebras.html#7203" class="Bound">sA</a> <a id="7206" href="Varieties.FreeAlgebras.html#7206" class="Bound">h</a> <a id="7208" class="Symbol">→</a> <a id="7210" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7240" class="Symbol">;</a> <a id="7242" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7246" class="Symbol">=</a> <a id="7248" class="Symbol">λ</a> <a id="7250" href="Varieties.FreeAlgebras.html#7250" class="Bound">x</a> <a id="7252" href="Varieties.FreeAlgebras.html#7252" class="Bound">𝑨</a> <a id="7254" href="Varieties.FreeAlgebras.html#7254" class="Bound">sA</a> <a id="7257" href="Varieties.FreeAlgebras.html#7257" class="Bound">h</a> <a id="7259" class="Symbol">→</a> <a id="7261" class="Symbol">(</a><a id="7262" href="Varieties.FreeAlgebras.html#7250" class="Bound">x</a> <a id="7264" href="Varieties.FreeAlgebras.html#7252" class="Bound">𝑨</a> <a id="7266" href="Varieties.FreeAlgebras.html#7254" class="Bound">sA</a> <a id="7269" href="Varieties.FreeAlgebras.html#7257" class="Bound">h</a><a id="7270" class="Symbol">)</a><a id="7271" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a>
                         <a id="7299" class="Symbol">;</a> <a id="7301" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7307" class="Symbol">=</a> <a id="7309" class="Symbol">λ</a> <a id="7311" href="Varieties.FreeAlgebras.html#7311" class="Bound">pψq</a> <a id="7315" href="Varieties.FreeAlgebras.html#7315" class="Bound">qψr</a> <a id="7319" href="Varieties.FreeAlgebras.html#7319" class="Bound">𝑨</a> <a id="7321" href="Varieties.FreeAlgebras.html#7321" class="Bound">sA</a> <a id="7324" href="Varieties.FreeAlgebras.html#7324" class="Bound">h</a> <a id="7326" class="Symbol">→</a> <a id="7328" class="Symbol">(</a><a id="7329" href="Varieties.FreeAlgebras.html#7311" class="Bound">pψq</a> <a id="7333" href="Varieties.FreeAlgebras.html#7319" class="Bound">𝑨</a> <a id="7335" href="Varieties.FreeAlgebras.html#7321" class="Bound">sA</a> <a id="7338" href="Varieties.FreeAlgebras.html#7324" class="Bound">h</a><a id="7339" class="Symbol">)</a> <a id="7341" href="Overture.Preliminaries.html#5275" class="Function Operator">∙</a> <a id="7343" class="Symbol">(</a><a id="7344" href="Varieties.FreeAlgebras.html#7315" class="Bound">qψr</a> <a id="7348" href="Varieties.FreeAlgebras.html#7319" class="Bound">𝑨</a> <a id="7350" href="Varieties.FreeAlgebras.html#7321" class="Bound">sA</a> <a id="7353" href="Varieties.FreeAlgebras.html#7324" class="Bound">h</a><a id="7354" class="Symbol">)</a> <a id="7356" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7656" href="Varieties.FreeAlgebras.html#7656" class="Function">ψCon</a> <a id="7661" class="Symbol">:</a> <a id="7663" href="Foundations.Welldefined.html#2935" class="Function">swelldef</a> <a id="7672" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="7674" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="7676" class="Symbol">→</a> <a id="7678" href="Algebras.Congruences.html#1985" class="Function">Con</a> <a id="7682" class="Symbol">(</a><a id="7683" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="7685" href="Varieties.FreeAlgebras.html#6097" class="Bound">X</a><a id="7686" class="Symbol">)</a>
 <a id="7689" href="Varieties.FreeAlgebras.html#7656" class="Function">ψCon</a> <a id="7694" href="Varieties.FreeAlgebras.html#7694" class="Bound">wd</a> <a id="7697" class="Symbol">=</a> <a id="7699" href="Varieties.FreeAlgebras.html#6427" class="Function">ψRel</a> <a id="7704" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7706" href="Algebras.Congruences.html#1887" class="InductiveConstructor">mkcon</a> <a id="7712" href="Varieties.FreeAlgebras.html#7129" class="Function">ψIsEquivalence</a> <a id="7727" class="Symbol">(</a><a id="7728" href="Varieties.FreeAlgebras.html#6738" class="Function">ψcompatible</a> <a id="7740" href="Varieties.FreeAlgebras.html#7694" class="Bound">wd</a><a id="7742" class="Symbol">)</a>

</pre>



#### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10197" class="Keyword">module</a> <a id="10204" href="Varieties.FreeAlgebras.html#10204" class="Module">_</a> <a id="10206" class="Symbol">{</a><a id="10207" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="10210" class="Symbol">:</a> <a id="10212" href="Foundations.Extensionality.html#2528" class="Function">DFunExt</a><a id="10219" class="Symbol">}{</a><a id="10221" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="10224" class="Symbol">:</a> <a id="10226" href="Foundations.Welldefined.html#3233" class="Function">SwellDef</a><a id="10234" class="Symbol">}{</a><a id="10236" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="10238" class="Symbol">:</a> <a id="10240" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="10245" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10246" class="Symbol">}</a> <a id="10248" class="Symbol">{</a><a id="10249" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="10251" class="Symbol">:</a> <a id="10253" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10258" class="Symbol">(</a><a id="10259" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="10267" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="10269" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="10270" class="Symbol">)</a> <a id="10272" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="10273" class="Symbol">}</a> <a id="10275" class="Keyword">where</a>

 <a id="10283" class="Keyword">open</a> <a id="10288" href="Varieties.Preservation.html#10417" class="Module">class-products-with-maps</a> <a id="10313" class="Symbol">{</a><a id="10314" class="Argument">X</a> <a id="10316" class="Symbol">=</a> <a id="10318" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="10319" class="Symbol">}{</a><a id="10321" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="10324" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10326" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10327" class="Symbol">}{</a><a id="10329" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="10332" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="10335" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="10337" class="Symbol">}{</a><a id="10339" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="10342" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10344" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="10345" class="Symbol">}</a> <a id="10347" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10562" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10620" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="10622" class="Symbol">:</a> <a id="10624" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="10632" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10634" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="10637" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="10639" class="Symbol">=</a> <a id="10641" href="Algebras.Products.html#1808" class="Function">⨅</a> <a id="10643" href="Varieties.Preservation.html#11834" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="10807" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="10812" class="Symbol">:</a> <a id="10814" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="10818" class="Symbol">(</a><a id="10819" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="10821" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="10822" class="Symbol">)</a> <a id="10824" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a>
 <a id="10827" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="10832" class="Symbol">=</a> <a id="10834" href="Homomorphisms.Basic.html#10716" class="Function">⨅-hom-co</a> <a id="10843" href="Varieties.Preservation.html#11834" class="Function">𝔄&#39;</a> <a id="10846" class="Symbol">(</a><a id="10847" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="10850" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="10852" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10853" class="Symbol">){</a><a id="10855" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="10856" class="Symbol">}(</a><a id="10858" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="10860" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="10861" class="Symbol">)</a> <a id="10863" class="Symbol">λ</a> <a id="10865" href="Varieties.FreeAlgebras.html#10865" class="Bound">i</a> <a id="10867" class="Symbol">→</a> <a id="10869" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="10878" class="Symbol">(</a><a id="10879" href="Varieties.Preservation.html#11834" class="Function">𝔄&#39;</a> <a id="10882" href="Varieties.FreeAlgebras.html#10865" class="Bound">i</a><a id="10883" class="Symbol">)(</a><a id="10885" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="10889" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="10891" href="Varieties.FreeAlgebras.html#10865" class="Bound">i</a> <a id="10893" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a><a id="10894" class="Symbol">)</a>

</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned above, the initial version of the [Agda UniversalAlgebra][] used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11400" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="11402" class="Symbol">:</a> <a id="11404" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="11412" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="11415" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="11418" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="11420" class="Symbol">=</a> <a id="11422" href="Homomorphisms.Basic.html#8060" class="Function Operator">ker[</a> <a id="11427" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="11429" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="11431" href="Homomorphisms.Basic.html#8060" class="Function Operator">⇒</a> <a id="11433" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="11435" href="Homomorphisms.Basic.html#8060" class="Function Operator">]</a> <a id="11437" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="11442" href="Homomorphisms.Basic.html#8060" class="Function Operator">↾</a> <a id="11444" class="Symbol">(</a><a id="11445" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="11448" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11450" class="Symbol">(</a><a id="11451" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="11454" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11455" class="Symbol">))</a>

 <a id="11460" href="Varieties.FreeAlgebras.html#11460" class="Function">epi𝔽</a> <a id="11465" class="Symbol">:</a> <a id="11467" href="Homomorphisms.Basic.html#5975" class="Function">epi</a> <a id="11471" class="Symbol">(</a><a id="11472" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="11474" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="11475" class="Symbol">)</a> <a id="11477" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a>
 <a id="11480" href="Varieties.FreeAlgebras.html#11460" class="Function">epi𝔽</a> <a id="11485" class="Symbol">=</a> <a id="11487" href="Homomorphisms.Basic.html#9519" class="Function">πker</a> <a id="11492" class="Symbol">(</a><a id="11493" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="11496" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11498" class="Symbol">(</a><a id="11499" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="11502" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11503" class="Symbol">))</a> <a id="11506" class="Symbol">{</a><a id="11507" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a><a id="11508" class="Symbol">}</a> <a id="11510" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a>

 <a id="11517" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="11522" class="Symbol">:</a> <a id="11524" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="11528" class="Symbol">(</a><a id="11529" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="11531" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="11532" class="Symbol">)</a> <a id="11534" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a>
 <a id="11537" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="11542" class="Symbol">=</a> <a id="11544" href="Homomorphisms.Basic.html#6442" class="Function">epi-to-hom</a> <a id="11555" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="11557" href="Varieties.FreeAlgebras.html#11460" class="Function">epi𝔽</a>

 <a id="11564" href="Varieties.FreeAlgebras.html#11564" class="Function">hom𝔽-is-epic</a> <a id="11577" class="Symbol">:</a> <a id="11579" href="Overture.Inverses.html#3227" class="Function">IsSurjective</a> <a id="11592" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11594" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="11599" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a>
 <a id="11602" href="Varieties.FreeAlgebras.html#11564" class="Function">hom𝔽-is-epic</a> <a id="11615" class="Symbol">=</a> <a id="11617" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11621" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="11623" href="Varieties.FreeAlgebras.html#11460" class="Function">epi𝔽</a> <a id="11628" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11726" href="Varieties.FreeAlgebras.html#11726" class="Function">ψlemma0</a> <a id="11734" class="Symbol">:</a> <a id="11736" class="Symbol">∀</a> <a id="11738" href="Varieties.FreeAlgebras.html#11738" class="Bound">p</a> <a id="11740" href="Varieties.FreeAlgebras.html#11740" class="Bound">q</a> <a id="11742" class="Symbol">→</a>  <a id="11745" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11747" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="11752" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11754" href="Varieties.FreeAlgebras.html#11738" class="Bound">p</a> <a id="11756" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11758" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11760" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="11765" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11767" href="Varieties.FreeAlgebras.html#11740" class="Bound">q</a>  <a id="11770" class="Symbol">→</a> <a id="11772" class="Symbol">(</a><a id="11773" href="Varieties.FreeAlgebras.html#11738" class="Bound">p</a> <a id="11775" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11777" href="Varieties.FreeAlgebras.html#11740" class="Bound">q</a><a id="11778" class="Symbol">)</a> <a id="11780" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11782" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="11784" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
 <a id="11787" href="Varieties.FreeAlgebras.html#11726" class="Function">ψlemma0</a> <a id="11795" href="Varieties.FreeAlgebras.html#11795" class="Bound">p</a> <a id="11797" href="Varieties.FreeAlgebras.html#11797" class="Bound">q</a> <a id="11799" href="Varieties.FreeAlgebras.html#11799" class="Bound">phomℭq</a> <a id="11806" href="Varieties.FreeAlgebras.html#11806" class="Bound">𝑨</a> <a id="11808" href="Varieties.FreeAlgebras.html#11808" class="Bound">sA</a> <a id="11811" href="Varieties.FreeAlgebras.html#11811" class="Bound">h</a> <a id="11813" class="Symbol">=</a> <a id="11815" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="11824" href="Varieties.FreeAlgebras.html#11799" class="Bound">phomℭq</a> <a id="11831" class="Symbol">(</a><a id="11832" href="Varieties.FreeAlgebras.html#11806" class="Bound">𝑨</a> <a id="11834" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11836" href="Varieties.FreeAlgebras.html#11808" class="Bound">sA</a> <a id="11839" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11841" href="Varieties.FreeAlgebras.html#11811" class="Bound">h</a><a id="11842" class="Symbol">)</a>

 <a id="11846" href="Varieties.FreeAlgebras.html#11846" class="Function">ψlemma0-ap</a> <a id="11857" class="Symbol">:</a> <a id="11859" class="Symbol">{</a><a id="11860" href="Varieties.FreeAlgebras.html#11860" class="Bound">𝑨</a> <a id="11862" class="Symbol">:</a> <a id="11864" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="11872" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="11874" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="11875" class="Symbol">}{</a><a id="11877" href="Varieties.FreeAlgebras.html#11877" class="Bound">h</a> <a id="11879" class="Symbol">:</a> <a id="11881" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="11883" class="Symbol">→</a> <a id="11885" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11887" href="Varieties.FreeAlgebras.html#11860" class="Bound">𝑨</a> <a id="11889" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="11890" class="Symbol">}</a> <a id="11892" class="Symbol">→</a> <a id="11894" href="Varieties.FreeAlgebras.html#11860" class="Bound">𝑨</a> <a id="11896" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11898" href="Varieties.Closure.html#3790" class="Datatype">S</a><a id="11899" class="Symbol">{</a><a id="11900" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11901" class="Symbol">}{</a><a id="11903" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11904" class="Symbol">}</a> <a id="11906" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
  <a id="11910" class="Symbol">→</a>           <a id="11922" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="11929" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11931" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="11936" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="11938" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="11940" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="11947" class="Symbol">(</a><a id="11948" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="11958" href="Varieties.FreeAlgebras.html#11860" class="Bound">𝑨</a> <a id="11960" href="Varieties.FreeAlgebras.html#11877" class="Bound">h</a><a id="11961" class="Symbol">)</a>

 <a id="11965" href="Varieties.FreeAlgebras.html#11846" class="Function">ψlemma0-ap</a> <a id="11976" class="Symbol">{</a><a id="11977" href="Varieties.FreeAlgebras.html#11977" class="Bound">𝑨</a><a id="11978" class="Symbol">}{</a><a id="11980" href="Varieties.FreeAlgebras.html#11980" class="Bound">h</a><a id="11981" class="Symbol">}</a> <a id="11983" href="Varieties.FreeAlgebras.html#11983" class="Bound">skA</a> <a id="11987" class="Symbol">{</a><a id="11988" href="Varieties.FreeAlgebras.html#11988" class="Bound">p</a> <a id="11990" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11992" href="Varieties.FreeAlgebras.html#11992" class="Bound">q</a><a id="11993" class="Symbol">}</a> <a id="11995" href="Varieties.FreeAlgebras.html#11995" class="Bound">x</a> <a id="11997" class="Symbol">=</a> <a id="11999" href="Varieties.FreeAlgebras.html#12142" class="Function">γ</a> <a id="12001" class="Keyword">where</a>

  <a id="12010" href="Varieties.FreeAlgebras.html#12010" class="Function">ν</a> <a id="12012" class="Symbol">:</a> <a id="12014" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12016" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="12021" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12023" href="Varieties.FreeAlgebras.html#11988" class="Bound">p</a> <a id="12025" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12027" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12029" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="12034" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12036" href="Varieties.FreeAlgebras.html#11992" class="Bound">q</a>
  <a id="12040" href="Varieties.FreeAlgebras.html#12010" class="Function">ν</a> <a id="12042" class="Symbol">=</a> <a id="12044" href="Homomorphisms.Basic.html#10028" class="Function">ker-in-con</a> <a id="12055" class="Symbol">{</a><a id="12056" class="Argument">α</a> <a id="12058" class="Symbol">=</a> <a id="12060" class="Symbol">(</a><a id="12061" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="12064" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12065" class="Symbol">)}{</a><a id="12068" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="12071" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12072" class="Symbol">}{</a><a id="12074" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="12076" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="12077" class="Symbol">}{</a><a id="12079" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="12082" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12084" class="Symbol">(</a><a id="12085" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12090" class="Symbol">(</a><a id="12091" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="12094" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12095" class="Symbol">))}(</a><a id="12099" href="Homomorphisms.Basic.html#7652" class="Function">kercon</a> <a id="12106" class="Symbol">(</a><a id="12107" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="12110" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12112" class="Symbol">(</a><a id="12113" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="12116" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12117" class="Symbol">))</a> <a id="12120" class="Symbol">{</a><a id="12121" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a><a id="12122" class="Symbol">}</a> <a id="12124" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a><a id="12128" class="Symbol">)</a> <a id="12130" class="Symbol">{</a><a id="12131" href="Varieties.FreeAlgebras.html#11988" class="Bound">p</a><a id="12132" class="Symbol">}{</a><a id="12134" href="Varieties.FreeAlgebras.html#11992" class="Bound">q</a><a id="12135" class="Symbol">}</a> <a id="12137" href="Varieties.FreeAlgebras.html#11995" class="Bound">x</a>

  <a id="12142" href="Varieties.FreeAlgebras.html#12142" class="Function">γ</a> <a id="12144" class="Symbol">:</a> <a id="12146" class="Symbol">(</a><a id="12147" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="12157" href="Varieties.FreeAlgebras.html#11977" class="Bound">𝑨</a> <a id="12159" href="Varieties.FreeAlgebras.html#11980" class="Bound">h</a><a id="12160" class="Symbol">)</a> <a id="12162" href="Varieties.FreeAlgebras.html#11988" class="Bound">p</a> <a id="12164" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12166" class="Symbol">(</a><a id="12167" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="12177" href="Varieties.FreeAlgebras.html#11977" class="Bound">𝑨</a> <a id="12179" href="Varieties.FreeAlgebras.html#11980" class="Bound">h</a><a id="12180" class="Symbol">)</a> <a id="12182" href="Varieties.FreeAlgebras.html#11992" class="Bound">q</a>
  <a id="12186" href="Varieties.FreeAlgebras.html#12142" class="Function">γ</a> <a id="12188" class="Symbol">=</a> <a id="12190" class="Symbol">((</a><a id="12192" href="Varieties.FreeAlgebras.html#11726" class="Function">ψlemma0</a> <a id="12200" href="Varieties.FreeAlgebras.html#11988" class="Bound">p</a> <a id="12202" href="Varieties.FreeAlgebras.html#11992" class="Bound">q</a><a id="12203" class="Symbol">)</a> <a id="12205" href="Varieties.FreeAlgebras.html#12010" class="Function">ν</a><a id="12206" class="Symbol">)</a> <a id="12208" href="Varieties.FreeAlgebras.html#11977" class="Bound">𝑨</a> <a id="12210" href="Varieties.FreeAlgebras.html#11983" class="Bound">skA</a> <a id="12214" href="Varieties.FreeAlgebras.html#11980" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12395" href="Varieties.FreeAlgebras.html#12395" class="Function">𝔽-lift-hom</a> <a id="12406" class="Symbol">:</a> <a id="12408" class="Symbol">(</a><a id="12409" href="Varieties.FreeAlgebras.html#12409" class="Bound">𝑨</a> <a id="12411" class="Symbol">:</a> <a id="12413" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="12421" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12423" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12424" class="Symbol">)</a> <a id="12426" class="Symbol">→</a> <a id="12428" href="Varieties.FreeAlgebras.html#12409" class="Bound">𝑨</a> <a id="12430" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12432" href="Varieties.Closure.html#3790" class="Datatype">S</a><a id="12433" class="Symbol">{</a><a id="12434" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12435" class="Symbol">}{</a><a id="12437" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12438" class="Symbol">}</a> <a id="12440" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="12442" class="Symbol">→</a> <a id="12444" class="Symbol">(</a><a id="12445" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="12447" class="Symbol">→</a> <a id="12449" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12451" href="Varieties.FreeAlgebras.html#12409" class="Bound">𝑨</a> <a id="12453" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="12454" class="Symbol">)</a> <a id="12456" class="Symbol">→</a> <a id="12458" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="12462" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="12464" href="Varieties.FreeAlgebras.html#12409" class="Bound">𝑨</a>
 <a id="12467" href="Varieties.FreeAlgebras.html#12395" class="Function">𝔽-lift-hom</a> <a id="12478" href="Varieties.FreeAlgebras.html#12478" class="Bound">𝑨</a> <a id="12480" href="Varieties.FreeAlgebras.html#12480" class="Bound">skA</a> <a id="12484" href="Varieties.FreeAlgebras.html#12484" class="Bound">h</a> <a id="12486" class="Symbol">=</a> <a id="12488" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a><a id="12491" class="Symbol">(</a><a id="12492" href="Homomorphisms.Noether.html#8579" class="Function">HomFactor</a> <a id="12502" class="Symbol">(</a><a id="12503" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="12506" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12508" class="Symbol">(</a><a id="12509" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12514" class="Symbol">(</a><a id="12515" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="12518" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12519" class="Symbol">)))</a>  <a id="12524" href="Varieties.FreeAlgebras.html#12478" class="Bound">𝑨</a> <a id="12526" class="Symbol">(</a><a id="12527" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="12536" href="Varieties.FreeAlgebras.html#12478" class="Bound">𝑨</a> <a id="12538" href="Varieties.FreeAlgebras.html#12484" class="Bound">h</a><a id="12539" class="Symbol">)</a> <a id="12541" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="12546" class="Symbol">(</a><a id="12547" href="Varieties.FreeAlgebras.html#11846" class="Function">ψlemma0-ap</a> <a id="12558" href="Varieties.FreeAlgebras.html#12480" class="Bound">skA</a><a id="12561" class="Symbol">)</a> <a id="12563" href="Varieties.FreeAlgebras.html#11564" class="Function">hom𝔽-is-epic</a><a id="12575" class="Symbol">)</a>

</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="12960" class="Keyword">open</a> <a id="12965" href="Algebras.Congruences.html#1799" class="Module">IsCongruence</a>

 <a id="12980" href="Varieties.FreeAlgebras.html#12980" class="Function">X↪𝔽</a> <a id="12984" class="Symbol">:</a> <a id="12986" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="12988" class="Symbol">→</a> <a id="12990" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="12992" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="12994" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a>
 <a id="12997" href="Varieties.FreeAlgebras.html#12980" class="Function">X↪𝔽</a> <a id="13001" href="Varieties.FreeAlgebras.html#13001" class="Bound">x</a> <a id="13003" class="Symbol">=</a> <a id="13005" href="Relations.Quotients.html#5179" class="Function Operator">⟪</a> <a id="13007" href="Terms.Basic.html#1894" class="InductiveConstructor">ℊ</a> <a id="13009" href="Varieties.FreeAlgebras.html#13001" class="Bound">x</a> <a id="13011" href="Relations.Quotients.html#5179" class="Function Operator">⟫</a> <a id="13013" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13079" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13081" class="Symbol">:</a> <a id="13083" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="13087" class="Symbol">(</a><a id="13088" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="13090" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="13091" class="Symbol">)</a> <a id="13093" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a>
 <a id="13096" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13098" class="Symbol">=</a> <a id="13100" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="13109" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="13111" href="Varieties.FreeAlgebras.html#12980" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13214" class="Keyword">open</a> <a id="13219" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13233" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a> <a id="13250" class="Symbol">:</a> <a id="13252" class="Symbol">∀</a> <a id="13254" href="Varieties.FreeAlgebras.html#13254" class="Bound">p</a> <a id="13256" class="Symbol">→</a> <a id="13258" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13260" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13262" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13264" href="Varieties.FreeAlgebras.html#13254" class="Bound">p</a> <a id="13266" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13268" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13270" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="13275" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13277" href="Varieties.FreeAlgebras.html#13254" class="Bound">p</a>
 <a id="13280" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a> <a id="13297" class="Symbol">(</a><a id="13298" href="Terms.Basic.html#1894" class="InductiveConstructor">ℊ</a> <a id="13300" href="Varieties.FreeAlgebras.html#13300" class="Bound">x</a><a id="13301" class="Symbol">)</a> <a id="13303" class="Symbol">=</a> <a id="13305" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13311" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a> <a id="13328" class="Symbol">(</a><a id="13329" href="Terms.Basic.html#1936" class="InductiveConstructor">node</a> <a id="13334" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13336" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a><a id="13337" class="Symbol">)</a> <a id="13339" class="Symbol">=</a>
  <a id="13343" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13345" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13347" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13349" class="Symbol">(</a><a id="13350" href="Terms.Basic.html#1936" class="InductiveConstructor">node</a> <a id="13355" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13357" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a><a id="13358" class="Symbol">)</a>              <a id="13373" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13376" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="13378" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13380" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="13382" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13384" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13386" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13390" class="Symbol">(</a><a id="13391" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13393" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="13395" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a><a id="13396" class="Symbol">)(λ</a> <a id="13400" href="Varieties.FreeAlgebras.html#13400" class="Bound">i</a> <a id="13402" class="Symbol">→</a> <a id="13404" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13406" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13408" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="13409" class="Symbol">(</a><a id="13410" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13412" href="Varieties.FreeAlgebras.html#13400" class="Bound">i</a><a id="13413" class="Symbol">))</a>     <a id="13420" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13423" href="Varieties.FreeAlgebras.html#13531" class="Function">wd-proof</a> <a id="13432" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13436" class="Symbol">(</a><a id="13437" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13439" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="13441" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a><a id="13442" class="Symbol">)(λ</a> <a id="13446" href="Varieties.FreeAlgebras.html#13446" class="Bound">i</a> <a id="13448" class="Symbol">→</a> <a id="13450" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13452" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="13457" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13459" class="Symbol">(</a><a id="13460" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13462" href="Varieties.FreeAlgebras.html#13446" class="Bound">i</a><a id="13463" class="Symbol">))</a> <a id="13466" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13469" class="Symbol">(</a><a id="13470" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="13472" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="13477" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="13479" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13481" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a><a id="13482" class="Symbol">)</a><a id="13483" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a> <a id="13486" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13490" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13492" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="13497" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13499" class="Symbol">(</a><a id="13500" href="Terms.Basic.html#1936" class="InductiveConstructor">node</a> <a id="13505" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13507" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a><a id="13508" class="Symbol">)</a>           <a id="13520" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13525" class="Keyword">where</a> <a id="13531" href="Varieties.FreeAlgebras.html#13531" class="Function">wd-proof</a> <a id="13540" class="Symbol">=</a> <a id="13542" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="13545" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="13547" class="Symbol">(</a><a id="13548" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="13553" class="Symbol">(</a><a id="13554" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="13557" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="13558" class="Symbol">))</a>
                    <a id="13581" class="Symbol">(</a><a id="13582" href="Varieties.FreeAlgebras.html#13334" class="Bound">𝑓</a> <a id="13584" href="Algebras.Basic.html#8352" class="Function Operator">̂</a> <a id="13586" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a><a id="13587" class="Symbol">)</a> <a id="13589" class="Symbol">(λ</a> <a id="13592" href="Varieties.FreeAlgebras.html#13592" class="Bound">i</a> <a id="13594" class="Symbol">→</a> <a id="13596" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13598" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13600" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="13601" class="Symbol">(</a><a id="13602" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13604" href="Varieties.FreeAlgebras.html#13592" class="Bound">i</a><a id="13605" class="Symbol">))</a> <a id="13608" class="Symbol">(λ</a> <a id="13611" href="Varieties.FreeAlgebras.html#13611" class="Bound">i</a> <a id="13613" class="Symbol">→</a> <a id="13615" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13617" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="13622" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13624" class="Symbol">(</a><a id="13625" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13627" href="Varieties.FreeAlgebras.html#13611" class="Bound">i</a><a id="13628" class="Symbol">))</a>
                    <a id="13651" class="Symbol">(λ</a> <a id="13654" href="Varieties.FreeAlgebras.html#13654" class="Bound">x</a> <a id="13656" class="Symbol">→</a> <a id="13658" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a><a id="13674" class="Symbol">(</a><a id="13675" href="Varieties.FreeAlgebras.html#13336" class="Bound">𝒕</a> <a id="13677" href="Varieties.FreeAlgebras.html#13654" class="Bound">x</a><a id="13678" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="13782" href="Varieties.FreeAlgebras.html#13782" class="Function">ψlemma1</a> <a id="13790" class="Symbol">:</a> <a id="13792" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="13799" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13801" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13803" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13805" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="13807" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="13809" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
 <a id="13812" href="Varieties.FreeAlgebras.html#13782" class="Function">ψlemma1</a> <a id="13820" class="Symbol">{</a><a id="13821" href="Varieties.FreeAlgebras.html#13821" class="Bound">p</a> <a id="13823" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13825" href="Varieties.FreeAlgebras.html#13825" class="Bound">q</a><a id="13826" class="Symbol">}</a> <a id="13828" href="Varieties.FreeAlgebras.html#13828" class="Bound">𝔑pq</a> <a id="13832" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a> <a id="13834" href="Varieties.FreeAlgebras.html#13834" class="Bound">sA</a> <a id="13837" href="Varieties.FreeAlgebras.html#13837" class="Bound">h</a> <a id="13839" class="Symbol">=</a> <a id="13841" href="Varieties.FreeAlgebras.html#14062" class="Function">γ</a>
  <a id="13845" class="Keyword">where</a>
   <a id="13854" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="13856" class="Symbol">:</a> <a id="13858" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="13862" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="13864" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a>
   <a id="13869" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="13871" class="Symbol">=</a> <a id="13873" href="Varieties.FreeAlgebras.html#12395" class="Function">𝔽-lift-hom</a> <a id="13884" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a> <a id="13886" href="Varieties.FreeAlgebras.html#13834" class="Bound">sA</a> <a id="13889" href="Varieties.FreeAlgebras.html#13837" class="Bound">h</a>

   <a id="13895" href="Varieties.FreeAlgebras.html#13895" class="Function">h&#39;</a> <a id="13898" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="13900" class="Symbol">:</a> <a id="13902" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="13906" class="Symbol">(</a><a id="13907" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="13909" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="13910" class="Symbol">)</a> <a id="13912" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a>
   <a id="13917" href="Varieties.FreeAlgebras.html#13895" class="Function">h&#39;</a> <a id="13920" class="Symbol">=</a> <a id="13922" href="Homomorphisms.Basic.html#3466" class="Function">∘-hom</a> <a id="13928" class="Symbol">(</a><a id="13929" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="13931" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="13932" class="Symbol">)</a> <a id="13934" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a> <a id="13936" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13938" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a>
   <a id="13943" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="13945" class="Symbol">=</a> <a id="13947" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="13956" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a> <a id="13958" href="Varieties.FreeAlgebras.html#13837" class="Bound">h</a>

   <a id="13964" href="Varieties.FreeAlgebras.html#13964" class="Function">h≡φ</a> <a id="13968" class="Symbol">:</a> <a id="13970" class="Symbol">∀</a> <a id="13972" href="Varieties.FreeAlgebras.html#13972" class="Bound">t</a> <a id="13974" class="Symbol">→</a> <a id="13976" class="Symbol">(</a><a id="13977" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13979" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="13981" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13983" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="13985" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13987" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="13989" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="13990" class="Symbol">)</a> <a id="13992" href="Varieties.FreeAlgebras.html#13972" class="Bound">t</a> <a id="13994" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13996" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="13998" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14000" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14002" href="Varieties.FreeAlgebras.html#13972" class="Bound">t</a>
   <a id="14007" href="Varieties.FreeAlgebras.html#13964" class="Function">h≡φ</a> <a id="14011" href="Varieties.FreeAlgebras.html#14011" class="Bound">t</a> <a id="14013" class="Symbol">=</a> <a id="14015" href="Terms.Properties.html#3563" class="Function">free-unique</a> <a id="14027" class="Symbol">(</a><a id="14028" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="14031" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14033" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14034" class="Symbol">)</a> <a id="14036" href="Varieties.FreeAlgebras.html#13832" class="Bound">𝑨</a> <a id="14038" href="Varieties.FreeAlgebras.html#13895" class="Function">h&#39;</a> <a id="14041" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14043" class="Symbol">(λ</a> <a id="14046" href="Varieties.FreeAlgebras.html#14046" class="Bound">x</a> <a id="14048" class="Symbol">→</a> <a id="14050" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14054" class="Symbol">)</a> <a id="14056" href="Varieties.FreeAlgebras.html#14011" class="Bound">t</a>

   <a id="14062" href="Varieties.FreeAlgebras.html#14062" class="Function">γ</a> <a id="14064" class="Symbol">:</a> <a id="14066" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14068" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14070" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14072" href="Varieties.FreeAlgebras.html#13821" class="Bound">p</a> <a id="14074" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14076" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14078" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14080" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14082" href="Varieties.FreeAlgebras.html#13825" class="Bound">q</a>
   <a id="14087" href="Varieties.FreeAlgebras.html#14062" class="Function">γ</a> <a id="14089" class="Symbol">=</a> <a id="14091" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14093" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14095" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14097" href="Varieties.FreeAlgebras.html#13821" class="Bound">p</a>             <a id="14111" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14114" class="Symbol">(</a><a id="14115" href="Varieties.FreeAlgebras.html#13964" class="Function">h≡φ</a> <a id="14119" href="Varieties.FreeAlgebras.html#13821" class="Bound">p</a><a id="14120" class="Symbol">)</a><a id="14121" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a> <a id="14124" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14133" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14135" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="14137" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14139" class="Symbol">(</a> <a id="14141" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14143" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="14145" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14147" href="Varieties.FreeAlgebras.html#13821" class="Bound">p</a> <a id="14149" class="Symbol">)</a>   <a id="14153" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14156" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14161" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14163" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="14165" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14167" href="Varieties.FreeAlgebras.html#13828" class="Bound">𝔑pq</a> <a id="14171" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14180" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14182" href="Varieties.FreeAlgebras.html#13854" class="Function">f</a> <a id="14184" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14186" class="Symbol">(</a> <a id="14188" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14190" href="Varieties.FreeAlgebras.html#13079" class="Function">𝔑</a> <a id="14192" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14194" href="Varieties.FreeAlgebras.html#13825" class="Bound">q</a> <a id="14196" class="Symbol">)</a>   <a id="14200" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14203" href="Varieties.FreeAlgebras.html#13964" class="Function">h≡φ</a> <a id="14207" href="Varieties.FreeAlgebras.html#13825" class="Bound">q</a> <a id="14209" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14218" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14220" href="Varieties.FreeAlgebras.html#13898" class="Function">φ</a> <a id="14222" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14224" href="Varieties.FreeAlgebras.html#13825" class="Bound">q</a>             <a id="14238" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14243" href="Varieties.FreeAlgebras.html#14243" class="Function">ψlemma2</a> <a id="14251" class="Symbol">:</a> <a id="14253" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="14260" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14262" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="14267" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14269" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14271" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a> <a id="14273" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
 <a id="14276" href="Varieties.FreeAlgebras.html#14243" class="Function">ψlemma2</a> <a id="14284" class="Symbol">{</a><a id="14285" href="Varieties.FreeAlgebras.html#14285" class="Bound">p</a> <a id="14287" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14289" href="Varieties.FreeAlgebras.html#14289" class="Bound">q</a><a id="14290" class="Symbol">}</a> <a id="14292" href="Varieties.FreeAlgebras.html#14292" class="Bound">x</a> <a id="14294" class="Symbol">=</a> <a id="14296" href="Varieties.FreeAlgebras.html#13782" class="Function">ψlemma1</a> <a id="14304" class="Symbol">{</a><a id="14305" href="Varieties.FreeAlgebras.html#14285" class="Bound">p</a> <a id="14307" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14309" href="Varieties.FreeAlgebras.html#14289" class="Bound">q</a><a id="14310" class="Symbol">}</a> <a id="14312" href="Varieties.FreeAlgebras.html#14327" class="Function">γ</a>
   <a id="14317" class="Keyword">where</a>
    <a id="14327" href="Varieties.FreeAlgebras.html#14327" class="Function">γ</a> <a id="14329" class="Symbol">:</a> <a id="14331" class="Symbol">(</a><a id="14332" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="14342" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="14344" href="Varieties.FreeAlgebras.html#12980" class="Function">X↪𝔽</a><a id="14347" class="Symbol">)</a> <a id="14349" href="Varieties.FreeAlgebras.html#14285" class="Bound">p</a> <a id="14351" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14353" class="Symbol">(</a><a id="14354" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="14364" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="14366" href="Varieties.FreeAlgebras.html#12980" class="Function">X↪𝔽</a><a id="14369" class="Symbol">)</a> <a id="14371" href="Varieties.FreeAlgebras.html#14289" class="Bound">q</a>
    <a id="14377" href="Varieties.FreeAlgebras.html#14327" class="Function">γ</a> <a id="14379" class="Symbol">=</a> <a id="14381" class="Symbol">(</a><a id="14382" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a> <a id="14399" href="Varieties.FreeAlgebras.html#14285" class="Bound">p</a><a id="14400" class="Symbol">)</a> <a id="14402" href="Overture.Preliminaries.html#5275" class="Function Operator">∙</a> <a id="14404" href="Varieties.FreeAlgebras.html#14292" class="Bound">x</a> <a id="14406" href="Overture.Preliminaries.html#5275" class="Function Operator">∙</a> <a id="14408" class="Symbol">(</a><a id="14409" href="Varieties.FreeAlgebras.html#13233" class="Function">hom𝔽-is-lift-hom</a> <a id="14426" href="Varieties.FreeAlgebras.html#14289" class="Bound">q</a><a id="14427" class="Symbol">)</a><a id="14428" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a>


 <a id="14434" href="Varieties.FreeAlgebras.html#14434" class="Function">ψlemma3</a> <a id="14442" class="Symbol">:</a> <a id="14444" class="Symbol">∀</a> <a id="14446" href="Varieties.FreeAlgebras.html#14446" class="Bound">p</a> <a id="14448" href="Varieties.FreeAlgebras.html#14448" class="Bound">q</a> <a id="14450" class="Symbol">→</a> <a id="14452" class="Symbol">(</a><a id="14453" href="Varieties.FreeAlgebras.html#14446" class="Bound">p</a> <a id="14455" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14457" href="Varieties.FreeAlgebras.html#14448" class="Bound">q</a><a id="14458" class="Symbol">)</a> <a id="14460" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14462" href="Varieties.FreeAlgebras.html#6143" class="Function">ψ</a><a id="14463" class="Symbol">{</a><a id="14464" class="Argument">X</a> <a id="14466" class="Symbol">=</a> <a id="14468" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="14469" class="Symbol">}</a> <a id="14471" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="14473" class="Symbol">→</a> <a id="14475" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="14477" href="Varieties.EquationalLogic.html#2728" class="Function Operator">⊫</a> <a id="14479" href="Varieties.FreeAlgebras.html#14446" class="Bound">p</a> <a id="14481" href="Varieties.EquationalLogic.html#2728" class="Function Operator">≈</a> <a id="14483" href="Varieties.FreeAlgebras.html#14448" class="Bound">q</a>
 <a id="14486" href="Varieties.FreeAlgebras.html#14434" class="Function">ψlemma3</a> <a id="14494" href="Varieties.FreeAlgebras.html#14494" class="Bound">p</a> <a id="14496" href="Varieties.FreeAlgebras.html#14496" class="Bound">q</a> <a id="14498" href="Varieties.FreeAlgebras.html#14498" class="Bound">pψq</a> <a id="14502" class="Symbol">{</a><a id="14503" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a><a id="14504" class="Symbol">}</a> <a id="14506" href="Varieties.FreeAlgebras.html#14506" class="Bound">kA</a> <a id="14509" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a> <a id="14511" class="Symbol">=</a> <a id="14513" href="Varieties.FreeAlgebras.html#14530" class="Function">goal</a>
   <a id="14521" class="Keyword">where</a>
   <a id="14530" href="Varieties.FreeAlgebras.html#14530" class="Function">goal</a> <a id="14535" class="Symbol">:</a> <a id="14537" class="Symbol">(</a><a id="14538" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14540" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14542" href="Varieties.FreeAlgebras.html#14494" class="Bound">p</a> <a id="14544" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14545" class="Symbol">)</a> <a id="14547" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a> <a id="14549" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14551" class="Symbol">(</a><a id="14552" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14554" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14556" href="Varieties.FreeAlgebras.html#14496" class="Bound">q</a> <a id="14558" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14559" class="Symbol">)</a> <a id="14561" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a>
   <a id="14566" href="Varieties.FreeAlgebras.html#14530" class="Function">goal</a> <a id="14571" class="Symbol">=</a> <a id="14573" class="Symbol">(</a><a id="14574" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14576" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14578" href="Varieties.FreeAlgebras.html#14494" class="Bound">p</a> <a id="14580" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14581" class="Symbol">)</a> <a id="14583" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a>       <a id="14591" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14594" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="14611" class="Symbol">(</a><a id="14612" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="14615" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14617" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14618" class="Symbol">)</a> <a id="14620" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14622" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a> <a id="14624" href="Varieties.FreeAlgebras.html#14494" class="Bound">p</a> <a id="14626" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14638" class="Symbol">(</a><a id="14639" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="14649" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14651" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a><a id="14652" class="Symbol">)</a> <a id="14654" href="Varieties.FreeAlgebras.html#14494" class="Bound">p</a> <a id="14656" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14659" href="Varieties.FreeAlgebras.html#14498" class="Bound">pψq</a> <a id="14663" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14665" class="Symbol">(</a><a id="14666" href="Varieties.Closure.html#4076" class="InductiveConstructor">siso</a> <a id="14671" class="Symbol">(</a><a id="14672" href="Varieties.Closure.html#3878" class="InductiveConstructor">sbase</a> <a id="14678" href="Varieties.FreeAlgebras.html#14506" class="Bound">kA</a><a id="14680" class="Symbol">)</a> <a id="14682" class="Symbol">(</a><a id="14683" href="Homomorphisms.Isomorphisms.html#2926" class="Function">≅-sym</a> <a id="14689" href="Homomorphisms.Isomorphisms.html#4397" class="Function">Lift-≅</a><a id="14695" class="Symbol">))</a> <a id="14698" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a> <a id="14700" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14712" class="Symbol">(</a><a id="14713" href="Terms.Properties.html#2457" class="Function">free-lift</a> <a id="14723" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14725" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a><a id="14726" class="Symbol">)</a> <a id="14728" href="Varieties.FreeAlgebras.html#14496" class="Bound">q</a> <a id="14730" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14733" class="Symbol">(</a><a id="14734" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="14751" class="Symbol">(</a><a id="14752" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="14755" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14757" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14758" class="Symbol">)</a> <a id="14760" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14762" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a> <a id="14764" href="Varieties.FreeAlgebras.html#14496" class="Bound">q</a><a id="14765" class="Symbol">)</a><a id="14766" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a>  <a id="14770" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14782" class="Symbol">(</a><a id="14783" href="Varieties.FreeAlgebras.html#14503" class="Bound">𝑨</a> <a id="14785" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14787" href="Varieties.FreeAlgebras.html#14496" class="Bound">q</a> <a id="14789" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14790" class="Symbol">)</a> <a id="14792" href="Varieties.FreeAlgebras.html#14509" class="Bound">h</a>       <a id="14800" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="14923" href="Varieties.FreeAlgebras.html#14923" class="Function">class-models-kernel</a> <a id="14943" class="Symbol">:</a> <a id="14945" class="Symbol">∀</a> <a id="14947" href="Varieties.FreeAlgebras.html#14947" class="Bound">p</a> <a id="14949" href="Varieties.FreeAlgebras.html#14949" class="Bound">q</a> <a id="14951" class="Symbol">→</a> <a id="14953" class="Symbol">(</a><a id="14954" href="Varieties.FreeAlgebras.html#14947" class="Bound">p</a> <a id="14956" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14958" href="Varieties.FreeAlgebras.html#14949" class="Bound">q</a><a id="14959" class="Symbol">)</a> <a id="14961" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14963" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="14970" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14972" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="14977" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="14979" class="Symbol">→</a> <a id="14981" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="14983" href="Varieties.EquationalLogic.html#2728" class="Function Operator">⊫</a> <a id="14985" href="Varieties.FreeAlgebras.html#14947" class="Bound">p</a> <a id="14987" href="Varieties.EquationalLogic.html#2728" class="Function Operator">≈</a> <a id="14989" href="Varieties.FreeAlgebras.html#14949" class="Bound">q</a>
 <a id="14992" href="Varieties.FreeAlgebras.html#14923" class="Function">class-models-kernel</a> <a id="15012" href="Varieties.FreeAlgebras.html#15012" class="Bound">p</a> <a id="15014" href="Varieties.FreeAlgebras.html#15014" class="Bound">q</a> <a id="15016" href="Varieties.FreeAlgebras.html#15016" class="Bound">x</a> <a id="15018" class="Symbol">=</a> <a id="15020" href="Varieties.FreeAlgebras.html#14434" class="Function">ψlemma3</a> <a id="15028" href="Varieties.FreeAlgebras.html#15012" class="Bound">p</a> <a id="15030" href="Varieties.FreeAlgebras.html#15014" class="Bound">q</a> <a id="15032" class="Symbol">(</a><a id="15033" href="Varieties.FreeAlgebras.html#14243" class="Function">ψlemma2</a> <a id="15041" href="Varieties.FreeAlgebras.html#15016" class="Bound">x</a><a id="15042" class="Symbol">)</a>

 <a id="15046" href="Varieties.FreeAlgebras.html#15046" class="Function">𝕍𝒦</a> <a id="15049" class="Symbol">:</a> <a id="15051" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15056" class="Symbol">(</a><a id="15057" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="15065" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15068" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15069" class="Symbol">)</a> <a id="15071" class="Symbol">(</a><a id="15072" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="15077" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="15079" class="Symbol">)</a>
 <a id="15082" href="Varieties.FreeAlgebras.html#15046" class="Function">𝕍𝒦</a> <a id="15085" class="Symbol">=</a> <a id="15087" href="Varieties.Closure.html#5334" class="Datatype">V</a><a id="15088" class="Symbol">{</a><a id="15089" class="Argument">α</a> <a id="15091" class="Symbol">=</a> <a id="15093" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15094" class="Symbol">}{</a><a id="15096" class="Argument">β</a> <a id="15098" class="Symbol">=</a> <a id="15100" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="15102" class="Symbol">}</a> <a id="15104" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>

 <a id="15108" href="Varieties.FreeAlgebras.html#15108" class="Function">kernel-in-theory&#39;</a> <a id="15126" class="Symbol">:</a> <a id="15128" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="15135" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15137" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="15142" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15144" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15146" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a> <a id="15149" class="Symbol">(</a><a id="15150" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="15152" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a><a id="15153" class="Symbol">)</a>
 <a id="15156" href="Varieties.FreeAlgebras.html#15108" class="Function">kernel-in-theory&#39;</a> <a id="15174" class="Symbol">{</a><a id="15175" href="Varieties.FreeAlgebras.html#15175" class="Bound">p</a> <a id="15177" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15179" href="Varieties.FreeAlgebras.html#15179" class="Bound">q</a><a id="15180" class="Symbol">}</a> <a id="15182" href="Varieties.FreeAlgebras.html#15182" class="Bound">pKq</a> <a id="15186" class="Symbol">=</a> <a id="15188" class="Symbol">(</a><a id="15189" href="Varieties.Preservation.html#20329" class="Function">class-ids-⇒</a> <a id="15201" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="15204" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="15207" href="Varieties.FreeAlgebras.html#15175" class="Bound">p</a> <a id="15209" href="Varieties.FreeAlgebras.html#15179" class="Bound">q</a> <a id="15211" class="Symbol">(</a><a id="15212" href="Varieties.FreeAlgebras.html#14923" class="Function">class-models-kernel</a> <a id="15232" href="Varieties.FreeAlgebras.html#15175" class="Bound">p</a> <a id="15234" href="Varieties.FreeAlgebras.html#15179" class="Bound">q</a> <a id="15236" href="Varieties.FreeAlgebras.html#15182" class="Bound">pKq</a><a id="15239" class="Symbol">))</a>

 <a id="15244" href="Varieties.FreeAlgebras.html#15244" class="Function">kernel-in-theory</a> <a id="15261" class="Symbol">:</a> <a id="15263" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="15270" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15272" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="15277" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15279" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15281" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a> <a id="15284" href="Varieties.FreeAlgebras.html#15046" class="Function">𝕍𝒦</a>
 <a id="15288" href="Varieties.FreeAlgebras.html#15244" class="Function">kernel-in-theory</a> <a id="15305" class="Symbol">{</a><a id="15306" href="Varieties.FreeAlgebras.html#15306" class="Bound">p</a> <a id="15308" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15310" href="Varieties.FreeAlgebras.html#15310" class="Bound">q</a><a id="15311" class="Symbol">}</a> <a id="15313" href="Varieties.FreeAlgebras.html#15313" class="Bound">pKq</a> <a id="15317" href="Varieties.FreeAlgebras.html#15317" class="Bound">vkA</a> <a id="15321" href="Varieties.FreeAlgebras.html#15321" class="Bound">x</a> <a id="15323" class="Symbol">=</a> <a id="15325" href="Varieties.Preservation.html#20442" class="Function">class-ids</a> <a id="15335" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="15338" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="15341" href="Varieties.FreeAlgebras.html#15306" class="Bound">p</a> <a id="15343" href="Varieties.FreeAlgebras.html#15310" class="Bound">q</a> <a id="15345" class="Symbol">(</a><a id="15346" href="Varieties.FreeAlgebras.html#14923" class="Function">class-models-kernel</a> <a id="15366" href="Varieties.FreeAlgebras.html#15306" class="Bound">p</a> <a id="15368" href="Varieties.FreeAlgebras.html#15310" class="Bound">q</a> <a id="15370" href="Varieties.FreeAlgebras.html#15313" class="Bound">pKq</a><a id="15373" class="Symbol">)</a> <a id="15375" href="Varieties.FreeAlgebras.html#15317" class="Bound">vkA</a> <a id="15379" href="Varieties.FreeAlgebras.html#15321" class="Bound">x</a>

 <a id="15383" href="Varieties.FreeAlgebras.html#15383" class="Function Operator">_↠_</a> <a id="15387" class="Symbol">:</a> <a id="15389" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15394" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="15396" class="Symbol">→</a> <a id="15398" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="15406" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15409" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="15411" class="Symbol">→</a> <a id="15413" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15418" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a>
 <a id="15422" href="Varieties.FreeAlgebras.html#15422" class="Bound">X</a> <a id="15424" href="Varieties.FreeAlgebras.html#15383" class="Function Operator">↠</a> <a id="15426" href="Varieties.FreeAlgebras.html#15426" class="Bound">𝑨</a> <a id="15428" class="Symbol">=</a> <a id="15430" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15433" href="Varieties.FreeAlgebras.html#15433" class="Bound">h</a> <a id="15435" href="Data.Product.html#916" class="Function">∈</a> <a id="15437" class="Symbol">(</a><a id="15438" href="Varieties.FreeAlgebras.html#15422" class="Bound">X</a> <a id="15440" class="Symbol">→</a> <a id="15442" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15444" href="Varieties.FreeAlgebras.html#15426" class="Bound">𝑨</a> <a id="15446" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="15447" class="Symbol">)</a> <a id="15449" href="Data.Product.html#916" class="Function">]</a> <a id="15451" href="Overture.Inverses.html#3227" class="Function">IsSurjective</a> <a id="15464" href="Varieties.FreeAlgebras.html#15433" class="Bound">h</a>

 <a id="15468" href="Varieties.FreeAlgebras.html#15468" class="Function">𝔽-ModTh-epi</a> <a id="15480" class="Symbol">:</a> <a id="15482" class="Symbol">(</a><a id="15483" href="Varieties.FreeAlgebras.html#15483" class="Bound">𝑨</a> <a id="15485" class="Symbol">:</a> <a id="15487" href="Algebras.Basic.html#6023" class="Function">Algebra</a> <a id="15495" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="15498" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15499" class="Symbol">)</a> <a id="15501" class="Symbol">→</a> <a id="15503" class="Symbol">(</a><a id="15504" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="15506" href="Varieties.FreeAlgebras.html#15383" class="Function Operator">↠</a> <a id="15508" href="Varieties.FreeAlgebras.html#15483" class="Bound">𝑨</a><a id="15509" class="Symbol">)</a> <a id="15511" class="Symbol">→</a> <a id="15513" href="Varieties.FreeAlgebras.html#15483" class="Bound">𝑨</a> <a id="15515" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15517" href="Varieties.EquationalLogic.html#4029" class="Function">Mod</a> <a id="15521" class="Symbol">(</a><a id="15522" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a> <a id="15525" href="Varieties.FreeAlgebras.html#15046" class="Function">𝕍𝒦</a><a id="15527" class="Symbol">)</a> <a id="15529" class="Symbol">→</a> <a id="15531" href="Homomorphisms.Basic.html#5975" class="Function">epi</a> <a id="15535" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="15537" href="Varieties.FreeAlgebras.html#15483" class="Bound">𝑨</a>
 <a id="15540" href="Varieties.FreeAlgebras.html#15468" class="Function">𝔽-ModTh-epi</a> <a id="15552" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15554" class="Symbol">(</a><a id="15555" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a> <a id="15557" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15559" href="Varieties.FreeAlgebras.html#15559" class="Bound">ηE</a><a id="15561" class="Symbol">)</a> <a id="15563" href="Varieties.FreeAlgebras.html#15563" class="Bound">AinMTV</a> <a id="15570" class="Symbol">=</a> <a id="15572" href="Varieties.FreeAlgebras.html#16084" class="Function">goal</a>
  <a id="15579" class="Keyword">where</a>
  <a id="15587" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="15589" class="Symbol">:</a> <a id="15591" href="Homomorphisms.Basic.html#3104" class="Function">hom</a> <a id="15595" class="Symbol">(</a><a id="15596" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="15598" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="15599" class="Symbol">)</a> <a id="15601" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a>
  <a id="15605" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="15607" class="Symbol">=</a> <a id="15609" href="Terms.Properties.html#3164" class="Function">lift-hom</a> <a id="15618" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15620" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a>

  <a id="15625" href="Varieties.FreeAlgebras.html#15625" class="Function">φE</a> <a id="15628" class="Symbol">:</a> <a id="15630" href="Overture.Inverses.html#3227" class="Function">IsSurjective</a> <a id="15643" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15645" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="15647" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a>
  <a id="15651" href="Varieties.FreeAlgebras.html#15625" class="Function">φE</a> <a id="15654" class="Symbol">=</a> <a id="15656" href="Terms.Properties.html#4769" class="Function">lift-of-epi-is-epi</a> <a id="15675" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15677" href="Varieties.FreeAlgebras.html#15559" class="Bound">ηE</a>

  <a id="15683" href="Varieties.FreeAlgebras.html#15683" class="Function">pqlem2</a> <a id="15690" class="Symbol">:</a> <a id="15692" class="Symbol">∀</a> <a id="15694" href="Varieties.FreeAlgebras.html#15694" class="Bound">p</a> <a id="15696" href="Varieties.FreeAlgebras.html#15696" class="Bound">q</a> <a id="15698" class="Symbol">→</a> <a id="15700" class="Symbol">(</a><a id="15701" href="Varieties.FreeAlgebras.html#15694" class="Bound">p</a> <a id="15703" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15705" href="Varieties.FreeAlgebras.html#15696" class="Bound">q</a><a id="15706" class="Symbol">)</a> <a id="15708" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15710" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="15717" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15719" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="15724" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15726" class="Symbol">→</a> <a id="15728" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15730" href="Varieties.EquationalLogic.html#2650" class="Function Operator">⊧</a> <a id="15732" href="Varieties.FreeAlgebras.html#15694" class="Bound">p</a> <a id="15734" href="Varieties.EquationalLogic.html#2650" class="Function Operator">≈</a> <a id="15736" href="Varieties.FreeAlgebras.html#15696" class="Bound">q</a>
  <a id="15740" href="Varieties.FreeAlgebras.html#15683" class="Function">pqlem2</a> <a id="15747" href="Varieties.FreeAlgebras.html#15747" class="Bound">p</a> <a id="15749" href="Varieties.FreeAlgebras.html#15749" class="Bound">q</a> <a id="15751" href="Varieties.FreeAlgebras.html#15751" class="Bound">z</a> <a id="15753" class="Symbol">=</a> <a id="15755" class="Symbol">λ</a> <a id="15757" href="Varieties.FreeAlgebras.html#15757" class="Bound">x</a> <a id="15759" class="Symbol">→</a> <a id="15761" href="Varieties.FreeAlgebras.html#15563" class="Bound">AinMTV</a> <a id="15768" href="Varieties.FreeAlgebras.html#15747" class="Bound">p</a> <a id="15770" href="Varieties.FreeAlgebras.html#15749" class="Bound">q</a> <a id="15772" class="Symbol">(</a><a id="15773" href="Varieties.FreeAlgebras.html#15244" class="Function">kernel-in-theory</a> <a id="15790" href="Varieties.FreeAlgebras.html#15751" class="Bound">z</a><a id="15791" class="Symbol">)</a> <a id="15793" href="Varieties.FreeAlgebras.html#15757" class="Bound">x</a>

  <a id="15798" href="Varieties.FreeAlgebras.html#15798" class="Function">kerincl</a> <a id="15806" class="Symbol">:</a> <a id="15808" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="15815" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15817" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="15822" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15824" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15826" href="Relations.Discrete.html#3905" class="Function">kernel</a> <a id="15833" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15835" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="15837" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a>
  <a id="15841" href="Varieties.FreeAlgebras.html#15798" class="Function">kerincl</a> <a id="15849" class="Symbol">{</a><a id="15850" href="Varieties.FreeAlgebras.html#15850" class="Bound">p</a> <a id="15852" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15854" href="Varieties.FreeAlgebras.html#15854" class="Bound">q</a><a id="15855" class="Symbol">}</a> <a id="15857" href="Varieties.FreeAlgebras.html#15857" class="Bound">x</a> <a id="15859" class="Symbol">=</a> <a id="15861" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15863" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="15865" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="15867" href="Varieties.FreeAlgebras.html#15850" class="Bound">p</a>      <a id="15874" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15877" class="Symbol">(</a><a id="15878" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="15895" class="Symbol">(</a><a id="15896" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="15899" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="15901" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="15903" class="Symbol">)</a> <a id="15905" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15907" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a> <a id="15909" href="Varieties.FreeAlgebras.html#15850" class="Bound">p</a><a id="15910" class="Symbol">)</a><a id="15911" href="Overture.Preliminaries.html#4949" class="Function Operator">⁻¹</a> <a id="15914" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15938" class="Symbol">(</a><a id="15939" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15941" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="15943" href="Varieties.FreeAlgebras.html#15850" class="Bound">p</a> <a id="15945" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="15946" class="Symbol">)</a> <a id="15948" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a>  <a id="15951" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="15954" href="Varieties.FreeAlgebras.html#15683" class="Function">pqlem2</a> <a id="15961" href="Varieties.FreeAlgebras.html#15850" class="Bound">p</a> <a id="15963" href="Varieties.FreeAlgebras.html#15854" class="Bound">q</a> <a id="15965" href="Varieties.FreeAlgebras.html#15857" class="Bound">x</a> <a id="15967" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a> <a id="15969" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="15993" class="Symbol">(</a><a id="15994" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="15996" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="15998" href="Varieties.FreeAlgebras.html#15854" class="Bound">q</a> <a id="16000" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="16001" class="Symbol">)</a> <a id="16003" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a>  <a id="16006" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16009" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="16026" class="Symbol">(</a><a id="16027" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="16030" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16032" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="16034" class="Symbol">)</a> <a id="16036" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="16038" href="Varieties.FreeAlgebras.html#15555" class="Bound">η</a> <a id="16040" href="Varieties.FreeAlgebras.html#15854" class="Bound">q</a> <a id="16042" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16066" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="16068" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="16070" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="16072" href="Varieties.FreeAlgebras.html#15854" class="Bound">q</a>      <a id="16079" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16084" href="Varieties.FreeAlgebras.html#16084" class="Function">goal</a> <a id="16089" class="Symbol">:</a> <a id="16091" href="Homomorphisms.Basic.html#5975" class="Function">epi</a> <a id="16095" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="16097" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a>
  <a id="16101" href="Varieties.FreeAlgebras.html#16084" class="Function">goal</a> <a id="16106" class="Symbol">=</a> <a id="16108" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a> <a id="16112" class="Symbol">(</a><a id="16113" href="Homomorphisms.Noether.html#9853" class="Function">HomFactorEpi</a> <a id="16126" class="Symbol">(</a><a id="16127" href="Varieties.FreeAlgebras.html#10221" class="Bound">wd</a> <a id="16130" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16132" class="Symbol">(</a><a id="16133" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="16138" class="Symbol">(</a><a id="16139" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16142" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16143" class="Symbol">)))</a> <a id="16147" href="Varieties.FreeAlgebras.html#15552" class="Bound">𝑨</a> <a id="16149" href="Varieties.FreeAlgebras.html#15587" class="Function">φ</a> <a id="16151" href="Varieties.FreeAlgebras.html#11517" class="Function">hom𝔽</a> <a id="16156" href="Varieties.FreeAlgebras.html#15798" class="Function">kerincl</a> <a id="16164" href="Varieties.FreeAlgebras.html#11564" class="Function">hom𝔽-is-epic</a> <a id="16177" href="Varieties.FreeAlgebras.html#15625" class="Function">φE</a><a id="16179" class="Symbol">)</a>

</pre>



#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16539" class="Keyword">module</a> <a id="16546" href="Varieties.FreeAlgebras.html#16546" class="Module">_</a> <a id="16548" class="Symbol">(</a><a id="16549" href="Varieties.FreeAlgebras.html#16549" class="Bound">pe</a> <a id="16552" class="Symbol">:</a> <a id="16554" href="Foundations.Extensionality.html#4368" class="Function">pred-ext</a> <a id="16563" class="Symbol">(</a><a id="16564" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16567" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16568" class="Symbol">)(</a><a id="16570" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16573" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16574" class="Symbol">))(</a><a id="16577" href="Varieties.FreeAlgebras.html#16577" class="Bound">wd</a> <a id="16580" class="Symbol">:</a> <a id="16582" href="Foundations.Welldefined.html#3233" class="Function">SwellDef</a><a id="16590" class="Symbol">)</a> <a id="16592" class="Comment">-- extensionality assumptions</a>
          <a id="16632" class="Symbol">(</a><a id="16633" href="Varieties.FreeAlgebras.html#16633" class="Bound">Cset</a> <a id="16638" class="Symbol">:</a> <a id="16640" href="Foundations.Truncation.html#6586" class="Function">is-set</a> <a id="16647" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="16649" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="16651" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="16652" class="Symbol">)</a>                       <a id="16676" class="Comment">-- truncation assumptions</a>
          <a id="16712" class="Symbol">(</a><a id="16713" href="Varieties.FreeAlgebras.html#16713" class="Bound">kuip</a> <a id="16718" class="Symbol">:</a> <a id="16720" href="Foundations.Truncation.html#10844" class="Function">blk-uip</a><a id="16727" class="Symbol">(</a><a id="16728" href="Terms.Basic.html#1853" class="Datatype">Term</a> <a id="16733" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="16734" class="Symbol">)</a><a id="16735" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a> <a id="16737" href="Homomorphisms.Basic.html#7652" class="Function">kercon</a> <a id="16744" class="Symbol">(</a><a id="16745" href="Varieties.FreeAlgebras.html#16577" class="Bound">wd</a> <a id="16748" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16750" class="Symbol">(</a><a id="16751" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16754" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16755" class="Symbol">)){</a><a id="16758" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a><a id="16759" class="Symbol">}</a><a id="16760" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="16765" href="Overture.Preliminaries.html#4245" class="Function Operator">∣</a><a id="16766" class="Symbol">)</a>
  <a id="16770" class="Keyword">where</a>

  <a id="16779" href="Varieties.FreeAlgebras.html#16779" class="Function">𝔽≤ℭ</a> <a id="16783" class="Symbol">:</a> <a id="16785" class="Symbol">(</a><a id="16786" href="Homomorphisms.Basic.html#8060" class="Function Operator">ker[</a> <a id="16791" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="16793" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="16795" href="Homomorphisms.Basic.html#8060" class="Function Operator">⇒</a> <a id="16797" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="16799" href="Homomorphisms.Basic.html#8060" class="Function Operator">]</a> <a id="16801" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="16806" href="Homomorphisms.Basic.html#8060" class="Function Operator">↾</a> <a id="16808" class="Symbol">(</a><a id="16809" href="Varieties.FreeAlgebras.html#16577" class="Bound">wd</a> <a id="16812" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16814" class="Symbol">(</a><a id="16815" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16818" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16819" class="Symbol">)))</a> <a id="16823" href="Subalgebras.Subalgebras.html#2513" class="Function Operator">≤</a> <a id="16825" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a>
  <a id="16829" href="Varieties.FreeAlgebras.html#16779" class="Function">𝔽≤ℭ</a> <a id="16833" class="Symbol">=</a> <a id="16835" href="Subalgebras.Subalgebras.html#4345" class="Function">FirstHomCorollary|Set</a> <a id="16857" class="Symbol">(</a><a id="16858" href="Terms.Basic.html#3125" class="Function">𝑻</a> <a id="16860" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="16861" class="Symbol">)</a> <a id="16863" href="Varieties.FreeAlgebras.html#10620" class="Function">ℭ</a> <a id="16865" href="Varieties.FreeAlgebras.html#10807" class="Function">homℭ</a> <a id="16870" href="Varieties.FreeAlgebras.html#16549" class="Bound">pe</a> <a id="16873" class="Symbol">(</a><a id="16874" href="Varieties.FreeAlgebras.html#16577" class="Bound">wd</a> <a id="16877" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16879" class="Symbol">(</a><a id="16880" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="16883" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16884" class="Symbol">))</a> <a id="16887" href="Varieties.FreeAlgebras.html#16633" class="Bound">Cset</a> <a id="16892" href="Varieties.FreeAlgebras.html#16713" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="17955" href="Varieties.FreeAlgebras.html#17955" class="Function">𝔽∈SP</a> <a id="17960" class="Symbol">:</a> <a id="17962" href="Foundations.Truncation.html#3935" class="Function">hfunext</a> <a id="17970" class="Symbol">(</a><a id="17971" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="17974" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17975" class="Symbol">)(</a><a id="17977" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="17980" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17981" class="Symbol">)</a> <a id="17983" class="Symbol">→</a> <a id="17985" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="17987" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="17989" class="Symbol">(</a><a id="17990" href="Varieties.Closure.html#3790" class="Datatype">S</a><a id="17991" class="Symbol">{</a><a id="17992" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="17993" class="Symbol">}{</a><a id="17995" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="17997" class="Symbol">}</a> <a id="17999" class="Symbol">(</a><a id="18000" href="Varieties.Closure.html#4374" class="Datatype">P</a><a id="18001" class="Symbol">{</a><a id="18002" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18003" class="Symbol">}{</a><a id="18005" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18006" class="Symbol">}</a> <a id="18008" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a><a id="18009" class="Symbol">))</a>
  <a id="18014" href="Varieties.FreeAlgebras.html#17955" class="Function">𝔽∈SP</a> <a id="18019" href="Varieties.FreeAlgebras.html#18019" class="Bound">hfe</a> <a id="18023" class="Symbol">=</a> <a id="18025" href="Varieties.Closure.html#3998" class="InductiveConstructor">ssub</a> <a id="18030" class="Symbol">(</a><a id="18031" href="Varieties.Preservation.html#12939" class="Function">class-prod-s-∈-sp</a> <a id="18049" href="Varieties.FreeAlgebras.html#18019" class="Bound">hfe</a><a id="18052" class="Symbol">)</a> <a id="18054" href="Varieties.FreeAlgebras.html#16779" class="Function">𝔽≤ℭ</a>

  <a id="18061" href="Varieties.FreeAlgebras.html#18061" class="Function">𝔽∈𝕍</a> <a id="18065" class="Symbol">:</a> <a id="18067" href="Foundations.Truncation.html#3935" class="Function">hfunext</a> <a id="18075" class="Symbol">(</a><a id="18076" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="18079" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18080" class="Symbol">)(</a><a id="18082" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="18085" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18086" class="Symbol">)</a> <a id="18088" class="Symbol">→</a> <a id="18090" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="18092" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18094" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="18096" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
  <a id="18100" href="Varieties.FreeAlgebras.html#18061" class="Function">𝔽∈𝕍</a> <a id="18104" href="Varieties.FreeAlgebras.html#18104" class="Bound">hfe</a> <a id="18108" class="Symbol">=</a> <a id="18110" href="Varieties.Preservation.html#9267" class="Function">SP⊆V&#39;</a> <a id="18116" class="Symbol">{</a><a id="18117" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18118" class="Symbol">}{</a><a id="18120" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="18123" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="18125" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18126" class="Symbol">}{</a><a id="18128" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="18131" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a> <a id="18134" href="Varieties.FreeAlgebras.html#3744" class="Function">𝓕⁺</a><a id="18136" class="Symbol">}{</a><a id="18138" href="Varieties.FreeAlgebras.html#10207" class="Bound">fe</a> <a id="18141" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a> <a id="18143" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18144" class="Symbol">}{</a><a id="18146" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a><a id="18147" class="Symbol">}</a> <a id="18149" class="Symbol">(</a><a id="18150" href="Varieties.FreeAlgebras.html#17955" class="Function">𝔽∈SP</a> <a id="18155" href="Varieties.FreeAlgebras.html#18104" class="Bound">hfe</a><a id="18158" class="Symbol">)</a>

</pre>

#### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18495" href="Varieties.FreeAlgebras.html#18495" class="Function">Birkhoff</a> <a id="18504" class="Symbol">:</a> <a id="18506" href="Foundations.Truncation.html#3935" class="Function">hfunext</a> <a id="18514" class="Symbol">(</a><a id="18515" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="18518" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18519" class="Symbol">)(</a><a id="18521" href="Algebras.Products.html#3004" class="Function">ov</a> <a id="18524" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18525" class="Symbol">)</a> <a id="18527" class="Symbol">→</a> <a id="18529" class="Symbol">(∀</a> <a id="18532" href="Varieties.FreeAlgebras.html#18532" class="Bound">𝑨</a> <a id="18534" class="Symbol">→</a> <a id="18536" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a> <a id="18538" href="Varieties.FreeAlgebras.html#15383" class="Function Operator">↠</a> <a id="18540" href="Varieties.FreeAlgebras.html#18532" class="Bound">𝑨</a><a id="18541" class="Symbol">)</a> <a id="18543" class="Symbol">→</a> <a id="18545" href="Varieties.EquationalLogic.html#4029" class="Function">Mod</a> <a id="18549" class="Symbol">(</a><a id="18550" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a> <a id="18553" class="Symbol">(</a><a id="18554" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="18556" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a><a id="18557" class="Symbol">))</a> <a id="18560" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18562" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="18564" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a>
  <a id="18568" href="Varieties.FreeAlgebras.html#18495" class="Function">Birkhoff</a> <a id="18577" href="Varieties.FreeAlgebras.html#18577" class="Bound">hfe</a> <a id="18581" href="Varieties.FreeAlgebras.html#18581" class="Bound">𝕏</a> <a id="18583" class="Symbol">{</a><a id="18584" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a><a id="18585" class="Symbol">}</a> <a id="18587" href="Varieties.FreeAlgebras.html#18587" class="Bound">α</a> <a id="18589" class="Symbol">=</a> <a id="18591" href="Varieties.Closure.html#5615" class="InductiveConstructor">vhimg</a><a id="18596" class="Symbol">{</a><a id="18597" class="Argument">𝑩</a> <a id="18599" class="Symbol">=</a> <a id="18601" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a><a id="18602" class="Symbol">}</a> <a id="18604" class="Symbol">(</a><a id="18605" href="Varieties.FreeAlgebras.html#18061" class="Function">𝔽∈𝕍</a> <a id="18609" href="Varieties.FreeAlgebras.html#18577" class="Bound">hfe</a><a id="18612" class="Symbol">)</a> <a id="18614" class="Symbol">(</a><a id="18615" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a> <a id="18617" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18619" href="Homomorphisms.Basic.html#6442" class="Function">epi-to-hom</a> <a id="18630" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a> <a id="18632" href="Varieties.FreeAlgebras.html#18661" class="Function">φE</a> <a id="18635" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18637" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="18641" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a> <a id="18643" href="Varieties.FreeAlgebras.html#18661" class="Function">φE</a> <a id="18646" href="Overture.Preliminaries.html#4283" class="Function Operator">∥</a><a id="18647" class="Symbol">)</a>
   <a id="18652" class="Keyword">where</a>
   <a id="18661" href="Varieties.FreeAlgebras.html#18661" class="Function">φE</a> <a id="18664" class="Symbol">:</a> <a id="18666" href="Homomorphisms.Basic.html#5975" class="Function">epi</a> <a id="18670" href="Varieties.FreeAlgebras.html#11400" class="Function">𝔽</a> <a id="18672" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a>
   <a id="18677" href="Varieties.FreeAlgebras.html#18661" class="Function">φE</a> <a id="18680" class="Symbol">=</a> <a id="18682" href="Varieties.FreeAlgebras.html#15468" class="Function">𝔽-ModTh-epi</a> <a id="18694" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a> <a id="18696" class="Symbol">(</a><a id="18697" href="Varieties.FreeAlgebras.html#18581" class="Bound">𝕏</a> <a id="18699" href="Varieties.FreeAlgebras.html#18584" class="Bound">𝑨</a><a id="18700" class="Symbol">)</a> <a id="18702" href="Varieties.FreeAlgebras.html#18587" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="18960" href="Varieties.FreeAlgebras.html#18960" class="Function">Birkhoff-converse</a> <a id="18978" class="Symbol">:</a> <a id="18980" href="Varieties.Closure.html#5334" class="Datatype">V</a><a id="18981" class="Symbol">{</a><a id="18982" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18983" class="Symbol">}{</a><a id="18985" href="Varieties.FreeAlgebras.html#3742" class="Function">𝓕</a><a id="18986" class="Symbol">}</a> <a id="18988" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a> <a id="18990" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18992" href="Varieties.EquationalLogic.html#4029" class="Function">Mod</a><a id="18995" class="Symbol">{</a><a id="18996" class="Argument">X</a> <a id="18998" class="Symbol">=</a> <a id="19000" href="Varieties.FreeAlgebras.html#10236" class="Bound">X</a><a id="19001" class="Symbol">}</a> <a id="19003" class="Symbol">(</a><a id="19004" href="Varieties.EquationalLogic.html#3454" class="Function">Th</a> <a id="19007" class="Symbol">(</a><a id="19008" href="Varieties.Closure.html#5334" class="Datatype">V</a> <a id="19010" href="Varieties.FreeAlgebras.html#10249" class="Bound">𝒦</a><a id="19011" class="Symbol">))</a>
  <a id="19016" href="Varieties.FreeAlgebras.html#18960" class="Function">Birkhoff-converse</a> <a id="19034" href="Varieties.FreeAlgebras.html#19034" class="Bound">α</a> <a id="19036" href="Varieties.FreeAlgebras.html#19036" class="Bound">p</a> <a id="19038" href="Varieties.FreeAlgebras.html#19038" class="Bound">q</a> <a id="19040" href="Varieties.FreeAlgebras.html#19040" class="Bound">pThq</a> <a id="19045" class="Symbol">=</a> <a id="19047" href="Varieties.FreeAlgebras.html#19040" class="Bound">pThq</a> <a id="19052" href="Varieties.FreeAlgebras.html#19034" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.




----------------------------


<sup>1</sup><span class="footnote" id="fn1"> Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.</span>


--------------------------------


<br>


[← Varieties.Preservation](Varieties.Preservation.html)
<span style="float:right;">[Varieties.Setoid →](Varieties.Setoid.html)</span>

{% include UALib.Links.md %}


[agda-algebras development team]: https://github.com/ualib/agda-algebras#the-agda-algebras-development-team
