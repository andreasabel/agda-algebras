---
layout: default
title : Varieties.FreeAlgebras module (Agda Universal Algebra Library)
date : 2021-03-01
author: [agda-algebras development team][]
---

## <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="799" class="Symbol">{-#</a> <a id="803" class="Keyword">OPTIONS</a> <a id="811" class="Pragma">--without-K</a> <a id="823" class="Pragma">--exact-split</a> <a id="837" class="Pragma">--safe</a> <a id="844" class="Symbol">#-}</a>


<a id="850" class="Keyword">open</a> <a id="855" class="Keyword">import</a> <a id="862" href="Level.html" class="Module">Level</a> <a id="868" class="Keyword">renaming</a> <a id="877" class="Symbol">(</a> <a id="879" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="883" class="Symbol">to</a> <a id="886" class="Primitive">lsuc</a> <a id="891" class="Symbol">)</a>
<a id="893" class="Keyword">open</a> <a id="898" class="Keyword">import</a> <a id="905" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="920" class="Keyword">using</a> <a id="926" class="Symbol">(</a> <a id="928" href="Algebras.Basic.html#1139" class="Generalizable">𝓞</a> <a id="930" class="Symbol">;</a> <a id="932" href="Algebras.Basic.html#1141" class="Generalizable">𝓥</a> <a id="934" class="Symbol">;</a> <a id="936" href="Algebras.Basic.html#3865" class="Function">Signature</a> <a id="946" class="Symbol">)</a>

<a id="949" class="Keyword">module</a> <a id="956" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="979" class="Symbol">{</a><a id="980" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="982" href="Varieties.FreeAlgebras.html#982" class="Bound">𝓞</a> <a id="984" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="986" class="Symbol">:</a> <a id="988" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="993" class="Symbol">}</a> <a id="995" class="Symbol">(</a><a id="996" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Algebras.Basic.html#3865" class="Function">Signature</a> <a id="1010" href="Varieties.FreeAlgebras.html#982" class="Bound">𝓞</a> <a id="1012" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a><a id="1013" class="Symbol">)</a> <a id="1015" class="Keyword">where</a>

<a id="1022" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1095" class="Keyword">open</a> <a id="1100" class="Keyword">import</a> <a id="1107" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1170" class="Keyword">using</a> <a id="1176" class="Symbol">()</a> <a id="1179" class="Keyword">renaming</a> <a id="1188" class="Symbol">(</a><a id="1189" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1204" class="Symbol">to</a> <a id="1207" class="Function">funext</a><a id="1213" class="Symbol">)</a>
<a id="1215" class="Keyword">open</a> <a id="1220" class="Keyword">import</a> <a id="1227" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1243" class="Keyword">using</a> <a id="1249" class="Symbol">(</a> <a id="1251" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1255" class="Symbol">)</a> <a id="1257" class="Keyword">renaming</a> <a id="1266" class="Symbol">(</a> <a id="1268" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1272" class="Symbol">to</a> <a id="1275" class="Primitive">Type</a> <a id="1280" class="Symbol">)</a>
<a id="1282" class="Keyword">open</a> <a id="1287" class="Keyword">import</a> <a id="1294" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1310" class="Keyword">using</a> <a id="1316" class="Symbol">(</a> <a id="1318" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1322" class="Symbol">;</a> <a id="1324" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1333" class="Symbol">;</a> <a id="1335" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1339" class="Symbol">)</a> <a id="1341" class="Keyword">renaming</a> <a id="1350" class="Symbol">(</a> <a id="1352" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1358" class="Symbol">to</a> <a id="1361" class="Field">fst</a> <a id="1365" class="Symbol">;</a> <a id="1367" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1373" class="Symbol">to</a> <a id="1376" class="Field">snd</a> <a id="1380" class="Symbol">)</a>
<a id="1382" class="Keyword">open</a> <a id="1387" class="Keyword">import</a> <a id="1394" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1410" class="Keyword">using</a> <a id="1416" class="Symbol">(</a> <a id="1418" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1422" class="Symbol">)</a>
<a id="1424" class="Keyword">open</a> <a id="1429" class="Keyword">import</a> <a id="1436" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1452" class="Keyword">using</a> <a id="1458" class="Symbol">(</a> <a id="1460" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1474" class="Symbol">)</a> <a id="1476" class="Keyword">renaming</a> <a id="1485" class="Symbol">(</a> <a id="1487" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1491" class="Symbol">to</a> <a id="1494" class="Function">BinRel</a> <a id="1501" class="Symbol">)</a>
<a id="1503" class="Keyword">open</a> <a id="1508" class="Keyword">import</a> <a id="1515" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1581" class="Keyword">using</a> <a id="1587" class="Symbol">(</a> <a id="1589" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1593" class="Symbol">;</a> <a id="1595" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1618" class="Symbol">;</a> <a id="1620" class="Keyword">module</a> <a id="1627" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1639" class="Symbol">)</a>
<a id="1641" class="Keyword">open</a> <a id="1646" class="Keyword">import</a> <a id="1653" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1669" class="Keyword">using</a>    <a id="1678" class="Symbol">(</a> <a id="1680" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1685" class="Symbol">;</a> <a id="1687" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1691" class="Symbol">;</a> <a id="1693" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1697" class="Symbol">;</a> <a id="1699" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1703" class="Symbol">;</a> <a id="1705" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1709" class="Symbol">)</a>

<a id="1712" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1807" class="Keyword">open</a> <a id="1812" class="Keyword">import</a> <a id="1819" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1854" class="Keyword">using</a> <a id="1860" class="Symbol">(</a> <a id="1862" href="Overture.Preliminaries.html#4524" class="Function Operator">∣_∣</a> <a id="1866" class="Symbol">;</a> <a id="1868" href="Overture.Preliminaries.html#4562" class="Function Operator">∥_∥</a> <a id="1872" class="Symbol">;</a> <a id="1874" href="Overture.Preliminaries.html#5554" class="Function Operator">_∙_</a> <a id="1878" class="Symbol">;</a> <a id="1880" href="Overture.Preliminaries.html#5228" class="Function Operator">_⁻¹</a> <a id="1884" class="Symbol">)</a>
<a id="1886" class="Keyword">open</a> <a id="1891" class="Keyword">import</a> <a id="1898" href="Overture.Inverses.html" class="Module">Overture.Inverses</a>                  <a id="1933" class="Keyword">using</a> <a id="1939" class="Symbol">(</a> <a id="1941" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="1954" class="Symbol">)</a>
<a id="1956" class="Keyword">open</a> <a id="1961" class="Keyword">import</a> <a id="1968" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2003" class="Keyword">using</a> <a id="2009" class="Symbol">(</a> <a id="2011" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="2018" class="Symbol">)</a>
<a id="2020" class="Keyword">open</a> <a id="2025" class="Keyword">import</a> <a id="2032" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2067" class="Keyword">using</a> <a id="2073" class="Symbol">(</a> <a id="2075" href="Relations.Quotients.html#5374" class="Function Operator">⟪_⟫</a> <a id="2079" class="Symbol">)</a>
<a id="2081" class="Keyword">open</a> <a id="2086" class="Keyword">import</a> <a id="2093" href="Foundations.Truncation.html" class="Module">Foundations.Truncation</a>             <a id="2128" class="Keyword">using</a> <a id="2134" class="Symbol">(</a> <a id="2136" href="Foundations.Truncation.html#6614" class="Function">is-set</a> <a id="2143" class="Symbol">;</a> <a id="2145" href="Foundations.Truncation.html#10869" class="Function">blk-uip</a> <a id="2153" class="Symbol">;</a> <a id="2155" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="2163" class="Symbol">)</a>
<a id="2165" class="Keyword">open</a> <a id="2170" class="Keyword">import</a> <a id="2177" href="Foundations.Welldefined.html" class="Module">Foundations.Welldefined</a>            <a id="2212" class="Keyword">using</a> <a id="2218" class="Symbol">(</a> <a id="2220" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a> <a id="2229" class="Symbol">;</a> <a id="2231" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="2240" class="Symbol">)</a>
<a id="2242" class="Keyword">open</a> <a id="2247" class="Keyword">import</a> <a id="2254" href="Foundations.Extensionality.html" class="Module">Foundations.Extensionality</a>         <a id="2289" class="Keyword">using</a> <a id="2295" class="Symbol">(</a> <a id="2297" href="Foundations.Extensionality.html#2463" class="Function">DFunExt</a><a id="2304" class="Symbol">;</a> <a id="2306" href="Foundations.Extensionality.html#3279" class="Function">pred-ext</a> <a id="2315" class="Symbol">)</a>
<a id="2317" class="Keyword">open</a> <a id="2322" class="Keyword">import</a> <a id="2329" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2364" class="Keyword">using</a> <a id="2370" class="Symbol">(</a> <a id="2372" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="2380" class="Symbol">;</a> <a id="2382" href="Algebras.Basic.html#10869" class="Function">Lift-Alg</a> <a id="2391" class="Symbol">;</a> <a id="2393" href="Algebras.Basic.html#12418" class="Function">compatible</a> <a id="2404" class="Symbol">;</a> <a id="2406" href="Algebras.Basic.html#9410" class="Function Operator">_̂_</a> <a id="2410" class="Symbol">)</a>
<a id="2412" class="Keyword">open</a> <a id="2417" class="Keyword">import</a> <a id="2424" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2451" class="Symbol">{</a><a id="2452" class="Argument">𝑆</a> <a id="2454" class="Symbol">=</a> <a id="2456" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2457" class="Symbol">}</a> <a id="2459" class="Keyword">using</a> <a id="2465" class="Symbol">(</a> <a id="2467" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="2470" class="Symbol">;</a> <a id="2472" href="Algebras.Products.html#1785" class="Function">⨅</a> <a id="2474" class="Symbol">)</a>
<a id="2476" class="Keyword">open</a> <a id="2481" class="Keyword">import</a> <a id="2488" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2515" class="Symbol">{</a><a id="2516" class="Argument">𝑆</a> <a id="2518" class="Symbol">=</a> <a id="2520" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2521" class="Symbol">}</a> <a id="2523" class="Keyword">using</a> <a id="2529" class="Symbol">(</a> <a id="2531" href="Algebras.Congruences.html#1986" class="Function">Con</a><a id="2534" class="Symbol">;</a> <a id="2536" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="2542" class="Symbol">;</a> <a id="2544" href="Algebras.Congruences.html#1800" class="Record">IsCongruence</a> <a id="2557" class="Symbol">)</a>
<a id="2559" class="Keyword">open</a> <a id="2564" class="Keyword">import</a> <a id="2571" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2598" class="Symbol">{</a><a id="2599" class="Argument">𝑆</a> <a id="2601" class="Symbol">=</a> <a id="2603" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2604" class="Symbol">}</a> <a id="2606" class="Keyword">using</a> <a id="2612" class="Symbol">(</a> <a id="2614" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="2618" class="Symbol">;</a> <a id="2620" href="Homomorphisms.Basic.html#10776" class="Function">⨅-hom-co</a> <a id="2629" class="Symbol">;</a> <a id="2631" href="Homomorphisms.Basic.html#8122" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2643" class="Symbol">;</a> <a id="2645" href="Homomorphisms.Basic.html#6038" class="Function">epi</a>
                                                     <a id="2702" class="Symbol">;</a> <a id="2704" href="Homomorphisms.Basic.html#9580" class="Function">πker</a> <a id="2709" class="Symbol">;</a> <a id="2711" href="Homomorphisms.Basic.html#6505" class="Function">epi-to-hom</a> <a id="2722" class="Symbol">;</a> <a id="2724" href="Homomorphisms.Basic.html#10089" class="Function">ker-in-con</a>
                                                     <a id="2788" class="Symbol">;</a>  <a id="2791" href="Homomorphisms.Basic.html#7714" class="Function">kercon</a> <a id="2798" class="Symbol">;</a> <a id="2800" href="Homomorphisms.Basic.html#3531" class="Function">∘-hom</a> <a id="2806" class="Symbol">)</a>
<a id="2808" class="Keyword">open</a> <a id="2813" class="Keyword">import</a> <a id="2820" href="Homomorphisms.Noether.html" class="Module">Homomorphisms.Noether</a>      <a id="2847" class="Symbol">{</a><a id="2848" class="Argument">𝑆</a> <a id="2850" class="Symbol">=</a> <a id="2852" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2853" class="Symbol">}</a> <a id="2855" class="Keyword">using</a> <a id="2861" class="Symbol">(</a> <a id="2863" href="Homomorphisms.Noether.html#8601" class="Function">HomFactor</a> <a id="2873" class="Symbol">;</a> <a id="2875" href="Homomorphisms.Noether.html#9875" class="Function">HomFactorEpi</a> <a id="2888" class="Symbol">)</a>
<a id="2890" class="Keyword">open</a> <a id="2895" class="Keyword">import</a> <a id="2902" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2929" class="Symbol">{</a><a id="2930" class="Argument">𝑆</a> <a id="2932" class="Symbol">=</a> <a id="2934" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="2935" class="Symbol">}</a> <a id="2937" class="Keyword">using</a> <a id="2943" class="Symbol">(</a> <a id="2945" href="Homomorphisms.Isomorphisms.html#2276" class="Record Operator">_≅_</a> <a id="2949" class="Symbol">;</a> <a id="2951" href="Homomorphisms.Isomorphisms.html#2816" class="Function">≅-refl</a> <a id="2958" class="Symbol">;</a> <a id="2960" href="Homomorphisms.Isomorphisms.html#2906" class="Function">≅-sym</a> <a id="2966" class="Symbol">;</a> <a id="2968" href="Homomorphisms.Isomorphisms.html#4349" class="Function">Lift-≅</a> <a id="2975" class="Symbol">)</a>
<a id="2977" class="Keyword">open</a> <a id="2982" class="Keyword">import</a> <a id="2989" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3016" class="Symbol">{</a><a id="3017" class="Argument">𝑆</a> <a id="3019" class="Symbol">=</a> <a id="3021" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3022" class="Symbol">}</a> <a id="3024" class="Keyword">using</a> <a id="3030" class="Symbol">(</a> <a id="3032" href="Terms.Basic.html#1987" class="Datatype">Term</a> <a id="3037" class="Symbol">;</a> <a id="3039" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="3041" class="Symbol">)</a>
<a id="3043" class="Keyword">open</a> <a id="3048" class="Keyword">import</a> <a id="3055" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3082" class="Symbol">{</a><a id="3083" class="Argument">𝑆</a> <a id="3085" class="Symbol">=</a> <a id="3087" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3088" class="Symbol">}</a> <a id="3090" class="Keyword">using</a> <a id="3096" class="Symbol">(</a> <a id="3098" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="3108" class="Symbol">;</a> <a id="3110" href="Terms.Properties.html#3177" class="Function">lift-hom</a>
                                                     <a id="3172" class="Symbol">;</a> <a id="3174" href="Terms.Properties.html#3576" class="Function">free-unique</a> <a id="3186" class="Symbol">;</a> <a id="3188" href="Terms.Properties.html#4782" class="Function">lift-of-epi-is-epi</a> <a id="3207" class="Symbol">)</a>
<a id="3209" class="Keyword">open</a> <a id="3214" class="Keyword">import</a> <a id="3221" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3248" class="Symbol">{</a><a id="3249" class="Argument">𝑆</a> <a id="3251" class="Symbol">=</a> <a id="3253" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3254" class="Symbol">}</a> <a id="3256" class="Keyword">using</a> <a id="3262" class="Symbol">(</a> <a id="3264" href="Terms.Operations.html#2527" class="Function Operator">_⟦_⟧</a><a id="3268" class="Symbol">;</a> <a id="3270" href="Terms.Operations.html#6532" class="Function">comm-hom-term</a><a id="3283" class="Symbol">;</a> <a id="3285" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="3302" class="Symbol">)</a>
<a id="3304" class="Keyword">open</a> <a id="3309" class="Keyword">import</a> <a id="3316" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3343" class="Symbol">{</a><a id="3344" class="Argument">𝑆</a> <a id="3346" class="Symbol">=</a> <a id="3348" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3349" class="Symbol">}</a> <a id="3351" class="Keyword">using</a> <a id="3357" class="Symbol">(</a> <a id="3359" href="Subalgebras.Subalgebras.html#2553" class="Function Operator">_≤_</a> <a id="3363" class="Symbol">;</a> <a id="3365" href="Subalgebras.Subalgebras.html#4384" class="Function">FirstHomCorollary|Set</a> <a id="3387" class="Symbol">)</a>
<a id="3389" class="Keyword">open</a> <a id="3394" class="Keyword">import</a> <a id="3401" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3428" class="Symbol">{</a><a id="3429" class="Argument">𝑆</a> <a id="3431" class="Symbol">=</a> <a id="3433" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3434" class="Symbol">}</a> <a id="3436" class="Keyword">using</a> <a id="3442" class="Symbol">(</a> <a id="3444" href="Varieties.EquationalLogic.html#2683" class="Function Operator">_⊫_≈_</a><a id="3449" class="Symbol">;</a> <a id="3451" href="Varieties.EquationalLogic.html#2605" class="Function Operator">_⊧_≈_</a><a id="3456" class="Symbol">;</a> <a id="3458" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a><a id="3460" class="Symbol">;</a> <a id="3462" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="3466" class="Symbol">)</a>
<a id="3468" class="Keyword">open</a> <a id="3473" class="Keyword">import</a> <a id="3480" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3507" class="Symbol">{</a><a id="3508" class="Argument">𝑆</a> <a id="3510" class="Symbol">=</a> <a id="3512" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3513" class="Symbol">}</a> <a id="3515" class="Keyword">using</a> <a id="3521" class="Symbol">(</a> <a id="3523" href="Varieties.Closure.html#3769" class="Datatype">S</a> <a id="3525" class="Symbol">;</a> <a id="3527" href="Varieties.Closure.html#4352" class="Datatype">P</a> <a id="3529" class="Symbol">;</a> <a id="3531" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="3533" class="Symbol">)</a>
<a id="3535" class="Keyword">open</a> <a id="3540" class="Keyword">import</a> <a id="3547" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3574" class="Symbol">{</a><a id="3575" class="Argument">𝑆</a> <a id="3577" class="Symbol">=</a> <a id="3579" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="3580" class="Symbol">}</a> <a id="3582" class="Keyword">using</a> <a id="3588" class="Symbol">(</a> <a id="3590" class="Keyword">module</a> <a id="3597" href="Varieties.Preservation.html#10441" class="Module">class-products-with-maps</a>
                                                     <a id="3675" class="Symbol">;</a> <a id="3677" href="Varieties.Preservation.html#20348" class="Function">class-ids-⇒</a> <a id="3689" class="Symbol">;</a> <a id="3691" href="Varieties.Preservation.html#20461" class="Function">class-ids</a> <a id="3701" class="Symbol">;</a> <a id="3703" href="Varieties.Preservation.html#9292" class="Function">SP⊆V&#39;</a><a id="3708" class="Symbol">)</a>
<a id="3710" class="Keyword">open</a> <a id="3715" href="Terms.Basic.html#1987" class="Module">Term</a>
<a id="3720" class="Keyword">open</a> <a id="3725" href="Varieties.Closure.html#3769" class="Module">S</a>
<a id="3727" class="Keyword">open</a> <a id="3732" href="Varieties.Closure.html#5309" class="Module">V</a>

<a id="𝓕"></a><a id="3735" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3737" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="3740" class="Symbol">:</a> <a id="3742" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3748" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="3750" class="Symbol">=</a> <a id="3752" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="3755" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a>
<a id="3757" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="3760" class="Symbol">=</a> <a id="3762" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="3771" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="3772" class="Symbol">)</a>    <a id="3777" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in [the universal property](Terms.Basic.html#the-universal-property) section of the [Terms.Basic][] module that the term algebra `𝑻 X` is the absolutely free algebra in the class of all `𝑆`-structures. In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.

`Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}` &nbsp; &nbsp; and &nbsp; &nbsp; `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.

Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.

The free algebra is constructed by applying the above definitions to the special case in which `𝑨` is the term algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔉 := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔉` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔉` belongs to `S(P 𝒦)`, and it follows that `𝔉` satisfies all the identities satisfied by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` must belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔉`.

The `𝔉` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔉` is free *in* `S(P 𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔉`, technically it doesn't make sense to say "`X` generates `𝔉`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which does belong to 𝔉.



### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔉 𝒦 X := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6290" class="Keyword">module</a> <a id="6297" href="Varieties.FreeAlgebras.html#6297" class="Module">_</a> <a id="6299" class="Symbol">{</a><a id="6300" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6302" class="Symbol">:</a> <a id="6304" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="6309" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6310" class="Symbol">}(</a><a id="6312" href="Varieties.FreeAlgebras.html#6312" class="Bound">𝒦</a> <a id="6314" class="Symbol">:</a> <a id="6316" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6321" class="Symbol">(</a><a id="6322" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="6330" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6332" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="6333" class="Symbol">)</a> <a id="6335" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="6336" class="Symbol">)</a> <a id="6338" class="Keyword">where</a>

 <a id="6346" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6348" class="Symbol">:</a> <a id="6350" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6355" class="Symbol">(</a><a id="6356" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6358" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6360" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6362" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6364" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6366" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6368" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6370" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6372" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="6373" class="Symbol">)</a> <a id="6375" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a>
 <a id="6378" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6380" class="Symbol">(</a><a id="6381" href="Varieties.FreeAlgebras.html#6381" class="Bound">p</a> <a id="6383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6385" href="Varieties.FreeAlgebras.html#6385" class="Bound">q</a><a id="6386" class="Symbol">)</a> <a id="6388" class="Symbol">=</a> <a id="6390" class="Symbol">∀(</a><a id="6392" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6394" class="Symbol">:</a> <a id="6396" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="6404" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6406" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="6407" class="Symbol">)(</a><a id="6409" href="Varieties.FreeAlgebras.html#6409" class="Bound">sA</a> <a id="6412" class="Symbol">:</a> <a id="6414" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6416" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6418" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="6419" class="Symbol">{</a><a id="6420" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6421" class="Symbol">}{</a><a id="6423" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="6424" class="Symbol">}</a> <a id="6426" href="Varieties.FreeAlgebras.html#6312" class="Bound">𝒦</a><a id="6427" class="Symbol">)(</a><a id="6429" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a> <a id="6431" class="Symbol">:</a> <a id="6433" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6435" class="Symbol">→</a> <a id="6437" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6439" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6441" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6443" class="Symbol">)</a>
                 <a id="6462" class="Symbol">→</a>  <a id="6465" class="Symbol">(</a><a id="6466" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="6476" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6478" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a><a id="6479" class="Symbol">)</a> <a id="6481" href="Varieties.FreeAlgebras.html#6381" class="Bound">p</a> <a id="6483" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6485" class="Symbol">(</a><a id="6486" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="6496" href="Varieties.FreeAlgebras.html#6392" class="Bound">𝑨</a> <a id="6498" href="Varieties.FreeAlgebras.html#6429" class="Bound">h</a><a id="6499" class="Symbol">)</a> <a id="6501" href="Varieties.FreeAlgebras.html#6385" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6630" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="6635" class="Symbol">:</a> <a id="6637" href="Varieties.FreeAlgebras.html#1494" class="Function">BinRel</a> <a id="6644" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6646" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6648" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a> <a id="6650" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="6652" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a>
 <a id="6655" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="6660" href="Varieties.FreeAlgebras.html#6660" class="Bound">p</a> <a id="6662" href="Varieties.FreeAlgebras.html#6662" class="Bound">q</a> <a id="6664" class="Symbol">=</a> <a id="6666" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="6668" class="Symbol">(</a><a id="6669" href="Varieties.FreeAlgebras.html#6660" class="Bound">p</a> <a id="6671" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6673" href="Varieties.FreeAlgebras.html#6662" class="Bound">q</a><a id="6674" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6922" class="Keyword">open</a> <a id="6927" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6941" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="6953" class="Symbol">:</a> <a id="6955" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="6964" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="6966" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="6968" class="Symbol">→</a> <a id="6970" href="Algebras.Basic.html#12418" class="Function">compatible</a> <a id="6981" class="Symbol">(</a><a id="6982" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="6984" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="6985" class="Symbol">)</a> <a id="6987" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a>
 <a id="6993" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="7005" href="Varieties.FreeAlgebras.html#7005" class="Bound">wd</a> <a id="7008" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7010" class="Symbol">{</a><a id="7011" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7012" class="Symbol">}</a> <a id="7014" class="Symbol">{</a><a id="7015" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7016" class="Symbol">}</a> <a id="7018" href="Varieties.FreeAlgebras.html#7018" class="Bound">ψpq</a> <a id="7022" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7024" href="Varieties.FreeAlgebras.html#7024" class="Bound">sA</a> <a id="7027" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a> <a id="7029" class="Symbol">=</a> <a id="7031" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a>
  <a id="7035" class="Keyword">where</a>
  <a id="7043" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7045" class="Symbol">:</a> <a id="7047" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="7051" class="Symbol">(</a><a id="7052" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7054" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7055" class="Symbol">)</a> <a id="7057" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a>
  <a id="7061" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7063" class="Symbol">=</a> <a id="7065" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="7074" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7076" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a>

  <a id="7081" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a> <a id="7083" class="Symbol">:</a> <a id="7085" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7087" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7089" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7091" class="Symbol">((</a><a id="7093" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7095" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7097" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7099" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7100" class="Symbol">)</a> <a id="7102" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7103" class="Symbol">)</a> <a id="7105" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7107" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7109" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7111" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7113" class="Symbol">((</a><a id="7115" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7117" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7119" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7121" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7122" class="Symbol">)</a> <a id="7124" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7125" class="Symbol">)</a>

  <a id="7130" href="Varieties.FreeAlgebras.html#7081" class="Function">γ</a> <a id="7132" class="Symbol">=</a> <a id="7134" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7136" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7138" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7140" class="Symbol">((</a><a id="7142" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7144" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7146" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7148" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7149" class="Symbol">)</a> <a id="7151" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7152" class="Symbol">)</a>  <a id="7155" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7158" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7160" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7162" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7164" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7166" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a> <a id="7168" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7176" class="Symbol">(</a><a id="7177" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7179" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7181" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7182" class="Symbol">)</a> <a id="7184" class="Symbol">(</a><a id="7185" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7187" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7189" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7191" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7193" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7194" class="Symbol">)</a>  <a id="7197" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7200" href="Varieties.FreeAlgebras.html#7005" class="Bound">wd</a> <a id="7203" class="Symbol">(</a><a id="7204" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7206" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7208" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7209" class="Symbol">)(</a><a id="7211" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7213" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7215" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7217" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7219" href="Varieties.FreeAlgebras.html#7011" class="Bound">p</a><a id="7220" class="Symbol">)(</a><a id="7222" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7224" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7226" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7228" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7230" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7231" class="Symbol">)(λ</a> <a id="7235" href="Varieties.FreeAlgebras.html#7235" class="Bound">x</a> <a id="7237" class="Symbol">→</a> <a id="7239" href="Varieties.FreeAlgebras.html#7018" class="Bound">ψpq</a> <a id="7243" href="Varieties.FreeAlgebras.html#7235" class="Bound">x</a> <a id="7245" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a> <a id="7247" href="Varieties.FreeAlgebras.html#7024" class="Bound">sA</a> <a id="7250" href="Varieties.FreeAlgebras.html#7027" class="Bound">h</a><a id="7251" class="Symbol">)</a> <a id="7253" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7261" class="Symbol">(</a><a id="7262" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7264" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7266" href="Varieties.FreeAlgebras.html#7022" class="Bound">𝑨</a><a id="7267" class="Symbol">)</a> <a id="7269" class="Symbol">(</a><a id="7270" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7272" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7274" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7276" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7278" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7279" class="Symbol">)</a>  <a id="7282" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7285" class="Symbol">(</a><a id="7286" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7288" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7290" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="7292" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7294" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7295" class="Symbol">)</a><a id="7296" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="7299" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7307" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7309" href="Varieties.FreeAlgebras.html#7043" class="Function">φ</a> <a id="7311" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="7313" class="Symbol">((</a><a id="7315" href="Varieties.FreeAlgebras.html#7008" class="Bound">𝑓</a> <a id="7317" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="7319" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7321" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7322" class="Symbol">)</a> <a id="7324" href="Varieties.FreeAlgebras.html#7015" class="Bound">q</a><a id="7325" class="Symbol">)</a>  <a id="7328" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7332" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7347" class="Symbol">:</a> <a id="7349" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7363" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a>
 <a id="7369" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7384" class="Symbol">=</a> <a id="7386" class="Keyword">record</a> <a id="7393" class="Symbol">{</a> <a id="7395" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7400" class="Symbol">=</a> <a id="7402" class="Symbol">λ</a> <a id="7404" href="Varieties.FreeAlgebras.html#7404" class="Bound">𝑨</a> <a id="7406" href="Varieties.FreeAlgebras.html#7406" class="Bound">sA</a> <a id="7409" href="Varieties.FreeAlgebras.html#7409" class="Bound">h</a> <a id="7411" class="Symbol">→</a> <a id="7413" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7443" class="Symbol">;</a> <a id="7445" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7449" class="Symbol">=</a> <a id="7451" class="Symbol">λ</a> <a id="7453" href="Varieties.FreeAlgebras.html#7453" class="Bound">x</a> <a id="7455" href="Varieties.FreeAlgebras.html#7455" class="Bound">𝑨</a> <a id="7457" href="Varieties.FreeAlgebras.html#7457" class="Bound">sA</a> <a id="7460" href="Varieties.FreeAlgebras.html#7460" class="Bound">h</a> <a id="7462" class="Symbol">→</a> <a id="7464" class="Symbol">(</a><a id="7465" href="Varieties.FreeAlgebras.html#7453" class="Bound">x</a> <a id="7467" href="Varieties.FreeAlgebras.html#7455" class="Bound">𝑨</a> <a id="7469" href="Varieties.FreeAlgebras.html#7457" class="Bound">sA</a> <a id="7472" href="Varieties.FreeAlgebras.html#7460" class="Bound">h</a><a id="7473" class="Symbol">)</a><a id="7474" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>
                         <a id="7502" class="Symbol">;</a> <a id="7504" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7510" class="Symbol">=</a> <a id="7512" class="Symbol">λ</a> <a id="7514" href="Varieties.FreeAlgebras.html#7514" class="Bound">pψq</a> <a id="7518" href="Varieties.FreeAlgebras.html#7518" class="Bound">qψr</a> <a id="7522" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7524" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7527" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a> <a id="7529" class="Symbol">→</a> <a id="7531" class="Symbol">(</a><a id="7532" href="Varieties.FreeAlgebras.html#7514" class="Bound">pψq</a> <a id="7536" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7538" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7541" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a><a id="7542" class="Symbol">)</a> <a id="7544" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="7546" class="Symbol">(</a><a id="7547" href="Varieties.FreeAlgebras.html#7518" class="Bound">qψr</a> <a id="7551" href="Varieties.FreeAlgebras.html#7522" class="Bound">𝑨</a> <a id="7553" href="Varieties.FreeAlgebras.html#7524" class="Bound">sA</a> <a id="7556" href="Varieties.FreeAlgebras.html#7527" class="Bound">h</a><a id="7557" class="Symbol">)</a> <a id="7559" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7859" href="Varieties.FreeAlgebras.html#7859" class="Function">ψCon</a> <a id="7864" class="Symbol">:</a> <a id="7866" href="Foundations.Welldefined.html#2648" class="Function">swelldef</a> <a id="7875" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="7877" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="7879" class="Symbol">→</a> <a id="7881" href="Algebras.Congruences.html#1986" class="Function">Con</a> <a id="7885" class="Symbol">(</a><a id="7886" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="7888" href="Varieties.FreeAlgebras.html#6300" class="Bound">X</a><a id="7889" class="Symbol">)</a>
 <a id="7892" href="Varieties.FreeAlgebras.html#7859" class="Function">ψCon</a> <a id="7897" href="Varieties.FreeAlgebras.html#7897" class="Bound">wd</a> <a id="7900" class="Symbol">=</a> <a id="7902" href="Varieties.FreeAlgebras.html#6630" class="Function">ψRel</a> <a id="7907" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7909" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="7915" href="Varieties.FreeAlgebras.html#7332" class="Function">ψIsEquivalence</a> <a id="7930" class="Symbol">(</a><a id="7931" href="Varieties.FreeAlgebras.html#6941" class="Function">ψcompatible</a> <a id="7943" href="Varieties.FreeAlgebras.html#7897" class="Bound">wd</a><a id="7945" class="Symbol">)</a>

</pre>



### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄s hom𝔄`.

Here, `⨅-hom-co` (defined in [Homomorphisms.Basic](Homomorphisms.Basic.html#product-homomorphisms)) takes the term algebra `𝑻 X`, a family `{𝔄s : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄s i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is natural in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is highly nontrivial. We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10398" class="Keyword">module</a> <a id="10405" href="Varieties.FreeAlgebras.html#10405" class="Module">_</a> <a id="10407" class="Symbol">{</a><a id="10408" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10411" class="Symbol">:</a> <a id="10413" href="Foundations.Extensionality.html#2463" class="Function">DFunExt</a><a id="10420" class="Symbol">}{</a><a id="10422" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="10425" class="Symbol">:</a> <a id="10427" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a><a id="10435" class="Symbol">}{</a><a id="10437" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="10439" class="Symbol">:</a> <a id="10441" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="10446" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="10447" class="Symbol">}</a> <a id="10449" class="Symbol">{</a><a id="10450" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="10452" class="Symbol">:</a> <a id="10454" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10459" class="Symbol">(</a><a id="10460" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="10468" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="10470" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="10471" class="Symbol">)</a> <a id="10473" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="10474" class="Symbol">}</a> <a id="10476" class="Keyword">where</a>

 <a id="10484" class="Keyword">open</a> <a id="10489" href="Varieties.Preservation.html#10441" class="Module">class-products-with-maps</a> <a id="10514" class="Symbol">{</a><a id="10515" class="Argument">X</a> <a id="10517" class="Symbol">=</a> <a id="10519" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="10520" class="Symbol">}{</a><a id="10522" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10525" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10527" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="10528" class="Symbol">}{</a><a id="10530" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10533" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="10536" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="10538" class="Symbol">}{</a><a id="10540" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="10543" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10545" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="10546" class="Symbol">}</a> <a id="10548" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10763" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10821" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="10823" class="Symbol">:</a> <a id="10825" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="10833" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="10835" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a>
 <a id="10838" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="10840" class="Symbol">=</a> <a id="10842" href="Algebras.Products.html#1785" class="Function">⨅</a> <a id="10844" href="Varieties.Preservation.html#11858" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="11008" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11013" class="Symbol">:</a> <a id="11015" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="11019" class="Symbol">(</a><a id="11020" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11022" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11023" class="Symbol">)</a> <a id="11025" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a>
 <a id="11028" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11033" class="Symbol">=</a> <a id="11035" href="Homomorphisms.Basic.html#10776" class="Function">⨅-hom-co</a> <a id="11044" href="Varieties.Preservation.html#11858" class="Function">𝔄&#39;</a> <a id="11047" class="Symbol">(</a><a id="11048" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="11051" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="11053" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11054" class="Symbol">){</a><a id="11056" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="11057" class="Symbol">}(</a><a id="11059" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11061" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11062" class="Symbol">)</a> <a id="11064" class="Symbol">λ</a> <a id="11066" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a> <a id="11068" class="Symbol">→</a> <a id="11070" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="11079" class="Symbol">(</a><a id="11080" href="Varieties.Preservation.html#11858" class="Function">𝔄&#39;</a> <a id="11083" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a><a id="11084" class="Symbol">)(</a><a id="11086" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="11090" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="11092" href="Varieties.FreeAlgebras.html#11066" class="Bound">i</a> <a id="11094" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a><a id="11095" class="Symbol">)</a>

</pre>


### <a id="the-free-algebra">The free algebra</a>

 As mentioned above, the initial version of the [Agda UniversalAlgebra][] used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11600" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="11602" class="Symbol">:</a> <a id="11604" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="11612" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="11615" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a>
 <a id="11618" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="11620" class="Symbol">=</a> <a id="11622" href="Homomorphisms.Basic.html#8122" class="Function Operator">ker[</a> <a id="11627" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11629" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="11631" href="Homomorphisms.Basic.html#8122" class="Function Operator">⇒</a> <a id="11633" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="11635" href="Homomorphisms.Basic.html#8122" class="Function Operator">]</a> <a id="11637" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11642" href="Homomorphisms.Basic.html#8122" class="Function Operator">↾</a> <a id="11644" class="Symbol">(</a><a id="11645" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="11648" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="11650" class="Symbol">(</a><a id="11651" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="11654" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11655" class="Symbol">))</a>

 <a id="11660" href="Varieties.FreeAlgebras.html#11660" class="Function">epi𝔽</a> <a id="11665" class="Symbol">:</a> <a id="11667" href="Homomorphisms.Basic.html#6038" class="Function">epi</a> <a id="11671" class="Symbol">(</a><a id="11672" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11674" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11675" class="Symbol">)</a> <a id="11677" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a>
 <a id="11680" href="Varieties.FreeAlgebras.html#11660" class="Function">epi𝔽</a> <a id="11685" class="Symbol">=</a> <a id="11687" href="Homomorphisms.Basic.html#9580" class="Function">πker</a> <a id="11692" class="Symbol">(</a><a id="11693" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="11696" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="11698" class="Symbol">(</a><a id="11699" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="11702" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="11703" class="Symbol">))</a> <a id="11706" class="Symbol">{</a><a id="11707" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="11708" class="Symbol">}</a> <a id="11710" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a>

 <a id="11717" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="11722" class="Symbol">:</a> <a id="11724" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="11728" class="Symbol">(</a><a id="11729" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="11731" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="11732" class="Symbol">)</a> <a id="11734" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a>
 <a id="11737" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="11742" class="Symbol">=</a> <a id="11744" href="Homomorphisms.Basic.html#6505" class="Function">epi-to-hom</a> <a id="11755" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="11757" href="Varieties.FreeAlgebras.html#11660" class="Function">epi𝔽</a>

 <a id="11764" href="Varieties.FreeAlgebras.html#11764" class="Function">hom𝔽-is-epic</a> <a id="11777" class="Symbol">:</a> <a id="11779" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="11792" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11794" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="11799" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
 <a id="11802" href="Varieties.FreeAlgebras.html#11764" class="Function">hom𝔽-is-epic</a> <a id="11815" class="Symbol">=</a> <a id="11817" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="11821" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="11823" href="Varieties.FreeAlgebras.html#11660" class="Function">epi𝔽</a> <a id="11828" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11926" href="Varieties.FreeAlgebras.html#11926" class="Function">ψlemma0</a> <a id="11934" class="Symbol">:</a> <a id="11936" class="Symbol">∀</a> <a id="11938" href="Varieties.FreeAlgebras.html#11938" class="Bound">p</a> <a id="11940" href="Varieties.FreeAlgebras.html#11940" class="Bound">q</a> <a id="11942" class="Symbol">→</a>  <a id="11945" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11947" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11952" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11954" href="Varieties.FreeAlgebras.html#11938" class="Bound">p</a> <a id="11956" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11958" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11960" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="11965" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="11967" href="Varieties.FreeAlgebras.html#11940" class="Bound">q</a>  <a id="11970" class="Symbol">→</a> <a id="11972" class="Symbol">(</a><a id="11973" href="Varieties.FreeAlgebras.html#11938" class="Bound">p</a> <a id="11975" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11977" href="Varieties.FreeAlgebras.html#11940" class="Bound">q</a><a id="11978" class="Symbol">)</a> <a id="11980" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11982" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="11984" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="11987" href="Varieties.FreeAlgebras.html#11926" class="Function">ψlemma0</a> <a id="11995" href="Varieties.FreeAlgebras.html#11995" class="Bound">p</a> <a id="11997" href="Varieties.FreeAlgebras.html#11997" class="Bound">q</a> <a id="11999" href="Varieties.FreeAlgebras.html#11999" class="Bound">phomℭq</a> <a id="12006" href="Varieties.FreeAlgebras.html#12006" class="Bound">𝑨</a> <a id="12008" href="Varieties.FreeAlgebras.html#12008" class="Bound">sA</a> <a id="12011" href="Varieties.FreeAlgebras.html#12011" class="Bound">h</a> <a id="12013" class="Symbol">=</a> <a id="12015" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="12024" href="Varieties.FreeAlgebras.html#11999" class="Bound">phomℭq</a> <a id="12031" class="Symbol">(</a><a id="12032" href="Varieties.FreeAlgebras.html#12006" class="Bound">𝑨</a> <a id="12034" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12036" href="Varieties.FreeAlgebras.html#12008" class="Bound">sA</a> <a id="12039" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12041" href="Varieties.FreeAlgebras.html#12011" class="Bound">h</a><a id="12042" class="Symbol">)</a>

 <a id="12046" href="Varieties.FreeAlgebras.html#12046" class="Function">ψlemma0-ap</a> <a id="12057" class="Symbol">:</a> <a id="12059" class="Symbol">{</a><a id="12060" href="Varieties.FreeAlgebras.html#12060" class="Bound">𝑨</a> <a id="12062" class="Symbol">:</a> <a id="12064" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="12072" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="12074" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="12075" class="Symbol">}{</a><a id="12077" href="Varieties.FreeAlgebras.html#12077" class="Bound">h</a> <a id="12079" class="Symbol">:</a> <a id="12081" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="12083" class="Symbol">→</a> <a id="12085" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12087" href="Varieties.FreeAlgebras.html#12060" class="Bound">𝑨</a> <a id="12089" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="12090" class="Symbol">}</a> <a id="12092" class="Symbol">→</a> <a id="12094" href="Varieties.FreeAlgebras.html#12060" class="Bound">𝑨</a> <a id="12096" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12098" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="12099" class="Symbol">{</a><a id="12100" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12101" class="Symbol">}{</a><a id="12103" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12104" class="Symbol">}</a> <a id="12106" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="12110" class="Symbol">→</a>           <a id="12122" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="12129" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12131" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="12136" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12138" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="12140" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="12147" class="Symbol">(</a><a id="12148" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12158" href="Varieties.FreeAlgebras.html#12060" class="Bound">𝑨</a> <a id="12160" href="Varieties.FreeAlgebras.html#12077" class="Bound">h</a><a id="12161" class="Symbol">)</a>

 <a id="12165" href="Varieties.FreeAlgebras.html#12046" class="Function">ψlemma0-ap</a> <a id="12176" class="Symbol">{</a><a id="12177" href="Varieties.FreeAlgebras.html#12177" class="Bound">𝑨</a><a id="12178" class="Symbol">}{</a><a id="12180" href="Varieties.FreeAlgebras.html#12180" class="Bound">h</a><a id="12181" class="Symbol">}</a> <a id="12183" href="Varieties.FreeAlgebras.html#12183" class="Bound">skA</a> <a id="12187" class="Symbol">{</a><a id="12188" href="Varieties.FreeAlgebras.html#12188" class="Bound">p</a> <a id="12190" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12192" href="Varieties.FreeAlgebras.html#12192" class="Bound">q</a><a id="12193" class="Symbol">}</a> <a id="12195" href="Varieties.FreeAlgebras.html#12195" class="Bound">x</a> <a id="12197" class="Symbol">=</a> <a id="12199" href="Varieties.FreeAlgebras.html#12342" class="Function">γ</a> <a id="12201" class="Keyword">where</a>

  <a id="12210" href="Varieties.FreeAlgebras.html#12210" class="Function">ν</a> <a id="12212" class="Symbol">:</a> <a id="12214" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12216" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="12221" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12223" href="Varieties.FreeAlgebras.html#12188" class="Bound">p</a> <a id="12225" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12227" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12229" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="12234" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12236" href="Varieties.FreeAlgebras.html#12192" class="Bound">q</a>
  <a id="12240" href="Varieties.FreeAlgebras.html#12210" class="Function">ν</a> <a id="12242" class="Symbol">=</a> <a id="12244" href="Homomorphisms.Basic.html#10089" class="Function">ker-in-con</a> <a id="12255" class="Symbol">{</a><a id="12256" class="Argument">α</a> <a id="12258" class="Symbol">=</a> <a id="12260" class="Symbol">(</a><a id="12261" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="12264" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12265" class="Symbol">)}{</a><a id="12268" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="12271" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12272" class="Symbol">}{</a><a id="12274" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="12276" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="12277" class="Symbol">}{</a><a id="12279" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12282" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12284" class="Symbol">(</a><a id="12285" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="12290" class="Symbol">(</a><a id="12291" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="12294" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12295" class="Symbol">))}(</a><a id="12299" href="Homomorphisms.Basic.html#7714" class="Function">kercon</a> <a id="12306" class="Symbol">(</a><a id="12307" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12310" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12312" class="Symbol">(</a><a id="12313" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="12316" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12317" class="Symbol">))</a> <a id="12320" class="Symbol">{</a><a id="12321" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="12322" class="Symbol">}</a> <a id="12324" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a><a id="12328" class="Symbol">)</a> <a id="12330" class="Symbol">{</a><a id="12331" href="Varieties.FreeAlgebras.html#12188" class="Bound">p</a><a id="12332" class="Symbol">}{</a><a id="12334" href="Varieties.FreeAlgebras.html#12192" class="Bound">q</a><a id="12335" class="Symbol">}</a> <a id="12337" href="Varieties.FreeAlgebras.html#12195" class="Bound">x</a>

  <a id="12342" href="Varieties.FreeAlgebras.html#12342" class="Function">γ</a> <a id="12344" class="Symbol">:</a> <a id="12346" class="Symbol">(</a><a id="12347" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12357" href="Varieties.FreeAlgebras.html#12177" class="Bound">𝑨</a> <a id="12359" href="Varieties.FreeAlgebras.html#12180" class="Bound">h</a><a id="12360" class="Symbol">)</a> <a id="12362" href="Varieties.FreeAlgebras.html#12188" class="Bound">p</a> <a id="12364" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12366" class="Symbol">(</a><a id="12367" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="12377" href="Varieties.FreeAlgebras.html#12177" class="Bound">𝑨</a> <a id="12379" href="Varieties.FreeAlgebras.html#12180" class="Bound">h</a><a id="12380" class="Symbol">)</a> <a id="12382" href="Varieties.FreeAlgebras.html#12192" class="Bound">q</a>
  <a id="12386" href="Varieties.FreeAlgebras.html#12342" class="Function">γ</a> <a id="12388" class="Symbol">=</a> <a id="12390" class="Symbol">((</a><a id="12392" href="Varieties.FreeAlgebras.html#11926" class="Function">ψlemma0</a> <a id="12400" href="Varieties.FreeAlgebras.html#12188" class="Bound">p</a> <a id="12402" href="Varieties.FreeAlgebras.html#12192" class="Bound">q</a><a id="12403" class="Symbol">)</a> <a id="12405" href="Varieties.FreeAlgebras.html#12210" class="Function">ν</a><a id="12406" class="Symbol">)</a> <a id="12408" href="Varieties.FreeAlgebras.html#12177" class="Bound">𝑨</a> <a id="12410" href="Varieties.FreeAlgebras.html#12183" class="Bound">skA</a> <a id="12414" href="Varieties.FreeAlgebras.html#12180" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12595" href="Varieties.FreeAlgebras.html#12595" class="Function">𝔽-lift-hom</a> <a id="12606" class="Symbol">:</a> <a id="12608" class="Symbol">(</a><a id="12609" href="Varieties.FreeAlgebras.html#12609" class="Bound">𝑨</a> <a id="12611" class="Symbol">:</a> <a id="12613" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="12621" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="12623" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="12624" class="Symbol">)</a> <a id="12626" class="Symbol">→</a> <a id="12628" href="Varieties.FreeAlgebras.html#12609" class="Bound">𝑨</a> <a id="12630" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12632" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="12633" class="Symbol">{</a><a id="12634" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12635" class="Symbol">}{</a><a id="12637" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12638" class="Symbol">}</a> <a id="12640" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="12642" class="Symbol">→</a> <a id="12644" class="Symbol">(</a><a id="12645" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="12647" class="Symbol">→</a> <a id="12649" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="12651" href="Varieties.FreeAlgebras.html#12609" class="Bound">𝑨</a> <a id="12653" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="12654" class="Symbol">)</a> <a id="12656" class="Symbol">→</a> <a id="12658" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="12662" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="12664" href="Varieties.FreeAlgebras.html#12609" class="Bound">𝑨</a>
 <a id="12667" href="Varieties.FreeAlgebras.html#12595" class="Function">𝔽-lift-hom</a> <a id="12678" href="Varieties.FreeAlgebras.html#12678" class="Bound">𝑨</a> <a id="12680" href="Varieties.FreeAlgebras.html#12680" class="Bound">skA</a> <a id="12684" href="Varieties.FreeAlgebras.html#12684" class="Bound">h</a> <a id="12686" class="Symbol">=</a> <a id="12688" href="Varieties.FreeAlgebras.html#1361" class="Field">fst</a><a id="12691" class="Symbol">(</a><a id="12692" href="Homomorphisms.Noether.html#8601" class="Function">HomFactor</a> <a id="12702" class="Symbol">(</a><a id="12703" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="12706" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="12708" class="Symbol">(</a><a id="12709" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="12714" class="Symbol">(</a><a id="12715" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="12718" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="12719" class="Symbol">)))</a>  <a id="12724" href="Varieties.FreeAlgebras.html#12678" class="Bound">𝑨</a> <a id="12726" class="Symbol">(</a><a id="12727" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="12736" href="Varieties.FreeAlgebras.html#12678" class="Bound">𝑨</a> <a id="12738" href="Varieties.FreeAlgebras.html#12684" class="Bound">h</a><a id="12739" class="Symbol">)</a> <a id="12741" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="12746" class="Symbol">(</a><a id="12747" href="Varieties.FreeAlgebras.html#12046" class="Function">ψlemma0-ap</a> <a id="12758" href="Varieties.FreeAlgebras.html#12680" class="Bound">skA</a><a id="12761" class="Symbol">)</a> <a id="12763" href="Varieties.FreeAlgebras.html#11764" class="Function">hom𝔽-is-epic</a><a id="12775" class="Symbol">)</a>

</pre>


### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="13159" class="Keyword">open</a> <a id="13164" href="Algebras.Congruences.html#1800" class="Module">IsCongruence</a>

 <a id="13179" href="Varieties.FreeAlgebras.html#13179" class="Function">X↪𝔽</a> <a id="13183" class="Symbol">:</a> <a id="13185" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="13187" class="Symbol">→</a> <a id="13189" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13191" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="13193" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
 <a id="13196" href="Varieties.FreeAlgebras.html#13179" class="Function">X↪𝔽</a> <a id="13200" href="Varieties.FreeAlgebras.html#13200" class="Bound">x</a> <a id="13202" class="Symbol">=</a> <a id="13204" href="Relations.Quotients.html#5374" class="Function Operator">⟪</a> <a id="13206" href="Terms.Basic.html#2028" class="InductiveConstructor">ℊ</a> <a id="13208" href="Varieties.FreeAlgebras.html#13200" class="Bound">x</a> <a id="13210" href="Relations.Quotients.html#5374" class="Function Operator">⟫</a> <a id="13212" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13278" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13280" class="Symbol">:</a> <a id="13282" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="13286" class="Symbol">(</a><a id="13287" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="13289" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="13290" class="Symbol">)</a> <a id="13292" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a>
 <a id="13295" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13297" class="Symbol">=</a> <a id="13299" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="13308" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="13310" href="Varieties.FreeAlgebras.html#13179" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13413" class="Keyword">open</a> <a id="13418" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13432" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a> <a id="13449" class="Symbol">:</a> <a id="13451" class="Symbol">∀</a> <a id="13453" href="Varieties.FreeAlgebras.html#13453" class="Bound">p</a> <a id="13455" class="Symbol">→</a> <a id="13457" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13459" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13461" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13463" href="Varieties.FreeAlgebras.html#13453" class="Bound">p</a> <a id="13465" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13467" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13469" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="13474" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13476" href="Varieties.FreeAlgebras.html#13453" class="Bound">p</a>
 <a id="13479" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a> <a id="13496" class="Symbol">(</a><a id="13497" href="Terms.Basic.html#2028" class="InductiveConstructor">ℊ</a> <a id="13499" href="Varieties.FreeAlgebras.html#13499" class="Bound">x</a><a id="13500" class="Symbol">)</a> <a id="13502" class="Symbol">=</a> <a id="13504" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13510" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a> <a id="13527" class="Symbol">(</a><a id="13528" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13533" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13535" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a><a id="13536" class="Symbol">)</a> <a id="13538" class="Symbol">=</a>
  <a id="13542" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13544" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13546" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13548" class="Symbol">(</a><a id="13549" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13554" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13556" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a><a id="13557" class="Symbol">)</a>              <a id="13572" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13575" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13577" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13579" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13581" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13583" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13585" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13589" class="Symbol">(</a><a id="13590" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13592" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13594" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a><a id="13595" class="Symbol">)(λ</a> <a id="13599" href="Varieties.FreeAlgebras.html#13599" class="Bound">i</a> <a id="13601" class="Symbol">→</a> <a id="13603" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13605" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13607" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="13608" class="Symbol">(</a><a id="13609" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13611" href="Varieties.FreeAlgebras.html#13599" class="Bound">i</a><a id="13612" class="Symbol">))</a>     <a id="13619" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13622" href="Varieties.FreeAlgebras.html#13730" class="Function">wd-proof</a> <a id="13631" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13635" class="Symbol">(</a><a id="13636" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13638" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13640" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a><a id="13641" class="Symbol">)(λ</a> <a id="13645" href="Varieties.FreeAlgebras.html#13645" class="Bound">i</a> <a id="13647" class="Symbol">→</a> <a id="13649" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13651" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="13656" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13658" class="Symbol">(</a><a id="13659" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13661" href="Varieties.FreeAlgebras.html#13645" class="Bound">i</a><a id="13662" class="Symbol">))</a> <a id="13665" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13668" class="Symbol">(</a><a id="13669" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13671" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="13676" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="13678" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13680" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a><a id="13681" class="Symbol">)</a><a id="13682" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="13685" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13689" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13691" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="13696" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13698" class="Symbol">(</a><a id="13699" href="Terms.Basic.html#2070" class="InductiveConstructor">node</a> <a id="13704" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13706" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a><a id="13707" class="Symbol">)</a>           <a id="13719" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13724" class="Keyword">where</a> <a id="13730" href="Varieties.FreeAlgebras.html#13730" class="Function">wd-proof</a> <a id="13739" class="Symbol">=</a> <a id="13741" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="13744" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="13746" class="Symbol">(</a><a id="13747" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="13752" class="Symbol">(</a><a id="13753" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="13756" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="13757" class="Symbol">))</a>
                    <a id="13780" class="Symbol">(</a><a id="13781" href="Varieties.FreeAlgebras.html#13533" class="Bound">𝑓</a> <a id="13783" href="Algebras.Basic.html#9410" class="Function Operator">̂</a> <a id="13785" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a><a id="13786" class="Symbol">)</a> <a id="13788" class="Symbol">(λ</a> <a id="13791" href="Varieties.FreeAlgebras.html#13791" class="Bound">i</a> <a id="13793" class="Symbol">→</a> <a id="13795" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13797" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="13799" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="13800" class="Symbol">(</a><a id="13801" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13803" href="Varieties.FreeAlgebras.html#13791" class="Bound">i</a><a id="13804" class="Symbol">))</a> <a id="13807" class="Symbol">(λ</a> <a id="13810" href="Varieties.FreeAlgebras.html#13810" class="Bound">i</a> <a id="13812" class="Symbol">→</a> <a id="13814" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13816" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="13821" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="13823" class="Symbol">(</a><a id="13824" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13826" href="Varieties.FreeAlgebras.html#13810" class="Bound">i</a><a id="13827" class="Symbol">))</a>
                    <a id="13850" class="Symbol">(λ</a> <a id="13853" href="Varieties.FreeAlgebras.html#13853" class="Bound">x</a> <a id="13855" class="Symbol">→</a> <a id="13857" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a><a id="13873" class="Symbol">(</a><a id="13874" href="Varieties.FreeAlgebras.html#13535" class="Bound">𝒕</a> <a id="13876" href="Varieties.FreeAlgebras.html#13853" class="Bound">x</a><a id="13877" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="13981" href="Varieties.FreeAlgebras.html#13981" class="Function">ψlemma1</a> <a id="13989" class="Symbol">:</a> <a id="13991" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="13998" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14000" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="14002" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14004" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14006" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="14008" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="14011" href="Varieties.FreeAlgebras.html#13981" class="Function">ψlemma1</a> <a id="14019" class="Symbol">{</a><a id="14020" href="Varieties.FreeAlgebras.html#14020" class="Bound">p</a> <a id="14022" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14024" href="Varieties.FreeAlgebras.html#14024" class="Bound">q</a><a id="14025" class="Symbol">}</a> <a id="14027" href="Varieties.FreeAlgebras.html#14027" class="Bound">𝔑pq</a> <a id="14031" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a> <a id="14033" href="Varieties.FreeAlgebras.html#14033" class="Bound">sA</a> <a id="14036" href="Varieties.FreeAlgebras.html#14036" class="Bound">h</a> <a id="14038" class="Symbol">=</a> <a id="14040" href="Varieties.FreeAlgebras.html#14261" class="Function">γ</a>
  <a id="14044" class="Keyword">where</a>
   <a id="14053" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14055" class="Symbol">:</a> <a id="14057" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="14061" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="14063" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a>
   <a id="14068" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14070" class="Symbol">=</a> <a id="14072" href="Varieties.FreeAlgebras.html#12595" class="Function">𝔽-lift-hom</a> <a id="14083" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a> <a id="14085" href="Varieties.FreeAlgebras.html#14033" class="Bound">sA</a> <a id="14088" href="Varieties.FreeAlgebras.html#14036" class="Bound">h</a>

   <a id="14094" href="Varieties.FreeAlgebras.html#14094" class="Function">h&#39;</a> <a id="14097" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14099" class="Symbol">:</a> <a id="14101" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="14105" class="Symbol">(</a><a id="14106" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="14108" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14109" class="Symbol">)</a> <a id="14111" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a>
   <a id="14116" href="Varieties.FreeAlgebras.html#14094" class="Function">h&#39;</a> <a id="14119" class="Symbol">=</a> <a id="14121" href="Homomorphisms.Basic.html#3531" class="Function">∘-hom</a> <a id="14127" class="Symbol">(</a><a id="14128" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="14130" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14131" class="Symbol">)</a> <a id="14133" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a> <a id="14135" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="14137" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a>
   <a id="14142" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14144" class="Symbol">=</a> <a id="14146" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="14155" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a> <a id="14157" href="Varieties.FreeAlgebras.html#14036" class="Bound">h</a>

   <a id="14163" href="Varieties.FreeAlgebras.html#14163" class="Function">h≡φ</a> <a id="14167" class="Symbol">:</a> <a id="14169" class="Symbol">∀</a> <a id="14171" href="Varieties.FreeAlgebras.html#14171" class="Bound">t</a> <a id="14173" class="Symbol">→</a> <a id="14175" class="Symbol">(</a><a id="14176" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14178" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14180" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14182" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14184" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14186" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="14188" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="14189" class="Symbol">)</a> <a id="14191" href="Varieties.FreeAlgebras.html#14171" class="Bound">t</a> <a id="14193" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14195" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14197" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14199" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14201" href="Varieties.FreeAlgebras.html#14171" class="Bound">t</a>
   <a id="14206" href="Varieties.FreeAlgebras.html#14163" class="Function">h≡φ</a> <a id="14210" href="Varieties.FreeAlgebras.html#14210" class="Bound">t</a> <a id="14212" class="Symbol">=</a> <a id="14214" href="Terms.Properties.html#3576" class="Function">free-unique</a> <a id="14226" class="Symbol">(</a><a id="14227" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14230" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14232" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14233" class="Symbol">)</a> <a id="14235" href="Varieties.FreeAlgebras.html#14031" class="Bound">𝑨</a> <a id="14237" href="Varieties.FreeAlgebras.html#14094" class="Function">h&#39;</a> <a id="14240" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14242" class="Symbol">(λ</a> <a id="14245" href="Varieties.FreeAlgebras.html#14245" class="Bound">x</a> <a id="14247" class="Symbol">→</a> <a id="14249" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14253" class="Symbol">)</a> <a id="14255" href="Varieties.FreeAlgebras.html#14210" class="Bound">t</a>

   <a id="14261" href="Varieties.FreeAlgebras.html#14261" class="Function">γ</a> <a id="14263" class="Symbol">:</a> <a id="14265" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14267" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14269" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14271" href="Varieties.FreeAlgebras.html#14020" class="Bound">p</a> <a id="14273" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14275" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14277" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14279" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14281" href="Varieties.FreeAlgebras.html#14024" class="Bound">q</a>
   <a id="14286" href="Varieties.FreeAlgebras.html#14261" class="Function">γ</a> <a id="14288" class="Symbol">=</a> <a id="14290" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14292" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14294" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14296" href="Varieties.FreeAlgebras.html#14020" class="Bound">p</a>             <a id="14310" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14313" class="Symbol">(</a><a id="14314" href="Varieties.FreeAlgebras.html#14163" class="Function">h≡φ</a> <a id="14318" href="Varieties.FreeAlgebras.html#14020" class="Bound">p</a><a id="14319" class="Symbol">)</a><a id="14320" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="14323" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14332" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14334" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14336" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14338" class="Symbol">(</a> <a id="14340" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14342" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="14344" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14346" href="Varieties.FreeAlgebras.html#14020" class="Bound">p</a> <a id="14348" class="Symbol">)</a>   <a id="14352" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14355" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14360" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14362" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14364" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14366" href="Varieties.FreeAlgebras.html#14027" class="Bound">𝔑pq</a> <a id="14370" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14379" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14381" href="Varieties.FreeAlgebras.html#14053" class="Function">f</a> <a id="14383" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14385" class="Symbol">(</a> <a id="14387" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14389" href="Varieties.FreeAlgebras.html#13278" class="Function">𝔑</a> <a id="14391" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14393" href="Varieties.FreeAlgebras.html#14024" class="Bound">q</a> <a id="14395" class="Symbol">)</a>   <a id="14399" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14402" href="Varieties.FreeAlgebras.html#14163" class="Function">h≡φ</a> <a id="14406" href="Varieties.FreeAlgebras.html#14024" class="Bound">q</a> <a id="14408" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14417" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14419" href="Varieties.FreeAlgebras.html#14097" class="Function">φ</a> <a id="14421" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14423" href="Varieties.FreeAlgebras.html#14024" class="Bound">q</a>             <a id="14437" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14442" href="Varieties.FreeAlgebras.html#14442" class="Function">ψlemma2</a> <a id="14450" class="Symbol">:</a> <a id="14452" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="14459" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14461" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="14466" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="14468" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14470" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a> <a id="14472" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
 <a id="14475" href="Varieties.FreeAlgebras.html#14442" class="Function">ψlemma2</a> <a id="14483" class="Symbol">{</a><a id="14484" href="Varieties.FreeAlgebras.html#14484" class="Bound">p</a> <a id="14486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14488" href="Varieties.FreeAlgebras.html#14488" class="Bound">q</a><a id="14489" class="Symbol">}</a> <a id="14491" href="Varieties.FreeAlgebras.html#14491" class="Bound">x</a> <a id="14493" class="Symbol">=</a> <a id="14495" href="Varieties.FreeAlgebras.html#13981" class="Function">ψlemma1</a> <a id="14503" class="Symbol">{</a><a id="14504" href="Varieties.FreeAlgebras.html#14484" class="Bound">p</a> <a id="14506" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14508" href="Varieties.FreeAlgebras.html#14488" class="Bound">q</a><a id="14509" class="Symbol">}</a> <a id="14511" href="Varieties.FreeAlgebras.html#14526" class="Function">γ</a>
   <a id="14516" class="Keyword">where</a>
    <a id="14526" href="Varieties.FreeAlgebras.html#14526" class="Function">γ</a> <a id="14528" class="Symbol">:</a> <a id="14530" class="Symbol">(</a><a id="14531" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14541" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="14543" href="Varieties.FreeAlgebras.html#13179" class="Function">X↪𝔽</a><a id="14546" class="Symbol">)</a> <a id="14548" href="Varieties.FreeAlgebras.html#14484" class="Bound">p</a> <a id="14550" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14552" class="Symbol">(</a><a id="14553" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14563" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="14565" href="Varieties.FreeAlgebras.html#13179" class="Function">X↪𝔽</a><a id="14568" class="Symbol">)</a> <a id="14570" href="Varieties.FreeAlgebras.html#14488" class="Bound">q</a>
    <a id="14576" href="Varieties.FreeAlgebras.html#14526" class="Function">γ</a> <a id="14578" class="Symbol">=</a> <a id="14580" class="Symbol">(</a><a id="14581" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a> <a id="14598" href="Varieties.FreeAlgebras.html#14484" class="Bound">p</a><a id="14599" class="Symbol">)</a> <a id="14601" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="14603" href="Varieties.FreeAlgebras.html#14491" class="Bound">x</a> <a id="14605" href="Overture.Preliminaries.html#5554" class="Function Operator">∙</a> <a id="14607" class="Symbol">(</a><a id="14608" href="Varieties.FreeAlgebras.html#13432" class="Function">hom𝔽-is-lift-hom</a> <a id="14625" href="Varieties.FreeAlgebras.html#14488" class="Bound">q</a><a id="14626" class="Symbol">)</a><a id="14627" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>


 <a id="14633" href="Varieties.FreeAlgebras.html#14633" class="Function">ψlemma3</a> <a id="14641" class="Symbol">:</a> <a id="14643" class="Symbol">∀</a> <a id="14645" href="Varieties.FreeAlgebras.html#14645" class="Bound">p</a> <a id="14647" href="Varieties.FreeAlgebras.html#14647" class="Bound">q</a> <a id="14649" class="Symbol">→</a> <a id="14651" class="Symbol">(</a><a id="14652" href="Varieties.FreeAlgebras.html#14645" class="Bound">p</a> <a id="14654" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14656" href="Varieties.FreeAlgebras.html#14647" class="Bound">q</a><a id="14657" class="Symbol">)</a> <a id="14659" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14661" href="Varieties.FreeAlgebras.html#6346" class="Function">ψ</a><a id="14662" class="Symbol">{</a><a id="14663" class="Argument">X</a> <a id="14665" class="Symbol">=</a> <a id="14667" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="14668" class="Symbol">}</a> <a id="14670" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="14672" class="Symbol">→</a> <a id="14674" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="14676" href="Varieties.EquationalLogic.html#2683" class="Function Operator">⊫</a> <a id="14678" href="Varieties.FreeAlgebras.html#14645" class="Bound">p</a> <a id="14680" href="Varieties.EquationalLogic.html#2683" class="Function Operator">≈</a> <a id="14682" href="Varieties.FreeAlgebras.html#14647" class="Bound">q</a>
 <a id="14685" href="Varieties.FreeAlgebras.html#14633" class="Function">ψlemma3</a> <a id="14693" href="Varieties.FreeAlgebras.html#14693" class="Bound">p</a> <a id="14695" href="Varieties.FreeAlgebras.html#14695" class="Bound">q</a> <a id="14697" href="Varieties.FreeAlgebras.html#14697" class="Bound">pψq</a> <a id="14701" class="Symbol">{</a><a id="14702" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a><a id="14703" class="Symbol">}</a> <a id="14705" href="Varieties.FreeAlgebras.html#14705" class="Bound">kA</a> <a id="14708" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a> <a id="14710" class="Symbol">=</a> <a id="14712" href="Varieties.FreeAlgebras.html#14729" class="Function">goal</a>
   <a id="14720" class="Keyword">where</a>
   <a id="14729" href="Varieties.FreeAlgebras.html#14729" class="Function">goal</a> <a id="14734" class="Symbol">:</a> <a id="14736" class="Symbol">(</a><a id="14737" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14739" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14741" href="Varieties.FreeAlgebras.html#14693" class="Bound">p</a> <a id="14743" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14744" class="Symbol">)</a> <a id="14746" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a> <a id="14748" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14750" class="Symbol">(</a><a id="14751" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14753" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14755" href="Varieties.FreeAlgebras.html#14695" class="Bound">q</a> <a id="14757" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14758" class="Symbol">)</a> <a id="14760" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a>
   <a id="14765" href="Varieties.FreeAlgebras.html#14729" class="Function">goal</a> <a id="14770" class="Symbol">=</a> <a id="14772" class="Symbol">(</a><a id="14773" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14775" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14777" href="Varieties.FreeAlgebras.html#14693" class="Bound">p</a> <a id="14779" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14780" class="Symbol">)</a> <a id="14782" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a>       <a id="14790" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14793" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="14810" class="Symbol">(</a><a id="14811" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14814" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14816" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14817" class="Symbol">)</a> <a id="14819" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14821" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a> <a id="14823" href="Varieties.FreeAlgebras.html#14693" class="Bound">p</a> <a id="14825" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14837" class="Symbol">(</a><a id="14838" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14848" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14850" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a><a id="14851" class="Symbol">)</a> <a id="14853" href="Varieties.FreeAlgebras.html#14693" class="Bound">p</a> <a id="14855" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14858" href="Varieties.FreeAlgebras.html#14697" class="Bound">pψq</a> <a id="14862" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14864" class="Symbol">(</a><a id="14865" href="Varieties.Closure.html#4055" class="InductiveConstructor">siso</a> <a id="14870" class="Symbol">(</a><a id="14871" href="Varieties.Closure.html#3857" class="InductiveConstructor">sbase</a> <a id="14877" href="Varieties.FreeAlgebras.html#14705" class="Bound">kA</a><a id="14879" class="Symbol">)</a> <a id="14881" class="Symbol">(</a><a id="14882" href="Homomorphisms.Isomorphisms.html#2906" class="Function">≅-sym</a> <a id="14888" href="Homomorphisms.Isomorphisms.html#4349" class="Function">Lift-≅</a><a id="14894" class="Symbol">))</a> <a id="14897" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a> <a id="14899" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14911" class="Symbol">(</a><a id="14912" href="Terms.Properties.html#2470" class="Function">free-lift</a> <a id="14922" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14924" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a><a id="14925" class="Symbol">)</a> <a id="14927" href="Varieties.FreeAlgebras.html#14695" class="Bound">q</a> <a id="14929" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14932" class="Symbol">(</a><a id="14933" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="14950" class="Symbol">(</a><a id="14951" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="14954" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="14956" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="14957" class="Symbol">)</a> <a id="14959" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14961" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a> <a id="14963" href="Varieties.FreeAlgebras.html#14695" class="Bound">q</a><a id="14964" class="Symbol">)</a><a id="14965" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a>  <a id="14969" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14981" class="Symbol">(</a><a id="14982" href="Varieties.FreeAlgebras.html#14702" class="Bound">𝑨</a> <a id="14984" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="14986" href="Varieties.FreeAlgebras.html#14695" class="Bound">q</a> <a id="14988" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="14989" class="Symbol">)</a> <a id="14991" href="Varieties.FreeAlgebras.html#14708" class="Bound">h</a>       <a id="14999" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="15122" href="Varieties.FreeAlgebras.html#15122" class="Function">class-models-kernel</a> <a id="15142" class="Symbol">:</a> <a id="15144" class="Symbol">∀</a> <a id="15146" href="Varieties.FreeAlgebras.html#15146" class="Bound">p</a> <a id="15148" href="Varieties.FreeAlgebras.html#15148" class="Bound">q</a> <a id="15150" class="Symbol">→</a> <a id="15152" class="Symbol">(</a><a id="15153" href="Varieties.FreeAlgebras.html#15146" class="Bound">p</a> <a id="15155" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15157" href="Varieties.FreeAlgebras.html#15148" class="Bound">q</a><a id="15158" class="Symbol">)</a> <a id="15160" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15162" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15169" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15171" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="15176" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15178" class="Symbol">→</a> <a id="15180" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="15182" href="Varieties.EquationalLogic.html#2683" class="Function Operator">⊫</a> <a id="15184" href="Varieties.FreeAlgebras.html#15146" class="Bound">p</a> <a id="15186" href="Varieties.EquationalLogic.html#2683" class="Function Operator">≈</a> <a id="15188" href="Varieties.FreeAlgebras.html#15148" class="Bound">q</a>
 <a id="15191" href="Varieties.FreeAlgebras.html#15122" class="Function">class-models-kernel</a> <a id="15211" href="Varieties.FreeAlgebras.html#15211" class="Bound">p</a> <a id="15213" href="Varieties.FreeAlgebras.html#15213" class="Bound">q</a> <a id="15215" href="Varieties.FreeAlgebras.html#15215" class="Bound">x</a> <a id="15217" class="Symbol">=</a> <a id="15219" href="Varieties.FreeAlgebras.html#14633" class="Function">ψlemma3</a> <a id="15227" href="Varieties.FreeAlgebras.html#15211" class="Bound">p</a> <a id="15229" href="Varieties.FreeAlgebras.html#15213" class="Bound">q</a> <a id="15231" class="Symbol">(</a><a id="15232" href="Varieties.FreeAlgebras.html#14442" class="Function">ψlemma2</a> <a id="15240" href="Varieties.FreeAlgebras.html#15215" class="Bound">x</a><a id="15241" class="Symbol">)</a>

 <a id="15245" href="Varieties.FreeAlgebras.html#15245" class="Function">𝕍𝒦</a> <a id="15248" class="Symbol">:</a> <a id="15250" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15255" class="Symbol">(</a><a id="15256" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15264" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15267" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="15268" class="Symbol">)</a> <a id="15270" class="Symbol">(</a><a id="15271" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="15276" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="15278" class="Symbol">)</a>
 <a id="15281" href="Varieties.FreeAlgebras.html#15245" class="Function">𝕍𝒦</a> <a id="15284" class="Symbol">=</a> <a id="15286" href="Varieties.Closure.html#5309" class="Datatype">V</a><a id="15287" class="Symbol">{</a><a id="15288" class="Argument">α</a> <a id="15290" class="Symbol">=</a> <a id="15292" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="15293" class="Symbol">}{</a><a id="15295" class="Argument">β</a> <a id="15297" class="Symbol">=</a> <a id="15299" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="15301" class="Symbol">}</a> <a id="15303" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>

 <a id="15307" href="Varieties.FreeAlgebras.html#15307" class="Function">kernel-in-theory&#39;</a> <a id="15325" class="Symbol">:</a> <a id="15327" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15334" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15336" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="15341" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15343" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15345" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15348" class="Symbol">(</a><a id="15349" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="15351" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="15352" class="Symbol">)</a>
 <a id="15355" href="Varieties.FreeAlgebras.html#15307" class="Function">kernel-in-theory&#39;</a> <a id="15373" class="Symbol">{</a><a id="15374" href="Varieties.FreeAlgebras.html#15374" class="Bound">p</a> <a id="15376" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15378" href="Varieties.FreeAlgebras.html#15378" class="Bound">q</a><a id="15379" class="Symbol">}</a> <a id="15381" href="Varieties.FreeAlgebras.html#15381" class="Bound">pKq</a> <a id="15385" class="Symbol">=</a> <a id="15387" class="Symbol">(</a><a id="15388" href="Varieties.Preservation.html#20348" class="Function">class-ids-⇒</a> <a id="15400" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="15403" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="15406" href="Varieties.FreeAlgebras.html#15374" class="Bound">p</a> <a id="15408" href="Varieties.FreeAlgebras.html#15378" class="Bound">q</a> <a id="15410" class="Symbol">(</a><a id="15411" href="Varieties.FreeAlgebras.html#15122" class="Function">class-models-kernel</a> <a id="15431" href="Varieties.FreeAlgebras.html#15374" class="Bound">p</a> <a id="15433" href="Varieties.FreeAlgebras.html#15378" class="Bound">q</a> <a id="15435" href="Varieties.FreeAlgebras.html#15381" class="Bound">pKq</a><a id="15438" class="Symbol">))</a>

 <a id="15443" href="Varieties.FreeAlgebras.html#15443" class="Function">kernel-in-theory</a> <a id="15460" class="Symbol">:</a> <a id="15462" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15469" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15471" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="15476" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15478" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15480" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15483" href="Varieties.FreeAlgebras.html#15245" class="Function">𝕍𝒦</a>
 <a id="15487" href="Varieties.FreeAlgebras.html#15443" class="Function">kernel-in-theory</a> <a id="15504" class="Symbol">{</a><a id="15505" href="Varieties.FreeAlgebras.html#15505" class="Bound">p</a> <a id="15507" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15509" href="Varieties.FreeAlgebras.html#15509" class="Bound">q</a><a id="15510" class="Symbol">}</a> <a id="15512" href="Varieties.FreeAlgebras.html#15512" class="Bound">pKq</a> <a id="15516" href="Varieties.FreeAlgebras.html#15516" class="Bound">vkA</a> <a id="15520" href="Varieties.FreeAlgebras.html#15520" class="Bound">x</a> <a id="15522" class="Symbol">=</a> <a id="15524" href="Varieties.Preservation.html#20461" class="Function">class-ids</a> <a id="15534" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="15537" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="15540" href="Varieties.FreeAlgebras.html#15505" class="Bound">p</a> <a id="15542" href="Varieties.FreeAlgebras.html#15509" class="Bound">q</a> <a id="15544" class="Symbol">(</a><a id="15545" href="Varieties.FreeAlgebras.html#15122" class="Function">class-models-kernel</a> <a id="15565" href="Varieties.FreeAlgebras.html#15505" class="Bound">p</a> <a id="15567" href="Varieties.FreeAlgebras.html#15509" class="Bound">q</a> <a id="15569" href="Varieties.FreeAlgebras.html#15512" class="Bound">pKq</a><a id="15572" class="Symbol">)</a> <a id="15574" href="Varieties.FreeAlgebras.html#15516" class="Bound">vkA</a> <a id="15578" href="Varieties.FreeAlgebras.html#15520" class="Bound">x</a>

 <a id="15582" href="Varieties.FreeAlgebras.html#15582" class="Function Operator">_↠_</a> <a id="15586" class="Symbol">:</a> <a id="15588" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="15593" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a> <a id="15595" class="Symbol">→</a> <a id="15597" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15605" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15608" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a> <a id="15610" class="Symbol">→</a> <a id="15612" href="Varieties.FreeAlgebras.html#1275" class="Primitive">Type</a> <a id="15617" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a>
 <a id="15621" href="Varieties.FreeAlgebras.html#15621" class="Bound">X</a> <a id="15623" href="Varieties.FreeAlgebras.html#15582" class="Function Operator">↠</a> <a id="15625" href="Varieties.FreeAlgebras.html#15625" class="Bound">𝑨</a> <a id="15627" class="Symbol">=</a> <a id="15629" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15632" href="Varieties.FreeAlgebras.html#15632" class="Bound">h</a> <a id="15634" href="Data.Product.html#916" class="Function">∈</a> <a id="15636" class="Symbol">(</a><a id="15637" href="Varieties.FreeAlgebras.html#15621" class="Bound">X</a> <a id="15639" class="Symbol">→</a> <a id="15641" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15643" href="Varieties.FreeAlgebras.html#15625" class="Bound">𝑨</a> <a id="15645" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="15646" class="Symbol">)</a> <a id="15648" href="Data.Product.html#916" class="Function">]</a> <a id="15650" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="15663" href="Varieties.FreeAlgebras.html#15632" class="Bound">h</a>

 <a id="15667" href="Varieties.FreeAlgebras.html#15667" class="Function">𝔽-ModTh-epi</a> <a id="15679" class="Symbol">:</a> <a id="15681" class="Symbol">(</a><a id="15682" href="Varieties.FreeAlgebras.html#15682" class="Bound">𝑨</a> <a id="15684" class="Symbol">:</a> <a id="15686" href="Algebras.Basic.html#6228" class="Function">Algebra</a> <a id="15694" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="15697" href="Varieties.FreeAlgebras.html#996" class="Bound">𝑆</a><a id="15698" class="Symbol">)</a> <a id="15700" class="Symbol">→</a> <a id="15702" class="Symbol">(</a><a id="15703" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="15705" href="Varieties.FreeAlgebras.html#15582" class="Function Operator">↠</a> <a id="15707" href="Varieties.FreeAlgebras.html#15682" class="Bound">𝑨</a><a id="15708" class="Symbol">)</a> <a id="15710" class="Symbol">→</a> <a id="15712" href="Varieties.FreeAlgebras.html#15682" class="Bound">𝑨</a> <a id="15714" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15716" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="15720" class="Symbol">(</a><a id="15721" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="15724" href="Varieties.FreeAlgebras.html#15245" class="Function">𝕍𝒦</a><a id="15726" class="Symbol">)</a> <a id="15728" class="Symbol">→</a> <a id="15730" href="Homomorphisms.Basic.html#6038" class="Function">epi</a> <a id="15734" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="15736" href="Varieties.FreeAlgebras.html#15682" class="Bound">𝑨</a>
 <a id="15739" href="Varieties.FreeAlgebras.html#15667" class="Function">𝔽-ModTh-epi</a> <a id="15751" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="15753" class="Symbol">(</a><a id="15754" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a> <a id="15756" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15758" href="Varieties.FreeAlgebras.html#15758" class="Bound">ηE</a><a id="15760" class="Symbol">)</a> <a id="15762" href="Varieties.FreeAlgebras.html#15762" class="Bound">AinMTV</a> <a id="15769" class="Symbol">=</a> <a id="15771" href="Varieties.FreeAlgebras.html#16283" class="Function">goal</a>
  <a id="15778" class="Keyword">where</a>
  <a id="15786" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="15788" class="Symbol">:</a> <a id="15790" href="Homomorphisms.Basic.html#3170" class="Function">hom</a> <a id="15794" class="Symbol">(</a><a id="15795" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="15797" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="15798" class="Symbol">)</a> <a id="15800" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a>
  <a id="15804" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="15806" class="Symbol">=</a> <a id="15808" href="Terms.Properties.html#3177" class="Function">lift-hom</a> <a id="15817" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="15819" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a>

  <a id="15824" href="Varieties.FreeAlgebras.html#15824" class="Function">φE</a> <a id="15827" class="Symbol">:</a> <a id="15829" href="Overture.Inverses.html#3314" class="Function">IsSurjective</a> <a id="15842" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15844" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="15846" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
  <a id="15850" href="Varieties.FreeAlgebras.html#15824" class="Function">φE</a> <a id="15853" class="Symbol">=</a> <a id="15855" href="Terms.Properties.html#4782" class="Function">lift-of-epi-is-epi</a> <a id="15874" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="15876" href="Varieties.FreeAlgebras.html#15758" class="Bound">ηE</a>

  <a id="15882" href="Varieties.FreeAlgebras.html#15882" class="Function">pqlem2</a> <a id="15889" class="Symbol">:</a> <a id="15891" class="Symbol">∀</a> <a id="15893" href="Varieties.FreeAlgebras.html#15893" class="Bound">p</a> <a id="15895" href="Varieties.FreeAlgebras.html#15895" class="Bound">q</a> <a id="15897" class="Symbol">→</a> <a id="15899" class="Symbol">(</a><a id="15900" href="Varieties.FreeAlgebras.html#15893" class="Bound">p</a> <a id="15902" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15904" href="Varieties.FreeAlgebras.html#15895" class="Bound">q</a><a id="15905" class="Symbol">)</a> <a id="15907" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15909" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="15916" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15918" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="15923" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="15925" class="Symbol">→</a> <a id="15927" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="15929" href="Varieties.EquationalLogic.html#2605" class="Function Operator">⊧</a> <a id="15931" href="Varieties.FreeAlgebras.html#15893" class="Bound">p</a> <a id="15933" href="Varieties.EquationalLogic.html#2605" class="Function Operator">≈</a> <a id="15935" href="Varieties.FreeAlgebras.html#15895" class="Bound">q</a>
  <a id="15939" href="Varieties.FreeAlgebras.html#15882" class="Function">pqlem2</a> <a id="15946" href="Varieties.FreeAlgebras.html#15946" class="Bound">p</a> <a id="15948" href="Varieties.FreeAlgebras.html#15948" class="Bound">q</a> <a id="15950" href="Varieties.FreeAlgebras.html#15950" class="Bound">z</a> <a id="15952" class="Symbol">=</a> <a id="15954" class="Symbol">λ</a> <a id="15956" href="Varieties.FreeAlgebras.html#15956" class="Bound">x</a> <a id="15958" class="Symbol">→</a> <a id="15960" href="Varieties.FreeAlgebras.html#15762" class="Bound">AinMTV</a> <a id="15967" href="Varieties.FreeAlgebras.html#15946" class="Bound">p</a> <a id="15969" href="Varieties.FreeAlgebras.html#15948" class="Bound">q</a> <a id="15971" class="Symbol">(</a><a id="15972" href="Varieties.FreeAlgebras.html#15443" class="Function">kernel-in-theory</a> <a id="15989" href="Varieties.FreeAlgebras.html#15950" class="Bound">z</a><a id="15990" class="Symbol">)</a> <a id="15992" href="Varieties.FreeAlgebras.html#15956" class="Bound">x</a>

  <a id="15997" href="Varieties.FreeAlgebras.html#15997" class="Function">kerincl</a> <a id="16005" class="Symbol">:</a> <a id="16007" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="16014" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16016" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="16021" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16023" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="16025" href="Relations.Discrete.html#4042" class="Function">kernel</a> <a id="16032" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16034" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="16036" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a>
  <a id="16040" href="Varieties.FreeAlgebras.html#15997" class="Function">kerincl</a> <a id="16048" class="Symbol">{</a><a id="16049" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a> <a id="16051" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16053" href="Varieties.FreeAlgebras.html#16053" class="Bound">q</a><a id="16054" class="Symbol">}</a> <a id="16056" href="Varieties.FreeAlgebras.html#16056" class="Bound">x</a> <a id="16058" class="Symbol">=</a> <a id="16060" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16062" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="16064" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16066" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a>      <a id="16073" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16076" class="Symbol">(</a><a id="16077" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="16094" class="Symbol">(</a><a id="16095" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16098" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16100" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="16102" class="Symbol">)</a> <a id="16104" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="16106" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a> <a id="16108" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a><a id="16109" class="Symbol">)</a><a id="16110" href="Overture.Preliminaries.html#5228" class="Function Operator">⁻¹</a> <a id="16113" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16137" class="Symbol">(</a><a id="16138" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="16140" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="16142" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a> <a id="16144" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="16145" class="Symbol">)</a> <a id="16147" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a>  <a id="16150" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16153" href="Varieties.FreeAlgebras.html#15882" class="Function">pqlem2</a> <a id="16160" href="Varieties.FreeAlgebras.html#16049" class="Bound">p</a> <a id="16162" href="Varieties.FreeAlgebras.html#16053" class="Bound">q</a> <a id="16164" href="Varieties.FreeAlgebras.html#16056" class="Bound">x</a> <a id="16166" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a> <a id="16168" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16192" class="Symbol">(</a><a id="16193" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="16195" href="Terms.Operations.html#2527" class="Function Operator">⟦</a> <a id="16197" href="Varieties.FreeAlgebras.html#16053" class="Bound">q</a> <a id="16199" href="Terms.Operations.html#2527" class="Function Operator">⟧</a><a id="16200" class="Symbol">)</a> <a id="16202" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a>  <a id="16205" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16208" href="Terms.Operations.html#2838" class="Function">free-lift-interp</a> <a id="16225" class="Symbol">(</a><a id="16226" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16229" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16231" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="16233" class="Symbol">)</a> <a id="16235" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="16237" href="Varieties.FreeAlgebras.html#15754" class="Bound">η</a> <a id="16239" href="Varieties.FreeAlgebras.html#16053" class="Bound">q</a> <a id="16241" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16265" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16267" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="16269" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16271" href="Varieties.FreeAlgebras.html#16053" class="Bound">q</a>      <a id="16278" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16283" href="Varieties.FreeAlgebras.html#16283" class="Function">goal</a> <a id="16288" class="Symbol">:</a> <a id="16290" href="Homomorphisms.Basic.html#6038" class="Function">epi</a> <a id="16294" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="16296" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a>
  <a id="16300" href="Varieties.FreeAlgebras.html#16283" class="Function">goal</a> <a id="16305" class="Symbol">=</a> <a id="16307" href="Varieties.FreeAlgebras.html#1361" class="Field">fst</a> <a id="16311" class="Symbol">(</a><a id="16312" href="Homomorphisms.Noether.html#9875" class="Function">HomFactorEpi</a> <a id="16325" class="Symbol">(</a><a id="16326" href="Varieties.FreeAlgebras.html#10422" class="Bound">wd</a> <a id="16329" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16331" class="Symbol">(</a><a id="16332" href="Varieties.FreeAlgebras.html#886" class="Primitive">lsuc</a> <a id="16337" class="Symbol">(</a><a id="16338" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="16341" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16342" class="Symbol">)))</a> <a id="16346" href="Varieties.FreeAlgebras.html#15751" class="Bound">𝑨</a> <a id="16348" href="Varieties.FreeAlgebras.html#15786" class="Function">φ</a> <a id="16350" href="Varieties.FreeAlgebras.html#11717" class="Function">hom𝔽</a> <a id="16355" href="Varieties.FreeAlgebras.html#15997" class="Function">kerincl</a> <a id="16363" href="Varieties.FreeAlgebras.html#11764" class="Function">hom𝔽-is-epic</a> <a id="16376" href="Varieties.FreeAlgebras.html#15824" class="Function">φE</a><a id="16378" class="Symbol">)</a>

</pre>



### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16737" class="Keyword">module</a> <a id="16744" href="Varieties.FreeAlgebras.html#16744" class="Module">_</a> <a id="16746" class="Symbol">(</a><a id="16747" href="Varieties.FreeAlgebras.html#16747" class="Bound">pe</a> <a id="16750" class="Symbol">:</a> <a id="16752" href="Foundations.Extensionality.html#3279" class="Function">pred-ext</a> <a id="16761" class="Symbol">(</a><a id="16762" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="16765" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16766" class="Symbol">)(</a><a id="16768" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="16771" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16772" class="Symbol">))(</a><a id="16775" href="Varieties.FreeAlgebras.html#16775" class="Bound">wd</a> <a id="16778" class="Symbol">:</a> <a id="16780" href="Foundations.Welldefined.html#2946" class="Function">SwellDef</a><a id="16788" class="Symbol">)</a> <a id="16790" class="Comment">-- extensionality assumptions</a>
          <a id="16830" class="Symbol">(</a><a id="16831" href="Varieties.FreeAlgebras.html#16831" class="Bound">Cset</a> <a id="16836" class="Symbol">:</a> <a id="16838" href="Foundations.Truncation.html#6614" class="Function">is-set</a> <a id="16845" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16847" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="16849" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="16850" class="Symbol">)</a>                       <a id="16874" class="Comment">-- truncation assumptions</a>
          <a id="16910" class="Symbol">(</a><a id="16911" href="Varieties.FreeAlgebras.html#16911" class="Bound">kuip</a> <a id="16916" class="Symbol">:</a> <a id="16918" href="Foundations.Truncation.html#10869" class="Function">blk-uip</a><a id="16925" class="Symbol">(</a><a id="16926" href="Terms.Basic.html#1987" class="Datatype">Term</a> <a id="16931" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="16932" class="Symbol">)</a><a id="16933" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a> <a id="16935" href="Homomorphisms.Basic.html#7714" class="Function">kercon</a> <a id="16942" class="Symbol">(</a><a id="16943" href="Varieties.FreeAlgebras.html#16775" class="Bound">wd</a> <a id="16946" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="16948" class="Symbol">(</a><a id="16949" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="16952" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="16953" class="Symbol">)){</a><a id="16956" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a><a id="16957" class="Symbol">}</a><a id="16958" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="16963" href="Overture.Preliminaries.html#4524" class="Function Operator">∣</a><a id="16964" class="Symbol">)</a>
  <a id="16968" class="Keyword">where</a>

  <a id="16977" href="Varieties.FreeAlgebras.html#16977" class="Function">𝔽≤ℭ</a> <a id="16981" class="Symbol">:</a> <a id="16983" class="Symbol">(</a><a id="16984" href="Homomorphisms.Basic.html#8122" class="Function Operator">ker[</a> <a id="16989" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="16991" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="16993" href="Homomorphisms.Basic.html#8122" class="Function Operator">⇒</a> <a id="16995" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="16997" href="Homomorphisms.Basic.html#8122" class="Function Operator">]</a> <a id="16999" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="17004" href="Homomorphisms.Basic.html#8122" class="Function Operator">↾</a> <a id="17006" class="Symbol">(</a><a id="17007" href="Varieties.FreeAlgebras.html#16775" class="Bound">wd</a> <a id="17010" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="17012" class="Symbol">(</a><a id="17013" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="17016" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="17017" class="Symbol">)))</a> <a id="17021" href="Subalgebras.Subalgebras.html#2553" class="Function Operator">≤</a> <a id="17023" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a>
  <a id="17027" href="Varieties.FreeAlgebras.html#16977" class="Function">𝔽≤ℭ</a> <a id="17031" class="Symbol">=</a> <a id="17033" href="Subalgebras.Subalgebras.html#4384" class="Function">FirstHomCorollary|Set</a> <a id="17055" class="Symbol">(</a><a id="17056" href="Terms.Basic.html#3258" class="Function">𝑻</a> <a id="17058" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="17059" class="Symbol">)</a> <a id="17061" href="Varieties.FreeAlgebras.html#10821" class="Function">ℭ</a> <a id="17063" href="Varieties.FreeAlgebras.html#11008" class="Function">homℭ</a> <a id="17068" href="Varieties.FreeAlgebras.html#16747" class="Bound">pe</a> <a id="17071" class="Symbol">(</a><a id="17072" href="Varieties.FreeAlgebras.html#16775" class="Bound">wd</a> <a id="17075" href="Varieties.FreeAlgebras.html#984" class="Bound">𝓥</a> <a id="17077" class="Symbol">(</a><a id="17078" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="17081" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="17082" class="Symbol">))</a> <a id="17085" href="Varieties.FreeAlgebras.html#16831" class="Bound">Cset</a> <a id="17090" href="Varieties.FreeAlgebras.html#16911" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="18152" href="Varieties.FreeAlgebras.html#18152" class="Function">𝔽∈SP</a> <a id="18157" class="Symbol">:</a> <a id="18159" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18167" class="Symbol">(</a><a id="18168" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18171" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18172" class="Symbol">)(</a><a id="18174" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18177" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18178" class="Symbol">)</a> <a id="18180" class="Symbol">→</a> <a id="18182" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="18184" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18186" class="Symbol">(</a><a id="18187" href="Varieties.Closure.html#3769" class="Datatype">S</a><a id="18188" class="Symbol">{</a><a id="18189" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18190" class="Symbol">}{</a><a id="18192" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="18194" class="Symbol">}</a> <a id="18196" class="Symbol">(</a><a id="18197" href="Varieties.Closure.html#4352" class="Datatype">P</a><a id="18198" class="Symbol">{</a><a id="18199" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18200" class="Symbol">}{</a><a id="18202" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18203" class="Symbol">}</a> <a id="18205" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18206" class="Symbol">))</a>
  <a id="18211" href="Varieties.FreeAlgebras.html#18152" class="Function">𝔽∈SP</a> <a id="18216" href="Varieties.FreeAlgebras.html#18216" class="Bound">hfe</a> <a id="18220" class="Symbol">=</a> <a id="18222" href="Varieties.Closure.html#3977" class="InductiveConstructor">ssub</a> <a id="18227" class="Symbol">(</a><a id="18228" href="Varieties.Preservation.html#12963" class="Function">class-prod-s-∈-sp</a> <a id="18246" href="Varieties.FreeAlgebras.html#18216" class="Bound">hfe</a><a id="18249" class="Symbol">)</a> <a id="18251" href="Varieties.FreeAlgebras.html#16977" class="Function">𝔽≤ℭ</a>

  <a id="18258" href="Varieties.FreeAlgebras.html#18258" class="Function">𝔽∈𝕍</a> <a id="18262" class="Symbol">:</a> <a id="18264" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18272" class="Symbol">(</a><a id="18273" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18276" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18277" class="Symbol">)(</a><a id="18279" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18282" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18283" class="Symbol">)</a> <a id="18285" class="Symbol">→</a> <a id="18287" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="18289" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18291" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18293" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="18297" href="Varieties.FreeAlgebras.html#18258" class="Function">𝔽∈𝕍</a> <a id="18301" href="Varieties.FreeAlgebras.html#18301" class="Bound">hfe</a> <a id="18305" class="Symbol">=</a> <a id="18307" href="Varieties.Preservation.html#9292" class="Function">SP⊆V&#39;</a> <a id="18313" class="Symbol">{</a><a id="18314" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18315" class="Symbol">}{</a><a id="18317" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18320" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="18322" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18323" class="Symbol">}{</a><a id="18325" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18328" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a> <a id="18331" href="Varieties.FreeAlgebras.html#3737" class="Function">𝓕⁺</a><a id="18333" class="Symbol">}{</a><a id="18335" href="Varieties.FreeAlgebras.html#10408" class="Bound">fe</a> <a id="18338" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a> <a id="18340" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="18341" class="Symbol">}{</a><a id="18343" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18344" class="Symbol">}</a> <a id="18346" class="Symbol">(</a><a id="18347" href="Varieties.FreeAlgebras.html#18152" class="Function">𝔽∈SP</a> <a id="18352" href="Varieties.FreeAlgebras.html#18301" class="Bound">hfe</a><a id="18355" class="Symbol">)</a>

</pre>

### The HSP Theorem
Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18691" href="Varieties.FreeAlgebras.html#18691" class="Function">Birkhoff</a> <a id="18700" class="Symbol">:</a> <a id="18702" href="Foundations.Truncation.html#3965" class="Function">hfunext</a> <a id="18710" class="Symbol">(</a><a id="18711" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18714" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18715" class="Symbol">)(</a><a id="18717" href="Algebras.Products.html#2981" class="Function">ov</a> <a id="18720" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="18721" class="Symbol">)</a> <a id="18723" class="Symbol">→</a> <a id="18725" class="Symbol">(∀</a> <a id="18728" href="Varieties.FreeAlgebras.html#18728" class="Bound">𝑨</a> <a id="18730" class="Symbol">→</a> <a id="18732" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a> <a id="18734" href="Varieties.FreeAlgebras.html#15582" class="Function Operator">↠</a> <a id="18736" href="Varieties.FreeAlgebras.html#18728" class="Bound">𝑨</a><a id="18737" class="Symbol">)</a> <a id="18739" class="Symbol">→</a> <a id="18741" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a> <a id="18745" class="Symbol">(</a><a id="18746" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="18749" class="Symbol">(</a><a id="18750" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18752" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="18753" class="Symbol">))</a> <a id="18756" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18758" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="18760" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a>
  <a id="18764" href="Varieties.FreeAlgebras.html#18691" class="Function">Birkhoff</a> <a id="18773" href="Varieties.FreeAlgebras.html#18773" class="Bound">hfe</a> <a id="18777" href="Varieties.FreeAlgebras.html#18777" class="Bound">𝕏</a> <a id="18779" class="Symbol">{</a><a id="18780" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a><a id="18781" class="Symbol">}</a> <a id="18783" href="Varieties.FreeAlgebras.html#18783" class="Bound">α</a> <a id="18785" class="Symbol">=</a> <a id="18787" href="Varieties.Closure.html#5590" class="InductiveConstructor">vhimg</a><a id="18792" class="Symbol">{</a><a id="18793" class="Argument">𝑩</a> <a id="18795" class="Symbol">=</a> <a id="18797" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a><a id="18798" class="Symbol">}</a> <a id="18800" class="Symbol">(</a><a id="18801" href="Varieties.FreeAlgebras.html#18258" class="Function">𝔽∈𝕍</a> <a id="18805" href="Varieties.FreeAlgebras.html#18773" class="Bound">hfe</a><a id="18808" class="Symbol">)</a> <a id="18810" class="Symbol">(</a><a id="18811" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a> <a id="18813" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18815" href="Homomorphisms.Basic.html#6505" class="Function">epi-to-hom</a> <a id="18826" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a> <a id="18828" href="Varieties.FreeAlgebras.html#18857" class="Function">φE</a> <a id="18831" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18833" href="Varieties.FreeAlgebras.html#1376" class="Field">snd</a> <a id="18837" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a> <a id="18839" href="Varieties.FreeAlgebras.html#18857" class="Function">φE</a> <a id="18842" href="Overture.Preliminaries.html#4562" class="Function Operator">∥</a><a id="18843" class="Symbol">)</a>
   <a id="18848" class="Keyword">where</a>
   <a id="18857" href="Varieties.FreeAlgebras.html#18857" class="Function">φE</a> <a id="18860" class="Symbol">:</a> <a id="18862" href="Homomorphisms.Basic.html#6038" class="Function">epi</a> <a id="18866" href="Varieties.FreeAlgebras.html#11600" class="Function">𝔽</a> <a id="18868" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a>
   <a id="18873" href="Varieties.FreeAlgebras.html#18857" class="Function">φE</a> <a id="18876" class="Symbol">=</a> <a id="18878" href="Varieties.FreeAlgebras.html#15667" class="Function">𝔽-ModTh-epi</a> <a id="18890" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a> <a id="18892" class="Symbol">(</a><a id="18893" href="Varieties.FreeAlgebras.html#18777" class="Bound">𝕏</a> <a id="18895" href="Varieties.FreeAlgebras.html#18780" class="Bound">𝑨</a><a id="18896" class="Symbol">)</a> <a id="18898" href="Varieties.FreeAlgebras.html#18783" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="19156" href="Varieties.FreeAlgebras.html#19156" class="Function">Birkhoff-converse</a> <a id="19174" class="Symbol">:</a> <a id="19176" href="Varieties.Closure.html#5309" class="Datatype">V</a><a id="19177" class="Symbol">{</a><a id="19178" href="Varieties.FreeAlgebras.html#980" class="Bound">α</a><a id="19179" class="Symbol">}{</a><a id="19181" href="Varieties.FreeAlgebras.html#3735" class="Function">𝓕</a><a id="19182" class="Symbol">}</a> <a id="19184" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a> <a id="19186" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19188" href="Varieties.EquationalLogic.html#3983" class="Function">Mod</a><a id="19191" class="Symbol">{</a><a id="19192" class="Argument">X</a> <a id="19194" class="Symbol">=</a> <a id="19196" href="Varieties.FreeAlgebras.html#10437" class="Bound">X</a><a id="19197" class="Symbol">}</a> <a id="19199" class="Symbol">(</a><a id="19200" href="Varieties.EquationalLogic.html#3408" class="Function">Th</a> <a id="19203" class="Symbol">(</a><a id="19204" href="Varieties.Closure.html#5309" class="Datatype">V</a> <a id="19206" href="Varieties.FreeAlgebras.html#10450" class="Bound">𝒦</a><a id="19207" class="Symbol">))</a>
  <a id="19212" href="Varieties.FreeAlgebras.html#19156" class="Function">Birkhoff-converse</a> <a id="19230" href="Varieties.FreeAlgebras.html#19230" class="Bound">α</a> <a id="19232" href="Varieties.FreeAlgebras.html#19232" class="Bound">p</a> <a id="19234" href="Varieties.FreeAlgebras.html#19234" class="Bound">q</a> <a id="19236" href="Varieties.FreeAlgebras.html#19236" class="Bound">pThq</a> <a id="19241" class="Symbol">=</a> <a id="19243" href="Varieties.FreeAlgebras.html#19236" class="Bound">pThq</a> <a id="19248" href="Varieties.FreeAlgebras.html#19230" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.





--------------------------------

<span style="float:left;">[← Varieties.Preservation](Varieties.Preservation.html)</span>
<span style="float:right;">[Varieties.Setoid →](Varieties.Setoid.html)</span>

{% include UALib.Links.md %}

[agda-algebras development team]: https://github.com/ualib/agda-algebras#the-agda-algebras-development-team
