---
layout: default
title : "Varieties.FreeAlgebras module (Agda Universal Algebra Library)"
date : "2021-03-01"
author: "the agda-algebras development team"
---

### <a id="free-algebras-and-birkhoffs-theorem">Free Algebras and Birkhoff's Theorem</a>

This is the [Varieties.FreeAlgebras][] module of the [Agda Universal Algebra Library][].

First we will define the relatively free algebra in a variety, which is the "freest" algebra among (universal for) those algebras that model all identities holding in the variety. Then we give a formal proof of Birkhoff's theorem which says that a variety is an equational class. In other terms, a class `𝒦` of algebras is closed under the operators `H`, `S`, and `P` if and only if 𝒦 is the class of algebras that satisfy some set of identities.

<pre class="Agda">

<a id="806" class="Symbol">{-#</a> <a id="810" class="Keyword">OPTIONS</a> <a id="818" class="Pragma">--without-K</a> <a id="830" class="Pragma">--exact-split</a> <a id="844" class="Pragma">--safe</a> <a id="851" class="Symbol">#-}</a>


<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Level.html" class="Module">Level</a> <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a> <a id="886" href="Agda.Primitive.html#780" class="Primitive">suc</a> <a id="890" class="Symbol">to</a> <a id="893" class="Primitive">lsuc</a> <a id="898" class="Symbol">)</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Algebras.Basic.html" class="Module">Algebras.Basic</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a> <a id="935" href="Algebras.Basic.html#1130" class="Generalizable">𝓞</a> <a id="937" class="Symbol">;</a> <a id="939" href="Algebras.Basic.html#1132" class="Generalizable">𝓥</a> <a id="941" class="Symbol">;</a> <a id="943" href="Algebras.Basic.html#3858" class="Function">Signature</a> <a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">module</a> <a id="963" href="Varieties.FreeAlgebras.html" class="Module">Varieties.FreeAlgebras</a> <a id="986" class="Symbol">{</a><a id="987" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="989" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="991" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="1000" class="Symbol">}</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="1005" class="Symbol">:</a> <a id="1007" href="Algebras.Basic.html#3858" class="Function">Signature</a> <a id="1017" href="Varieties.FreeAlgebras.html#989" class="Bound">𝓞</a> <a id="1019" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a><a id="1020" class="Symbol">)</a> <a id="1022" class="Keyword">where</a>

<a id="1029" class="Comment">-- Imports from Agda and the Agda Standard Library ---------------------</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Axiom.Extensionality.Propositional.html" class="Module">Axiom.Extensionality.Propositional</a>
                            <a id="1177" class="Keyword">using</a> <a id="1183" class="Symbol">()</a> <a id="1186" class="Keyword">renaming</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Axiom.Extensionality.Propositional.html#741" class="Function">Extensionality</a> <a id="1211" class="Symbol">to</a> <a id="1214" class="Function">funext</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="Agda.Primitive.html" class="Module">Agda.Primitive</a>  <a id="1250" class="Keyword">using</a> <a id="1256" class="Symbol">(</a> <a id="1258" href="Agda.Primitive.html#810" class="Primitive Operator">_⊔_</a> <a id="1262" class="Symbol">)</a> <a id="1264" class="Keyword">renaming</a> <a id="1273" class="Symbol">(</a> <a id="1275" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1279" class="Symbol">to</a> <a id="1282" class="Primitive">Type</a> <a id="1287" class="Symbol">)</a>
<a id="1289" class="Keyword">open</a> <a id="1294" class="Keyword">import</a> <a id="1301" href="Data.Product.html" class="Module">Data.Product</a>    <a id="1317" class="Keyword">using</a> <a id="1323" class="Symbol">(</a> <a id="1325" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1329" class="Symbol">;</a> <a id="1331" href="Data.Product.html#916" class="Function">Σ-syntax</a> <a id="1340" class="Symbol">;</a> <a id="1342" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="1346" class="Symbol">)</a> <a id="1348" class="Keyword">renaming</a> <a id="1357" class="Symbol">(</a> <a id="1359" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1365" class="Symbol">to</a> <a id="1368" class="Field">fst</a> <a id="1372" class="Symbol">;</a> <a id="1374" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1380" class="Symbol">to</a> <a id="1383" class="Field">snd</a> <a id="1387" class="Symbol">)</a>
<a id="1389" class="Keyword">open</a> <a id="1394" class="Keyword">import</a> <a id="1401" href="Function.Base.html" class="Module">Function.Base</a>   <a id="1417" class="Keyword">using</a> <a id="1423" class="Symbol">(</a> <a id="1425" href="Function.Base.html#1031" class="Function Operator">_∘_</a> <a id="1429" class="Symbol">)</a>
<a id="1431" class="Keyword">open</a> <a id="1436" class="Keyword">import</a> <a id="1443" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="1459" class="Keyword">using</a> <a id="1465" class="Symbol">(</a> <a id="1467" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="1481" class="Symbol">)</a> <a id="1483" class="Keyword">renaming</a> <a id="1492" class="Symbol">(</a> <a id="1494" href="Relation.Binary.Core.html#882" class="Function">Rel</a> <a id="1498" class="Symbol">to</a> <a id="1501" class="Function">BinRel</a> <a id="1508" class="Symbol">)</a>
<a id="1510" class="Keyword">open</a> <a id="1515" class="Keyword">import</a> <a id="1522" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
                            <a id="1588" class="Keyword">using</a> <a id="1594" class="Symbol">(</a> <a id="1596" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="1600" class="Symbol">;</a> <a id="1602" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1607" class="Symbol">;</a> <a id="1609" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="1614" class="Symbol">;</a> <a id="1616" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="1625" class="Symbol">;</a> <a id="1627" class="Keyword">module</a> <a id="1634" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a> <a id="1646" class="Symbol">)</a>
<a id="1648" class="Keyword">open</a> <a id="1653" class="Keyword">import</a> <a id="1660" href="Relation.Unary.html" class="Module">Relation.Unary</a>  <a id="1676" class="Keyword">using</a>    <a id="1685" class="Symbol">(</a> <a id="1687" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="1692" class="Symbol">;</a> <a id="1694" href="Relation.Unary.html#1523" class="Function Operator">_∈_</a> <a id="1698" class="Symbol">;</a> <a id="1700" href="Relation.Unary.html#1742" class="Function Operator">_⊆_</a> <a id="1704" class="Symbol">;</a> <a id="1706" href="Relation.Unary.html#1335" class="Function Operator">｛_｝</a> <a id="1710" class="Symbol">;</a> <a id="1712" href="Relation.Unary.html#4417" class="Function Operator">_∪_</a> <a id="1716" class="Symbol">)</a>

<a id="1719" class="Comment">-- Imports from the Agda Universal Algebra Library -------------------------------------------</a>
<a id="1814" class="Keyword">open</a> <a id="1819" class="Keyword">import</a> <a id="1826" href="Overture.Preliminaries.html" class="Module">Overture.Preliminaries</a>             <a id="1861" class="Keyword">using</a> <a id="1867" class="Symbol">(</a> <a id="1869" href="Overture.Preliminaries.html#4382" class="Function Operator">∣_∣</a> <a id="1873" class="Symbol">;</a> <a id="1875" href="Overture.Preliminaries.html#4420" class="Function Operator">∥_∥</a> <a id="1879" class="Symbol">;</a> <a id="1881" href="Overture.Preliminaries.html#5301" class="Function Operator">_∙_</a> <a id="1885" class="Symbol">;</a> <a id="1887" href="Overture.Preliminaries.html#4975" class="Function Operator">_⁻¹</a> <a id="1891" class="Symbol">)</a>
<a id="1893" class="Keyword">open</a> <a id="1898" class="Keyword">import</a> <a id="1905" href="Overture.Surjective.html" class="Module">Overture.Surjective</a>                <a id="1940" class="Keyword">using</a> <a id="1946" class="Symbol">(</a> <a id="1948" href="Overture.Surjective.html#1667" class="Function">IsSurjective</a> <a id="1961" class="Symbol">)</a>
<a id="1963" class="Keyword">open</a> <a id="1968" class="Keyword">import</a> <a id="1975" href="Relations.Discrete.html" class="Module">Relations.Discrete</a>                 <a id="2010" class="Keyword">using</a> <a id="2016" class="Symbol">(</a> <a id="2018" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="2025" class="Symbol">)</a>
<a id="2027" class="Keyword">open</a> <a id="2032" class="Keyword">import</a> <a id="2039" href="Relations.Quotients.html" class="Module">Relations.Quotients</a>                <a id="2074" class="Keyword">using</a> <a id="2080" class="Symbol">(</a> <a id="2082" href="Relations.Quotients.html#5376" class="Function Operator">⟪_⟫</a> <a id="2086" class="Symbol">)</a>
<a id="2088" class="Keyword">open</a> <a id="2093" class="Keyword">import</a> <a id="2100" href="Equality.Welldefined.html" class="Module">Equality.Welldefined</a>               <a id="2135" class="Keyword">using</a> <a id="2141" class="Symbol">(</a> <a id="2143" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a> <a id="2152" class="Symbol">;</a> <a id="2154" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="2163" class="Symbol">)</a>
<a id="2165" class="Keyword">open</a> <a id="2170" class="Keyword">import</a> <a id="2177" href="Equality.Truncation.html" class="Module">Equality.Truncation</a>                <a id="2212" class="Keyword">using</a> <a id="2218" class="Symbol">(</a> <a id="2220" href="Equality.Truncation.html#6506" class="Function">is-set</a> <a id="2227" class="Symbol">;</a> <a id="2229" href="Equality.Truncation.html#10764" class="Function">blk-uip</a> <a id="2237" class="Symbol">;</a> <a id="2239" href="Equality.Truncation.html#3855" class="Function">hfunext</a> <a id="2247" class="Symbol">)</a>
<a id="2249" class="Keyword">open</a> <a id="2254" class="Keyword">import</a> <a id="2261" href="Equality.Extensionality.html" class="Module">Equality.Extensionality</a>            <a id="2296" class="Keyword">using</a> <a id="2302" class="Symbol">(</a> <a id="2304" href="Equality.Extensionality.html#2264" class="Function">DFunExt</a><a id="2311" class="Symbol">;</a> <a id="2313" href="Equality.Extensionality.html#3081" class="Function">pred-ext</a> <a id="2322" class="Symbol">)</a>
<a id="2324" class="Keyword">open</a> <a id="2329" class="Keyword">import</a> <a id="2336" href="Algebras.Basic.html" class="Module">Algebras.Basic</a>                     <a id="2371" class="Keyword">using</a> <a id="2377" class="Symbol">(</a> <a id="2379" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="2387" class="Symbol">;</a> <a id="2389" href="Algebras.Basic.html#10858" class="Function">Lift-Alg</a> <a id="2398" class="Symbol">;</a> <a id="2400" href="Algebras.Basic.html#12408" class="Function">compatible</a> <a id="2411" class="Symbol">;</a> <a id="2413" href="Algebras.Basic.html#9397" class="Function Operator">_̂_</a> <a id="2417" class="Symbol">)</a>
<a id="2419" class="Keyword">open</a> <a id="2424" class="Keyword">import</a> <a id="2431" href="Algebras.Products.html" class="Module">Algebras.Products</a>          <a id="2458" class="Symbol">{</a><a id="2459" class="Argument">𝑆</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2464" class="Symbol">}</a> <a id="2466" class="Keyword">using</a> <a id="2472" class="Symbol">(</a> <a id="2474" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="2477" class="Symbol">;</a> <a id="2479" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="2481" class="Symbol">)</a>
<a id="2483" class="Keyword">open</a> <a id="2488" class="Keyword">import</a> <a id="2495" href="Algebras.Congruences.html" class="Module">Algebras.Congruences</a>       <a id="2522" class="Symbol">{</a><a id="2523" class="Argument">𝑆</a> <a id="2525" class="Symbol">=</a> <a id="2527" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2528" class="Symbol">}</a> <a id="2530" class="Keyword">using</a> <a id="2536" class="Symbol">(</a> <a id="2538" href="Algebras.Congruences.html#1986" class="Function">Con</a><a id="2541" class="Symbol">;</a> <a id="2543" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="2549" class="Symbol">;</a> <a id="2551" href="Algebras.Congruences.html#1800" class="Record">IsCongruence</a> <a id="2564" class="Symbol">)</a>
<a id="2566" class="Keyword">open</a> <a id="2571" class="Keyword">import</a> <a id="2578" href="Homomorphisms.Basic.html" class="Module">Homomorphisms.Basic</a>        <a id="2605" class="Symbol">{</a><a id="2606" class="Argument">𝑆</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2611" class="Symbol">}</a> <a id="2613" class="Keyword">using</a> <a id="2619" class="Symbol">(</a> <a id="2621" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="2625" class="Symbol">;</a> <a id="2627" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="2631" class="Symbol">;</a> <a id="2633" href="Homomorphisms.Basic.html#4752" class="Function">epi→hom</a> <a id="2641" class="Symbol">)</a>
<a id="2643" class="Keyword">open</a> <a id="2648" class="Keyword">import</a> <a id="2655" href="Homomorphisms.Kernels.html" class="Module">Homomorphisms.Kernels</a>      <a id="2682" class="Symbol">{</a><a id="2683" class="Argument">𝑆</a> <a id="2685" class="Symbol">=</a> <a id="2687" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2688" class="Symbol">}</a> <a id="2690" class="Keyword">using</a> <a id="2696" class="Symbol">(</a> <a id="2698" href="Homomorphisms.Kernels.html#2617" class="Function">kercon</a> <a id="2705" class="Symbol">;</a> <a id="2707" href="Homomorphisms.Kernels.html#5023" class="Function">ker-in-con</a> <a id="2718" class="Symbol">;</a> <a id="2720" href="Homomorphisms.Kernels.html#4514" class="Function">πker</a> <a id="2725" class="Symbol">;</a> <a id="2727" href="Homomorphisms.Kernels.html#3025" class="Function Operator">ker[_⇒_]_↾_</a> <a id="2739" class="Symbol">)</a>
<a id="2741" class="Keyword">open</a> <a id="2746" class="Keyword">import</a> <a id="2753" href="Homomorphisms.Products.html" class="Module">Homomorphisms.Products</a>     <a id="2780" class="Symbol">{</a><a id="2781" class="Argument">𝑆</a> <a id="2783" class="Symbol">=</a> <a id="2785" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2786" class="Symbol">}</a> <a id="2788" class="Keyword">using</a> <a id="2794" class="Symbol">(</a> <a id="2796" href="Homomorphisms.Products.html#1616" class="Function">⨅-hom-co</a> <a id="2805" class="Symbol">)</a>
<a id="2807" class="Keyword">open</a> <a id="2812" class="Keyword">import</a> <a id="2819" href="Homomorphisms.Properties.html" class="Module">Homomorphisms.Properties</a>   <a id="2846" class="Symbol">{</a><a id="2847" class="Argument">𝑆</a> <a id="2849" class="Symbol">=</a> <a id="2851" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2852" class="Symbol">}</a> <a id="2854" class="Keyword">using</a> <a id="2860" class="Symbol">(</a> <a id="2862" href="Homomorphisms.Properties.html#1366" class="Function">∘-hom</a> <a id="2868" class="Symbol">)</a>
<a id="2870" class="Keyword">open</a> <a id="2875" class="Keyword">import</a> <a id="2882" href="Homomorphisms.Factor.html" class="Module">Homomorphisms.Factor</a>       <a id="2909" class="Symbol">{</a><a id="2910" class="Argument">𝑆</a> <a id="2912" class="Symbol">=</a> <a id="2914" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2915" class="Symbol">}</a> <a id="2917" class="Keyword">using</a> <a id="2923" class="Symbol">(</a> <a id="2925" href="Homomorphisms.Factor.html#1848" class="Function">HomFactor</a> <a id="2935" class="Symbol">;</a> <a id="2937" href="Homomorphisms.Factor.html#3122" class="Function">HomFactorEpi</a> <a id="2950" class="Symbol">)</a>
<a id="2952" class="Keyword">open</a> <a id="2957" class="Keyword">import</a> <a id="2964" href="Homomorphisms.Isomorphisms.html" class="Module">Homomorphisms.Isomorphisms</a> <a id="2991" class="Symbol">{</a><a id="2992" class="Argument">𝑆</a> <a id="2994" class="Symbol">=</a> <a id="2996" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="2997" class="Symbol">}</a> <a id="2999" class="Keyword">using</a> <a id="3005" class="Symbol">(</a> <a id="3007" href="Homomorphisms.Isomorphisms.html#2333" class="Record Operator">_≅_</a> <a id="3011" class="Symbol">;</a> <a id="3013" href="Homomorphisms.Isomorphisms.html#2874" class="Function">≅-refl</a> <a id="3020" class="Symbol">;</a> <a id="3022" href="Homomorphisms.Isomorphisms.html#2964" class="Function">≅-sym</a> <a id="3028" class="Symbol">;</a> <a id="3030" href="Homomorphisms.Isomorphisms.html#4408" class="Function">Lift-≅</a> <a id="3037" class="Symbol">)</a>
<a id="3039" class="Keyword">open</a> <a id="3044" class="Keyword">import</a> <a id="3051" href="Terms.Basic.html" class="Module">Terms.Basic</a>                <a id="3078" class="Symbol">{</a><a id="3079" class="Argument">𝑆</a> <a id="3081" class="Symbol">=</a> <a id="3083" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3084" class="Symbol">}</a> <a id="3086" class="Keyword">using</a> <a id="3092" class="Symbol">(</a> <a id="3094" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="3099" class="Symbol">;</a> <a id="3101" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="3103" class="Symbol">)</a>
<a id="3105" class="Keyword">open</a> <a id="3110" class="Keyword">import</a> <a id="3117" href="Terms.Properties.html" class="Module">Terms.Properties</a>           <a id="3144" class="Symbol">{</a><a id="3145" class="Argument">𝑆</a> <a id="3147" class="Symbol">=</a> <a id="3149" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3150" class="Symbol">}</a> <a id="3152" class="Keyword">using</a> <a id="3158" class="Symbol">(</a> <a id="3160" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="3170" class="Symbol">;</a> <a id="3172" href="Terms.Properties.html#3236" class="Function">lift-hom</a>
                                                     <a id="3234" class="Symbol">;</a> <a id="3236" href="Terms.Properties.html#3635" class="Function">free-unique</a> <a id="3248" class="Symbol">;</a> <a id="3250" href="Terms.Properties.html#4841" class="Function">lift-of-epi-is-epi</a> <a id="3269" class="Symbol">)</a>
<a id="3271" class="Keyword">open</a> <a id="3276" class="Keyword">import</a> <a id="3283" href="Terms.Operations.html" class="Module">Terms.Operations</a>           <a id="3310" class="Symbol">{</a><a id="3311" class="Argument">𝑆</a> <a id="3313" class="Symbol">=</a> <a id="3315" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3316" class="Symbol">}</a> <a id="3318" class="Keyword">using</a> <a id="3324" class="Symbol">(</a> <a id="3326" href="Terms.Operations.html#2577" class="Function Operator">_⟦_⟧</a><a id="3330" class="Symbol">;</a> <a id="3332" href="Terms.Operations.html#6584" class="Function">comm-hom-term</a><a id="3345" class="Symbol">;</a> <a id="3347" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="3364" class="Symbol">)</a>
<a id="3366" class="Keyword">open</a> <a id="3371" class="Keyword">import</a> <a id="3378" href="Subalgebras.Subalgebras.html" class="Module">Subalgebras.Subalgebras</a>    <a id="3405" class="Symbol">{</a><a id="3406" class="Argument">𝑆</a> <a id="3408" class="Symbol">=</a> <a id="3410" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3411" class="Symbol">}</a> <a id="3413" class="Keyword">using</a> <a id="3419" class="Symbol">(</a> <a id="3421" href="Subalgebras.Subalgebras.html#2186" class="Function Operator">_≤_</a> <a id="3425" class="Symbol">;</a> <a id="3427" href="Subalgebras.Subalgebras.html#4012" class="Function">FirstHomCorollary|Set</a> <a id="3449" class="Symbol">)</a>
<a id="3451" class="Keyword">open</a> <a id="3456" class="Keyword">import</a> <a id="3463" href="Varieties.EquationalLogic.html" class="Module">Varieties.EquationalLogic</a>  <a id="3490" class="Symbol">{</a><a id="3491" class="Argument">𝑆</a> <a id="3493" class="Symbol">=</a> <a id="3495" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3496" class="Symbol">}</a> <a id="3498" class="Keyword">using</a> <a id="3504" class="Symbol">(</a> <a id="3506" href="Varieties.EquationalLogic.html#2716" class="Function Operator">_⊫_≈_</a><a id="3511" class="Symbol">;</a> <a id="3513" href="Varieties.EquationalLogic.html#2638" class="Function Operator">_⊧_≈_</a><a id="3518" class="Symbol">;</a> <a id="3520" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a><a id="3522" class="Symbol">;</a> <a id="3524" href="Varieties.EquationalLogic.html#4084" class="Function">Mod</a> <a id="3528" class="Symbol">)</a>
<a id="3530" class="Keyword">open</a> <a id="3535" class="Keyword">import</a> <a id="3542" href="Varieties.Closure.html" class="Module">Varieties.Closure</a>          <a id="3569" class="Symbol">{</a><a id="3570" class="Argument">𝑆</a> <a id="3572" class="Symbol">=</a> <a id="3574" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3575" class="Symbol">}</a> <a id="3577" class="Keyword">using</a> <a id="3583" class="Symbol">(</a> <a id="3585" href="Varieties.Closure.html#3783" class="Datatype">S</a> <a id="3587" class="Symbol">;</a> <a id="3589" href="Varieties.Closure.html#4359" class="Datatype">P</a> <a id="3591" class="Symbol">;</a> <a id="3593" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="3595" class="Symbol">)</a>
<a id="3597" class="Keyword">open</a> <a id="3602" class="Keyword">import</a> <a id="3609" href="Varieties.Preservation.html" class="Module">Varieties.Preservation</a>     <a id="3636" class="Symbol">{</a><a id="3637" class="Argument">𝑆</a> <a id="3639" class="Symbol">=</a> <a id="3641" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="3642" class="Symbol">}</a> <a id="3644" class="Keyword">using</a> <a id="3650" class="Symbol">(</a> <a id="3652" class="Keyword">module</a> <a id="3659" href="Varieties.Preservation.html#10544" class="Module">class-products-with-maps</a>
                                                     <a id="3737" class="Symbol">;</a> <a id="3739" href="Varieties.Preservation.html#20465" class="Function">class-ids-⇒</a> <a id="3751" class="Symbol">;</a> <a id="3753" href="Varieties.Preservation.html#20578" class="Function">class-ids</a> <a id="3763" class="Symbol">;</a> <a id="3765" href="Varieties.Preservation.html#9359" class="Function">SP⊆V&#39;</a><a id="3770" class="Symbol">)</a>
<a id="3772" class="Keyword">open</a> <a id="3777" href="Terms.Basic.html#1991" class="Module">Term</a>
<a id="3782" class="Keyword">open</a> <a id="3787" href="Varieties.Closure.html#3783" class="Module">S</a>
<a id="3789" class="Keyword">open</a> <a id="3794" href="Varieties.Closure.html#5312" class="Module">V</a>

<a id="𝓕"></a><a id="3797" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="𝓕⁺"></a><a id="3799" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="3802" class="Symbol">:</a> <a id="3804" href="Agda.Primitive.html#597" class="Postulate">Level</a>
<a id="3810" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="3812" class="Symbol">=</a> <a id="3814" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3817" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a>
<a id="3819" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="3822" class="Symbol">=</a> <a id="3824" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="3829" class="Symbol">(</a><a id="3830" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="3833" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="3834" class="Symbol">)</a>    <a id="3839" class="Comment">-- (this will be the level of the relatively free algebra)</a>

</pre>


#### <a id="the-free-algebra-in-theory">The free algebra in theory</a>

Recall, we proved in the [Terms.Basic][] module that the term algebra `𝑻 X` is absolutely free in the class of all `𝑆`-structures.
In this section, we formalize, for a given class `𝒦` of `𝑆`-algebras, the (relatively) free algebra in `S(P 𝒦)` over `X`.

We use the next definition to take a free algebra *for* a class `𝒦` and produce the free algebra *in* `𝒦`.
Let `Θ(𝒦, 𝑨) := {θ ∈ Con 𝑨 : 𝑨 / θ ∈ (S 𝒦)}`, and let `ψ(𝒦, 𝑨) := ⋂ Θ(𝒦, 𝑨)`.
(Notice that `Θ(𝒦, 𝑨)` may be empty, in which case `ψ(𝒦, 𝑨) = 1` and then `𝑨 / ψ(𝒦, 𝑨)` is trivial.)
The free algebra is constructed by applying the definitions of `θ` and `ψ` to the special case in which `𝑨` is the algebra `𝑻 X` of `𝑆`-terms over `X`.

Since `𝑻 X` is free for (and in) the class of all `𝑆`-algebras, it follows that `𝑻 X` is free for every class `𝒦` of `𝑆`-algebras. Of course, `𝑻 X` is not necessarily a member of `𝒦`, but if we form the quotient of `𝑻 X` modulo the congruence `ψ(𝒦, 𝑻 X)`, which we denote by `𝔽[ X ] := (𝑻 X) / ψ(𝒦, 𝑻 X)`, then it's not hard to see that `𝔽[ X ]` is a subdirect product of the algebras in `{(𝑻 𝑋) / θ}`, where `θ` ranges over `Θ(𝒦, 𝑻 X)`, so `𝔽[ X ]` belongs to `SP(𝒦)`, and must therefore satisfy all identities modeled by all members of `𝒦`.  Indeed, for each pair `p q : 𝑻 X`, if `𝒦 ⊧ p ≈ q`, then `p` and `q` belong to the same `ψ(𝒦, 𝑻 X)`-class, so `p` and `q` are identified in the quotient `𝔽[ X ]`.

The `𝔽[ X ]` that we have just defined is called the *free algebra over* `𝒦` *generated by* `X` and (because of what we just observed) we may say that `𝔽[ X ]` is free *in* `SP(𝒦)`.

**Remarks**. Since `X` is not a subset of `𝔽[ X ]`, technically it doesn't make sense to say "`X` generates `𝔽[ X ]`." But as long as 𝒦 contains a nontrivial algebra, we will have `ψ(𝒦, 𝑻 𝑋) ∩ X² ≠ ∅`, and we can identify `X` with `X / ψ(𝒦, 𝑻 X)` which *is* a subset of `𝔽[ X ]`.



#### <a id="the-free-algebra-in-agda">The free algebra in Agda</a>

Before we attempt to represent the free algebra in Agda we construct the congruence `ψ(𝒦, 𝑻 𝑋)` described above.
First, we represent the congruence relation `ψCon`, modulo which `𝑻 X` yields the relatively free algebra, `𝔽[ X ] := 𝑻 X ╱ ψCon`.  We let `ψ` be the collection of identities `(p, q)` satisfied by all subalgebras of algebras in `𝒦`.

<pre class="Agda">

<a id="6279" class="Keyword">module</a> <a id="6286" href="Varieties.FreeAlgebras.html#6286" class="Module">_</a> <a id="6288" class="Symbol">{</a><a id="6289" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a> <a id="6291" class="Symbol">:</a> <a id="6293" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="6298" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6299" class="Symbol">}(</a><a id="6301" href="Varieties.FreeAlgebras.html#6301" class="Bound">𝒦</a> <a id="6303" class="Symbol">:</a> <a id="6305" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6310" class="Symbol">(</a><a id="6311" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="6319" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6321" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6322" class="Symbol">)</a> <a id="6324" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="6325" class="Symbol">)</a> <a id="6327" class="Keyword">where</a>

 <a id="6335" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="6337" class="Symbol">:</a> <a id="6339" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="6344" class="Symbol">(</a><a id="6345" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6347" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="6349" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a> <a id="6351" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6353" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6355" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6357" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="6359" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a> <a id="6361" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="6362" class="Symbol">)</a> <a id="6364" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a>
 <a id="6367" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="6369" class="Symbol">(</a><a id="6370" href="Varieties.FreeAlgebras.html#6370" class="Bound">p</a> <a id="6372" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6374" href="Varieties.FreeAlgebras.html#6374" class="Bound">q</a><a id="6375" class="Symbol">)</a> <a id="6377" class="Symbol">=</a> <a id="6379" class="Symbol">∀(</a><a id="6381" href="Varieties.FreeAlgebras.html#6381" class="Bound">𝑨</a> <a id="6383" class="Symbol">:</a> <a id="6385" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="6393" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6395" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="6396" class="Symbol">)(</a><a id="6398" href="Varieties.FreeAlgebras.html#6398" class="Bound">sA</a> <a id="6401" class="Symbol">:</a> <a id="6403" href="Varieties.FreeAlgebras.html#6381" class="Bound">𝑨</a> <a id="6405" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="6407" href="Varieties.Closure.html#3783" class="Datatype">S</a><a id="6408" class="Symbol">{</a><a id="6409" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6410" class="Symbol">}{</a><a id="6412" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="6413" class="Symbol">}</a> <a id="6415" href="Varieties.FreeAlgebras.html#6301" class="Bound">𝒦</a><a id="6416" class="Symbol">)(</a><a id="6418" href="Varieties.FreeAlgebras.html#6418" class="Bound">h</a> <a id="6420" class="Symbol">:</a> <a id="6422" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a> <a id="6424" class="Symbol">→</a> <a id="6426" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6428" href="Varieties.FreeAlgebras.html#6381" class="Bound">𝑨</a> <a id="6430" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6432" class="Symbol">)</a>
                 <a id="6451" class="Symbol">→</a>  <a id="6454" class="Symbol">(</a><a id="6455" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="6465" href="Varieties.FreeAlgebras.html#6381" class="Bound">𝑨</a> <a id="6467" href="Varieties.FreeAlgebras.html#6418" class="Bound">h</a><a id="6468" class="Symbol">)</a> <a id="6470" href="Varieties.FreeAlgebras.html#6370" class="Bound">p</a> <a id="6472" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6474" class="Symbol">(</a><a id="6475" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="6485" href="Varieties.FreeAlgebras.html#6381" class="Bound">𝑨</a> <a id="6487" href="Varieties.FreeAlgebras.html#6418" class="Bound">h</a><a id="6488" class="Symbol">)</a> <a id="6490" href="Varieties.FreeAlgebras.html#6374" class="Bound">q</a>

</pre>

We convert the predicate ψ into a relation by [currying](https://en.wikipedia.org/wiki/Currying).

<pre class="Agda">

 <a id="6619" href="Varieties.FreeAlgebras.html#6619" class="Function">ψRel</a> <a id="6624" class="Symbol">:</a> <a id="6626" href="Varieties.FreeAlgebras.html#1501" class="Function">BinRel</a> <a id="6633" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6635" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="6637" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a> <a id="6639" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="6641" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a>
 <a id="6644" href="Varieties.FreeAlgebras.html#6619" class="Function">ψRel</a> <a id="6649" href="Varieties.FreeAlgebras.html#6649" class="Bound">p</a> <a id="6651" href="Varieties.FreeAlgebras.html#6651" class="Bound">q</a> <a id="6653" class="Symbol">=</a> <a id="6655" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="6657" class="Symbol">(</a><a id="6658" href="Varieties.FreeAlgebras.html#6649" class="Bound">p</a> <a id="6660" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6662" href="Varieties.FreeAlgebras.html#6651" class="Bound">q</a><a id="6663" class="Symbol">)</a>

</pre>

To express `ψRel` as a congruence of the term algebra `𝑻 X`, we must prove that

1. `ψRel` is compatible with the operations of `𝑻 X` (which are jsut the terms themselves) and
2. `ψRel` it is an equivalence relation.

<pre class="Agda">

 <a id="6911" class="Keyword">open</a> <a id="6916" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="6930" href="Varieties.FreeAlgebras.html#6930" class="Function">ψcompatible</a> <a id="6942" class="Symbol">:</a> <a id="6944" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="6953" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="6955" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="6957" class="Symbol">→</a> <a id="6959" href="Algebras.Basic.html#12408" class="Function">compatible</a> <a id="6970" class="Symbol">(</a><a id="6971" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="6973" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="6974" class="Symbol">)</a> <a id="6976" href="Varieties.FreeAlgebras.html#6619" class="Function">ψRel</a>
 <a id="6982" href="Varieties.FreeAlgebras.html#6930" class="Function">ψcompatible</a> <a id="6994" href="Varieties.FreeAlgebras.html#6994" class="Bound">wd</a> <a id="6997" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="6999" class="Symbol">{</a><a id="7000" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a><a id="7001" class="Symbol">}</a> <a id="7003" class="Symbol">{</a><a id="7004" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7005" class="Symbol">}</a> <a id="7007" href="Varieties.FreeAlgebras.html#7007" class="Bound">ψpq</a> <a id="7011" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a> <a id="7013" href="Varieties.FreeAlgebras.html#7013" class="Bound">sA</a> <a id="7016" href="Varieties.FreeAlgebras.html#7016" class="Bound">h</a> <a id="7018" class="Symbol">=</a> <a id="7020" href="Varieties.FreeAlgebras.html#7070" class="Function">γ</a>
  <a id="7024" class="Keyword">where</a>
  <a id="7032" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7034" class="Symbol">:</a> <a id="7036" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="7040" class="Symbol">(</a><a id="7041" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7043" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7044" class="Symbol">)</a> <a id="7046" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a>
  <a id="7050" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7052" class="Symbol">=</a> <a id="7054" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="7063" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a> <a id="7065" href="Varieties.FreeAlgebras.html#7016" class="Bound">h</a>

  <a id="7070" href="Varieties.FreeAlgebras.html#7070" class="Function">γ</a> <a id="7072" class="Symbol">:</a> <a id="7074" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7076" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7078" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7080" class="Symbol">((</a><a id="7082" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7084" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7086" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7088" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7089" class="Symbol">)</a> <a id="7091" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a><a id="7092" class="Symbol">)</a> <a id="7094" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7096" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7098" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7100" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7102" class="Symbol">((</a><a id="7104" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7106" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7108" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7110" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7111" class="Symbol">)</a> <a id="7113" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7114" class="Symbol">)</a>

  <a id="7119" href="Varieties.FreeAlgebras.html#7070" class="Function">γ</a> <a id="7121" class="Symbol">=</a> <a id="7123" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7125" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7127" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7129" class="Symbol">((</a><a id="7131" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7133" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7135" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7137" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7138" class="Symbol">)</a> <a id="7140" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a><a id="7141" class="Symbol">)</a>  <a id="7144" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7147" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="7149" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7151" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="7153" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7155" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a> <a id="7157" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7165" class="Symbol">(</a><a id="7166" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7168" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7170" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a><a id="7171" class="Symbol">)</a> <a id="7173" class="Symbol">(</a><a id="7174" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7176" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7178" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7180" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7182" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a><a id="7183" class="Symbol">)</a>  <a id="7186" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7189" href="Varieties.FreeAlgebras.html#6994" class="Bound">wd</a> <a id="7192" class="Symbol">(</a><a id="7193" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7195" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7197" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a><a id="7198" class="Symbol">)(</a><a id="7200" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7202" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7204" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7206" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7208" href="Varieties.FreeAlgebras.html#7000" class="Bound">p</a><a id="7209" class="Symbol">)(</a><a id="7211" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7213" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7215" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7217" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7219" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7220" class="Symbol">)(λ</a> <a id="7224" href="Varieties.FreeAlgebras.html#7224" class="Bound">x</a> <a id="7226" class="Symbol">→</a> <a id="7228" href="Varieties.FreeAlgebras.html#7007" class="Bound">ψpq</a> <a id="7232" href="Varieties.FreeAlgebras.html#7224" class="Bound">x</a> <a id="7234" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a> <a id="7236" href="Varieties.FreeAlgebras.html#7013" class="Bound">sA</a> <a id="7239" href="Varieties.FreeAlgebras.html#7016" class="Bound">h</a><a id="7240" class="Symbol">)</a> <a id="7242" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7250" class="Symbol">(</a><a id="7251" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7253" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7255" href="Varieties.FreeAlgebras.html#7011" class="Bound">𝑨</a><a id="7256" class="Symbol">)</a> <a id="7258" class="Symbol">(</a><a id="7259" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7261" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7263" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7265" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7267" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7268" class="Symbol">)</a>  <a id="7271" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="7274" class="Symbol">(</a><a id="7275" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="7277" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7279" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="7281" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7283" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7284" class="Symbol">)</a><a id="7285" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a> <a id="7288" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
      <a id="7296" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7298" href="Varieties.FreeAlgebras.html#7032" class="Function">φ</a> <a id="7300" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="7302" class="Symbol">((</a><a id="7304" href="Varieties.FreeAlgebras.html#6997" class="Bound">𝑓</a> <a id="7306" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="7308" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7310" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7311" class="Symbol">)</a> <a id="7313" href="Varieties.FreeAlgebras.html#7004" class="Bound">q</a><a id="7314" class="Symbol">)</a>  <a id="7317" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

 <a id="7321" href="Varieties.FreeAlgebras.html#7321" class="Function">ψIsEquivalence</a> <a id="7336" class="Symbol">:</a> <a id="7338" href="Relation.Binary.Structures.html#1522" class="Record">IsEquivalence</a> <a id="7352" href="Varieties.FreeAlgebras.html#6619" class="Function">ψRel</a>
 <a id="7358" href="Varieties.FreeAlgebras.html#7321" class="Function">ψIsEquivalence</a> <a id="7373" class="Symbol">=</a> <a id="7375" class="Keyword">record</a> <a id="7382" class="Symbol">{</a> <a id="7384" href="Relation.Binary.Structures.html#1568" class="Field">refl</a> <a id="7389" class="Symbol">=</a> <a id="7391" class="Symbol">λ</a> <a id="7393" href="Varieties.FreeAlgebras.html#7393" class="Bound">𝑨</a> <a id="7395" href="Varieties.FreeAlgebras.html#7395" class="Bound">sA</a> <a id="7398" href="Varieties.FreeAlgebras.html#7398" class="Bound">h</a> <a id="7400" class="Symbol">→</a> <a id="7402" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
                         <a id="7432" class="Symbol">;</a> <a id="7434" href="Relation.Binary.Structures.html#1594" class="Field">sym</a> <a id="7438" class="Symbol">=</a> <a id="7440" class="Symbol">λ</a> <a id="7442" href="Varieties.FreeAlgebras.html#7442" class="Bound">x</a> <a id="7444" href="Varieties.FreeAlgebras.html#7444" class="Bound">𝑨</a> <a id="7446" href="Varieties.FreeAlgebras.html#7446" class="Bound">sA</a> <a id="7449" href="Varieties.FreeAlgebras.html#7449" class="Bound">h</a> <a id="7451" class="Symbol">→</a> <a id="7453" class="Symbol">(</a><a id="7454" href="Varieties.FreeAlgebras.html#7442" class="Bound">x</a> <a id="7456" href="Varieties.FreeAlgebras.html#7444" class="Bound">𝑨</a> <a id="7458" href="Varieties.FreeAlgebras.html#7446" class="Bound">sA</a> <a id="7461" href="Varieties.FreeAlgebras.html#7449" class="Bound">h</a><a id="7462" class="Symbol">)</a><a id="7463" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a>
                         <a id="7491" class="Symbol">;</a> <a id="7493" href="Relation.Binary.Structures.html#1620" class="Field">trans</a> <a id="7499" class="Symbol">=</a> <a id="7501" class="Symbol">λ</a> <a id="7503" href="Varieties.FreeAlgebras.html#7503" class="Bound">pψq</a> <a id="7507" href="Varieties.FreeAlgebras.html#7507" class="Bound">qψr</a> <a id="7511" href="Varieties.FreeAlgebras.html#7511" class="Bound">𝑨</a> <a id="7513" href="Varieties.FreeAlgebras.html#7513" class="Bound">sA</a> <a id="7516" href="Varieties.FreeAlgebras.html#7516" class="Bound">h</a> <a id="7518" class="Symbol">→</a> <a id="7520" class="Symbol">(</a><a id="7521" href="Varieties.FreeAlgebras.html#7503" class="Bound">pψq</a> <a id="7525" href="Varieties.FreeAlgebras.html#7511" class="Bound">𝑨</a> <a id="7527" href="Varieties.FreeAlgebras.html#7513" class="Bound">sA</a> <a id="7530" href="Varieties.FreeAlgebras.html#7516" class="Bound">h</a><a id="7531" class="Symbol">)</a> <a id="7533" href="Overture.Preliminaries.html#5301" class="Function Operator">∙</a> <a id="7535" class="Symbol">(</a><a id="7536" href="Varieties.FreeAlgebras.html#7507" class="Bound">qψr</a> <a id="7540" href="Varieties.FreeAlgebras.html#7511" class="Bound">𝑨</a> <a id="7542" href="Varieties.FreeAlgebras.html#7513" class="Bound">sA</a> <a id="7545" href="Varieties.FreeAlgebras.html#7516" class="Bound">h</a><a id="7546" class="Symbol">)</a> <a id="7548" class="Symbol">}</a>
</pre>

We have collected all the pieces necessary to express the collection of identities satisfied by all subalgebras of algebras in the class as a congruence relation of the term algebra. We call this congruence `ψCon` and define it using the Congruence constructor `mkcon`.

<pre class="Agda">

 <a id="7848" href="Varieties.FreeAlgebras.html#7848" class="Function">ψCon</a> <a id="7853" class="Symbol">:</a> <a id="7855" href="Equality.Welldefined.html#2646" class="Function">swelldef</a> <a id="7864" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="7866" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="7868" class="Symbol">→</a> <a id="7870" href="Algebras.Congruences.html#1986" class="Function">Con</a> <a id="7874" class="Symbol">(</a><a id="7875" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="7877" href="Varieties.FreeAlgebras.html#6289" class="Bound">X</a><a id="7878" class="Symbol">)</a>
 <a id="7881" href="Varieties.FreeAlgebras.html#7848" class="Function">ψCon</a> <a id="7886" href="Varieties.FreeAlgebras.html#7886" class="Bound">wd</a> <a id="7889" class="Symbol">=</a> <a id="7891" href="Varieties.FreeAlgebras.html#6619" class="Function">ψRel</a> <a id="7896" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7898" href="Algebras.Congruences.html#1888" class="InductiveConstructor">mkcon</a> <a id="7904" href="Varieties.FreeAlgebras.html#7321" class="Function">ψIsEquivalence</a> <a id="7919" class="Symbol">(</a><a id="7920" href="Varieties.FreeAlgebras.html#6930" class="Function">ψcompatible</a> <a id="7932" href="Varieties.FreeAlgebras.html#7886" class="Bound">wd</a><a id="7934" class="Symbol">)</a>

</pre>



#### <a id="hsp-theorem">HSP Theorem</a>

This section presents a formal proof of the Birkhoff HSP theorem.

To complete the proof of Birkhoff's HSP theorem, it remains to show that `Mod X (Th (V 𝒦))` is contained in `V 𝒦`; that is, every algebra that models the equations in `Th (V 𝒦)` belongs to `V 𝒦`.  This will prove that `V 𝒦` is an equational class.  (The converse, that every equational class is a variety was already proved; see the remarks at the end of this module.)

We accomplish this goal by constructing an algebra `𝔽` with the following properties:

1. `𝔽 ∈ V 𝒦` and

2. Every `𝑨 ∈ Mod X (Th (V 𝒦))` is a homomorphic image of `𝔽`.

We denote by `ℭ` the product of all subalgebras of algebras in `𝒦`, and by `homℭ` the homomorphism from `𝑻 X` to `ℭ` defined as follows: `homℭ := ⨅-hom-co (𝑻 X) 𝔄 hom𝔄`. Here, `⨅-hom-co` (defined in the [Homomorphisms.Properties][] module) takes the term algebra `𝑻 X`, a family `{𝔄 : I → Algebra α 𝑆}` of `𝑆`-algebras, and a family `hom𝔄 : ∀ i → hom (𝑻 X) (𝔄 i)` of homomorphisms and constructs the natural homomorphism `homℭ` from `𝑻 X` to the product `ℭ := ⨅ 𝔄`.  The homomorphism `homℭ : hom (𝑻 X) (⨅ ℭ)` is "natural" in the sense that the `i`-th component of the image of `𝑡 : Term X` under `homℭ` is the image `∣ hom𝔄 i ∣ 𝑡` of 𝑡 under the i-th homomorphism `hom𝔄 i`.


#### <a id="F-in-classproduct">𝔽 ≤  ⨅ S(𝒦)</a>
Now we come to a step in the Agda formalization of Birkhoff's theorem that is presents the greatest technical challenge.  We must prove that the free algebra embeds in the product ℭ of all subalgebras of algebras in the class `𝒦`.  This is really the only stage in the proof of Birkhoff's theorem that requires the truncation assumption that `ℭ` be a *set* (that is, `ℭ` has the [UIP][] property).  We will also need to assume several local function extensionality postulates and, as a result, the next submodule will take as given the parameter `fe : (∀ a b → funext a b)`.  This allows us to postulate local function extensionality when and where we need it in the proof. For example, if we want to assume function extensionality at universe levels 𝓥 and α, we simply apply `fe` to those universes: `fe 𝓥 α`. (Earlier versions of the library used just a single *global* function extensionality postulate at the start of most modules, but we have since decided to exchange that elegant but crude option for greater precision and transparency.)

<pre class="Agda">

<a id="10382" class="Keyword">module</a> <a id="10389" href="Varieties.FreeAlgebras.html#10389" class="Module">_</a> <a id="10391" class="Symbol">{</a><a id="10392" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="10395" class="Symbol">:</a> <a id="10397" href="Equality.Extensionality.html#2264" class="Function">DFunExt</a><a id="10404" class="Symbol">}{</a><a id="10406" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="10409" class="Symbol">:</a> <a id="10411" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="10419" class="Symbol">}{</a><a id="10421" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="10423" class="Symbol">:</a> <a id="10425" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="10430" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10431" class="Symbol">}</a> <a id="10433" class="Symbol">{</a><a id="10434" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="10436" class="Symbol">:</a> <a id="10438" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="10443" class="Symbol">(</a><a id="10444" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="10452" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="10454" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="10455" class="Symbol">)</a> <a id="10457" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="10458" class="Symbol">}</a> <a id="10460" class="Keyword">where</a>

 <a id="10468" class="Keyword">open</a> <a id="10473" href="Varieties.Preservation.html#10544" class="Module">class-products-with-maps</a> <a id="10498" class="Symbol">{</a><a id="10499" class="Argument">X</a> <a id="10501" class="Symbol">=</a> <a id="10503" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="10504" class="Symbol">}{</a><a id="10506" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="10509" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="10511" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="10512" class="Symbol">}{</a><a id="10514" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="10517" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="10520" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="10522" class="Symbol">}{</a><a id="10524" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="10527" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="10529" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="10530" class="Symbol">}</a> <a id="10532" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>

</pre>

We begin by constructing `ℭ`, using the techniques described in the section on <a href="https://ualib.gitlab.io/Varieties.Varieties.html#products-of-classes">products of classes</a>.

<pre class="Agda">

  <a id="10747" class="Comment">-- ℭ is the product of all subalgebras of algebras in 𝒦.</a>
 <a id="10805" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="10807" class="Symbol">:</a> <a id="10809" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="10817" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="10819" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="10822" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="10824" class="Symbol">=</a> <a id="10826" href="Algebras.Products.html#1869" class="Function">⨅</a> <a id="10828" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a>

</pre>

Observe that the inhabitants of `ℭ` are maps from `ℑ` to `{𝔄 i : i ∈ ℑ}`.  A homomorphism from `𝑻 X` to `ℭ` is obtained as follows.

<pre class="Agda">

 <a id="10992" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="10997" class="Symbol">:</a> <a id="10999" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="11003" class="Symbol">(</a><a id="11004" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="11006" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="11007" class="Symbol">)</a> <a id="11009" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a>
 <a id="11012" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="11017" class="Symbol">=</a> <a id="11019" href="Homomorphisms.Products.html#1616" class="Function">⨅-hom-co</a> <a id="11028" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a> <a id="11031" class="Symbol">(</a><a id="11032" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="11035" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="11037" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11038" class="Symbol">){</a><a id="11040" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="11041" class="Symbol">}(</a><a id="11043" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="11045" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="11046" class="Symbol">)</a> <a id="11048" class="Symbol">λ</a> <a id="11050" href="Varieties.FreeAlgebras.html#11050" class="Bound">i</a> <a id="11052" class="Symbol">→</a> <a id="11054" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="11063" class="Symbol">(</a><a id="11064" href="Varieties.Preservation.html#11961" class="Function">𝔄&#39;</a> <a id="11067" href="Varieties.FreeAlgebras.html#11050" class="Bound">i</a><a id="11068" class="Symbol">)(</a><a id="11070" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11074" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="11076" href="Varieties.FreeAlgebras.html#11050" class="Bound">i</a> <a id="11078" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a><a id="11079" class="Symbol">)</a>

</pre>


#### <a id="the-free-algebra">The free algebra</a>

 As mentioned, the initial version of the [agda-algebras](https://github.com/ualib/agda-algebras) library used the free algebra `𝔉` developed above.  However, our new, more direct proof uses the algebra `𝔽`, which we now define, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

 We now define the algebra `𝔽`, which plays the role of the free algebra, along with the natural epimorphism `epi𝔽 : epi (𝑻 X) 𝔽` from `𝑻 X` to `𝔽`.

<pre class="Agda">

 <a id="11617" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="11619" class="Symbol">:</a> <a id="11621" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="11629" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="11632" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a>
 <a id="11635" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="11637" class="Symbol">=</a> <a id="11639" href="Homomorphisms.Kernels.html#3025" class="Function Operator">ker[</a> <a id="11644" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="11646" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="11648" href="Homomorphisms.Kernels.html#3025" class="Function Operator">⇒</a> <a id="11650" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="11652" href="Homomorphisms.Kernels.html#3025" class="Function Operator">]</a> <a id="11654" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="11659" href="Homomorphisms.Kernels.html#3025" class="Function Operator">↾</a> <a id="11661" class="Symbol">(</a><a id="11662" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="11665" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11667" class="Symbol">(</a><a id="11668" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11671" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11672" class="Symbol">))</a>

 <a id="11677" href="Varieties.FreeAlgebras.html#11677" class="Function">epi𝔽</a> <a id="11682" class="Symbol">:</a> <a id="11684" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="11688" class="Symbol">(</a><a id="11689" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="11691" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="11692" class="Symbol">)</a> <a id="11694" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a>
 <a id="11697" href="Varieties.FreeAlgebras.html#11677" class="Function">epi𝔽</a> <a id="11702" class="Symbol">=</a> <a id="11704" href="Homomorphisms.Kernels.html#4514" class="Function">πker</a> <a id="11709" class="Symbol">(</a><a id="11710" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="11713" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="11715" class="Symbol">(</a><a id="11716" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="11719" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="11720" class="Symbol">))</a> <a id="11723" class="Symbol">{</a><a id="11724" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a><a id="11725" class="Symbol">}</a> <a id="11727" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a>

 <a id="11734" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="11739" class="Symbol">:</a> <a id="11741" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="11745" class="Symbol">(</a><a id="11746" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="11748" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="11749" class="Symbol">)</a> <a id="11751" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a>
 <a id="11754" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="11759" class="Symbol">=</a> <a id="11761" href="Homomorphisms.Basic.html#4752" class="Function">epi→hom</a> <a id="11769" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="11771" href="Varieties.FreeAlgebras.html#11677" class="Function">epi𝔽</a>

 <a id="11778" href="Varieties.FreeAlgebras.html#11778" class="Function">hom𝔽-is-epic</a> <a id="11791" class="Symbol">:</a> <a id="11793" href="Overture.Surjective.html#1667" class="Function">IsSurjective</a> <a id="11806" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="11808" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="11813" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a>
 <a id="11816" href="Varieties.FreeAlgebras.html#11778" class="Function">hom𝔽-is-epic</a> <a id="11829" class="Symbol">=</a> <a id="11831" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="11835" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="11837" href="Varieties.FreeAlgebras.html#11677" class="Function">epi𝔽</a> <a id="11842" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a>

</pre>

We will need the following facts relating `homℭ`, `hom𝔽`, `and ψ`.

<pre class="Agda">

 <a id="11940" href="Varieties.FreeAlgebras.html#11940" class="Function">ψlemma0</a> <a id="11948" class="Symbol">:</a> <a id="11950" class="Symbol">∀</a> <a id="11952" href="Varieties.FreeAlgebras.html#11952" class="Bound">p</a> <a id="11954" href="Varieties.FreeAlgebras.html#11954" class="Bound">q</a> <a id="11956" class="Symbol">→</a>  <a id="11959" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="11961" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="11966" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="11968" href="Varieties.FreeAlgebras.html#11952" class="Bound">p</a> <a id="11970" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="11972" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="11974" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="11979" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="11981" href="Varieties.FreeAlgebras.html#11954" class="Bound">q</a>  <a id="11984" class="Symbol">→</a> <a id="11986" class="Symbol">(</a><a id="11987" href="Varieties.FreeAlgebras.html#11952" class="Bound">p</a> <a id="11989" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11991" href="Varieties.FreeAlgebras.html#11954" class="Bound">q</a><a id="11992" class="Symbol">)</a> <a id="11994" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="11996" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="11998" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
 <a id="12001" href="Varieties.FreeAlgebras.html#11940" class="Function">ψlemma0</a> <a id="12009" href="Varieties.FreeAlgebras.html#12009" class="Bound">p</a> <a id="12011" href="Varieties.FreeAlgebras.html#12011" class="Bound">q</a> <a id="12013" href="Varieties.FreeAlgebras.html#12013" class="Bound">phomℭq</a> <a id="12020" href="Varieties.FreeAlgebras.html#12020" class="Bound">𝑨</a> <a id="12022" href="Varieties.FreeAlgebras.html#12022" class="Bound">sA</a> <a id="12025" href="Varieties.FreeAlgebras.html#12025" class="Bound">h</a> <a id="12027" class="Symbol">=</a> <a id="12029" href="Relation.Binary.PropositionalEquality.Core.html#1461" class="Function">cong-app</a> <a id="12038" href="Varieties.FreeAlgebras.html#12013" class="Bound">phomℭq</a> <a id="12045" class="Symbol">(</a><a id="12046" href="Varieties.FreeAlgebras.html#12020" class="Bound">𝑨</a> <a id="12048" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12050" href="Varieties.FreeAlgebras.html#12022" class="Bound">sA</a> <a id="12053" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12055" href="Varieties.FreeAlgebras.html#12025" class="Bound">h</a><a id="12056" class="Symbol">)</a>

 <a id="12060" href="Varieties.FreeAlgebras.html#12060" class="Function">ψlemma0-ap</a> <a id="12071" class="Symbol">:</a> <a id="12073" class="Symbol">{</a><a id="12074" href="Varieties.FreeAlgebras.html#12074" class="Bound">𝑨</a> <a id="12076" class="Symbol">:</a> <a id="12078" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="12086" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12088" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12089" class="Symbol">}{</a><a id="12091" href="Varieties.FreeAlgebras.html#12091" class="Bound">h</a> <a id="12093" class="Symbol">:</a> <a id="12095" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="12097" class="Symbol">→</a> <a id="12099" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12101" href="Varieties.FreeAlgebras.html#12074" class="Bound">𝑨</a> <a id="12103" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="12104" class="Symbol">}</a> <a id="12106" class="Symbol">→</a> <a id="12108" href="Varieties.FreeAlgebras.html#12074" class="Bound">𝑨</a> <a id="12110" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12112" href="Varieties.Closure.html#3783" class="Datatype">S</a><a id="12113" class="Symbol">{</a><a id="12114" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12115" class="Symbol">}{</a><a id="12117" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12118" class="Symbol">}</a> <a id="12120" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
  <a id="12124" class="Symbol">→</a>           <a id="12136" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="12143" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12145" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="12150" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12152" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="12154" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="12161" class="Symbol">(</a><a id="12162" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12172" href="Varieties.FreeAlgebras.html#12074" class="Bound">𝑨</a> <a id="12174" href="Varieties.FreeAlgebras.html#12091" class="Bound">h</a><a id="12175" class="Symbol">)</a>

 <a id="12179" href="Varieties.FreeAlgebras.html#12060" class="Function">ψlemma0-ap</a> <a id="12190" class="Symbol">{</a><a id="12191" href="Varieties.FreeAlgebras.html#12191" class="Bound">𝑨</a><a id="12192" class="Symbol">}{</a><a id="12194" href="Varieties.FreeAlgebras.html#12194" class="Bound">h</a><a id="12195" class="Symbol">}</a> <a id="12197" href="Varieties.FreeAlgebras.html#12197" class="Bound">skA</a> <a id="12201" class="Symbol">{</a><a id="12202" href="Varieties.FreeAlgebras.html#12202" class="Bound">p</a> <a id="12204" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12206" href="Varieties.FreeAlgebras.html#12206" class="Bound">q</a><a id="12207" class="Symbol">}</a> <a id="12209" href="Varieties.FreeAlgebras.html#12209" class="Bound">x</a> <a id="12211" class="Symbol">=</a> <a id="12213" href="Varieties.FreeAlgebras.html#12356" class="Function">γ</a> <a id="12215" class="Keyword">where</a>

  <a id="12224" href="Varieties.FreeAlgebras.html#12224" class="Function">ν</a> <a id="12226" class="Symbol">:</a> <a id="12228" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12230" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="12235" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12237" href="Varieties.FreeAlgebras.html#12202" class="Bound">p</a> <a id="12239" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12241" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12243" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="12248" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12250" href="Varieties.FreeAlgebras.html#12206" class="Bound">q</a>
  <a id="12254" href="Varieties.FreeAlgebras.html#12224" class="Function">ν</a> <a id="12256" class="Symbol">=</a> <a id="12258" href="Homomorphisms.Kernels.html#5023" class="Function">ker-in-con</a> <a id="12269" class="Symbol">{</a><a id="12270" class="Argument">α</a> <a id="12272" class="Symbol">=</a> <a id="12274" class="Symbol">(</a><a id="12275" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12278" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12279" class="Symbol">)}{</a><a id="12282" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12285" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12286" class="Symbol">}{</a><a id="12288" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="12290" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="12291" class="Symbol">}{</a><a id="12293" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="12296" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12298" class="Symbol">(</a><a id="12299" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12304" class="Symbol">(</a><a id="12305" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12308" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12309" class="Symbol">))}(</a><a id="12313" href="Homomorphisms.Kernels.html#2617" class="Function">kercon</a> <a id="12320" class="Symbol">(</a><a id="12321" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="12324" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12326" class="Symbol">(</a><a id="12327" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12330" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12331" class="Symbol">))</a> <a id="12334" class="Symbol">{</a><a id="12335" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a><a id="12336" class="Symbol">}</a> <a id="12338" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a><a id="12342" class="Symbol">)</a> <a id="12344" class="Symbol">{</a><a id="12345" href="Varieties.FreeAlgebras.html#12202" class="Bound">p</a><a id="12346" class="Symbol">}{</a><a id="12348" href="Varieties.FreeAlgebras.html#12206" class="Bound">q</a><a id="12349" class="Symbol">}</a> <a id="12351" href="Varieties.FreeAlgebras.html#12209" class="Bound">x</a>

  <a id="12356" href="Varieties.FreeAlgebras.html#12356" class="Function">γ</a> <a id="12358" class="Symbol">:</a> <a id="12360" class="Symbol">(</a><a id="12361" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12371" href="Varieties.FreeAlgebras.html#12191" class="Bound">𝑨</a> <a id="12373" href="Varieties.FreeAlgebras.html#12194" class="Bound">h</a><a id="12374" class="Symbol">)</a> <a id="12376" href="Varieties.FreeAlgebras.html#12202" class="Bound">p</a> <a id="12378" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12380" class="Symbol">(</a><a id="12381" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="12391" href="Varieties.FreeAlgebras.html#12191" class="Bound">𝑨</a> <a id="12393" href="Varieties.FreeAlgebras.html#12194" class="Bound">h</a><a id="12394" class="Symbol">)</a> <a id="12396" href="Varieties.FreeAlgebras.html#12206" class="Bound">q</a>
  <a id="12400" href="Varieties.FreeAlgebras.html#12356" class="Function">γ</a> <a id="12402" class="Symbol">=</a> <a id="12404" class="Symbol">((</a><a id="12406" href="Varieties.FreeAlgebras.html#11940" class="Function">ψlemma0</a> <a id="12414" href="Varieties.FreeAlgebras.html#12202" class="Bound">p</a> <a id="12416" href="Varieties.FreeAlgebras.html#12206" class="Bound">q</a><a id="12417" class="Symbol">)</a> <a id="12419" href="Varieties.FreeAlgebras.html#12224" class="Function">ν</a><a id="12420" class="Symbol">)</a> <a id="12422" href="Varieties.FreeAlgebras.html#12191" class="Bound">𝑨</a> <a id="12424" href="Varieties.FreeAlgebras.html#12197" class="Bound">skA</a> <a id="12428" href="Varieties.FreeAlgebras.html#12194" class="Bound">h</a>


</pre>

We now use `ψlemma0-ap` to prove that every map `h : X → ∣ 𝑨 ∣`, from `X` to a subalgebra `𝑨 ∈ S 𝒦` of `𝒦`, lifts to a homomorphism from `𝔽` to `𝑨`.

<pre class="Agda">

 <a id="12609" href="Varieties.FreeAlgebras.html#12609" class="Function">𝔽-lift-hom</a> <a id="12620" class="Symbol">:</a> <a id="12622" class="Symbol">(</a><a id="12623" href="Varieties.FreeAlgebras.html#12623" class="Bound">𝑨</a> <a id="12625" class="Symbol">:</a> <a id="12627" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="12635" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="12637" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="12638" class="Symbol">)</a> <a id="12640" class="Symbol">→</a> <a id="12642" href="Varieties.FreeAlgebras.html#12623" class="Bound">𝑨</a> <a id="12644" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="12646" href="Varieties.Closure.html#3783" class="Datatype">S</a><a id="12647" class="Symbol">{</a><a id="12648" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12649" class="Symbol">}{</a><a id="12651" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12652" class="Symbol">}</a> <a id="12654" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="12656" class="Symbol">→</a> <a id="12658" class="Symbol">(</a><a id="12659" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="12661" class="Symbol">→</a> <a id="12663" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="12665" href="Varieties.FreeAlgebras.html#12623" class="Bound">𝑨</a> <a id="12667" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="12668" class="Symbol">)</a> <a id="12670" class="Symbol">→</a> <a id="12672" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="12676" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="12678" href="Varieties.FreeAlgebras.html#12623" class="Bound">𝑨</a>
 <a id="12681" href="Varieties.FreeAlgebras.html#12609" class="Function">𝔽-lift-hom</a> <a id="12692" href="Varieties.FreeAlgebras.html#12692" class="Bound">𝑨</a> <a id="12694" href="Varieties.FreeAlgebras.html#12694" class="Bound">skA</a> <a id="12698" href="Varieties.FreeAlgebras.html#12698" class="Bound">h</a> <a id="12700" class="Symbol">=</a> <a id="12702" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a><a id="12705" class="Symbol">(</a><a id="12706" href="Homomorphisms.Factor.html#1848" class="Function">HomFactor</a> <a id="12716" class="Symbol">(</a><a id="12717" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="12720" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="12722" class="Symbol">(</a><a id="12723" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="12728" class="Symbol">(</a><a id="12729" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="12732" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="12733" class="Symbol">)))</a>  <a id="12738" href="Varieties.FreeAlgebras.html#12692" class="Bound">𝑨</a> <a id="12740" class="Symbol">(</a><a id="12741" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="12750" href="Varieties.FreeAlgebras.html#12692" class="Bound">𝑨</a> <a id="12752" href="Varieties.FreeAlgebras.html#12698" class="Bound">h</a><a id="12753" class="Symbol">)</a> <a id="12755" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="12760" class="Symbol">(</a><a id="12761" href="Varieties.FreeAlgebras.html#12060" class="Function">ψlemma0-ap</a> <a id="12772" href="Varieties.FreeAlgebras.html#12694" class="Bound">skA</a><a id="12775" class="Symbol">)</a> <a id="12777" href="Varieties.FreeAlgebras.html#11778" class="Function">hom𝔽-is-epic</a><a id="12789" class="Symbol">)</a>

</pre>


#### <a id="k-models-psi">𝒦 models ψ</a>

The goal of this subsection is to prove that `𝒦` models `ψ 𝒦`. In other terms, for all pairs `(p , q) ∈ Term X × Term X` of terms, if `(p , q) ∈ ψ 𝒦`, then `𝒦 ⊫ p ≈ q`.

Next we define the lift of the natural embedding from `X` into 𝔽. We denote this homomorphism by `𝔑 : hom (𝑻 X) 𝔽` and define it as follows.

<pre class="Agda">

 <a id="13174" class="Keyword">open</a> <a id="13179" href="Algebras.Congruences.html#1800" class="Module">IsCongruence</a>

 <a id="13194" href="Varieties.FreeAlgebras.html#13194" class="Function">X↪𝔽</a> <a id="13198" class="Symbol">:</a> <a id="13200" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="13202" class="Symbol">→</a> <a id="13204" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13206" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="13208" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a>
 <a id="13211" href="Varieties.FreeAlgebras.html#13194" class="Function">X↪𝔽</a> <a id="13215" href="Varieties.FreeAlgebras.html#13215" class="Bound">x</a> <a id="13217" class="Symbol">=</a> <a id="13219" href="Relations.Quotients.html#5376" class="Function Operator">⟪</a> <a id="13221" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13223" href="Varieties.FreeAlgebras.html#13215" class="Bound">x</a> <a id="13225" href="Relations.Quotients.html#5376" class="Function Operator">⟫</a> <a id="13227" class="Comment">-- (the implicit relation here is  ⟨ kercon (fe 𝓥 𝓕) ℭ homℭ ⟩ )</a>

 <a id="13293" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13295" class="Symbol">:</a> <a id="13297" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="13301" class="Symbol">(</a><a id="13302" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="13304" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="13305" class="Symbol">)</a> <a id="13307" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a>
 <a id="13310" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13312" class="Symbol">=</a> <a id="13314" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="13323" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="13325" href="Varieties.FreeAlgebras.html#13194" class="Function">X↪𝔽</a>

</pre>

It turns out that the homomorphism so defined is equivalent to `hom𝔽`.

<pre class="Agda">
 <a id="13428" class="Keyword">open</a> <a id="13433" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>

 <a id="13447" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a> <a id="13464" class="Symbol">:</a> <a id="13466" class="Symbol">∀</a> <a id="13468" href="Varieties.FreeAlgebras.html#13468" class="Bound">p</a> <a id="13470" class="Symbol">→</a> <a id="13472" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13474" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13476" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13478" href="Varieties.FreeAlgebras.html#13468" class="Bound">p</a> <a id="13480" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13482" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13484" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="13489" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13491" href="Varieties.FreeAlgebras.html#13468" class="Bound">p</a>
 <a id="13494" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a> <a id="13511" class="Symbol">(</a><a id="13512" href="Terms.Basic.html#2032" class="InductiveConstructor">ℊ</a> <a id="13514" href="Varieties.FreeAlgebras.html#13514" class="Bound">x</a><a id="13515" class="Symbol">)</a> <a id="13517" class="Symbol">=</a> <a id="13519" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
 <a id="13525" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a> <a id="13542" class="Symbol">(</a><a id="13543" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13548" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13550" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a><a id="13551" class="Symbol">)</a> <a id="13553" class="Symbol">=</a>
  <a id="13557" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13559" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13561" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13563" class="Symbol">(</a><a id="13564" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13569" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13571" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a><a id="13572" class="Symbol">)</a>              <a id="13587" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13590" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="13592" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13594" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="13596" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13598" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13600" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13604" class="Symbol">(</a><a id="13605" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13607" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13609" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a><a id="13610" class="Symbol">)(λ</a> <a id="13614" href="Varieties.FreeAlgebras.html#13614" class="Bound">i</a> <a id="13616" class="Symbol">→</a> <a id="13618" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13620" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13622" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="13623" class="Symbol">(</a><a id="13624" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13626" href="Varieties.FreeAlgebras.html#13614" class="Bound">i</a><a id="13627" class="Symbol">))</a>     <a id="13634" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13637" href="Varieties.FreeAlgebras.html#13745" class="Function">wd-proof</a> <a id="13646" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13650" class="Symbol">(</a><a id="13651" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13653" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13655" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a><a id="13656" class="Symbol">)(λ</a> <a id="13660" href="Varieties.FreeAlgebras.html#13660" class="Bound">i</a> <a id="13662" class="Symbol">→</a> <a id="13664" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13666" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="13671" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13673" class="Symbol">(</a><a id="13674" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13676" href="Varieties.FreeAlgebras.html#13660" class="Bound">i</a><a id="13677" class="Symbol">))</a> <a id="13680" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="13683" class="Symbol">(</a><a id="13684" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="13686" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="13691" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="13693" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13695" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a><a id="13696" class="Symbol">)</a><a id="13697" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a> <a id="13700" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
  <a id="13704" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13706" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="13711" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13713" class="Symbol">(</a><a id="13714" href="Terms.Basic.html#2074" class="InductiveConstructor">node</a> <a id="13719" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13721" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a><a id="13722" class="Symbol">)</a>           <a id="13734" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>
   <a id="13739" class="Keyword">where</a> <a id="13745" href="Varieties.FreeAlgebras.html#13745" class="Function">wd-proof</a> <a id="13754" class="Symbol">=</a> <a id="13756" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="13759" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="13761" class="Symbol">(</a><a id="13762" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="13767" class="Symbol">(</a><a id="13768" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="13771" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="13772" class="Symbol">))</a>
                    <a id="13795" class="Symbol">(</a><a id="13796" href="Varieties.FreeAlgebras.html#13548" class="Bound">𝑓</a> <a id="13798" href="Algebras.Basic.html#9397" class="Function Operator">̂</a> <a id="13800" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a><a id="13801" class="Symbol">)</a> <a id="13803" class="Symbol">(λ</a> <a id="13806" href="Varieties.FreeAlgebras.html#13806" class="Bound">i</a> <a id="13808" class="Symbol">→</a> <a id="13810" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13812" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="13814" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="13815" class="Symbol">(</a><a id="13816" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13818" href="Varieties.FreeAlgebras.html#13806" class="Bound">i</a><a id="13819" class="Symbol">))</a> <a id="13822" class="Symbol">(λ</a> <a id="13825" href="Varieties.FreeAlgebras.html#13825" class="Bound">i</a> <a id="13827" class="Symbol">→</a> <a id="13829" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13831" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="13836" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="13838" class="Symbol">(</a><a id="13839" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13841" href="Varieties.FreeAlgebras.html#13825" class="Bound">i</a><a id="13842" class="Symbol">))</a>
                    <a id="13865" class="Symbol">(λ</a> <a id="13868" href="Varieties.FreeAlgebras.html#13868" class="Bound">x</a> <a id="13870" class="Symbol">→</a> <a id="13872" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a><a id="13888" class="Symbol">(</a><a id="13889" href="Varieties.FreeAlgebras.html#13550" class="Bound">𝒕</a> <a id="13891" href="Varieties.FreeAlgebras.html#13868" class="Bound">x</a><a id="13892" class="Symbol">))</a>
</pre>

We need a three more lemmas before we are ready to tackle our main goal.

<pre class="Agda">

 <a id="13996" href="Varieties.FreeAlgebras.html#13996" class="Function">ψlemma1</a> <a id="14004" class="Symbol">:</a> <a id="14006" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="14013" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14015" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="14017" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14019" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14021" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="14023" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
 <a id="14026" href="Varieties.FreeAlgebras.html#13996" class="Function">ψlemma1</a> <a id="14034" class="Symbol">{</a><a id="14035" href="Varieties.FreeAlgebras.html#14035" class="Bound">p</a> <a id="14037" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14039" href="Varieties.FreeAlgebras.html#14039" class="Bound">q</a><a id="14040" class="Symbol">}</a> <a id="14042" href="Varieties.FreeAlgebras.html#14042" class="Bound">𝔑pq</a> <a id="14046" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a> <a id="14048" href="Varieties.FreeAlgebras.html#14048" class="Bound">sA</a> <a id="14051" href="Varieties.FreeAlgebras.html#14051" class="Bound">h</a> <a id="14053" class="Symbol">=</a> <a id="14055" href="Varieties.FreeAlgebras.html#14276" class="Function">γ</a>
  <a id="14059" class="Keyword">where</a>
   <a id="14068" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14070" class="Symbol">:</a> <a id="14072" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="14076" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="14078" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a>
   <a id="14083" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14085" class="Symbol">=</a> <a id="14087" href="Varieties.FreeAlgebras.html#12609" class="Function">𝔽-lift-hom</a> <a id="14098" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a> <a id="14100" href="Varieties.FreeAlgebras.html#14048" class="Bound">sA</a> <a id="14103" href="Varieties.FreeAlgebras.html#14051" class="Bound">h</a>

   <a id="14109" href="Varieties.FreeAlgebras.html#14109" class="Function">h&#39;</a> <a id="14112" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14114" class="Symbol">:</a> <a id="14116" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="14120" class="Symbol">(</a><a id="14121" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="14123" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="14124" class="Symbol">)</a> <a id="14126" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a>
   <a id="14131" href="Varieties.FreeAlgebras.html#14109" class="Function">h&#39;</a> <a id="14134" class="Symbol">=</a> <a id="14136" href="Homomorphisms.Properties.html#1366" class="Function">∘-hom</a> <a id="14142" class="Symbol">(</a><a id="14143" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="14145" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="14146" class="Symbol">)</a> <a id="14148" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a> <a id="14150" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="14152" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a>
   <a id="14157" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14159" class="Symbol">=</a> <a id="14161" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="14170" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a> <a id="14172" href="Varieties.FreeAlgebras.html#14051" class="Bound">h</a>

   <a id="14178" href="Varieties.FreeAlgebras.html#14178" class="Function">h≡φ</a> <a id="14182" class="Symbol">:</a> <a id="14184" class="Symbol">∀</a> <a id="14186" href="Varieties.FreeAlgebras.html#14186" class="Bound">t</a> <a id="14188" class="Symbol">→</a> <a id="14190" class="Symbol">(</a><a id="14191" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14193" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14195" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14197" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="14199" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14201" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="14203" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="14204" class="Symbol">)</a> <a id="14206" href="Varieties.FreeAlgebras.html#14186" class="Bound">t</a> <a id="14208" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14210" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14212" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14214" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14216" href="Varieties.FreeAlgebras.html#14186" class="Bound">t</a>
   <a id="14221" href="Varieties.FreeAlgebras.html#14178" class="Function">h≡φ</a> <a id="14225" href="Varieties.FreeAlgebras.html#14225" class="Bound">t</a> <a id="14227" class="Symbol">=</a> <a id="14229" href="Terms.Properties.html#3635" class="Function">free-unique</a> <a id="14241" class="Symbol">(</a><a id="14242" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="14245" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14247" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14248" class="Symbol">)</a> <a id="14250" href="Varieties.FreeAlgebras.html#14046" class="Bound">𝑨</a> <a id="14252" href="Varieties.FreeAlgebras.html#14109" class="Function">h&#39;</a> <a id="14255" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14257" class="Symbol">(λ</a> <a id="14260" href="Varieties.FreeAlgebras.html#14260" class="Bound">x</a> <a id="14262" class="Symbol">→</a> <a id="14264" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="14268" class="Symbol">)</a> <a id="14270" href="Varieties.FreeAlgebras.html#14225" class="Bound">t</a>

   <a id="14276" href="Varieties.FreeAlgebras.html#14276" class="Function">γ</a> <a id="14278" class="Symbol">:</a> <a id="14280" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14282" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14284" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14286" href="Varieties.FreeAlgebras.html#14035" class="Bound">p</a> <a id="14288" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14290" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14292" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14294" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14296" href="Varieties.FreeAlgebras.html#14039" class="Bound">q</a>
   <a id="14301" href="Varieties.FreeAlgebras.html#14276" class="Function">γ</a> <a id="14303" class="Symbol">=</a> <a id="14305" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14307" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14309" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14311" href="Varieties.FreeAlgebras.html#14035" class="Bound">p</a>             <a id="14325" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14328" class="Symbol">(</a><a id="14329" href="Varieties.FreeAlgebras.html#14178" class="Function">h≡φ</a> <a id="14333" href="Varieties.FreeAlgebras.html#14035" class="Bound">p</a><a id="14334" class="Symbol">)</a><a id="14335" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a> <a id="14338" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14347" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14349" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14351" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14353" class="Symbol">(</a> <a id="14355" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14357" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="14359" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14361" href="Varieties.FreeAlgebras.html#14035" class="Bound">p</a> <a id="14363" class="Symbol">)</a>   <a id="14367" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14370" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a> <a id="14375" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14377" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14379" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14381" href="Varieties.FreeAlgebras.html#14042" class="Bound">𝔑pq</a> <a id="14385" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14394" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14396" href="Varieties.FreeAlgebras.html#14068" class="Function">f</a> <a id="14398" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14400" class="Symbol">(</a> <a id="14402" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14404" href="Varieties.FreeAlgebras.html#13293" class="Function">𝔑</a> <a id="14406" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14408" href="Varieties.FreeAlgebras.html#14039" class="Bound">q</a> <a id="14410" class="Symbol">)</a>   <a id="14414" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14417" href="Varieties.FreeAlgebras.html#14178" class="Function">h≡φ</a> <a id="14421" href="Varieties.FreeAlgebras.html#14039" class="Bound">q</a> <a id="14423" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
       <a id="14432" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14434" href="Varieties.FreeAlgebras.html#14112" class="Function">φ</a> <a id="14436" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14438" href="Varieties.FreeAlgebras.html#14039" class="Bound">q</a>             <a id="14452" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>


 <a id="14457" href="Varieties.FreeAlgebras.html#14457" class="Function">ψlemma2</a> <a id="14465" class="Symbol">:</a> <a id="14467" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="14474" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14476" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="14481" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="14483" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="14485" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a> <a id="14487" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
 <a id="14490" href="Varieties.FreeAlgebras.html#14457" class="Function">ψlemma2</a> <a id="14498" class="Symbol">{</a><a id="14499" href="Varieties.FreeAlgebras.html#14499" class="Bound">p</a> <a id="14501" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14503" href="Varieties.FreeAlgebras.html#14503" class="Bound">q</a><a id="14504" class="Symbol">}</a> <a id="14506" href="Varieties.FreeAlgebras.html#14506" class="Bound">x</a> <a id="14508" class="Symbol">=</a> <a id="14510" href="Varieties.FreeAlgebras.html#13996" class="Function">ψlemma1</a> <a id="14518" class="Symbol">{</a><a id="14519" href="Varieties.FreeAlgebras.html#14499" class="Bound">p</a> <a id="14521" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14523" href="Varieties.FreeAlgebras.html#14503" class="Bound">q</a><a id="14524" class="Symbol">}</a> <a id="14526" href="Varieties.FreeAlgebras.html#14541" class="Function">γ</a>
   <a id="14531" class="Keyword">where</a>
    <a id="14541" href="Varieties.FreeAlgebras.html#14541" class="Function">γ</a> <a id="14543" class="Symbol">:</a> <a id="14545" class="Symbol">(</a><a id="14546" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14556" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="14558" href="Varieties.FreeAlgebras.html#13194" class="Function">X↪𝔽</a><a id="14561" class="Symbol">)</a> <a id="14563" href="Varieties.FreeAlgebras.html#14499" class="Bound">p</a> <a id="14565" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14567" class="Symbol">(</a><a id="14568" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14578" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="14580" href="Varieties.FreeAlgebras.html#13194" class="Function">X↪𝔽</a><a id="14583" class="Symbol">)</a> <a id="14585" href="Varieties.FreeAlgebras.html#14503" class="Bound">q</a>
    <a id="14591" href="Varieties.FreeAlgebras.html#14541" class="Function">γ</a> <a id="14593" class="Symbol">=</a> <a id="14595" class="Symbol">(</a><a id="14596" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a> <a id="14613" href="Varieties.FreeAlgebras.html#14499" class="Bound">p</a><a id="14614" class="Symbol">)</a> <a id="14616" href="Overture.Preliminaries.html#5301" class="Function Operator">∙</a> <a id="14618" href="Varieties.FreeAlgebras.html#14506" class="Bound">x</a> <a id="14620" href="Overture.Preliminaries.html#5301" class="Function Operator">∙</a> <a id="14622" class="Symbol">(</a><a id="14623" href="Varieties.FreeAlgebras.html#13447" class="Function">hom𝔽-is-lift-hom</a> <a id="14640" href="Varieties.FreeAlgebras.html#14503" class="Bound">q</a><a id="14641" class="Symbol">)</a><a id="14642" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a>


 <a id="14648" href="Varieties.FreeAlgebras.html#14648" class="Function">ψlemma3</a> <a id="14656" class="Symbol">:</a> <a id="14658" class="Symbol">∀</a> <a id="14660" href="Varieties.FreeAlgebras.html#14660" class="Bound">p</a> <a id="14662" href="Varieties.FreeAlgebras.html#14662" class="Bound">q</a> <a id="14664" class="Symbol">→</a> <a id="14666" class="Symbol">(</a><a id="14667" href="Varieties.FreeAlgebras.html#14660" class="Bound">p</a> <a id="14669" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="14671" href="Varieties.FreeAlgebras.html#14662" class="Bound">q</a><a id="14672" class="Symbol">)</a> <a id="14674" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="14676" href="Varieties.FreeAlgebras.html#6335" class="Function">ψ</a><a id="14677" class="Symbol">{</a><a id="14678" class="Argument">X</a> <a id="14680" class="Symbol">=</a> <a id="14682" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="14683" class="Symbol">}</a> <a id="14685" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="14687" class="Symbol">→</a> <a id="14689" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="14691" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="14693" href="Varieties.FreeAlgebras.html#14660" class="Bound">p</a> <a id="14695" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="14697" href="Varieties.FreeAlgebras.html#14662" class="Bound">q</a>
 <a id="14700" href="Varieties.FreeAlgebras.html#14648" class="Function">ψlemma3</a> <a id="14708" href="Varieties.FreeAlgebras.html#14708" class="Bound">p</a> <a id="14710" href="Varieties.FreeAlgebras.html#14710" class="Bound">q</a> <a id="14712" href="Varieties.FreeAlgebras.html#14712" class="Bound">pψq</a> <a id="14716" class="Symbol">{</a><a id="14717" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a><a id="14718" class="Symbol">}</a> <a id="14720" href="Varieties.FreeAlgebras.html#14720" class="Bound">kA</a> <a id="14723" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a> <a id="14725" class="Symbol">=</a> <a id="14727" href="Varieties.FreeAlgebras.html#14744" class="Function">goal</a>
   <a id="14735" class="Keyword">where</a>
   <a id="14744" href="Varieties.FreeAlgebras.html#14744" class="Function">goal</a> <a id="14749" class="Symbol">:</a> <a id="14751" class="Symbol">(</a><a id="14752" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14754" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14756" href="Varieties.FreeAlgebras.html#14708" class="Bound">p</a> <a id="14758" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14759" class="Symbol">)</a> <a id="14761" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a> <a id="14763" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14765" class="Symbol">(</a><a id="14766" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14768" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14770" href="Varieties.FreeAlgebras.html#14710" class="Bound">q</a> <a id="14772" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14773" class="Symbol">)</a> <a id="14775" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a>
   <a id="14780" href="Varieties.FreeAlgebras.html#14744" class="Function">goal</a> <a id="14785" class="Symbol">=</a> <a id="14787" class="Symbol">(</a><a id="14788" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14790" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="14792" href="Varieties.FreeAlgebras.html#14708" class="Bound">p</a> <a id="14794" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="14795" class="Symbol">)</a> <a id="14797" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a>       <a id="14805" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14808" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="14825" class="Symbol">(</a><a id="14826" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="14829" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14831" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14832" class="Symbol">)</a> <a id="14834" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14836" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a> <a id="14838" href="Varieties.FreeAlgebras.html#14708" class="Bound">p</a> <a id="14840" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14852" class="Symbol">(</a><a id="14853" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14863" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14865" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a><a id="14866" class="Symbol">)</a> <a id="14868" href="Varieties.FreeAlgebras.html#14708" class="Bound">p</a> <a id="14870" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14873" href="Varieties.FreeAlgebras.html#14712" class="Bound">pψq</a> <a id="14877" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14879" class="Symbol">(</a><a id="14880" href="Varieties.Closure.html#4069" class="InductiveConstructor">siso</a> <a id="14885" class="Symbol">(</a><a id="14886" href="Varieties.Closure.html#3871" class="InductiveConstructor">sbase</a> <a id="14892" href="Varieties.FreeAlgebras.html#14720" class="Bound">kA</a><a id="14894" class="Symbol">)</a> <a id="14896" class="Symbol">(</a><a id="14897" href="Homomorphisms.Isomorphisms.html#2964" class="Function">≅-sym</a> <a id="14903" href="Homomorphisms.Isomorphisms.html#4408" class="Function">Lift-≅</a><a id="14909" class="Symbol">))</a> <a id="14912" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a> <a id="14914" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14926" class="Symbol">(</a><a id="14927" href="Terms.Properties.html#2529" class="Function">free-lift</a> <a id="14937" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14939" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a><a id="14940" class="Symbol">)</a> <a id="14942" href="Varieties.FreeAlgebras.html#14710" class="Bound">q</a> <a id="14944" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="14947" class="Symbol">(</a><a id="14948" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="14965" class="Symbol">(</a><a id="14966" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="14969" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="14971" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="14972" class="Symbol">)</a> <a id="14974" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14976" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a> <a id="14978" href="Varieties.FreeAlgebras.html#14710" class="Bound">q</a><a id="14979" class="Symbol">)</a><a id="14980" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a>  <a id="14984" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
          <a id="14996" class="Symbol">(</a><a id="14997" href="Varieties.FreeAlgebras.html#14717" class="Bound">𝑨</a> <a id="14999" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="15001" href="Varieties.FreeAlgebras.html#14710" class="Bound">q</a> <a id="15003" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="15004" class="Symbol">)</a> <a id="15006" href="Varieties.FreeAlgebras.html#14723" class="Bound">h</a>       <a id="15014" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

</pre>

With these results in hand, it is now trivial to prove the main theorem of this subsection.

<pre class="Agda">

 <a id="15137" href="Varieties.FreeAlgebras.html#15137" class="Function">class-models-kernel</a> <a id="15157" class="Symbol">:</a> <a id="15159" class="Symbol">∀</a> <a id="15161" href="Varieties.FreeAlgebras.html#15161" class="Bound">p</a> <a id="15163" href="Varieties.FreeAlgebras.html#15163" class="Bound">q</a> <a id="15165" class="Symbol">→</a> <a id="15167" class="Symbol">(</a><a id="15168" href="Varieties.FreeAlgebras.html#15161" class="Bound">p</a> <a id="15170" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15172" href="Varieties.FreeAlgebras.html#15163" class="Bound">q</a><a id="15173" class="Symbol">)</a> <a id="15175" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15177" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15184" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15186" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="15191" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15193" class="Symbol">→</a> <a id="15195" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="15197" href="Varieties.EquationalLogic.html#2716" class="Function Operator">⊫</a> <a id="15199" href="Varieties.FreeAlgebras.html#15161" class="Bound">p</a> <a id="15201" href="Varieties.EquationalLogic.html#2716" class="Function Operator">≈</a> <a id="15203" href="Varieties.FreeAlgebras.html#15163" class="Bound">q</a>
 <a id="15206" href="Varieties.FreeAlgebras.html#15137" class="Function">class-models-kernel</a> <a id="15226" href="Varieties.FreeAlgebras.html#15226" class="Bound">p</a> <a id="15228" href="Varieties.FreeAlgebras.html#15228" class="Bound">q</a> <a id="15230" href="Varieties.FreeAlgebras.html#15230" class="Bound">x</a> <a id="15232" class="Symbol">=</a> <a id="15234" href="Varieties.FreeAlgebras.html#14648" class="Function">ψlemma3</a> <a id="15242" href="Varieties.FreeAlgebras.html#15226" class="Bound">p</a> <a id="15244" href="Varieties.FreeAlgebras.html#15228" class="Bound">q</a> <a id="15246" class="Symbol">(</a><a id="15247" href="Varieties.FreeAlgebras.html#14457" class="Function">ψlemma2</a> <a id="15255" href="Varieties.FreeAlgebras.html#15230" class="Bound">x</a><a id="15256" class="Symbol">)</a>

 <a id="15260" href="Varieties.FreeAlgebras.html#15260" class="Function">𝕍𝒦</a> <a id="15263" class="Symbol">:</a> <a id="15265" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="15270" class="Symbol">(</a><a id="15271" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15279" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="15282" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15283" class="Symbol">)</a> <a id="15285" class="Symbol">(</a><a id="15286" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="15291" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="15293" class="Symbol">)</a>
 <a id="15296" href="Varieties.FreeAlgebras.html#15260" class="Function">𝕍𝒦</a> <a id="15299" class="Symbol">=</a> <a id="15301" href="Varieties.Closure.html#5312" class="Datatype">V</a><a id="15302" class="Symbol">{</a><a id="15303" class="Argument">α</a> <a id="15305" class="Symbol">=</a> <a id="15307" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="15308" class="Symbol">}{</a><a id="15310" class="Argument">β</a> <a id="15312" class="Symbol">=</a> <a id="15314" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="15316" class="Symbol">}</a> <a id="15318" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>

 <a id="15322" href="Varieties.FreeAlgebras.html#15322" class="Function">kernel-in-theory&#39;</a> <a id="15340" class="Symbol">:</a> <a id="15342" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15349" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15351" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="15356" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15358" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15360" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a> <a id="15363" class="Symbol">(</a><a id="15364" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="15366" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a><a id="15367" class="Symbol">)</a>
 <a id="15370" href="Varieties.FreeAlgebras.html#15322" class="Function">kernel-in-theory&#39;</a> <a id="15388" class="Symbol">{</a><a id="15389" href="Varieties.FreeAlgebras.html#15389" class="Bound">p</a> <a id="15391" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15393" href="Varieties.FreeAlgebras.html#15393" class="Bound">q</a><a id="15394" class="Symbol">}</a> <a id="15396" href="Varieties.FreeAlgebras.html#15396" class="Bound">pKq</a> <a id="15400" class="Symbol">=</a> <a id="15402" class="Symbol">(</a><a id="15403" href="Varieties.Preservation.html#20465" class="Function">class-ids-⇒</a> <a id="15415" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="15418" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="15421" href="Varieties.FreeAlgebras.html#15389" class="Bound">p</a> <a id="15423" href="Varieties.FreeAlgebras.html#15393" class="Bound">q</a> <a id="15425" class="Symbol">(</a><a id="15426" href="Varieties.FreeAlgebras.html#15137" class="Function">class-models-kernel</a> <a id="15446" href="Varieties.FreeAlgebras.html#15389" class="Bound">p</a> <a id="15448" href="Varieties.FreeAlgebras.html#15393" class="Bound">q</a> <a id="15450" href="Varieties.FreeAlgebras.html#15396" class="Bound">pKq</a><a id="15453" class="Symbol">))</a>

 <a id="15458" href="Varieties.FreeAlgebras.html#15458" class="Function">kernel-in-theory</a> <a id="15475" class="Symbol">:</a> <a id="15477" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15484" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15486" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="15491" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15493" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="15495" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a> <a id="15498" href="Varieties.FreeAlgebras.html#15260" class="Function">𝕍𝒦</a>
 <a id="15502" href="Varieties.FreeAlgebras.html#15458" class="Function">kernel-in-theory</a> <a id="15519" class="Symbol">{</a><a id="15520" href="Varieties.FreeAlgebras.html#15520" class="Bound">p</a> <a id="15522" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15524" href="Varieties.FreeAlgebras.html#15524" class="Bound">q</a><a id="15525" class="Symbol">}</a> <a id="15527" href="Varieties.FreeAlgebras.html#15527" class="Bound">pKq</a> <a id="15531" href="Varieties.FreeAlgebras.html#15531" class="Bound">vkA</a> <a id="15535" href="Varieties.FreeAlgebras.html#15535" class="Bound">x</a> <a id="15537" class="Symbol">=</a> <a id="15539" href="Varieties.Preservation.html#20578" class="Function">class-ids</a> <a id="15549" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="15552" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="15555" href="Varieties.FreeAlgebras.html#15520" class="Bound">p</a> <a id="15557" href="Varieties.FreeAlgebras.html#15524" class="Bound">q</a> <a id="15559" class="Symbol">(</a><a id="15560" href="Varieties.FreeAlgebras.html#15137" class="Function">class-models-kernel</a> <a id="15580" href="Varieties.FreeAlgebras.html#15520" class="Bound">p</a> <a id="15582" href="Varieties.FreeAlgebras.html#15524" class="Bound">q</a> <a id="15584" href="Varieties.FreeAlgebras.html#15527" class="Bound">pKq</a><a id="15587" class="Symbol">)</a> <a id="15589" href="Varieties.FreeAlgebras.html#15531" class="Bound">vkA</a> <a id="15593" href="Varieties.FreeAlgebras.html#15535" class="Bound">x</a>

 <a id="15597" href="Varieties.FreeAlgebras.html#15597" class="Function Operator">_↠_</a> <a id="15601" class="Symbol">:</a> <a id="15603" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15608" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a> <a id="15610" class="Symbol">→</a> <a id="15612" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15620" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="15623" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a> <a id="15625" class="Symbol">→</a> <a id="15627" href="Varieties.FreeAlgebras.html#1282" class="Primitive">Type</a> <a id="15632" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a>
 <a id="15636" href="Varieties.FreeAlgebras.html#15636" class="Bound">X</a> <a id="15638" href="Varieties.FreeAlgebras.html#15597" class="Function Operator">↠</a> <a id="15640" href="Varieties.FreeAlgebras.html#15640" class="Bound">𝑨</a> <a id="15642" class="Symbol">=</a> <a id="15644" href="Data.Product.html#916" class="Function">Σ[</a> <a id="15647" href="Varieties.FreeAlgebras.html#15647" class="Bound">h</a> <a id="15649" href="Data.Product.html#916" class="Function">∈</a> <a id="15651" class="Symbol">(</a><a id="15652" href="Varieties.FreeAlgebras.html#15636" class="Bound">X</a> <a id="15654" class="Symbol">→</a> <a id="15656" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15658" href="Varieties.FreeAlgebras.html#15640" class="Bound">𝑨</a> <a id="15660" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="15661" class="Symbol">)</a> <a id="15663" href="Data.Product.html#916" class="Function">]</a> <a id="15665" href="Overture.Surjective.html#1667" class="Function">IsSurjective</a> <a id="15678" href="Varieties.FreeAlgebras.html#15647" class="Bound">h</a>

 <a id="15682" href="Varieties.FreeAlgebras.html#15682" class="Function">𝔽-ModTh-epi</a> <a id="15694" class="Symbol">:</a> <a id="15696" class="Symbol">(</a><a id="15697" href="Varieties.FreeAlgebras.html#15697" class="Bound">𝑨</a> <a id="15699" class="Symbol">:</a> <a id="15701" href="Algebras.Basic.html#6222" class="Function">Algebra</a> <a id="15709" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="15712" href="Varieties.FreeAlgebras.html#1003" class="Bound">𝑆</a><a id="15713" class="Symbol">)</a> <a id="15715" class="Symbol">→</a> <a id="15717" class="Symbol">(</a><a id="15718" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="15720" href="Varieties.FreeAlgebras.html#15597" class="Function Operator">↠</a> <a id="15722" href="Varieties.FreeAlgebras.html#15697" class="Bound">𝑨</a><a id="15723" class="Symbol">)</a> <a id="15725" class="Symbol">→</a> <a id="15727" href="Varieties.FreeAlgebras.html#15697" class="Bound">𝑨</a> <a id="15729" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15731" href="Varieties.EquationalLogic.html#4084" class="Function">Mod</a> <a id="15735" class="Symbol">(</a><a id="15736" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a> <a id="15739" href="Varieties.FreeAlgebras.html#15260" class="Function">𝕍𝒦</a><a id="15741" class="Symbol">)</a> <a id="15743" class="Symbol">→</a> <a id="15745" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="15749" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="15751" href="Varieties.FreeAlgebras.html#15697" class="Bound">𝑨</a>
 <a id="15754" href="Varieties.FreeAlgebras.html#15682" class="Function">𝔽-ModTh-epi</a> <a id="15766" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="15768" class="Symbol">(</a><a id="15769" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a> <a id="15771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15773" href="Varieties.FreeAlgebras.html#15773" class="Bound">ηE</a><a id="15775" class="Symbol">)</a> <a id="15777" href="Varieties.FreeAlgebras.html#15777" class="Bound">AinMTV</a> <a id="15784" class="Symbol">=</a> <a id="15786" href="Varieties.FreeAlgebras.html#16298" class="Function">goal</a>
  <a id="15793" class="Keyword">where</a>
  <a id="15801" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="15803" class="Symbol">:</a> <a id="15805" href="Homomorphisms.Basic.html#2647" class="Function">hom</a> <a id="15809" class="Symbol">(</a><a id="15810" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="15812" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="15813" class="Symbol">)</a> <a id="15815" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a>
  <a id="15819" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="15821" class="Symbol">=</a> <a id="15823" href="Terms.Properties.html#3236" class="Function">lift-hom</a> <a id="15832" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="15834" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a>

  <a id="15839" href="Varieties.FreeAlgebras.html#15839" class="Function">φE</a> <a id="15842" class="Symbol">:</a> <a id="15844" href="Overture.Surjective.html#1667" class="Function">IsSurjective</a> <a id="15857" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15859" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="15861" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a>
  <a id="15865" href="Varieties.FreeAlgebras.html#15839" class="Function">φE</a> <a id="15868" class="Symbol">=</a> <a id="15870" href="Terms.Properties.html#4841" class="Function">lift-of-epi-is-epi</a> <a id="15889" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="15891" href="Varieties.FreeAlgebras.html#15773" class="Bound">ηE</a>

  <a id="15897" href="Varieties.FreeAlgebras.html#15897" class="Function">pqlem2</a> <a id="15904" class="Symbol">:</a> <a id="15906" class="Symbol">∀</a> <a id="15908" href="Varieties.FreeAlgebras.html#15908" class="Bound">p</a> <a id="15910" href="Varieties.FreeAlgebras.html#15910" class="Bound">q</a> <a id="15912" class="Symbol">→</a> <a id="15914" class="Symbol">(</a><a id="15915" href="Varieties.FreeAlgebras.html#15908" class="Bound">p</a> <a id="15917" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15919" href="Varieties.FreeAlgebras.html#15910" class="Bound">q</a><a id="15920" class="Symbol">)</a> <a id="15922" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="15924" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="15931" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15933" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="15938" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="15940" class="Symbol">→</a> <a id="15942" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="15944" href="Varieties.EquationalLogic.html#2638" class="Function Operator">⊧</a> <a id="15946" href="Varieties.FreeAlgebras.html#15908" class="Bound">p</a> <a id="15948" href="Varieties.EquationalLogic.html#2638" class="Function Operator">≈</a> <a id="15950" href="Varieties.FreeAlgebras.html#15910" class="Bound">q</a>
  <a id="15954" href="Varieties.FreeAlgebras.html#15897" class="Function">pqlem2</a> <a id="15961" href="Varieties.FreeAlgebras.html#15961" class="Bound">p</a> <a id="15963" href="Varieties.FreeAlgebras.html#15963" class="Bound">q</a> <a id="15965" href="Varieties.FreeAlgebras.html#15965" class="Bound">z</a> <a id="15967" class="Symbol">=</a> <a id="15969" class="Symbol">λ</a> <a id="15971" href="Varieties.FreeAlgebras.html#15971" class="Bound">x</a> <a id="15973" class="Symbol">→</a> <a id="15975" href="Varieties.FreeAlgebras.html#15777" class="Bound">AinMTV</a> <a id="15982" href="Varieties.FreeAlgebras.html#15961" class="Bound">p</a> <a id="15984" href="Varieties.FreeAlgebras.html#15963" class="Bound">q</a> <a id="15986" class="Symbol">(</a><a id="15987" href="Varieties.FreeAlgebras.html#15458" class="Function">kernel-in-theory</a> <a id="16004" href="Varieties.FreeAlgebras.html#15965" class="Bound">z</a><a id="16005" class="Symbol">)</a> <a id="16007" href="Varieties.FreeAlgebras.html#15971" class="Bound">x</a>

  <a id="16012" href="Varieties.FreeAlgebras.html#16012" class="Function">kerincl</a> <a id="16020" class="Symbol">:</a> <a id="16022" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="16029" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16031" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="16036" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16038" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="16040" href="Relations.Discrete.html#4514" class="Function">kernel</a> <a id="16047" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16049" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="16051" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a>
  <a id="16055" href="Varieties.FreeAlgebras.html#16012" class="Function">kerincl</a> <a id="16063" class="Symbol">{</a><a id="16064" href="Varieties.FreeAlgebras.html#16064" class="Bound">p</a> <a id="16066" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16068" href="Varieties.FreeAlgebras.html#16068" class="Bound">q</a><a id="16069" class="Symbol">}</a> <a id="16071" href="Varieties.FreeAlgebras.html#16071" class="Bound">x</a> <a id="16073" class="Symbol">=</a> <a id="16075" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16077" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="16079" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16081" href="Varieties.FreeAlgebras.html#16064" class="Bound">p</a>      <a id="16088" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16091" class="Symbol">(</a><a id="16092" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16109" class="Symbol">(</a><a id="16110" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="16113" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16115" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="16117" class="Symbol">)</a> <a id="16119" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="16121" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a> <a id="16123" href="Varieties.FreeAlgebras.html#16064" class="Bound">p</a><a id="16124" class="Symbol">)</a><a id="16125" href="Overture.Preliminaries.html#4975" class="Function Operator">⁻¹</a> <a id="16128" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16152" class="Symbol">(</a><a id="16153" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="16155" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16157" href="Varieties.FreeAlgebras.html#16064" class="Bound">p</a> <a id="16159" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16160" class="Symbol">)</a> <a id="16162" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a>  <a id="16165" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16168" href="Varieties.FreeAlgebras.html#15897" class="Function">pqlem2</a> <a id="16175" href="Varieties.FreeAlgebras.html#16064" class="Bound">p</a> <a id="16177" href="Varieties.FreeAlgebras.html#16068" class="Bound">q</a> <a id="16179" href="Varieties.FreeAlgebras.html#16071" class="Bound">x</a> <a id="16181" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a> <a id="16183" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16207" class="Symbol">(</a><a id="16208" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="16210" href="Terms.Operations.html#2577" class="Function Operator">⟦</a> <a id="16212" href="Varieties.FreeAlgebras.html#16068" class="Bound">q</a> <a id="16214" href="Terms.Operations.html#2577" class="Function Operator">⟧</a><a id="16215" class="Symbol">)</a> <a id="16217" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a>  <a id="16220" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="16223" href="Terms.Operations.html#2888" class="Function">free-lift-interp</a> <a id="16240" class="Symbol">(</a><a id="16241" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="16244" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16246" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="16248" class="Symbol">)</a> <a id="16250" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="16252" href="Varieties.FreeAlgebras.html#15769" class="Bound">η</a> <a id="16254" href="Varieties.FreeAlgebras.html#16068" class="Bound">q</a> <a id="16256" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                      <a id="16280" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16282" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="16284" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16286" href="Varieties.FreeAlgebras.html#16068" class="Bound">q</a>      <a id="16293" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

  <a id="16298" href="Varieties.FreeAlgebras.html#16298" class="Function">goal</a> <a id="16303" class="Symbol">:</a> <a id="16305" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="16309" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="16311" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a>
  <a id="16315" href="Varieties.FreeAlgebras.html#16298" class="Function">goal</a> <a id="16320" class="Symbol">=</a> <a id="16322" href="Varieties.FreeAlgebras.html#1368" class="Field">fst</a> <a id="16326" class="Symbol">(</a><a id="16327" href="Homomorphisms.Factor.html#3122" class="Function">HomFactorEpi</a> <a id="16340" class="Symbol">(</a><a id="16341" href="Varieties.FreeAlgebras.html#10406" class="Bound">wd</a> <a id="16344" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16346" class="Symbol">(</a><a id="16347" href="Varieties.FreeAlgebras.html#893" class="Primitive">lsuc</a> <a id="16352" class="Symbol">(</a><a id="16353" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16356" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16357" class="Symbol">)))</a> <a id="16361" href="Varieties.FreeAlgebras.html#15766" class="Bound">𝑨</a> <a id="16363" href="Varieties.FreeAlgebras.html#15801" class="Function">φ</a> <a id="16365" href="Varieties.FreeAlgebras.html#11734" class="Function">hom𝔽</a> <a id="16370" href="Varieties.FreeAlgebras.html#16012" class="Function">kerincl</a> <a id="16378" href="Varieties.FreeAlgebras.html#11778" class="Function">hom𝔽-is-epic</a> <a id="16391" href="Varieties.FreeAlgebras.html#15839" class="Function">φE</a><a id="16393" class="Symbol">)</a>

</pre>



#### <a id="the-homomorphic-images-of-F">The homomorphic images of 𝔽</a>

Finally we come to one of the main theorems of this module; it asserts that every algebra in `Mod X (Th 𝕍𝒦)` is a homomorphic image of 𝔽.  We prove this below as the function (or proof object) `𝔽-ModTh-epi`.  Before that, we prove two auxiliary lemmas.

<pre class="Agda">

 <a id="16753" class="Keyword">module</a> <a id="16760" href="Varieties.FreeAlgebras.html#16760" class="Module">_</a> <a id="16762" class="Symbol">(</a><a id="16763" href="Varieties.FreeAlgebras.html#16763" class="Bound">pe</a> <a id="16766" class="Symbol">:</a> <a id="16768" href="Equality.Extensionality.html#3081" class="Function">pred-ext</a> <a id="16777" class="Symbol">(</a><a id="16778" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16781" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16782" class="Symbol">)(</a><a id="16784" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16787" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16788" class="Symbol">))(</a><a id="16791" href="Varieties.FreeAlgebras.html#16791" class="Bound">wd</a> <a id="16794" class="Symbol">:</a> <a id="16796" href="Equality.Welldefined.html#2944" class="Function">SwellDef</a><a id="16804" class="Symbol">)</a> <a id="16806" class="Comment">-- extensionality assumptions</a>
          <a id="16846" class="Symbol">(</a><a id="16847" href="Varieties.FreeAlgebras.html#16847" class="Bound">Cset</a> <a id="16852" class="Symbol">:</a> <a id="16854" href="Equality.Truncation.html#6506" class="Function">is-set</a> <a id="16861" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16863" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="16865" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="16866" class="Symbol">)</a>                       <a id="16890" class="Comment">-- truncation assumptions</a>
          <a id="16926" class="Symbol">(</a><a id="16927" href="Varieties.FreeAlgebras.html#16927" class="Bound">kuip</a> <a id="16932" class="Symbol">:</a> <a id="16934" href="Equality.Truncation.html#10764" class="Function">blk-uip</a><a id="16941" class="Symbol">(</a><a id="16942" href="Terms.Basic.html#1991" class="Datatype">Term</a> <a id="16947" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="16948" class="Symbol">)</a><a id="16949" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a> <a id="16951" href="Homomorphisms.Kernels.html#2617" class="Function">kercon</a> <a id="16958" class="Symbol">(</a><a id="16959" href="Varieties.FreeAlgebras.html#16791" class="Bound">wd</a> <a id="16962" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="16964" class="Symbol">(</a><a id="16965" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="16968" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="16969" class="Symbol">)){</a><a id="16972" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a><a id="16973" class="Symbol">}</a><a id="16974" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="16979" href="Overture.Preliminaries.html#4382" class="Function Operator">∣</a><a id="16980" class="Symbol">)</a>
  <a id="16984" class="Keyword">where</a>

  <a id="16993" href="Varieties.FreeAlgebras.html#16993" class="Function">𝔽≤ℭ</a> <a id="16997" class="Symbol">:</a> <a id="16999" class="Symbol">(</a><a id="17000" href="Homomorphisms.Kernels.html#3025" class="Function Operator">ker[</a> <a id="17005" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="17007" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="17009" href="Homomorphisms.Kernels.html#3025" class="Function Operator">⇒</a> <a id="17011" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="17013" href="Homomorphisms.Kernels.html#3025" class="Function Operator">]</a> <a id="17015" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="17020" href="Homomorphisms.Kernels.html#3025" class="Function Operator">↾</a> <a id="17022" class="Symbol">(</a><a id="17023" href="Varieties.FreeAlgebras.html#16791" class="Bound">wd</a> <a id="17026" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17028" class="Symbol">(</a><a id="17029" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17032" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17033" class="Symbol">)))</a> <a id="17037" href="Subalgebras.Subalgebras.html#2186" class="Function Operator">≤</a> <a id="17039" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a>
  <a id="17043" href="Varieties.FreeAlgebras.html#16993" class="Function">𝔽≤ℭ</a> <a id="17047" class="Symbol">=</a> <a id="17049" href="Subalgebras.Subalgebras.html#4012" class="Function">FirstHomCorollary|Set</a> <a id="17071" class="Symbol">(</a><a id="17072" href="Terms.Basic.html#3274" class="Function">𝑻</a> <a id="17074" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="17075" class="Symbol">)</a> <a id="17077" href="Varieties.FreeAlgebras.html#10805" class="Function">ℭ</a> <a id="17079" href="Varieties.FreeAlgebras.html#10992" class="Function">homℭ</a> <a id="17084" href="Varieties.FreeAlgebras.html#16763" class="Bound">pe</a> <a id="17087" class="Symbol">(</a><a id="17088" href="Varieties.FreeAlgebras.html#16791" class="Bound">wd</a> <a id="17091" href="Varieties.FreeAlgebras.html#991" class="Bound">𝓥</a> <a id="17093" class="Symbol">(</a><a id="17094" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="17097" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="17098" class="Symbol">))</a> <a id="17101" href="Varieties.FreeAlgebras.html#16847" class="Bound">Cset</a> <a id="17106" href="Varieties.FreeAlgebras.html#16927" class="Bound">kuip</a>

</pre>

The last piece we need to prove that every model of `Th 𝕍𝒦` is a homomorphic image of `𝔽` is a crucial assumption that is taken for granted throughout informal universal algebra---namely, that our collection `X` of variable symbols is arbitrarily large and that we have an *environment* which interprets the variable symbols in every algebra under consideration. In other terms, an environment provides, for every algebra `𝑨`, a surjective mapping `η : X → ∣ 𝑨 ∣` from `X` onto the domain of `𝑨`.

We do *not* assert that for an arbitrary type `X` such surjective maps exist.  Indeed, our `X` must is quite special to have this property.  Later, we will construct such an `X`, but for now we simply postulate its existence. Note that this assumption that an environment exists is only required in the proof of the theorem `𝔽-ModTh-epi`.



#### <a id="F-in-VK">𝔽 ∈ V(𝒦)</a>

With this result in hand, along with what we proved earlier---namely, `PS(𝒦) ⊆ SP(𝒦) ⊆ HSP(𝒦) ≡ V 𝒦`---it is not hard to show that `𝔽` belongs to `V 𝒦`.

<pre class="Agda">

  <a id="18169" href="Varieties.FreeAlgebras.html#18169" class="Function">𝔽∈SP</a> <a id="18174" class="Symbol">:</a> <a id="18176" href="Equality.Truncation.html#3855" class="Function">hfunext</a> <a id="18184" class="Symbol">(</a><a id="18185" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18188" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18189" class="Symbol">)(</a><a id="18191" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18194" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18195" class="Symbol">)</a> <a id="18197" class="Symbol">→</a> <a id="18199" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="18201" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18203" class="Symbol">(</a><a id="18204" href="Varieties.Closure.html#3783" class="Datatype">S</a><a id="18205" class="Symbol">{</a><a id="18206" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="18207" class="Symbol">}{</a><a id="18209" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="18211" class="Symbol">}</a> <a id="18213" class="Symbol">(</a><a id="18214" href="Varieties.Closure.html#4359" class="Datatype">P</a><a id="18215" class="Symbol">{</a><a id="18216" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18217" class="Symbol">}{</a><a id="18219" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="18220" class="Symbol">}</a> <a id="18222" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a><a id="18223" class="Symbol">))</a>
  <a id="18228" href="Varieties.FreeAlgebras.html#18169" class="Function">𝔽∈SP</a> <a id="18233" href="Varieties.FreeAlgebras.html#18233" class="Bound">hfe</a> <a id="18237" class="Symbol">=</a> <a id="18239" href="Varieties.Closure.html#3991" class="InductiveConstructor">ssub</a> <a id="18244" class="Symbol">(</a><a id="18245" href="Varieties.Preservation.html#13066" class="Function">class-prod-s-∈-sp</a> <a id="18263" href="Varieties.FreeAlgebras.html#18233" class="Bound">hfe</a><a id="18266" class="Symbol">)</a> <a id="18268" href="Varieties.FreeAlgebras.html#16993" class="Function">𝔽≤ℭ</a>

  <a id="18275" href="Varieties.FreeAlgebras.html#18275" class="Function">𝔽∈𝕍</a> <a id="18279" class="Symbol">:</a> <a id="18281" href="Equality.Truncation.html#3855" class="Function">hfunext</a> <a id="18289" class="Symbol">(</a><a id="18290" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18293" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18294" class="Symbol">)(</a><a id="18296" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18299" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18300" class="Symbol">)</a> <a id="18302" class="Symbol">→</a> <a id="18304" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="18306" href="Relation.Unary.html#1523" class="Function Operator">∈</a> <a id="18308" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="18310" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
  <a id="18314" href="Varieties.FreeAlgebras.html#18275" class="Function">𝔽∈𝕍</a> <a id="18318" href="Varieties.FreeAlgebras.html#18318" class="Bound">hfe</a> <a id="18322" class="Symbol">=</a> <a id="18324" href="Varieties.Preservation.html#9359" class="Function">SP⊆V&#39;</a> <a id="18330" class="Symbol">{</a><a id="18331" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18332" class="Symbol">}{</a><a id="18334" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="18337" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="18339" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18340" class="Symbol">}{</a><a id="18342" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="18345" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a> <a id="18348" href="Varieties.FreeAlgebras.html#3799" class="Function">𝓕⁺</a><a id="18350" class="Symbol">}{</a><a id="18352" href="Varieties.FreeAlgebras.html#10392" class="Bound">fe</a> <a id="18355" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a> <a id="18357" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="18358" class="Symbol">}{</a><a id="18360" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a><a id="18361" class="Symbol">}</a> <a id="18363" class="Symbol">(</a><a id="18364" href="Varieties.FreeAlgebras.html#18169" class="Function">𝔽∈SP</a> <a id="18369" href="Varieties.FreeAlgebras.html#18318" class="Bound">hfe</a><a id="18372" class="Symbol">)</a>

</pre>

#### The HSP Theorem

Now that we have all of the necessary ingredients, it is all but trivial to
combine them to prove Birkhoff's HSP theorem. (Note that since the proof enlists
the help of the `𝔽-ModTh-epi` theorem, we must assume an environment exists,
which is manifested in the premise `∀ 𝑨 → X ↠ 𝑨`.

<pre class="Agda">

  <a id="18710" href="Varieties.FreeAlgebras.html#18710" class="Function">Birkhoff</a> <a id="18719" class="Symbol">:</a> <a id="18721" href="Equality.Truncation.html#3855" class="Function">hfunext</a> <a id="18729" class="Symbol">(</a><a id="18730" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18733" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18734" class="Symbol">)(</a><a id="18736" href="Algebras.Products.html#3135" class="Function">ov</a> <a id="18739" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="18740" class="Symbol">)</a> <a id="18742" class="Symbol">→</a> <a id="18744" class="Symbol">(∀</a> <a id="18747" href="Varieties.FreeAlgebras.html#18747" class="Bound">𝑨</a> <a id="18749" class="Symbol">→</a> <a id="18751" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a> <a id="18753" href="Varieties.FreeAlgebras.html#15597" class="Function Operator">↠</a> <a id="18755" href="Varieties.FreeAlgebras.html#18747" class="Bound">𝑨</a><a id="18756" class="Symbol">)</a> <a id="18758" class="Symbol">→</a> <a id="18760" href="Varieties.EquationalLogic.html#4084" class="Function">Mod</a> <a id="18764" class="Symbol">(</a><a id="18765" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a> <a id="18768" class="Symbol">(</a><a id="18769" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="18771" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a><a id="18772" class="Symbol">))</a> <a id="18775" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="18777" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="18779" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a>
  <a id="18783" href="Varieties.FreeAlgebras.html#18710" class="Function">Birkhoff</a> <a id="18792" href="Varieties.FreeAlgebras.html#18792" class="Bound">hfe</a> <a id="18796" href="Varieties.FreeAlgebras.html#18796" class="Bound">𝕏</a> <a id="18798" class="Symbol">{</a><a id="18799" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a><a id="18800" class="Symbol">}</a> <a id="18802" href="Varieties.FreeAlgebras.html#18802" class="Bound">α</a> <a id="18804" class="Symbol">=</a> <a id="18806" href="Varieties.Closure.html#5593" class="InductiveConstructor">vhimg</a><a id="18811" class="Symbol">{</a><a id="18812" class="Argument">𝑩</a> <a id="18814" class="Symbol">=</a> <a id="18816" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a><a id="18817" class="Symbol">}</a> <a id="18819" class="Symbol">(</a><a id="18820" href="Varieties.FreeAlgebras.html#18275" class="Function">𝔽∈𝕍</a> <a id="18824" href="Varieties.FreeAlgebras.html#18792" class="Bound">hfe</a><a id="18827" class="Symbol">)</a> <a id="18829" class="Symbol">(</a><a id="18830" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a> <a id="18832" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18834" href="Homomorphisms.Basic.html#4752" class="Function">epi→hom</a> <a id="18842" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a> <a id="18844" href="Varieties.FreeAlgebras.html#18873" class="Function">φE</a> <a id="18847" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18849" href="Varieties.FreeAlgebras.html#1383" class="Field">snd</a> <a id="18853" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a> <a id="18855" href="Varieties.FreeAlgebras.html#18873" class="Function">φE</a> <a id="18858" href="Overture.Preliminaries.html#4420" class="Function Operator">∥</a><a id="18859" class="Symbol">)</a>
   <a id="18864" class="Keyword">where</a>
   <a id="18873" href="Varieties.FreeAlgebras.html#18873" class="Function">φE</a> <a id="18876" class="Symbol">:</a> <a id="18878" href="Homomorphisms.Basic.html#4291" class="Function">epi</a> <a id="18882" href="Varieties.FreeAlgebras.html#11617" class="Function">𝔽</a> <a id="18884" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a>
   <a id="18889" href="Varieties.FreeAlgebras.html#18873" class="Function">φE</a> <a id="18892" class="Symbol">=</a> <a id="18894" href="Varieties.FreeAlgebras.html#15682" class="Function">𝔽-ModTh-epi</a> <a id="18906" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a> <a id="18908" class="Symbol">(</a><a id="18909" href="Varieties.FreeAlgebras.html#18796" class="Bound">𝕏</a> <a id="18911" href="Varieties.FreeAlgebras.html#18799" class="Bound">𝑨</a><a id="18912" class="Symbol">)</a> <a id="18914" href="Varieties.FreeAlgebras.html#18802" class="Bound">α</a>

</pre>

The converse inclusion, `V 𝒦 ⊆ Mod X (Th (V 𝒦))`, is a simple consequence of the
fact that `Mod Th` is a closure operator. Nonetheless, completeness demands
that we formalize this inclusion as well, however trivial the proof.

<pre class="Agda">

  <a id="19172" href="Varieties.FreeAlgebras.html#19172" class="Function">Birkhoff-converse</a> <a id="19190" class="Symbol">:</a> <a id="19192" href="Varieties.Closure.html#5312" class="Datatype">V</a><a id="19193" class="Symbol">{</a><a id="19194" href="Varieties.FreeAlgebras.html#987" class="Bound">α</a><a id="19195" class="Symbol">}{</a><a id="19197" href="Varieties.FreeAlgebras.html#3797" class="Function">𝓕</a><a id="19198" class="Symbol">}</a> <a id="19200" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a> <a id="19202" href="Relation.Unary.html#1742" class="Function Operator">⊆</a> <a id="19204" href="Varieties.EquationalLogic.html#4084" class="Function">Mod</a><a id="19207" class="Symbol">{</a><a id="19208" class="Argument">X</a> <a id="19210" class="Symbol">=</a> <a id="19212" href="Varieties.FreeAlgebras.html#10421" class="Bound">X</a><a id="19213" class="Symbol">}</a> <a id="19215" class="Symbol">(</a><a id="19216" href="Varieties.EquationalLogic.html#3510" class="Function">Th</a> <a id="19219" class="Symbol">(</a><a id="19220" href="Varieties.Closure.html#5312" class="Datatype">V</a> <a id="19222" href="Varieties.FreeAlgebras.html#10434" class="Bound">𝒦</a><a id="19223" class="Symbol">))</a>
  <a id="19228" href="Varieties.FreeAlgebras.html#19172" class="Function">Birkhoff-converse</a> <a id="19246" href="Varieties.FreeAlgebras.html#19246" class="Bound">α</a> <a id="19248" href="Varieties.FreeAlgebras.html#19248" class="Bound">p</a> <a id="19250" href="Varieties.FreeAlgebras.html#19250" class="Bound">q</a> <a id="19252" href="Varieties.FreeAlgebras.html#19252" class="Bound">pThq</a> <a id="19257" class="Symbol">=</a> <a id="19259" href="Varieties.FreeAlgebras.html#19252" class="Bound">pThq</a> <a id="19264" href="Varieties.FreeAlgebras.html#19246" class="Bound">α</a>

</pre>

We have thus proved that every variety is an equational class.  Readers familiar
with the classical formulation of the Birkhoff HSP theorem, as an "if and only
if" result, might worry that we haven't completed the proof.  But recall that
in the [Varieties.Preservation][] module we proved the following identity
preservation lemmas:

* `𝒦 ⊫ p ≈ q → H 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → S 𝒦 ⊫ p ≈ q`
* `𝒦 ⊫ p ≈ q → P 𝒦 ⊫ p ≈ q`

From these it follows that every equational class is a variety. Thus, our formal
proof of Birkhoff's theorem is complete.

--------------------------------

<span style="float:left;">[← Varieties.Preservation](Varieties.Preservation.html)</span>
<span style="float:right;">[Varieties.Func →](Varieties.Func.html)</span>

{% include UALib.Links.md %}
